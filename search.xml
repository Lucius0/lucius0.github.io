<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[è„šæ‰‹æ¶çš„ç•¥çŸ¥ä¸€äºŒ]]></title>
      <url>https://lucius0.github.io/2018/07/18/archivers/about-scaffold/</url>
      <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯è„šæ‰‹æ¶ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è„šæ‰‹æ¶ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è„šæ‰‹æ¶ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è„šæ‰‹æ¶ï¼Ÿ</h2><p>å½“æˆ‘ä»¬å»ºé€ æˆ¿å­çš„æ—¶å€™ï¼Œå·¥åœ°ä¸Šä¼šå…ˆæ­ä¸ªæ¶å­ï¼Œç„¶åå·¥äººä»¬ä¼šåœ¨è¿™ä¸ªçš„åŸºç¡€ä¸Šæ·»ç –åŠ ç“¦ï¼Œç›´åˆ°æˆ¿å±‹æˆå‹ã€‚é‚£ä¹ˆæˆ‘ä»¬ç¨‹åºä¹Ÿæ˜¯è¿™æ ·çš„é“ç†ï¼Œä¼šåœ¨æˆ‘ä»¬å¼€å‘ä¹‹å‰æœ‰ä¸€å¥—ç›¸å¯¹æˆç†Ÿä¸”é€‚ç”¨çš„æ¶å­(é…ç½®é¡¹ã€æŠ€æœ¯æ ˆ)ï¼Œç„¶åæˆ‘ä»¬ä¼šåœ¨è¿™åŸºç¡€ä¸Šç›´æ¥äº§å‡ºéœ€æ±‚åŠŸèƒ½ï¼Œè€Œéœ€æ±‚é‡å¤çš„é€ æ¶å­ã€‚è„šæ‰‹æ¶åœ¨æˆ‘ä»¬å¼€å‘é¡¹ç›®ä¸­ä¹Ÿæ˜¯æå…¶é‡è¦ï¼Œèƒ½å¤Ÿæé«˜æˆ‘ä»¬çš„å¼€å‘ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180718232750.png?imageslim" alt=""></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¼€å‘ä¸­æœ‰ç”¨åˆ°å“ªäº›è„šæ‰‹æ¶å‘¢ï¼Ÿæœ‰<code>vue-cli</code>ã€<code>create-react-app</code>ã€<code>yeoman</code>ç­‰ã€‚</p>
<h2 id="Yeoman"><a href="#Yeoman" class="headerlink" title="Yeoman"></a>Yeoman</h2><p><a href="http://yeoman.io/" target="_blank" rel="noopener">yeoman</a>è¾ƒçœŸæ¥è®²æ›´åº”è¯¥ç§°ä¸ºè„šæ‰‹æ¶æ¡†æ¶ï¼Œå› ä¸ºå®ƒä¸èƒ½ç›´æ¥åˆ›å»ºé¡¹ç›®æ–‡ä»¶ï¼Œè€Œæ˜¯æä¾›äº†ä¸€å¥—å®Œæ•´çš„å¼€å‘APIï¼Œå¯ä»¥é€šè¿‡è¿™äº›APIæ¥çµæ´»åœ°æ¥åˆ¶é€ ç¬¦åˆä½ éœ€æ±‚çš„è„šæ‰‹æ¶æ–¹æ¡ˆã€‚</p>
<h3 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h3><p>æˆ‘ä»¬å…ˆæ¥åˆ›å»ºä¸€ä¸ª<code>yeoman</code>è„šæ‰‹æ¶ç”Ÿæˆå™¨ï¼Œ<strong>æ³¨æ„æ–‡ä»¶å¤¹çš„åå­—å¾—ä¸ºgenerator-å¼€å¤´ï¼Œå¦‚generator-vuecliã€generator-createapp</strong>ã€‚</p>
<ul>
<li><code>npm install --global yo</code> </li>
<li><code>mkdir generator-testcli &amp;&amp; cd generator-testcli</code></li>
<li><code>npm init</code>ï¼Œç”Ÿæˆ<code>package.json</code>éœ€è¦ä¸»è¦å‡ ç‚¹ï¼š<ul>
<li>name å±æ€§å¿…é¡»å¸¦æœ‰å‰ç¼€ <code>generator-</code></li>
<li>keywords å±æ€§å¿…é¡»å«æœ‰ <code>yeoman-generator</code>ï¼›</li>
</ul>
</li>
<li><code>npm install --save yeoman-generator</code></li>
</ul>
<p><code>yeoman-generator</code>ï¼šyeoman ä¼šæ ¹æ®ç”¨æˆ·é€‰æ‹©çš„ <code>generator</code> ä¸‹è½½çš„æœ¬åœ°ï¼Œå…¶ä¸­ <code>generator</code> æŒ‡çš„æ˜¯ä¸€å¥—å…·æœ‰æ¨¡æ¿çš„é¡¹ç›®ã€‚<br>åœ¨å®˜æ–¹ä¾‹å­ä¸­<code>generator-fountain-webapp</code>å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ª<code>generator</code>ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä½ è¦çš„<code>generator</code>ï¼Œå¦‚è¾“å…¥å‘½ä»¤è¡Œ<code>yo</code>ï¼Œä¼šæœ‰é€‰é¡¹<code>Install a generator</code>è®©ä½ é€‰æ‹©ä½ æƒ³è¦å®‰è£…çš„<code>generator</code>ã€‚</p>
<p><strong>æç¤ºï¼š</strong>å‡å¦‚å®‰è£…è¿‡ç¨‹æŠ¥<code>Error: EACCES, permission denied</code>é”™è¯¯ï¼Œè¯·ä½¿ç”¨<code>sudo npm</code>è¿›è¡Œå®‰è£…ã€‚</p>
<h3 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h3><p><code>yeoman</code>æ”¯æŒä¸¤ç§ä¸åŒçš„ç›®å½•ç»“æ„ï¼š./ å’Œ ./generatorsã€‚å³ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">|---- package.json</span><br><span class="line">|---- generators/</span><br><span class="line">    |---- app/</span><br><span class="line">        |---- index.js</span><br><span class="line">    |---- router/</span><br><span class="line">        |---- index.js</span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line">|---- package.json</span><br><span class="line">|---- app/</span><br><span class="line">    |---- index.js</span><br><span class="line">|---- router/</span><br><span class="line">    |---- index.js</span><br></pre></td></tr></table></figure></p>
<h3 id="é‡å†™æ„é€ å‡½æ•°"><a href="#é‡å†™æ„é€ å‡½æ•°" class="headerlink" title="é‡å†™æ„é€ å‡½æ•°"></a>é‡å†™æ„é€ å‡½æ•°</h3><p>æŸäº›ç”Ÿæˆå™¨æ–¹æ³•åªèƒ½åœ¨æ„é€ å‡½æ•°å†…éƒ¨è°ƒç”¨ã€‚è¿™äº›ç‰¹æ®Šæ–¹æ³•å¯èƒ½ä¼šæ‰§è¡Œè¯¸å¦‚è®¾ç½®é‡è¦çŠ¶æ€æ§ä»¶ä¹‹ç±»çš„æ“ä½œï¼Œå¹¶ä¸”å¯èƒ½æ— æ³•åœ¨æ„é€ å‡½æ•°ä¹‹å¤–è¿è¡Œã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Generator = <span class="built_in">require</span>(<span class="string">'yeoman-generator'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">Generator</span> </span>&#123;</span><br><span class="line">  <span class="comment">// The name `constructor` is important here</span></span><br><span class="line">  <span class="keyword">constructor</span>(args, opts) &#123;</span><br><span class="line">    <span class="comment">// Calling the super constructor is important so our generator is correctly set up</span></span><br><span class="line">    <span class="keyword">super</span>(args, opts);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Next, add your custom code</span></span><br><span class="line">    <span class="keyword">this</span>.option(<span class="string">'babel'</span>); <span class="comment">// This method adds support for a `--babel` flag</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h3 id="æ·»åŠ åŠŸèƒ½å‡½æ•°"><a href="#æ·»åŠ åŠŸèƒ½å‡½æ•°" class="headerlink" title="æ·»åŠ åŠŸèƒ½å‡½æ•°"></a>æ·»åŠ åŠŸèƒ½å‡½æ•°</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">method1() &#123;</span><br><span class="line">  <span class="keyword">this</span>.log(<span class="string">'method 1 just ran'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">method2() &#123;</span><br><span class="line">  <span class="keyword">this</span>.log(<span class="string">'method 2 just ran'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®Œæ•´ä»£ç ä¸ºï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Generator = <span class="built_in">require</span>(<span class="string">'yeoman-generator'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">Generator</span> </span>&#123;</span><br><span class="line">  <span class="comment">// The name `constructor` is important here</span></span><br><span class="line">  <span class="keyword">constructor</span>(args, opts) &#123;</span><br><span class="line">    <span class="comment">// Calling the super constructor is important so our generator is correctly set up</span></span><br><span class="line">    <span class="keyword">super</span>(args, opts);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Next, add your custom code</span></span><br><span class="line">    <span class="keyword">this</span>.option(<span class="string">'babel'</span>); <span class="comment">// This method adds support for a `--babel` flag</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  method1() &#123;</span><br><span class="line">    <span class="keyword">this</span>.log(<span class="string">'method 1 just ran'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  method2() &#123;</span><br><span class="line">    <span class="keyword">this</span>.log(<span class="string">'method 2 just ran'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h3 id="npmç»‘å®šå…¨å±€"><a href="#npmç»‘å®šå…¨å±€" class="headerlink" title="npmç»‘å®šå…¨å±€"></a>npmç»‘å®šå…¨å±€</h3><p>ä½¿ç”¨ npm åˆ›å»ºä¸€ä¸ªnodeå…¨å±€æ¨¡å—ï¼Œå¹¶ä¸”è¿æ¥åˆ°æœ¬åœ°ã€‚åœ¨è„šæ‰‹æ¶é¡¹ç›®æ ¹ç›®å½•ä¸‹<code>generator-name/</code>ï¼Œè¾“å…¥<code>npm link</code>ã€‚</p>
<h3 id="æ‰§è¡Œ"><a href="#æ‰§è¡Œ" class="headerlink" title="æ‰§è¡Œ"></a>æ‰§è¡Œ</h3><p><code>yo testcli</code>ï¼Œä¼šå‡ºç°å¦‚ä¸‹å›¾ä¿¡æ¯ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180718233135.png?imageslim" alt=""></p>
<p>åˆ°è¿™é‡Œä¸€ä¸ªå°å°çš„å®˜æ–¹demoå·²ç»æ‰§è¡Œå®Œæˆäº†ï¼Œæ›´å¤šçš„å¯ä»¥æŸ¥çœ‹<a href="http://yeoman.io/authoring/index.html" target="_blank" rel="noopener">Writing Your Own Yeoman Generator | Yeoman</a></p>
<h2 id="è‡ªå®šä¹‰å‰ç«¯è„šæ‰‹æ¶"><a href="#è‡ªå®šä¹‰å‰ç«¯è„šæ‰‹æ¶" class="headerlink" title="è‡ªå®šä¹‰å‰ç«¯è„šæ‰‹æ¶"></a>è‡ªå®šä¹‰å‰ç«¯è„šæ‰‹æ¶</h2><p>åˆšæ‰åœ¨ä¸Šé—®å·²ç»è¯´äº†ï¼Œ<code>yeoman</code>å®é™…ä¸Šæ›´åƒæ˜¯ä¸€ä¸ªè„šæ‰‹æ¶æ¡†æ¶ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥æ‰“é€ å„ç§åˆ©å™¨(è„šæ‰‹æ¶)ã€‚é‚£æˆ‘ä»¬ç°åœ¨å°±ä»å¤´å¼€å§‹å­¦ä¹ ä¸‹æ€ä¹ˆæ‰“é€ ä¸€ä¸ªåˆ©å™¨ã€‚</p>
<p>æˆ‘ä»¬ç°åœ¨å°±æ¥ç®€å•çš„åšä¸€ä¸ªå°æ —å­ï¼Œæ‰§è¡Œ<code>init</code>æ—¶ä¼šæ‹‰å–GitHubä¸Šé¢çš„ä»£ç ã€‚<strong>ä¸Šé¢å·²ç»è¯´è¿‡äº†ï¼Œå®é™…ä¸Šå°±æ˜¯ç›¸å½“äºcloneä¸€ä¸ªåŸºç¡€é¡¹ç›®åˆ°æœ¬åœ°ã€‚</strong></p>
<h3 id="èµ·æ­¥"><a href="#èµ·æ­¥" class="headerlink" title="èµ·æ­¥"></a>èµ·æ­¥</h3><p>æˆ‘ä»¬æŠŠè¿™ä¸ªé¡¹ç›®ç§°ä¸º<strong>messi</strong>å§ã€‚</p>
<ul>
<li><code>mkdir messi &amp;&amp; cd messi</code>ï¼›</li>
<li><code>npm init</code>(æ­¤å¤„çš„<code>package.json</code>å°±æ²¡æœ‰<code>yeoman</code>é‚£æ ·éœ€è¦nameè·Ÿkeyæœ‰å‰ç¼€çš„è¦æ±‚äº†)ï¼›</li>
<li><code>npm install --save chalk co co-prompt commander</code><ul>
<li><a href="https://github.com/chalk/chalk" target="_blank" rel="noopener">chalk</a>ï¼šèƒ½åœ¨terminalä¸­æ˜¾ç¤ºè‡ªå®šä¹‰å­—ç¬¦ä¸²é¢œè‰²çš„æ’ä»¶ï¼›</li>
<li><a href="https://github.com/tj/co" target="_blank" rel="noopener">co</a>ï¼šå¼‚æ­¥æµç¨‹æ§åˆ¶å·¥å…·ï¼›</li>
<li><a href="https://github.com/tj/co-prompt" target="_blank" rel="noopener">co-prompt</a>ï¼šä¸ä½†å¯ä»¥æä¾›æç¤ºä¿¡æ¯ï¼Œè¿˜å¯ä»¥åˆ†æ­¥éª¤è¾“å…¥ä½ æƒ³è¦çš„å‚æ•°å’Œé€‰é¡¹ï¼›</li>
<li><a href="https://github.com/tj/commander.js/" target="_blank" rel="noopener">commander</a>ï¼šæœ‰æ•ˆçš„ç»„ç»‡terminalçš„è¾“å…¥ï¼›</li>
</ul>
</li>
</ul>
<h3 id="å…¥å£æ–‡ä»¶"><a href="#å…¥å£æ–‡ä»¶" class="headerlink" title="å…¥å£æ–‡ä»¶"></a>å…¥å£æ–‡ä»¶</h3><p>æˆ‘ä»¬åœ¨æ ¹ç›®å½•åˆ›å»º<code>/bin</code>æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨è¯¥æ–‡ä»¶å¤¹åˆ›å»ºçš„æ–‡ä»¶<code>messi.js</code>ã€‚å³<code>bin/messi.js</code>ä¸ºæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®çš„å…¥å£æ–‡ä»¶ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bin/messi.js</span></span><br><span class="line"><span class="comment">// æ‰§è¡Œç¯å¢ƒèƒ½å¤Ÿæ”¯æŒES6</span></span><br><span class="line"><span class="meta">#!/usr/bin/env node --harmony</span></span><br><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>);</span><br><span class="line"><span class="keyword">const</span> pkg = <span class="built_in">require</span>(<span class="string">'../package'</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// å®šä¹‰å½“å‰ç‰ˆæœ¬</span></span><br><span class="line">program.version(pkg.version);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä½¿ç”¨æ–¹æ³•</span></span><br><span class="line"><span class="comment">// Usage: messi [options] [command] -&gt; </span></span><br><span class="line"><span class="comment">// Usage: messi &lt;command&gt;</span></span><br><span class="line"><span class="comment">// åŒºåˆ«å°±æ˜¯å¯é€‰åˆ°å¿…é€‰</span></span><br><span class="line">program</span><br><span class="line">  .usage(<span class="string">'&lt;command&gt;'</span>);</span><br><span class="line"></span><br><span class="line">program.parse(process.argv);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!program.args.length) &#123;</span><br><span class="line">  program.help();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æŒ‚è½½å…¨å±€"><a href="#æŒ‚è½½å…¨å±€" class="headerlink" title="æŒ‚è½½å…¨å±€"></a>æŒ‚è½½å…¨å±€</h3><p>å…¶å®è¿™æ ·å°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†ã€‚æˆ‘ä»¬ç°åœ¨åœ¨<code>package.json</code>æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œè¡¨ç¤ºå…¨å±€é’©å­<code>messi</code>çš„åŠ è½½æ–‡ä»¶æ˜¯<code>bin/messi.js</code>ã€‚</p>
<p>ä¾‹å¦‚ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="regexp">/usr/</span>local/bin/messi -&gt; <span class="regexp">/usr/</span>local/lib/node_modules/messi/bin/messi.js</span><br><span class="line">&gt;&gt;&gt; <span class="regexp">/usr/</span>local/lib/node_modules/messi -&gt; <span class="regexp">/Users/</span>xxx/Documents/study/messi</span><br></pre></td></tr></table></figure></p>
<p><strong>package.json</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"bin": &#123;</span><br><span class="line">  "messi": "bin/messi.js"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç„¶ååœ¨æ ¹ç›®å½•æ‰§è¡Œ<code>npm link</code>æˆ–<code>sudo npm link</code>ã€‚æ‰“å¼€å¦ä¸€ä¸ªterminalæ ‡ç­¾æ‰§è¡Œ<code>messi</code>å‘½ä»¤ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180718233522.png?imageslim" alt=""></p>
<h3 id="æ·»åŠ initæ¨¡ç‰ˆ"><a href="#æ·»åŠ initæ¨¡ç‰ˆ" class="headerlink" title="æ·»åŠ initæ¨¡ç‰ˆ"></a>æ·»åŠ initæ¨¡ç‰ˆ</h3><p>æˆ‘ä»¬åœ¨æ ¹ç›®å½•åˆ›å»º<code>command</code>æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨å…¶æ–‡ä»¶å¤¹åˆ›å»ºæˆ‘ä»¬çš„ä¸»è§’<code>init.js</code>ã€‚ç›®çš„æ˜¯æƒ³é€šè¿‡<code>init</code>ä»è¿œç«¯ä»“åº“æ‹‰å–ä¸€ä¸ªé¡¹ç›®æ¨¡æ¿ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦åœ¨<code>messi.js</code>æ·»åŠ äº†ç›¸å¯¹åº”çš„å‘½ä»¤è¡Œã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// messi.js</span></span><br><span class="line"><span class="keyword">const</span> init = <span class="built_in">require</span>(<span class="string">'../init'</span>);</span><br><span class="line"></span><br><span class="line">program</span><br><span class="line">  .command(<span class="string">'init'</span>)</span><br><span class="line">  .description(<span class="string">'åˆ›å»ºæ–°é¡¹ç›®'</span>)</span><br><span class="line">  .alias(<span class="string">'i'</span>)</span><br><span class="line">  .action(<span class="function"><span class="params">()</span> =&gt;</span> &#123; init(); &#125;);</span><br></pre></td></tr></table></figure></p>
<p>ç„¶åæˆ‘ä»¬éœ€è¦åœ¨<code>init.js</code>æ·»åŠ é€»è¾‘ä»£ç ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// init.js</span></span><br><span class="line"><span class="keyword">const</span> co = <span class="built_in">require</span>(<span class="string">'co'</span>);</span><br><span class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">'chalk'</span>)</span><br><span class="line"><span class="keyword">const</span> prompt = <span class="built_in">require</span>(<span class="string">'co-prompt'</span>);</span><br><span class="line"><span class="keyword">const</span> exec = <span class="built_in">require</span>(<span class="string">'child_process'</span>).exec;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(chalk.white(<span class="string">'init...'</span>));</span><br><span class="line"></span><br><span class="line">  co(<span class="function"><span class="keyword">function</span> *(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> pull = <span class="keyword">yield</span> prompt(<span class="string">'ä½ æ˜¯å¦æƒ³è¦æ‹‰å–scaffold-clié¡¹ç›®? y/n '</span>);</span><br><span class="line">    pull = pull.toLowerCase();</span><br><span class="line">    <span class="keyword">if</span> (pull === <span class="string">'n'</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(chalk.red(<span class="string">'å·²ç»æˆåŠŸé€€å‡º!'</span>));</span><br><span class="line">      process.exit()</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pull === <span class="string">'y'</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> projectName = <span class="keyword">yield</span> prompt(<span class="string">'é¡¹ç›®åç§°ï¼š'</span>);</span><br><span class="line">      <span class="keyword">const</span> gitCmd = <span class="string">`git clone git@github.com:Lucius0/scaffold-cli.git <span class="subst">$&#123;projectName&#125;</span> &amp;&amp; cd <span class="subst">$&#123;projectName&#125;</span> &amp;&amp; git checkout master`</span>;</span><br><span class="line">    </span><br><span class="line">      <span class="built_in">console</span>.log(chalk.white(<span class="string">'å¼€å§‹æ‹‰å–...'</span>));</span><br><span class="line"></span><br><span class="line">      exec(gitCmd, (error, stdout, stderr) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (error) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(error);</span><br><span class="line">          process.exit();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(chalk.green(<span class="string">'æ‹‰å–æˆåŠŸ!'</span>));</span><br><span class="line">        process.exit()</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>åˆ°æ­¤åˆ»ä¸ºæ­¢ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šçš„ä¸€ä¸ªå°demoå·²ç»å®Œæˆäº†ã€‚å…³äº<code>exec</code>æ–¹æ³•ï¼Œå¯ä»¥é˜…è§ˆ<a href="https://nodejs.org/api/child_process.html#child_process_child_process_exec_command_options_callback" target="_blank" rel="noopener">exec</a>ã€‚</p>
<h3 id="ç›®å½•ç»“æ„-1"><a href="#ç›®å½•ç»“æ„-1" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">|__ bin</span><br><span class="line">  |__ messi.js</span><br><span class="line">|__ command</span><br><span class="line">  |__ init.js</span><br><span class="line">|__ node_modules</span><br><span class="line">|__ package.json</span><br></pre></td></tr></table></figure>
<p>emmmã€‚æ˜¯ä¸æ˜¯æ„Ÿè§‰æœ‰äº›ç¼ºå°‘ä»€ä¹ˆï¼Ÿæ˜¯çš„ï¼Œæˆ‘ä»¬å¦‚ä½•èƒ½åšåˆ°è·Ÿ<code>vue-cli</code>ä¸€æ ·ä¼˜ç§€ï¼Œå¯ä»¥è‡ªä¸»é€‰æ‹©è‡ªå·±æƒ³è¦çš„é€‰æ‹©(æœ‰ç‚¹æ‹—å£)ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180718233622.png?imageslim" alt=""></p>
<h3 id="inquirer"><a href="#inquirer" class="headerlink" title="inquirer"></a>inquirer</h3><blockquote>
<p>å¸¸ç”¨äº¤äº’å¼å‘½ä»¤è¡Œç”¨æˆ·ç•Œé¢çš„é›†åˆã€‚</p>
</blockquote>
<p>å…·ä½“çš„å®˜æ–¹æ–‡æ¡£å¯ä»¥çœ‹ -&gt; <a href="https://github.com/SBoudrias/Inquirer.js#readme" target="_blank" rel="noopener">inquirer</a>ï¼Œæˆ‘ä»¬æ¥ç®€å•çš„å±•ç¤ºä¸€ä¸‹ä½¿ç”¨æ–¹æ³•ã€‚é¦–å…ˆ<code>npm install --save inquirer</code>ï¼Œç„¶ååœ¨<code>messi.js</code>æ·»åŠ æˆ‘ä»¬è·Ÿ<code>init.js</code>åŠŸèƒ½ä¸€æ ·çš„æŒ‡ä»¤<code>init2</code>ä»¥åŠåœ¨<code>init2.js</code>æ·»åŠ ç›¸å¯¹åº”çš„é€»è¾‘ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// messi.js</span></span><br><span class="line"><span class="keyword">const</span> init2 = <span class="built_in">require</span>(<span class="string">'../command/init2'</span>);</span><br><span class="line">program</span><br><span class="line">  .command(<span class="string">'init2'</span>)</span><br><span class="line">  .description(<span class="string">'åˆ›å»ºæ–°é¡¹ç›®'</span>)</span><br><span class="line">  .alias(<span class="string">'i2'</span>)</span><br><span class="line">  .action(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    init2();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// init2.js</span></span><br><span class="line"><span class="keyword">const</span> co = <span class="built_in">require</span>(<span class="string">'co'</span>);</span><br><span class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">'chalk'</span>)</span><br><span class="line"><span class="keyword">const</span> inquirer = <span class="built_in">require</span>(<span class="string">'inquirer'</span>);</span><br><span class="line"><span class="keyword">const</span> exec = <span class="built_in">require</span>(<span class="string">'child_process'</span>).exec;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(chalk.white(<span class="string">'init...'</span>));</span><br><span class="line"></span><br><span class="line">  co(<span class="function"><span class="keyword">function</span> *(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promps = [];</span><br><span class="line"></span><br><span class="line">    promps.push(&#123;</span><br><span class="line">      type: <span class="string">'list'</span>,</span><br><span class="line">      name: <span class="string">'pullProject'</span>,</span><br><span class="line">      message: <span class="string">'ä½ æ˜¯å¦æƒ³è¦æ‹‰å–scaffold-clié¡¹ç›®?'</span>,</span><br><span class="line">      choices: [&#123;</span><br><span class="line">        name: <span class="string">'Yes'</span>,</span><br><span class="line">        value: <span class="string">'y'</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        name: <span class="string">'No'</span>,</span><br><span class="line">        value: <span class="string">'n'</span></span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    inquirer.prompt(promps).then(<span class="function">(<span class="params">answers</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(answers);</span><br><span class="line">      <span class="keyword">const</span> wanna = answers[<span class="string">'pullProject'</span>].toLowerCase();</span><br><span class="line">      <span class="keyword">if</span> (wanna === <span class="string">'n'</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(chalk.red(<span class="string">'å·²ç»æˆåŠŸé€€å‡º!'</span>));</span><br><span class="line">        process.exit()</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (wanna === <span class="string">'y'</span>) &#123;</span><br><span class="line">        promps = [];</span><br><span class="line"></span><br><span class="line">        promps.push(&#123;</span><br><span class="line">          type: <span class="string">'input'</span>,</span><br><span class="line">          name: <span class="string">'nameProject'</span>,</span><br><span class="line">          message: <span class="string">'é¡¹ç›®åç§°ï¼š'</span></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        inquirer.prompt(promps).then(<span class="function">(<span class="params">answers</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> projectName = answers[<span class="string">'nameProject'</span>];</span><br><span class="line">          <span class="keyword">const</span> gitCmd = <span class="string">`git clone git@github.com:Lucius0/scaffold-cli.git <span class="subst">$&#123;projectName&#125;</span> &amp;&amp; cd <span class="subst">$&#123;projectName&#125;</span> &amp;&amp; git checkout master`</span>;</span><br><span class="line">          <span class="built_in">console</span>.log(chalk.white(<span class="string">'å¼€å§‹æ‹‰å–...'</span>));</span><br><span class="line">          exec(gitCmd, (error, stdout, stderr) =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (error) &#123;</span><br><span class="line">              <span class="built_in">console</span>.log(error);</span><br><span class="line">              process.exit();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">console</span>.log(chalk.green(<span class="string">'æ‹‰å–æˆåŠŸ!'</span>));</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`cd <span class="subst">$&#123;projectName&#125;</span>`</span>);</span><br><span class="line">            exec(<span class="string">`cd <span class="subst">$&#123;projectName&#125;</span>`</span>, () =&gt; &#123;</span><br><span class="line">              process.exit();</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥ä¸€æ­¥å°±æ˜¯æ„å»ºé¡¹ç›®<code>npm link</code>ï¼Œç„¶åæ‰§è¡Œ<code>messi ini2</code>ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180718234154.png?imageslim" alt=""></p>
<p>å¥½äº†ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ç¡è§‰ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
]]></content>
      
        <categories>
            
            <category> js </category>
            
            <category> node </category>
            
        </categories>
        
        
        <tags>
            
            <tag> js </tag>
            
            <tag> node </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[GitLab CI / CD å…¥é—¨é…ç½®]]></title>
      <url>https://lucius0.github.io/2018/07/09/archivers/gitlab-ci-cd-getting-started-guide/</url>
      <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯CI"><a href="#ä»€ä¹ˆæ˜¯CI" class="headerlink" title="ä»€ä¹ˆæ˜¯CI"></a>ä»€ä¹ˆæ˜¯CI</h2><p><strong>CI(Continuous integration)</strong>ï¼ŒæŒç»­é›†æˆã€‚å³å¼€å‘æˆå‘˜åœ¨å·¥ä½œæ—¶ä¸æ–­çš„é›†æˆå·¥ä½œåˆ†æ”¯åˆ°ä¸»åˆ†æ”¯ã€‚è¿™æ ·åšä¸ä»…å¯ä»¥æä¾›å¼€å‘æ•ˆç‡ï¼Œè¿˜å¯ä»¥è‡ªåŠ¨æµ‹è¯•å’Œæ„å»ºå·¥ä½œï¼Œå¿«é€Ÿè¿­ä»£çš„åŒæ—¶è¿˜å¯ä»¥åŠæ—¶å‘ç°é”™è¯¯ï¼Œä¸€ä¸¾å¤šå¾—ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯CD"><a href="#ä»€ä¹ˆæ˜¯CD" class="headerlink" title="ä»€ä¹ˆæ˜¯CD"></a>ä»€ä¹ˆæ˜¯CD</h2><p><strong>CD(Continuous Deployment)</strong>ï¼ŒæŒç»­äº¤ä»˜ã€‚ç®€å•çš„è¯´å°±æ˜¯é¢‘ç¹åœ°å°†é›†æˆåçš„äº§å“äº¤ä»˜ç»™è´¨é‡å›¢é˜Ÿæˆ–ç”¨æˆ·è¿›è¡Œä¸‹ä¸€æ­¥çš„è¯„å®¡ï¼Œé€šè¿‡äº†åˆ™åˆ°ç”Ÿäº§é˜¶æ®µã€‚</p>
<h2 id="GitLab-CI-CD"><a href="#GitLab-CI-CD" class="headerlink" title="GitLab CI / CD"></a>GitLab CI / CD</h2><p>GitLab CI / CDï¼Œå°±æ˜¯åœ¨GitLabä¸Šé›†æˆäº†CI / CDç³»ç»Ÿã€‚å‡å¦‚ä½ çš„é¡¹ç›®ä¸­æœ‰<code>.gitlab-ci.yml</code>æ–‡ä»¶ï¼Œé‚£ä¹ˆå½“å¼€å‘æˆå‘˜åœ¨<code>commit</code>æˆ–è€…<code>merge request</code>ä¹‹åï¼Œä¼šæŒ‰ç…§<code>.gitlab-ci.yml</code>æ‰€é…ç½®çš„å†…å®¹æ¥æ‰§è¡Œï¼Œå®ŒæˆCI / CDæ“ä½œã€‚</p>
<p>Runneræœ‰å¾ˆå¤šæ‰§è¡Œå¹³å°ï¼Œä¾‹å¦‚<code>SSHã€Dockerã€Kubernetes</code>ã€‚è¿™é‡Œæˆ‘ä»¬å…ˆç”¨SSHæ¥æ‰§è¡Œä¸€ä¸‹ã€‚(æ³¨æ„ï¼šè¿™é‡Œæ“ä½œç³»ç»Ÿç»Ÿä¸€ä¸ºmacOS)</p>
<h3 id="SSHå®‰è£…GitLab-Runner"><a href="#SSHå®‰è£…GitLab-Runner" class="headerlink" title="SSHå®‰è£…GitLab Runner"></a>SSHå®‰è£…GitLab Runner</h3><p>å…·ä½“æµç¨‹ï¼š<a href="https://docs.gitlab.com/runner/install/osx.html#installation" target="_blank" rel="noopener">https://docs.gitlab.com/runner/install/osx.html#installation</a></p>
<ol>
<li><p>ä¸‹è½½</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; sudo curl --output /usr/<span class="built_in">local</span>/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-darwin-amd64</span><br></pre></td></tr></table></figure>
</li>
<li><p>èµ‹äºˆæƒé™</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; sudo chmod +x /usr/<span class="built_in">local</span>/bin/gitlab-runner</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ³¨å†Œ<br>å…¶ä¸­åœ¨æ³¨å†Œæ­¥éª¤ä¸­ï¼Œéœ€è¦ä½ è¾“å…¥URLå’ŒTokenã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; Please enter the gitlab-ci coordinator URL (e.g. https://gitlab.com )</span><br><span class="line">&gt;&gt;&gt; xxx-url</span><br><span class="line">&gt;&gt;&gt; Please enter the gitlab-ci token <span class="keyword">for</span> this runner</span><br><span class="line">&gt;&gt;&gt; xxx-token</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨é¡¹ç›®ä¸­æ‰¾åˆ°å¯¹åº”çš„ä¿¡æ¯ã€‚å¦‚ä¸‹å›¾ä¸­çš„4åˆ™å¯¹åº”xxx-urlã€5åˆ™å¯¹åº”xxx-tokenã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/18712982379123.png" alt="1"><br>ä¹‹åçš„æ­¥éª¤æŒ‰ç…§é“¾æ¥çš„æ‰§è¡Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯<strong>executor</strong>æˆ‘ä»¬é€‰<strong>ssh</strong>ã€‚</p>
<ol>
<li><p>å¯åŠ¨æœåŠ¡</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; gitlab-runner install</span><br><span class="line">&gt;&gt;&gt; gitlab-runner start</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¿è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; sudo gitlab-runner run</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Docker-å®‰è£…-GitLab-Runner"><a href="#Docker-å®‰è£…-GitLab-Runner" class="headerlink" title="Docker å®‰è£… GitLab Runner"></a>Docker å®‰è£… GitLab Runner</h3><p><a href="https://segmentfault.com/a/1190000012279248" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥</a>ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚</p>
<h2 id="åŸºç¡€æ¦‚å¿µä»‹ç»"><a href="#åŸºç¡€æ¦‚å¿µä»‹ç»" class="headerlink" title="åŸºç¡€æ¦‚å¿µä»‹ç»"></a>åŸºç¡€æ¦‚å¿µä»‹ç»</h2><h3 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h3><p>æ¯ä¸€æ¬¡commitæˆ–è€…MRéƒ½ä¼šæ‰§è¡Œä¸€æ¬¡pipelineæ„å»ºä»»åŠ¡ï¼Œå½“ç„¶é‡Œé¢æœ‰å¾ˆå¤šé˜¶æ®µéœ€è¦æ‰§è¡Œï¼Œå¦‚æµ‹è¯•ã€ç¼–è¯‘ç­‰ã€‚</p>
<h3 id="Stage"><a href="#Stage" class="headerlink" title="Stage"></a>Stage</h3><p>è¿™é‡Œå°±æ˜¯ä¸Šæ–‡æåˆ°çš„é˜¶æ®µï¼Œæ¯ä¸€æ¬¡pipelineæœ‰å¾ˆå¤šä¸ªstageï¼Œè¿™äº›stageéƒ½æ˜¯ä¼šæŒ‰ä¸Šåˆ°ä¸‹æ‰§è¡Œï¼Œè€Œä¸”åªæœ‰å½“å‰stageæ‰§è¡Œå®Œæ¯•ä¹‹åæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªstageï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ã€‚</p>
<h3 id="Job"><a href="#Job" class="headerlink" title="Job"></a>Job</h3><p>job ä¸ºGitLab CI / CDçš„æœ€å°ç‹¬ç«‹è¿è¡Œå•ä½ï¼Œå®ƒè¡¨ç¤ºåœ¨æŒ‡å®šstageä¸‹æ‰§è¡Œçš„ä»»åŠ¡å·¥ä½œï¼Œå½“ç„¶åŠ å…¥å…¶ä¸­ä¸€ä¸ªjobæ‰§è¡Œå¤±è´¥ï¼ŒåŒæ ·çš„è¯¥stageä¹Ÿä¼šç®—æ˜¯æ‰§è¡Œå¤±è´¥ã€‚ä½†æ˜¯ä¸åŒçš„ä¸€ç‚¹æ˜¯ï¼Œç›¸åŒstageé‡Œé¢å¯ä»¥æœ‰å¾ˆå¤šä¸åŒçš„jobï¼Œè¿™äº›jobæ˜¯å¹¶è¡Œæ‰§è¡Œçš„ã€‚</p>
<h3 id="gitlab-ci-yml"><a href="#gitlab-ci-yml" class="headerlink" title=".gitlab-ci.yml"></a>.gitlab-ci.yml</h3><p>ä»‹ç»å®ŒåŸºç¡€æ¦‚å¿µï¼Œé‚£ä¹ˆå°±æ˜¯æˆ‘ä»¬é¡¹ç›®ä¸­éœ€è¦çš„æ–‡ä»¶<code>.gitlab-ci.yml</code>ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰åœ¨æ¯ä¸ªjobä¹‹å‰è¿è¡Œçš„å‘½ä»¤</span><br><span class="line">before_script:</span><br><span class="line">  - yarn</span><br><span class="line"> </span><br><span class="line">// å®šä¹‰æ„å»ºé˜¶æ®µï¼Œstages</span><br><span class="line">stages:</span><br><span class="line">  - build</span><br><span class="line">  - test</span><br><span class="line">  - deploy</span><br><span class="line"> </span><br><span class="line">// job1</span><br><span class="line">lint:</span><br><span class="line">  stage: test</span><br><span class="line">  script:</span><br><span class="line">    - echo "Running lint"</span><br><span class="line">    - yarn lint</span><br><span class="line"> </span><br><span class="line">// job2</span><br><span class="line">deploy_staging:</span><br><span class="line">  stage: deploy</span><br><span class="line">  script:</span><br><span class="line">    - echo "Deploy to staging environment"</span><br><span class="line">    - yarn build:stag</span><br><span class="line">    - yarn pub:stag</span><br><span class="line">  // å®šä¹‰gitåˆ†æ”¯ï¼Œå¹¶ä¸ºå…¶åˆ›å»ºjobã€‚è¿™é‡Œè¡¨ç¤ºåªæœ‰releaseåˆ†æ”¯æ‰ä¼šæ‰§è¡Œè¯¥job</span><br><span class="line">  only:</span><br><span class="line">    - release</span><br></pre></td></tr></table></figure></p>
<p>æ›´å¤šçš„å¯ä»¥æŸ¥çœ‹<a href="https://fennay.github.io/gitlab-ci-cn/gitlab-ci-yaml.html" target="_blank" rel="noopener">gitlab-ci-yaml</a>ã€‚</p>
<h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><p>1ã€åœ¨æŸäº›æ—¶å€™ï¼Œæˆ‘ä»¬çš„runnerå‡å¦‚æ˜¯åœ¨æœ¬åœ°è¿è¡Œçš„æ—¶å€™ï¼Œä¼šé’ˆå¯¹é¡¹ç›®åšä¸€äº›ç¯å¢ƒå˜é‡çš„å¤„ç†ï¼Œä¾‹å¦‚<code>CONFIG_ENV=UAT</code>ã€<code>CONFIG_ENV=DEV</code>åˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ªä¸åŒçš„ç¯å¢ƒã€‚é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡<code>.gitlab-cli.yml</code>çš„é…ç½®è®©runneråœ¨ä¸åŒçš„ç¯å¢ƒå˜é‡ä¸‹æ‰§è¡Œã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// ä¿®æ”¹ job2</span><br><span class="line">deploy_dev:</span><br><span class="line">  stage: deploy</span><br><span class="line">  script:</span><br><span class="line">    - echo "Deploy to dev environment"</span><br><span class="line">    // @1 è¡¨ç¤ºè®¾ç½®runneræ‰§è¡Œçš„ç¯å¢ƒå˜é‡xxx_keyä¸º$xxx_keyï¼Œä¼šä¸‹é¢è¯´æ˜ã€‚</span><br><span class="line">    - export xxx_key=$xxx_key</span><br><span class="line">    // è¡¨ç¤ºè®¾ç½®runneræ‰§è¡Œçš„ç¯å¢ƒå˜é‡CONFIG_ENVä¸ºDEV</span><br><span class="line">    - export CONFIG_ENV=DEV</span><br><span class="line">    - yarn build:dev</span><br><span class="line">    - yarn pub:dev</span><br><span class="line">  only:</span><br><span class="line">    - release</span><br></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ï¼Œxxx_keyä¸ºä¸‹å›¾ä¸­çš„4ï¼Œ$xxx_keyä¸ºä¸‹å›¾ä¸­çš„5ã€‚ä¾‹å¦‚xxx_key = 123456<br><img src="http://ouazw12mz.bkt.clouddn.com/123823987231981-1.png" alt="1-1"></p>
<p>2ã€åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨runneræ‰§è¡Œä»»åŠ¡æ—¶ï¼Œä¼šæƒ³npmjsæ‹‰å»npmåŒ…ï¼Œä½†æ˜¯å› ä¸ºå¢™çš„é—®é¢˜ï¼Œå¾€å¾€ä¼šå› ä¸ºè¶…æ—¶è€Œæ‹‰å–å¤±è´¥ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>.gitlab-cli.yml</code>çš„é…ç½®æ¥æŒ‡å®šrunneræ¥æ‰§è¡Œã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// ä¿®æ”¹ job2</span><br><span class="line">deploy_dev:</span><br><span class="line">  // æ–°å¢tagså±æ€§ï¼Œè¡¨ç¤ºæŒ‡å®štagä¸ºxxxçš„runner</span><br><span class="line">  tags:</span><br><span class="line">    - xxx</span><br></pre></td></tr></table></figure></p>
<p>xxxåœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°å‘¢ï¼Ÿä¸‹å›¾ä¸­çš„<code>inernal</code>ï¼Œ<code>k8s</code>ï¼Œ<code>shared</code>ï¼Œ<code>test</code>å³ä¸ºè¯¥runnerçš„tagã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/987128731219231-2.png" alt="1-2"></p>
<p>3ã€åœ¨è¡¥å……2ä¸­è¯´åˆ°ï¼Œå‡å¦‚è¦ç¿»å¢™æ—¶æˆ‘ä»¬å¯ä»¥è®¾ç½®æŒ‡å®šçš„runneræ¥æ‰§è¡Œæˆ‘ä»¬çš„ä»»åŠ¡ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ç¯å¢ƒå˜é‡ä¸­è®¾ç½®(ä¸)ä»£ç†ç¯å¢ƒçš„é…ç½®ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// ä¿®æ”¹ job2</span><br><span class="line">deploy_dev:</span><br><span class="line">  // æ–°å¢ç¯å¢ƒä»£ç†(è¡¨ç¤ºè¯¥jobåœ¨æ‰§è¡Œrunneræ—¶çš„ç¯å¢ƒä¸‹ä»£ç†)</span><br><span class="line">  - export http_proxy=http://xx.xx.xx.xx:xxxx</span><br><span class="line">  - export https_proxy=http://xx.xx.xx.xx:xxxx</span><br><span class="line">  // æ–°å¢ç¯å¢ƒä¸ä»£ç†(è¡¨ç¤ºå½“ipæˆ–åŸŸåä¸ºä»¥ä¸‹å˜é‡æ—¶ï¼Œä¸æ‰§è¡Œä»£ç†)</span><br><span class="line">  - export no_proxy=123.123.123.123:1234,noproxy.com</span><br></pre></td></tr></table></figure></p>
<h2 id="Q-amp-A-æŒç»­æ›´æ–°"><a href="#Q-amp-A-æŒç»­æ›´æ–°" class="headerlink" title="Q &amp; A(æŒç»­æ›´æ–°)"></a>Q &amp; A(æŒç»­æ›´æ–°)</h2><p>Qï¼šä¸ºä»€ä¹ˆ<code>yarn: not found</code>ï¼Ÿ<br>Aï¼šé•œåƒé‡Œé¢æ‰¾ä¸åˆ°yarnï¼Œå¯ä»¥é€šè¿‡é…ç½®imageä¸ºå…¶æŒ‡å®šé•œåƒã€‚</p>
<p>Qï¼š<code>error An unexpected error occurred: &quot;https://registry.npmjs.org/xxx: ETIMEDOUT&quot;.</code><br>Aï¼šnpmè®¿é—®ä¸äº†ï¼Œå¾—ç¿»å¢™ã€‚ï¼ˆå¯ä»¥é€šè¿‡ä¸ªäººç”µè„‘è¿è¡Œspecific runneräº¦æˆ–æ‰¾è¿ç»´é…ç½®ä¸€ä¸ªshared runnerï¼‰ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒè¡¥å……2ã€‚</p>
<p>Q: ä¸€ç›´é‡å¤<code>Waiting for pod xxx to be running, status is Pending...</code>ã€‚<br>A: æœ‰æ—¶å€™å—ç½‘ç»œçš„å½±å“ï¼Œå¯èƒ½ä¼šæ‹‰å–å¤±è´¥ã€‚è¿™æ—¶å€™å…ˆè‡ªå·±<strong>å°è¯•å¤šå‡ æ¬¡</strong>ï¼Œå‡å¦‚å†ä¸è¡Œï¼Œå†çœ‹ğŸ‘†çš„è§£å†³æ–¹æ¡ˆã€‚</p>
]]></content>
      
        <categories>
            
            <category> git </category>
            
        </categories>
        
        
        <tags>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[WebRTC-åˆæ¢]]></title>
      <url>https://lucius0.github.io/2018/04/13/archivers/webrtc-01/</url>
      <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯WebRTC"><a href="#ä»€ä¹ˆæ˜¯WebRTC" class="headerlink" title="ä»€ä¹ˆæ˜¯WebRTC"></a>ä»€ä¹ˆæ˜¯WebRTC</h2><p>WebRTC(Web Real-Time Communication)ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯åŸºäºWebæŠ€æœ¯ä¸Šå®ç°å®æ—¶é€šä¿¡æŠ€æœ¯ã€‚ä¾‹å¦‚QQè§†é¢‘ï¼ŒFacetimeï¼Œä½†ä¸éœ€è¦åœ¨æµè§ˆå™¨ä¸Šå®‰è£…ä»»ä½•çš„æ’ä»¶ï¼Œæ ¹æ®å…¶æ ‡å‡†ä»¥åŠHTML5æ ‡ç­¾å’ŒJavaScriptè¯­æ³•å°±å¯ä»¥å®ç°è¿™äº›åŠŸèƒ½ã€‚</p>
<p>WebRTCæœ€å¤§çš„ç‰¹ç‚¹æœ‰ä¸¤ç‚¹ï¼šæµè§ˆå™¨ä¸æµè§ˆå™¨ä¹‹é—´çš„å¯¹ç­‰è¿æ¥ï¼Œå³ä¸€ä¸ªæµè§ˆå™¨é€šè¿‡æ ‡å‡†åè®®ä¸å¦ä¸€ä¸ªæµè§ˆå™¨è¿›è¡Œå®æ—¶é€šä¿¡ï¼›å¦ä¸€ä¸ªç‰¹ç‚¹æ˜¯WebRTCæä¾›äº†ä¿¡ä»¤æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨åœ¨æµè§ˆå™¨å’Œå¯¹ç­‰è¿æ¥å¦ä¸€ç«¯ä¹‹é—´æä¾›ä¿¡ä»¤é€šé“ï¼Œå…³äºè¿™ä¸€ç‚¹ä¸‹é¢ä¼šè®²åˆ°ã€‚ç›®å‰æ˜¯1.0ç‰ˆæœ¬ï¼Œä¹‹åå¯èƒ½ä¼šæœ‰æ›´å¤šçš„ç‰¹æ€§ã€‚</p>
<p>ä¸€ä¸ªæœ€ç®€å•çš„WebRTCç»“æ„ï¼Œä½†å®é™…ä¸Šæƒ…å†µæ¯”è¿™ä¸ªå¤æ‚æ›´å¤šï¼Œä¾‹å¦‚å¤šä¸ªæµè§ˆå™¨äº’ç›¸å»ºç«‹å¯¹ç­‰è¿æ¥çš„å¯¹æ–¹ä¼šè¯ã€‚</p>
<p><img src="http://ouazw12mz.bkt.clouddn.com/180413121213.png?imageslim" alt=""></p>
<h2 id="å¦‚ä½•ä½¿ç”¨WebRTC"><a href="#å¦‚ä½•ä½¿ç”¨WebRTC" class="headerlink" title="å¦‚ä½•ä½¿ç”¨WebRTC"></a>å¦‚ä½•ä½¿ç”¨WebRTC</h2><p>å»ºç«‹ä¸€ä¸ªç®€å•çš„WebRTCä¼šè¯ï¼Œåªéœ€è¦ä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š<br>1ï¼‰è·å–æœ¬åœ°åª’ä½“ã€‚<code>window.navigator.getUserMedia</code>ï¼Œè·å–å•ä¸ªæœ¬åœ°<code>MediaStream</code>ï¼›<br>2ï¼‰åœ¨æµè§ˆå™¨å’Œå¯¹ç­‰ç«¯(å…¶ä»–æµè§ˆå™¨)å»ºç«‹è¿æ¥ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸é€šè¿‡æœåŠ¡å™¨é€šä¿¡ï¼Œè€Œæ˜¯æµè§ˆå™¨ä¸æµè§ˆå™¨ä¹‹é—´çš„åª’ä½“è¿æ¥ã€‚<code>new RTCPeerConnection(c)</code>ï¼Œç®€å•çš„è¯´æ˜ä¸‹cä¸ºICEæ‰“æ´é€šè¿‡NATè®¾å¤‡å’Œé˜²ç«å¢™éœ€è¦çš„é…ç½®ä¿¡æ¯ï¼›<br>3ï¼‰å°†åª’ä½“å’Œæ•°æ®é€šé“å…³è”è‡³æ­¤è¿æ¥ï¼Œ<code>new RTCSessionDescription</code>ï¼›<br>4ï¼‰äº¤æ¢ä¼šè¯æè¿°ï¼›<br>5ï¼‰å…³é—­è¿æ¥ã€‚<br>ç»“æ„å›¾å¦‚ä»¥ä¸‹å·¦è¾¹å›¾ï¼Œè‹¥æ·»åŠ äº†ä¿¡ä»¤é€šé“ï¼Œåˆ™å¦‚å³è¾¹å›¾ã€‚</p>
<p><img src="http://ouazw12mz.bkt.clouddn.com/180413121314.png?imageslim" alt=""></p>
<p>è¿™é‡Œç®€å•è¯´ä¸‹3ï¼‰è·Ÿ4ï¼‰ã€‚å½“å»ºç«‹å®Œè¿æ¥ä¹‹åï¼Œæœ¬åœ°ä»¥åŠè¿œç¨‹éƒ½ä¼šé€šè¿‡<code>RTCPeerConnection</code>äº¤æ¢<code>RTCSessionDescription</code>ï¼Œè€Œ<code>RTCSessionDescription</code>çš„æ„ä¹‰æ˜¯ä¸ºäº†ä¸¤ç«¯ä¹‹é—´åå•†å¦‚ä½•å»ºç«‹åª’ä½“ä¿¡æ¯ï¼Œä¾‹å¦‚ç¼–è§£ç å™¨ã€‚äº¤æ¢å®Œæ¯•ä¹‹åï¼Œå³å¯å»ºç«‹åª’ä½“æˆ–æ•°æ®ä¼šè¯ã€‚æ­¤æ—¶ï¼Œä¸¤ä¸ªæµè§ˆå™¨å¼€å§‹æ‰“æ´(ç©¿é€NATè®¾å¤‡å’Œé˜²ç«å¢™)ã€‚æ‰“æ´å®Œæ¯•ä¹‹åï¼Œå³å¯å¼€å§‹åå•†<code>RTCSessionDescription</code>äº¤æ¢çš„ä¿¡æ¯ã€‚ä¸ºäº†ç¡®ä¿å®‰å…¨ï¼Œäº¤æ¢å¯†é’¥ã€‚æœ€åå¼€å§‹åª’ä½“æˆ–æ•°æ®é€šè¯ã€‚</p>
<p>WebRTCçš„ä½“ç³»ç»“æ„å¦‚ä¸‹ï¼Œæœ‰å¿…è¦æé†’çš„æ˜¯ï¼Œæµè§ˆå™¨Aå‘èµ·çš„1ã€2å’Œæµè§ˆå™¨Bå‘èµ·çš„3ã€4æ˜¯ä¸æ’å…ˆåçš„ã€‚è€Œä¸”å®é™…ä¸Šçš„ä½“ç³»ç»“æ„æ˜¯æ ¹æ®éœ€æ±‚æ”¹å˜çš„ï¼Œè€Œå¹¶éä»¥ä¸‹å›¾çš„ä¸€æˆä¸å˜ã€‚</p>
<p><img src="http://ouazw12mz.bkt.clouddn.com/180413121430.png?imageslim" alt=""></p>
<ol>
<li>æµè§ˆå™¨Aå‘æœåŠ¡å™¨è¯·æ±‚ç½‘é¡µï¼›</li>
<li>æœåŠ¡å™¨è¿”å›æºå¸¦WebRTCåº”ç”¨çš„ç½‘é¡µç»™æµè§ˆå™¨Aï¼›</li>
<li>æµè§ˆå™¨Bå‘æœåŠ¡å™¨è¯·æ±‚ç½‘é¡µï¼›</li>
<li>æœåŠ¡å™¨è¿”å›æºå¸¦åŒAä¸€æ ·å†…å®¹çš„ç½‘é¡µç»™æµè§ˆå™¨Bï¼›</li>
<li>æµè§ˆå™¨Aæƒ³ä¸æµè§ˆå™¨Bé€šä¿¡ï¼Œäºæ˜¯é€šè¿‡æœåŠ¡å™¨ï¼Œå°†æè¿°å¯¹è±¡(offer, æè®®)å‘é€ç»™æœåŠ¡å™¨ï¼›</li>
<li>æœåŠ¡å™¨å°†æµè§ˆå™¨Aå‘é€è¿‡æ¥çš„æè¿°å¯¹è±¡å‘é€ç»™æµè§ˆå™¨Bï¼›</li>
<li>æµè§ˆå™¨Bæ¥æ”¶åˆ°æè®®ä¹‹åï¼Œä¹Ÿå°†è‡ªå·±çš„æè¿°å¯¹è±¡(answer, åº”ç­”)å‘é€åˆ°æœåŠ¡å™¨ï¼›</li>
<li>æœåŠ¡å™¨æ¥æ”¶åˆ°æµè§ˆå™¨Bçš„æè¿°å¯¹è±¡ä¹‹åå‘é€ç»™æµè§ˆå™¨Aï¼›</li>
<li>æµè§ˆå™¨Aæ¥æ”¶åˆ°æµè§ˆå™¨Bçš„åº”ç­”ä¹‹åï¼Œä¸¤ç«¯å¼€å§‹æ‰“æ´ï¼Œæ ¹æ®ä¸¤è¾¹çš„æè¿°å¯¹è±¡æ¥ç¡®å®šæœ€ä½³çš„è®¿é—®æ–¹å¼ï¼›</li>
<li>æ‰“å®Œæ´ä¹‹åï¼Œå°±å¼€å§‹åå•†å¯†é’¥ä»¥ç¡®ä¿ä¹‹åçš„ä¼šè¯å®‰å…¨ï¼›</li>
<li>ä¸¤ç«¯å¼€å§‹äº’ç›¸ä¼ è¾“è§†é¢‘ï¼Œè¯­éŸ³ä»¥åŠæ•°æ®ã€‚</li>
</ol>
<h2 id="ç›®å‰å…¼å®¹æƒ…å†µ-2018-04"><a href="#ç›®å‰å…¼å®¹æƒ…å†µ-2018-04" class="headerlink" title="ç›®å‰å…¼å®¹æƒ…å†µ(2018-04)"></a>ç›®å‰å…¼å®¹æƒ…å†µ(2018-04)</h2><p><img src="http://ouazw12mz.bkt.clouddn.com/180413121633.png?imageslim" alt=""></p>
<h2 id="æœ¬åœ°åª’ä½“"><a href="#æœ¬åœ°åª’ä½“" class="headerlink" title="æœ¬åœ°åª’ä½“"></a>æœ¬åœ°åª’ä½“</h2><p>MediaStreamTrackï¼Œæ˜¯WebRTCçš„åŸºæœ¬å•ä½ï¼Œå¯ä»¥æ˜¯è‡ªæºçš„åŸå§‹åª’ä½“ï¼Œä¹Ÿå¯ä»¥æ˜¯æµè§ˆå™¨è½¬æ¢è¿‡çš„ã€‚ä¾‹å¦‚ï¼ŒMediaStreamTrackå¯ä»¥æ˜¯æ‘„åƒå¤´ä»¥é«˜åˆ†è¾¨ç‡å½•åˆ¶çš„ä½é‡‡æ ·ç‡ç‰ˆæœ¬ã€‚MediaStreamTrackä¸­çš„readyStateæœ‰<code>newã€liveã€ended</code>ï¼Œå¯é€šè¿‡<code>enabled=false</code>ç¦ç”¨ã€‚è€ŒMediaStreamæ˜¯MediaStreamTrackçš„é›†åˆï¼Œç›®å‰é€šè¿‡<code>window.navigator.getUserMedia</code>è·å–çš„æˆ–ä½¿ç”¨å¯¹ç­‰è¿æ¥æ¥æ”¶çš„æµï¼Œæœªæ¥è¯´ä¸å®šè¿˜æœ‰å…¶ä»–çš„è·å–æ–¹å¼ã€‚<a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack" target="_blank" rel="noopener">MediaStreamTrack - Web APIs | MDN</a></p>
<p>ä¸‹é¢æœ‰ç®€å•çš„ä»£ç ç¤ºä¾‹ä¸‹å¦‚ä½•è·å–æœ¬åœ°åª’ä½“ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">navigator.getUserMedia(&#123;<span class="string">'audio'</span>: <span class="literal">true</span>, <span class="string">'video'</span>: <span class="literal">true</span>&#125;, gotUserMedia, didntGetUserMedia);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">didntGetUserMedia</span>(<span class="params">s</span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gotUserMedia</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> videoEle = <span class="built_in">document</span>.getElementById(<span class="string">'videoEle'</span>);</span><br><span class="line">  videoEle.srcObject = s; <span class="comment">// ç›®å‰è¿˜æ— æ³•ä½¿ç”¨Blob</span></span><br><span class="line">  <span class="built_in">console</span>.log(s.getVideoTracks(), s.getAudioTracks());</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çº¦æŸï¼Œæ˜¯æŒ‡æµè§ˆå™¨ä¼šå°†åª’ä½“æµå°½å¯èƒ½çš„æ»¡è¶³çº¦æŸçš„æ¡ä»¶ï¼Œå¦‚å®½é«˜ï¼Œæ¯”ä¾‹ï¼Œå¸§ç‡ç­‰çº¦æŸæ¡ä»¶ã€‚</span></span><br><span class="line">  <span class="keyword">var</span> constraints = &#123;</span><br><span class="line">    width: &#123;<span class="attr">min</span>: <span class="number">640</span>, <span class="attr">ideal</span>: <span class="number">1280</span>&#125;,</span><br><span class="line">    height: &#123;<span class="attr">min</span>: <span class="number">480</span>, <span class="attr">ideal</span>: <span class="number">720</span>&#125;,</span><br><span class="line">    advanced: [</span><br><span class="line">      &#123;<span class="attr">width</span>: <span class="number">1920</span>, <span class="attr">height</span>: <span class="number">1280</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">aspectRatio</span>: <span class="number">1.333</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">var</span> t = (s.getVideoTracks())[<span class="number">0</span>];</span><br><span class="line">    t.applyConstraints(constraints).then(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// t.getSettingsï¼šè¿”å›æ‰€æœ‰è®¾å®šçš„çº¦æŸå€¼</span></span><br><span class="line">      <span class="comment">// t.getConstraintsï¼šè¿”å›å½“å‰çº¦æŸçš„å€¼</span></span><br><span class="line">      <span class="built_in">console</span>.log(t.getSettings(), t.getConstraints());</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è€Œ<code>s.getTracks()</code>çš„ä¿¡æ¯å¦‚ä¸‹å›¾ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180413121930.png?imageslim" alt=""></p>
<p>é€šè¿‡ä»¥ä¸Šä»£ç å¯ä»¥çœ‹å‡º<code>gotUserMedia</code>å¯ä»¥æ­£å¸¸çš„è¿”å›éŸ³è§†é¢‘è½¨é“ï¼Œä½†æ˜¯è¿˜æ— æ³•æ­£å¸¸çš„æ’­æ”¾ã€‚</p>
<h2 id="ä¿¡ä»¤-signaling"><a href="#ä¿¡ä»¤-signaling" class="headerlink" title="ä¿¡ä»¤(signaling)"></a>ä¿¡ä»¤(signaling)</h2><p>å…¶ä½œç”¨ä¸»è¦ä½“ç°ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>åå•†åª’ä½“åŠŸèƒ½å’Œè®¾ç½®(å¿…å¤‡)ï¼›</li>
<li>æ ‡è¯†å’ŒéªŒè¯ä¼šè¯å‚ä¸è€…çš„èº«ä»½ï¼›</li>
<li>æ§åˆ¶åª’ä½“ä¼šè¯ã€æŒ‡ç¤ºè¿›åº¦ã€æ›´æ”¹ä¼šè¯å’Œç»ˆæ­¢ä¼šè¯ï¼›</li>
<li>å½“ä¼šè¯åŒæ–¹åŒæ—¶å°è¯•å»ºç«‹æˆ–æ›´æ”¹ä¼šè¯æ—¶ï¼Œå®æ–½åŒå ç”¨åˆ†è§£ã€‚</li>
</ul>
<h3 id="åª’ä½“åå•†"><a href="#åª’ä½“åå•†" class="headerlink" title="åª’ä½“åå•†"></a>åª’ä½“åå•†</h3><p>å› ä¸ºå¿…å¤‡ï¼Œæ‰€ä»¥æ¥ç®€å•è¯´æ˜ä¸‹ã€‚è¿™ä¸€æ­¥ä¸»è¦çš„å·¥ä½œæ˜¯åœ¨å‚ä¸å¯¹ç­‰è¿æ¥çš„ä¸¤ä¸ªæµè§ˆå™¨ä¹‹é—´äº¤æ¢SDP(Session Description Protocol)å¯¹è±¡ä¸­åŒ…å«çš„ä¿¡æ¯ï¼Œä¾‹å¦‚éŸ³è§†é¢‘æ•°æ®ã€ç¼–è§£ç å™¨ä»¥åŠæœ‰å…³çš„å¸¦å®½ä¿¡æ¯ç­‰ã€‚æ­¤å¤–è¿˜ç”¨äºäº¤æ¢<strong>å€™é€‰åœ°å€</strong>ï¼Œä¾¿äºICEæ‰“æ´ã€‚<strong>å€™é€‰åœ°å€</strong>è¡¨ç¤ºæµè§ˆå™¨å¯ä»ä¸­æ¥æ”¶æ½œåœ¨çš„åª’ä½“æ•°æ®åŒ…çš„IPåœ°å€å’ŒUDPç«¯å£ã€‚å¦å¤–è¿˜å¿…é¡»åœ¨ä¿¡ä»¤é€šé“äº¤æ¢<strong>å¯†é’¥</strong>ã€‚åªæœ‰äº¤æ¢å®Œå€™é€‰åœ°å€æ‰èƒ½å¼€å§‹ICEæ‰“æ´ï¼Œä¹‹åæ‰èƒ½å»ºç«‹å¯¹ç­‰è¿æ¥ã€‚</p>
<h3 id="ä¿¡ä»¤ä¼ è¾“"><a href="#ä¿¡ä»¤ä¼ è¾“" class="headerlink" title="ä¿¡ä»¤ä¼ è¾“"></a>ä¿¡ä»¤ä¼ è¾“</h3><p>å¸¸è§çš„ä¿¡ä»¤ä¼ è¾“æœ‰ï¼šHTTPè½®è¯¢ã€WebSocketå’Œæ•°æ®é€šé“ã€‚ç”±äºå‰ä¸¤ç§æ¯”è¾ƒå¸¸è§ï¼Œæˆ‘ä»¬å°±åªè¯´è¯´æ•°æ®é€šé“çš„åŸç†ã€‚</p>
<p>åœ¨æœ€åˆå»ºç«‹æ•°æ®é€šé“æ—¶ï¼Œæ˜¯æ— æ³•ä¼ è¾“WebRTCä¿¡ä»¤çš„ï¼Œå› ä¸ºæ•°æ®é€šé“ä¹Ÿéœ€è¦ä¿¡ä»¤æ‰èƒ½å»ºç«‹ï¼Œæ‰€ä»¥ä¸€å¼€å§‹ï¼Œæ˜¯é€šè¿‡HTTPæˆ–è€…WebSocketæ¥ä¼ è¾“æœ€å¼€å§‹çš„ä¿¡ä»¤çš„ã€‚å½“ä¸¤ä¸ªæµè§ˆå™¨ä¹‹é—´å»ºç«‹æ•°æ®é€šé“ä¹‹åï¼Œå®ƒä¼šæä¾›ç›´æ¥çš„ä½å»¶è¿Ÿè¿æ¥ï¼Œè¿™æ—¶å€™å°±å¯ä»¥å¤„ç†æ¥å¾€çš„ä¿¡ä»¤äº†ã€‚</p>
<p><img src="http://ouazw12mz.bkt.clouddn.com/180413122141.png?imageslim" alt=""></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç </span></span><br><span class="line">funciton createSignalingChannel(msgHandler) &#123;</span><br><span class="line">  <span class="keyword">var</span> socket = <span class="keyword">new</span> WebSocket(<span class="string">'wss://192.168.0.1:49152/'</span>);</span><br><span class="line">  socket.addEventListener(<span class="string">'message'</span>, msgHandler, <span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">return</span> &#123;<span class="string">'send'</span>: socket.send&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ‰“å¼€WebSocket</span></span><br><span class="line">signalingChannel = createSignalingChannel(onMessage);</span><br><span class="line"><span class="comment">// é€šè¿‡WebSocketå‘é€æ¶ˆæ¯</span></span><br><span class="line">signalingChannel.send(message);</span><br><span class="line"><span class="comment">// å¤„ç†é€šè¿‡WebSocketä¼ å…¥çš„æ¶ˆæ¯</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onMessage</span>(<span class="params">msg</span>) </span>&#123; <span class="comment">//... &#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="å¯¹ç­‰åª’ä½“"><a href="#å¯¹ç­‰åª’ä½“" class="headerlink" title="å¯¹ç­‰åª’ä½“"></a>å¯¹ç­‰åª’ä½“</h2><p>å¯¹ç­‰åª’ä½“ï¼ŒæŒ‡çš„å°±æ˜¯ä¸¤ä¸ªæµè§ˆå™¨ä¹‹é—´èƒ½å¤Ÿç›´æ¥å»ºç«‹è§†é¢‘ã€éŸ³é¢‘å’Œæ•°æ®è¿æ¥ï¼Œèƒ½å¤ŸèŠ‚çº¦å¸¦å®½ã€‚ä½†å¿…é¡»é‡‡ç”¨ç‰¹æ®Šçš„åè®®ï¼Œå¦‚STUNæœåŠ¡å™¨å’ŒTURNæœåŠ¡å™¨ã€‚ä¸ç„¶ä¼šå—åˆ°NATå’Œé˜²ç«å¢™çš„æ‹¦æˆªã€‚</p>
<h3 id="å¯¹ç­‰åª’ä½“å’Œç½‘ç»œåœ°å€è½¬æ¢-NAT"><a href="#å¯¹ç­‰åª’ä½“å’Œç½‘ç»œåœ°å€è½¬æ¢-NAT" class="headerlink" title="å¯¹ç­‰åª’ä½“å’Œç½‘ç»œåœ°å€è½¬æ¢(NAT)"></a>å¯¹ç­‰åª’ä½“å’Œç½‘ç»œåœ°å€è½¬æ¢(NAT)</h3><p>æ‰€è°“NATï¼Œç®€å•æ¥è¯´å°±æ˜¯å°†ç§æœ‰åœ°å€è½¬æ¢æˆå…¬æœ‰åœ°å€çš„ä¸€ç§æ–¹å¼ï¼Œä¾‹å¦‚å†…ç½‘IP:å†…ç½‘ç«¯å£ -&gt; å¤–ç½‘IP:å¤–ç½‘ç«¯å£ã€‚å¸¸è§è®¾å¤‡å¦‚è·¯ç”±å™¨ã€‚æ‰€ä»¥è¯´ï¼Œæ¯ä¸ªå¤„äºNATçš„ç½‘ç»œéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç½‘ç»œä¸ç½‘ç»œä¹‹é—´çš„è®¿é—®éƒ½æ˜¯é€šè¿‡NATæ¥è®¿é—®çš„ã€‚</p>
<p>åœ¨ä¸Šé¢è¯´è¿‡å¯¹ç­‰åª’ä½“ä¼šå—åˆ°NATçš„å½±å“ï¼Œå°±æ˜¯å› ä¸ºç«¯å¯¹ç«¯çš„è¿æ¥ä¸åƒæˆ‘ä»¬å¸¸ç”¨çš„C/Sç»“æ„ï¼Œèƒ½å¤Ÿéå†NATï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç©¿è¿‡å®ƒï¼Œå¦‚STUNæœåŠ¡å™¨å’ŒTURNæœåŠ¡å™¨ã€‚</p>
<h2 id="å¯¹ç­‰è¿æ¥å’Œæè®®-åº”ç­”åå•†"><a href="#å¯¹ç­‰è¿æ¥å’Œæè®®-åº”ç­”åå•†" class="headerlink" title="å¯¹ç­‰è¿æ¥å’Œæè®®/åº”ç­”åå•†"></a>å¯¹ç­‰è¿æ¥å’Œæè®®/åº”ç­”åå•†</h2><h3 id="å¯¹ç­‰è¿æ¥"><a href="#å¯¹ç­‰è¿æ¥" class="headerlink" title="å¯¹ç­‰è¿æ¥"></a>å¯¹ç­‰è¿æ¥</h3><p><code>RTCPeerConnection</code>æ˜¯WebRTCç”¨äºä¸¤ç«¯ä¹‹é—´å»ºç«‹åª’ä½“ä¸æ•°æ®è¿æ¥çš„APIã€‚å…¶APIæ˜¯ç»‘å®šåœ¨JSEP(JavaScript Session Establishment Protocol)åè®®ä¸Šæ¥è¿›è¡Œåª’ä½“åå•†çš„ï¼Œè€Œä¸”è¯¥JSEPåŸºæœ¬ä¸Šç”±æµè§ˆå™¨å¤„ç†ã€‚<strong>å€¼å¾—è¯´æ˜çš„ä¸€ç‚¹ï¼ŒWebRTCçš„å¯¹ç­‰è¿æ¥å¹¶éæ˜¯TCPæ„ä¹‰ä¸Šçš„è¿æ¥ã€‚è€Œæ˜¯ä¸€ç»„è·¯å¾„å»ºç«‹è¿›ç¨‹(ICE)ä»¥åŠä¸€ä¸ªå¯ç¡®å®šåº”å»ºç«‹å“ªäº›åª’ä½“å’Œæ•°æ®è·¯å¾„çš„åå•†å™¨ã€‚</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> pc = <span class="keyword">new</span> RTCPeerConnection(&#123;</span><br><span class="line">      iceServers: [</span><br><span class="line">          &#123;<span class="string">'url'</span>: <span class="string">'stun:stun.l.google.com:19302'</span>&#125;,</span><br><span class="line">          &#123;<span class="string">'url'</span>: <span class="string">'turn:user@turn.myserver.com'</span>, </span><br><span class="line">           <span class="string">'credential'</span>: <span class="string">'test'</span>&#125;</span><br><span class="line">      ]</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.navigator.getUserMedia(&#123;<span class="string">'audio'</span>: <span class="literal">true</span>, <span class="string">'video'</span>: <span class="literal">true</span>&#125;, successCB, failureCB);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">successCB</span>(<span class="params">stream</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// æ·»åŠ æœ¬åœ°åª’ä½“æµåˆ°å¯¹æ¥çš„æµè§ˆå™¨ç«¯ï¼Œä½†æ˜¯æ­¤æ“ä½œä¸ä¼šäº§ç”Ÿä»»ä½•åª’ä½“æµã€‚åªæ˜¯ä¸ºäº†å‘Šè¯‰æµè§ˆå™¨ï¼Œæœ¬åœ°æµè§ˆå™¨ä¸å¯¹ç­‰ç«¯æµè§ˆå™¨å°±è¯¥MediaSteamè¿›è¡Œåå•†</span></span><br><span class="line">    pc.addStream(stream);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æè®®-åº”ç­”åå•†"><a href="#æè®®-åº”ç­”åå•†" class="headerlink" title="æè®®/åº”ç­”åå•†"></a>æè®®/åº”ç­”åå•†</h3><p>æè®®/åº”ç­”çš„ä¸»è¦æ„ä¹‰å°±æ˜¯ç¡®ä¿åŒæ–¹éƒ½çŸ¥é“è¦å‘é€å’Œæ¥æ”¶çš„åª’ä½“ç±»å‹ï¼Œä»¥åŠå¦‚ä½•æ­£ç¡®è§£ç å’Œå¤„ç†åª’ä½“æµã€‚ä¾‹å¦‚ï¼šè¦ä½¿ç”¨çš„ä¸€ä¸ªæˆ–å¤šä¸ªè§£ç å™¨ã€è§£ç å™¨çš„å‚æ•°ã€ç”¨äºåª’ä½“åŠ å¯†å’Œèº«ä»½éªŒè¯çš„å¯†é’¥ä¿¡æ¯ç­‰ã€‚è¿™æ ·åŒæ–¹å°±å¯ä»¥è¾¾æˆä¸€è‡´ï¼Œæ–¹ä¾¿åç»­å·¥ä½œçš„å¤„ç†ã€‚<code>RTCSessionDescription</code>ï¼Œæ¥è¡¨ç¤ºæè®®å’Œåº”ç­”ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†è‡ªå·±çš„ä¼šè¯æè¿°å‘Šè¯‰æœ¬åœ°æµè§ˆå™¨</span></span><br><span class="line">pc.setLocalDescription(mySessionDescription);</span><br><span class="line"><span class="comment">// å°†å¯¹ç­‰ç«¯çš„ä¼šè¯æè¿°å‘Šè¯‰æœ¬åœ°æµè§ˆå™¨</span></span><br><span class="line">pc.setRemoteDescription(remoteSessionDescription);</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¼ªä»£ç å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ä¸€ç«¯åªèƒ½æ˜¯æ¥æ”¶æ–¹ï¼Œè€Œå¦ä¸€ç«¯åªèƒ½æ˜¯å‘é€æ–¹ã€‚è¿™æ ·çš„è¯ï¼Œä¸‡ä¸€å‘é€æ–¹è·Ÿæ¥æ”¶æ–¹çš„è§’è‰²å¯¹è°ƒåˆ™ä¼šå‘ç”Ÿé—®é¢˜ã€‚å¥½åœ¨WebRTCæä¾›äº†å¦‚ä¸‹çš„è§£å†³æ–¹æ³•ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºæè®®</span></span><br><span class="line">pc.createOffer(gotOffer, didntGetOffer);</span><br><span class="line"><span class="comment">// åˆ›å»ºåº”ç­”</span></span><br><span class="line">pc.createAnswer(gotOffer, didntGetOffer);</span><br></pre></td></tr></table></figure>
<p>æ•´ä¸ªè¿‡ç¨‹çš„ä¼ªä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Aæµè§ˆå™¨</span></span><br><span class="line"><span class="comment">// è®¿é—®ï¼Œå…¶ä¸­keyä¸ºæˆ¿é—´å·</span></span><br><span class="line">GET <span class="string">'/connect?key=123456'</span></span><br><span class="line"><span class="comment">// å‡å¦‚è®¿é—®æˆåŠŸï¼Œé‚£ä¹ˆå°±è¿›å…¥ç­‰å¾…çŠ¶æ€</span></span><br><span class="line"><span class="keyword">if</span>(readyState === DONE &amp;&amp; status === <span class="number">200</span>) &#123;</span><br><span class="line">  <span class="comment">// ç­‰å¾…å¦ä¸€ç«¯çš„è®¿é—®</span></span><br><span class="line">  Waiting</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è·å–æœ¬åœ°åª’ä½“</span></span><br><span class="line">navigator.getUserMedia(&#123;<span class="string">'video'</span>: <span class="literal">true</span>, <span class="string">'audio'</span>: <span class="literal">true</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Bæµè§ˆå™¨åŒæ ·è®¿é—®æœåŠ¡å™¨å¹¶ä¸”åŠ å…¥æˆ¿é—´å·ä¸º123456</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Aæµè§ˆå™¨æ”¶åˆ°æ¶ˆæ¯ï¼Œå¹¶å»ºç«‹å¯¹ç­‰è¿æ¥</span></span><br><span class="line">connect()</span><br><span class="line"><span class="comment">// configç”¨åˆ°çš„æ˜¯Googleçš„å…¬ç”¨çš„stunæœåŠ¡å™¨ï¼Œä¸ºå€™é€‰åœ°å€ï¼Œæ˜¯ICEæ‰“æ´é€šè¿‡NATè®¾å¤‡å’Œé˜²ç«å¢™éœ€è¦çš„é…ç½®ä¿¡æ¯ã€‚</span></span><br><span class="line">config = [&#123;<span class="string">"url"</span>:<span class="string">"stun:stun.l.google.com:19302"</span>&#125;]</span><br><span class="line">pc = <span class="keyword">new</span> RTCPeerConnection(&#123;<span class="attr">iceServers</span>:config&#125;);</span><br><span class="line">pc.onicecandidate = onIceCandidate;</span><br><span class="line">pc.onaddstream = onRemoteStreamAdded;</span><br><span class="line">pc.onremovestream = onRemoteStreamRemoved;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Aæµè§ˆå™¨å‘èµ·æè®® æˆ– Bæµè§ˆå™¨å‘èµ·æè®®ã€‚æˆ‘ä»¬è¿™é‡Œé»˜è®¤ä½¿ç”¨Aæµè§ˆå™¨å‘èµ·ã€‚</span></span><br><span class="line">pc.createOffer(gotDescription, doNothing, constraints);</span><br><span class="line">gotDescription(sDesc) -&gt; pc.setLocalDescription(sDesc);</span><br><span class="line"><span class="comment">// é€šè¿‡æœåŠ¡å™¨å°†ä¿¡æ¯å‘é€ç»™Bæµè§ˆå™¨</span></span><br><span class="line">seng(sDesc);</span><br><span class="line"><span class="comment">// Aæµè§ˆå™¨è§¦å‘onicecandidateäº‹ä»¶ï¼Œå³å¦‚æœæˆ‘ä»¬æµè§ˆå™¨æœ‰å€™é€‰é…ç½®ï¼Œåˆ™å°†å…¶å‘é€ç»™å¯¹ç­‰ç«¯</span></span><br><span class="line">onicecandidate(e) -&gt; send(&#123;<span class="attr">type</span>: <span class="string">'candidate'</span>, <span class="attr">candidate</span>: e. candidate&#125;)</span><br><span class="line"><span class="comment">// Bæµè§ˆå™¨æ”¶åˆ°offerï¼Œä¹‹åå°†æ”¶åˆ°çš„è¿”å›ç»™Aæµè§ˆå™¨</span></span><br><span class="line">pc.setRemoteDescription(<span class="keyword">new</span> RTCSessionDescription(msg));</span><br><span class="line"><span class="comment">// Bæµè§ˆå™¨åˆ›å»ºanswerï¼Œå°†æ¥æ”¶åˆ°çš„æè¿°æ·»åŠ åˆ°æœ¬åœ°</span></span><br><span class="line">pc.createAnswer(gotDescription, doNothing, constraints);</span><br><span class="line">gotDescription(sDesc) -&gt; pc.setLocalDescription(sDesc);</span><br><span class="line"><span class="comment">// Aæµè§ˆå™¨æ”¶åˆ°Bæµè§ˆå™¨å‘é€çš„å€™é€‰é…ç½®</span></span><br><span class="line">pc.addIceCandidate(<span class="keyword">new</span> RTCIceCandidate(&#123;<span class="attr">sdpMLineIndex</span>:msg. candidate.mlineindex, <span class="attr">candidate</span>:msg. candidate.candidate&#125;));</span><br><span class="line"><span class="comment">// ps: ä»¥ä¸Šçš„æè®® / åº”ç­”çš„è¿‡ç¨‹ä¼šç»å†å‡ æ¬¡ã€‚</span></span><br><span class="line"><span class="comment">// è¿™æ—¶å€™ä½ ä¸ä½†èƒ½çœ‹åˆ°è‡ªå·±å¸…æ°”çš„è„¸ï¼Œè¿˜å¯ä»¥çœ‹åˆ°å¯¹æ–¹ç¾ä¸½çš„è„¸ã€‚</span></span><br></pre></td></tr></table></figure>
<h2 id="æ•°æ®é€šé“"><a href="#æ•°æ®é€šé“" class="headerlink" title="æ•°æ®é€šé“"></a>æ•°æ®é€šé“</h2><p>WebRTCæ•°æ®é€šé“æ˜¯åœ¨æµè§ˆå™¨ä¹‹é—´ï¼Œç»•è¿‡æœåŠ¡å™¨æ¥ç›´æ¥äº¤æ¢æ•°æ®çš„ã€‚åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬éƒ½æ˜¯å€ŸåŠ©WebSocketæˆ–HTTPæ¥æ»¡è¶³éœ€æ±‚ã€‚è€Œç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡WebRTCæ•°æ®é€šé“æ¥ä¼ è¾“ï¼Œè€Œä¸”æ•°æ®é€šé“æ”¯æŒæµé‡å¤§ã€å»¶è¿Ÿä½çš„è¿æ¥ã€‚</p>
<p>WebRTCæ•°æ®é€šé“æ˜¯åŸºäºWebSocketå»ºç«‹çš„ï¼Œä¹Ÿå…·æœ‰sendæ–¹æ³•å’Œonmessageæ–¹æ³•ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">pc = <span class="keyword">new</span> RTCPeerConnection();</span><br><span class="line"><span class="comment">// dc-1ä¸ºæ ‡ç­¾ï¼Œåˆ›å»ºå®Œä¹‹åä¼šå¯¼è‡´å¯¹ç«¯æ”¶åˆ°RTCDataChannelEvent</span></span><br><span class="line">dc = pc.createDataChannel(<span class="string">'dc-1'</span>); </span><br><span class="line"><span class="comment">// å¯åœ¨å¯¹ç«¯å¤„ç†è¯¥äº‹ä»¶</span></span><br><span class="line">pc = <span class="keyword">new</span> RTCPeerConnection();</span><br><span class="line">pc.ondatachannel = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  dc = e.channel;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// send / onmessage</span></span><br><span class="line">dc.send(<span class="string">'string type msg'</span>);</span><br><span class="line">dc.send(<span class="keyword">new</span> Blob([<span class="string">'blob message'</span>], &#123;<span class="attr">type</span>: <span class="string">'text/plain'</span>&#125;));</span><br><span class="line">dc.send(<span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">32</span>));</span><br><span class="line">dc.send(<span class="keyword">new</span> uInt8Array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]));</span><br><span class="line">dc.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Received message'</span> + e.data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// .createDataChannel()ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæ§åˆ¶é…ç½®</span></span><br><span class="line"><span class="comment">// é™åˆ¶é€šé“åœ¨ç¬¬ä¸€æ¬¡æ•°æ®ä¼ è¾“å¤±è´¥æ—¶é‡æ–°ä¼ è¾“æ•°æ®çš„æ¬¡æ•°</span></span><br><span class="line">pc.createDataChannel(<span class="string">''</span>, &#123;<span class="attr">maxRetransimits</span>:<span class="number">3</span>&#125;);</span><br><span class="line"><span class="comment">// é™åˆ¶é€šé“å…è®¸é‡è¯•æ“ä½œæŒç»­çš„æ¯«ç§’æ•°</span></span><br><span class="line">pc.createDataChannel(<span class="string">''</span>, &#123;<span class="attr">maxRetransimitTime</span>:<span class="number">30</span>&#125;);</span><br><span class="line"><span class="comment">// psï¼šmaxRetransimitsã€maxRetransimitTimeæ˜¯äº’æ–¥çš„</span></span><br><span class="line"><span class="comment">// ä¸æ­¢è¿™ä¸¤ä¸ªé…ç½®</span></span><br><span class="line"><span class="comment">// order: æ¥æ”¶é¡ºåºï¼Œfalseåˆ™ä¸ºæ¥æ”¶é¡ºåºæ··ä¹±ä¹Ÿæ— æ‰€è°“</span></span><br></pre></td></tr></table></figure></p>
<p>æ›´å¤šä¾‹å­ï¼š<a href="https://webrtc.github.io/samples/" target="_blank" rel="noopener">WebRTC samples</a></p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="http://w3c.github.io/webrtc-pc/" target="_blank" rel="noopener">WebRTC 1.0</a></li>
<li>ã€ŠWebRTC æƒå¨æŒ‡å—ã€‹</li>
<li><a href="https://blog.coding.net/blog/getting-started-with-webrtc" target="_blank" rel="noopener">WebRTC çš„å‰ä¸–ä»Šç”Ÿ - Coding åšå®¢</a></li>
<li><a href="https://www.html5rocks.com/zh/tutorials/getusermedia/intro/" target="_blank" rel="noopener">Capturing Audio &amp; Video in HTML5</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
            <tag> webrtc </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘å­¦ä¹ -MSEå®è·µç¯‡]]></title>
      <url>https://lucius0.github.io/2018/03/11/archivers/media-study-011/</url>
      <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡å¤§è‡´è®²è§£äº†MSEçš„åŸç†ï¼Œä¸èƒ½å…‰è¯´ä¸ç»ƒã€‚æˆ‘ä»¬å°±æ¥ç®€å•çš„æ¥ä¸ªä¾‹å­ã€‚å½“ç„¶æ²¡æœ‰flvçš„è§£æï¼Œä¹Ÿæ²¡æœ‰fmp4çš„è½¬æ¢ã€‚ä¸»è¦æ˜¯MPEG-DASH + MSEçš„æ“ç»ƒã€‚</p>
<p>é¦–å…ˆå…ˆæŠ“æ¥ä¸€ä¸ªmp4çš„è§†é¢‘ï¼Œæˆ‘ä»¬å°±å‘½åä¸º<code>mse.mp4</code>å§ã€‚ç„¶åè¿™é‡Œæ¶‰åŠåˆ°äº†åˆ‡ç‰‡çš„æ“ä½œã€‚å…¶å®åˆ‡ç‰‡è·ŸHLSçš„åŸç†æ˜¯ä¸€æ ·çš„ï¼Œç›®çš„å°±æ˜¯æŠŠä¸€ä¸ªé•¿è§†é¢‘åˆ‡æˆä¸€å°æ®µä¸€å°æ®µçš„ï¼Œç„¶åå†å»è¯·æ±‚å®ƒä»¬ã€‚è¿™æ ·èƒ½è¾¾åˆ°å½“éœ€è¦åˆ‡æ¢ç ç‡çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è¯·æ±‚ä¸åŒçš„ç‰‡æ®µæ¥è¾¾åˆ°ç›®çš„ã€‚</p>
<h2 id="MPEG-DASH-æ¦‚å¿µ"><a href="#MPEG-DASH-æ¦‚å¿µ" class="headerlink" title="MPEG-DASH æ¦‚å¿µ"></a>MPEG-DASH æ¦‚å¿µ</h2><p>MPEG-DASHï¼Œ Dynamic Adaptive Streaming over HTTPã€‚æœ¬èº«å°±æ˜¯Adaptive Streamingçš„ä¸€ç§ï¼Œä¸HLSæ˜¯åŒæ ·çš„ä½œç”¨ã€‚åœ¨MPEG-DASHè§„èŒƒä¸­çš„MPDæè¿°æ–‡ä»¶ï¼Œä¸»è¦æ˜¯ç”¨æ¥æè¿°åª’ä½“æ–‡ä»¶çš„mimeTypeã€codecsã€segmentä¿¡æ¯ç­‰ï¼ŒMPDå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªxmlæ–‡ä»¶ã€‚</p>
<h2 id="åˆ‡ç‰‡æ–¹å¼"><a href="#åˆ‡ç‰‡æ–¹å¼" class="headerlink" title="åˆ‡ç‰‡æ–¹å¼"></a>åˆ‡ç‰‡æ–¹å¼</h2><p>æ‰€ä»¥æˆ‘ä»¬é€šè¿‡<code>MP4Box</code>å¯¹mp4è¿›è¡ŒMPEG-DASHåˆ‡ç‰‡ã€‚å‚è€ƒ<a href="https://bitmovin.com/mp4box-dash-content-generation-x264/" target="_blank" rel="noopener">MPEG-DASH Content Generation with MP4Box and x264 - Bitmovin</a></p>
<p>MPEG-DASHåˆ‡ç‰‡ä¸€èˆ¬æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li>Adaptive Streamingï¼šè·Ÿä¸Šé¢å…¶å®æ„æ€å·®ä¸å¤šï¼Œä¹Ÿæ˜¯ç‰‡æ®µåŒ–æ“ä½œï¼Œä½†æ˜¯è¿™ä¸ªä¼šäº‹å…ˆæŠŠç‰‡æ®µéƒ½åˆ‡åˆ†å¥½ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘è¯·æ±‚çš„æ˜¯ä¸‹ä¸€ä¸ªç‰‡æ®µè€Œä¸æ˜¯æ ¹æ®æ—¶é—´æˆ³æ¥è¯·æ±‚ã€‚</li>
<li>Progress Downloadï¼šé€šè¿‡<strong>http Range header</strong>ï¼Œè·å–æ¯ä¸€ä¸ªç‰‡æ®µçš„rangeå€¼ï¼Œä»è€Œä¸æ–­çš„æ‹‰å–rangeçš„åª’ä½“æµã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåª’ä½“æ–‡ä»¶å°±ä¸€ä¸ªï¼Œä½†æ˜¯æˆ‘ä¸æ–­çš„è¯·æ±‚åª’ä½“æ–‡ä»¶çš„æ’­æ”¾èµ·å§‹æ—¶é—´æˆ³ä¹‹é—´çš„åª’ä½“æµï¼Œä»è€Œè¾¾åˆ°ç‰‡æ®µåŒ–çš„æ“ä½œã€‚</li>
</ul>
<h3 id="Adaptive-Streaming"><a href="#Adaptive-Streaming" class="headerlink" title="Adaptive Streaming"></a>Adaptive Streaming</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; MP4Box -dash 5000 -rap -segment-name output/segment_ mse.mp4</span><br><span class="line"></span><br><span class="line">// _dash.mpd: å°†å…¶æ”¹ä¸ºxmlæˆ–è€…ç›´æ¥åœ¨ç¼–è¾‘å™¨æ‰“å¼€ï¼Œå°±ä¼šå‘ç°é‡Œé¢æ”¾ç€çš„æ˜¯æ•´ä¸ªåª’ä½“æ–‡ä»¶çš„ä¿¡æ¯ä»¥åŠæ¯ä¸€æ®µsegmentçš„ä½ç½®ã€‚</span><br><span class="line">// *_init.mp4: åˆå§‹çš„mp4æ–‡ä»¶ï¼Œç›¸å½“äºè§†é¢‘å¤´ï¼Œåœ¨è¿™ä¸ªå¤´æ–‡ä»¶ä¸­åŒ…å«äº†å®Œæ•´çš„è§†é¢‘å…ƒä¿¡æ¯(ftyp + moov)ï¼Œå…·ä½“çš„å¯ä»¥ä½¿ç”¨ MP4Box &lt;init video&gt; -info æŸ¥çœ‹ã€‚</span><br><span class="line">// *.m4s: å³ä¸Šé¢æåˆ°çš„Segmentsæ–‡ä»¶ï¼Œæ¯ä¸ªm4sä»…åŒ…å«åª’ä½“ä¿¡æ¯ (moof + mdat)ï¼Œè€Œæ’­æ”¾å™¨æ˜¯ä¸èƒ½ç›´æ¥æ’­æ”¾è¿™ä¸ªæ–‡ä»¶çš„ï¼Œéœ€è¦ç”¨æ”¯æŒDASHçš„æ’­æ”¾å™¨ä»initæ–‡ä»¶å¼€å§‹æ’­æ”¾ã€‚</span><br><span class="line">// -rap: random access point</span><br><span class="line">// -segment-name: ç”Ÿæˆçš„åˆ‡ç‰‡åå­—å‰ç¼€ï¼Œå¦‚segment_1.m4s</span><br></pre></td></tr></table></figure>
<p>1ã€å°†mpdæ–‡ä»¶æ”¹ä¸ºxmlæ–‡ä»¶ï¼Œå¹¶è·å–é‡Œé¢æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œå¦‚mimeTypeï¼Œcodecsã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">xhr.open(<span class="string">'get'</span>, baseUrl + <span class="string">'mse_dash.xml'</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.responseType = <span class="string">'text'</span>;</span><br><span class="line">xhr.send();</span><br><span class="line"></span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.readyState === xhr.DONE) &#123;</span><br><span class="line">    <span class="keyword">var</span> output = xhr.response;</span><br><span class="line">    <span class="keyword">var</span> parser = <span class="keyword">new</span> DOMParser();</span><br><span class="line">    <span class="keyword">var</span> xmlData = parser.parseFromString(tempoutput, <span class="string">"text/xml"</span>, <span class="number">0</span>);</span><br><span class="line">    getFileType(xmlData);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFileType</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> file = data.querySelectorAll(<span class="string">'Representation'</span>)[<span class="number">0</span>];</span><br><span class="line">    mimeType = file.getAttribute(<span class="string">'mimeType'</span>);</span><br><span class="line">    codecs = file.getAttribute(<span class="string">'codecs'</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span>(e) &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>2ã€å®ä¾‹åŒ–Media Sourceå¯¹è±¡ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.MediaSource) &#123;</span><br><span class="line">  <span class="keyword">var</span> mediaSource = <span class="keyword">new</span> <span class="built_in">window</span>.MediaSource();</span><br><span class="line">  <span class="keyword">var</span> url = URL.createObjectURL(mediaSource);</span><br><span class="line">  videoEle = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'video'</span>)[<span class="number">0</span>];</span><br><span class="line">  videoEle.src = url;</span><br><span class="line"></span><br><span class="line">  mediaSource.addEventListener(<span class="string">'sourceopen'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> tempStr = mimeType + <span class="string">'; codecs="'</span> +  codecs + <span class="string">'"'</span>;</span><br><span class="line">      <span class="keyword">if</span> (MediaSource.isTypeSupported(tempStr)) &#123;</span><br><span class="line">        videoSource = mediaSource.addSourceBuffer(tempStr);</span><br><span class="line">        videoSource.addEventListener(<span class="string">'updateend'</span>, nextSegment);</span><br><span class="line">        initVideo();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">      <span class="built_in">console</span>.error(<span class="string">'source open error'</span>, e.message);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  mediaSource.addEventListener(<span class="string">'sourceclose'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'media source close...'</span>, e.message);</span><br><span class="line">  &#125;, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  mediaSource.addEventListener(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'media source error...'</span>, e.message);</span><br><span class="line">  &#125;, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>3ã€åŠ è½½åª’ä½“æ–‡ä»¶åˆå§‹åŒ–ç‰‡æ®µçš„ä¿¡æ¯<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initVideo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  getSeg(baseUrl + <span class="string">'output/segment_init.mp4'</span>, appendToBuffer);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> playPromise = videoEle.play();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿™é‡Œåšä¸‹promiseçš„å¤„ç†ï¼Œå‚è€ƒè¿™é‡Œhttps://developers.google.com/web/updates/2017/06/play-request-was-interrupted</span></span><br><span class="line">  <span class="keyword">if</span> (playPromise !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">    playPromise.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'play promise then'</span>);</span><br><span class="line">    &#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'play promise error'</span>, err);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSeg</span>(<span class="params">url, callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">  xhr.open(<span class="string">'GET'</span>, url);</span><br><span class="line">  xhr.responseType = <span class="string">'arraybuffer'</span>;</span><br><span class="line"></span><br><span class="line">  xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (xhr.status != <span class="number">200</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    callback(xhr.response);</span><br><span class="line">  &#125;;</span><br><span class="line">  xhr.send();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">appendToBuffer</span>(<span class="params">videoChunk</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (videoChunk) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      videoSource.appendBuffer(<span class="keyword">new</span> <span class="built_in">Uint8Array</span>(videoChunk));</span><br><span class="line">    &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">      <span class="built_in">console</span>.error(e.message);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>4ã€ä¸æ–­çš„æ·»åŠ media segment<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nextSegment</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  ++index;</span><br><span class="line">  <span class="keyword">if</span> (index &lt;= maxChunksIndex) &#123;</span><br><span class="line">    <span class="keyword">var</span> url = baseUrl + <span class="string">'output/segment_'</span> + index + <span class="string">'.m4s'</span>;</span><br><span class="line">    getSeg(url, appendToBuffer);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    videoSource.removeEventListener(<span class="string">'updateend'</span>, nextSegment);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Progress-Download"><a href="#Progress-Download" class="headerlink" title="Progress Download"></a>Progress Download</h3><p>è·Ÿä¹‹å‰ä¸€æ ·ï¼Œå…ˆè¿›è¡Œåª’ä½“æµçš„ç‰‡æ®µåˆ‡ç‰‡ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿™é‡Œä¸å†è§£é‡Š</span></span><br><span class="line">&gt;&gt;&gt; MP4Box -dash 10000 -frag 10000 -rap mse.mp4 </span><br><span class="line"><span class="comment"># å‡å¦‚ä¸Šé¢çš„æ“ä½œæ²¡æœ‰å‡ºç°MPDæ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦é€šè¿‡ffmpegè½¬ä¸ºfmp4æ–‡ä»¶ï¼Œå†ç”¨MP4Boxåˆ‡ç‰‡</span></span><br></pre></td></tr></table></figure></p>
<p>Progress Downloadè·ŸAdaptive Streamingä¸åŒçš„æ˜¯ï¼Œå®ƒéœ€è¦è®¡ç®—æ¯ä¸€ä¸ªsegment durationã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> time = (size * <span class="number">8</span>) / bitrate</span><br><span class="line"><span class="comment">// å³åœ¨MPDè·å–ç›¸å¯¹åº”çš„ä¿¡æ¯ä¹‹åï¼Œä»£ç å¦‚ä¸‹</span></span><br><span class="line"><span class="keyword">var</span> ranges = mediaRange.split(<span class="string">'-'</span>);</span><br><span class="line"><span class="keyword">var</span> time = (ranges[<span class="number">1</span>] - ranges[<span class="number">0</span>]) * <span class="number">8</span> / bandwidth;</span><br></pre></td></tr></table></figure></p>
<p>å®é™…ä¸Šï¼Œå…³äºProgress Downloadï¼Œå¯ä»¥ç§»æ­¥åˆ°<a href="https://msdn.microsoft.com/zh-cn/library/dn551368.aspx" target="_blank" rel="noopener">æ„å»ºç®€å•çš„ MPEG-DASH æµåª’ä½“æ’­æ”¾å™¨</a>ï¼Œè¿™é‡Œåªæ˜¯å¯¹å…¶åšæœ€ç®€å•çš„æ¼”ç¤ºã€‚<br>1ã€ç¬¬ä¸€æ­¥å…¶å®è·Ÿä¸Šé¢çš„å·®ä¸å¤šï¼Œåªæ˜¯å¤šäº†å‡ ä¸ªå­—æ®µï¼Œbandwidth(åšsegment durationè®¡ç®—)ï¼Œsegments(æ¯ä¸€ä¸ªsegmentå­—æ®µ)ï¼ŒinitRange(å°±æ˜¯ä¸Šé¢çš„<code>segment_init.mp4</code>)ã€‚<br>2ã€å®ä¾‹åŒ–Media Sourceå¯¹è±¡ã€‚ä¸€æ ·çš„æ“ä½œï¼Œç†Ÿæ‚‰çš„å‘³é“ã€‚<br>3ã€åŠ è½½åª’ä½“æ–‡ä»¶åˆå§‹åŒ–ç‰‡æ®µçš„ä¿¡æ¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ²¡ç»™å‡ºçš„ä»£ç åŸºæœ¬è·Ÿä¸Šé¢ä¸€è‡´</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initVideo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  getSeg(initRange, baseFile, appendToBuffer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSeg</span>(<span class="params">range, url, callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">  xhr.open(<span class="string">'get'</span>, url);</span><br><span class="line">  xhr.setRequestHeader(<span class="string">'Range'</span>, <span class="string">'bytes='</span> + range);</span><br><span class="line">  xhr.responseType = <span class="string">'arraybuffer'</span>;</span><br><span class="line">  xhr.send();</span><br><span class="line">      </span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    xhr.addEventListener(<span class="string">'readystatechange'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (xhr.readyState === xhr.DONE) &#123;</span><br><span class="line">        callback(xhr.response);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="literal">false</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(e.message);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4ã€ä¸æ–­çš„æ·»åŠ media segment<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nextSegment</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (index &lt;= segments.length - <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> segment = segments[index];</span><br><span class="line">    <span class="keyword">var</span> range = segment.getAttribute(<span class="string">'mediaRange'</span>);</span><br><span class="line">    getSeg(range, baseFile, appendToBuffer);</span><br><span class="line">    ++index;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    videoSource.removeEventListener(<span class="string">'updateend'</span>, nextSegment);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œå·²ç»è®²å¾—å·®ä¸å¤šäº†ã€‚åŸºæœ¬ä¸Šä»flv.jsçš„è§£æå†åˆ°mseçš„å®è·µï¼Œå…³äºåª’ä½“çš„å­¦ä¹ å…ˆå‘Šä¸€æ®µè½ã€‚ä½†æ˜¯è¿™ä¸€éƒ¨åˆ†æœ¬èº«å°±æ˜¯æ¦‚å¿µå¾ˆå¤šå‘å¾ˆå¤šï¼Œè‹¥ä»¥åæœ‰ä»€ä¹ˆå¯ä»¥åˆ†äº«æˆ–è€…ä»€ä¹ˆå‘ï¼Œæˆ‘éƒ½ä¼šåˆ°æ­¤è®°å½•ä¸‹æ¥ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="http://www.mediaentertainmentinfo.com/2015/04/6-concept-series-what-is-the-difference-between-progressive-download-rtmp-streaming-and-adaptive-streaming.html/#Diff-Progressive-RTMP-AdaptiveStreaming" target="_blank" rel="noopener">Difference between Progressive download, RTMP RTSP Streaming and Adaptive Steaming | Media &amp; Entertainment Industry Trends, Technology and Research</a></li>
<li><a href="https://hacks.mozilla.org/2015/07/streaming-media-on-demand-with-media-source-extensions/" target="_blank" rel="noopener">https://hacks.mozilla.org/2015/07/streaming-media-on-demand-with-media-source-extensions/</a></li>
<li><a href="https://bitmovin.com/mp4box-dash-content-generation-x264/" target="_blank" rel="noopener">MPEG-DASH Content Generation with MP4Box and x264 - Bitmovin</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘å­¦ä¹ -MSEåŸºç¡€åŸç†ç¯‡]]></title>
      <url>https://lucius0.github.io/2018/02/23/archivers/media-study-010/</url>
      <content type="html"><![CDATA[<p>MSE å¯ä»¥è¯´W3Cæœ€é‡è¦çš„ä¸€ä¸ªåª’ä½“æºæ‰©å±•æ ‡å‡†ã€‚å‡å¦‚æ²¡æœ‰ MSE çš„å­˜åœ¨ï¼Œé‚£ä¹ˆä»€ä¹ˆhls.jsï¼Œflv.jsï¼Œdash.jséƒ½æ˜¯ç©ºè°ˆã€‚å› ä¸º MSEï¼Œæ‰ä½¿å¾—åª’ä½“æµèƒ½æ ¹æ®éœ€è¦è¿›è¡Œæ›´ç²¾å‡†åœ°æ§åˆ¶ã€‚è¿™æ˜¯w3cçš„æ–‡æ¡£<a href="https://w3c.github.io/media-source/" target="_blank" rel="noopener">Media Source Extensionsâ„¢</a>ã€‚</p>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>æ—©å…ˆçš„åª’ä½“æµè¿˜æ˜¯ä¸€ç›´ä¾èµ–Flashï¼Œé€šè¿‡rtmpæˆ–è€…http-flvç­‰åè®®è¿›è¡Œè§†é¢‘ä¸²æµï¼Œå†åˆ° Flash æ’­æ”¾å™¨ã€‚</p>
<p>ç„¶è€Œæœ‰äº†MSE(media souce extensions)ä¹‹åï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ã€‚æˆ‘ä»¬å¯ä»¥å¼•ç”¨<code>MediaSource</code>å¯¹è±¡ï¼Œä½ å¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªå®¹å™¨ï¼Œä¸€ä¸ªå¼•ç”¨å¤šä¸ª<code>SourceBuffer</code>å¯¹è±¡çš„å®¹å™¨ã€‚é‚£ä¹ˆåœ¨ä¸Šé¢æˆ‘ä»¬å°±æåˆ°ï¼ŒMSEèƒ½å¤Ÿæ ¹æ®éœ€è¦å¯¹åª’ä½“æµè¿›è¡Œæ›´ç²¾å‡†çš„æ§åˆ¶ï¼Œä¾‹å¦‚æ ¹æ®ç½‘ç»œæƒ…å†µè¿›è¡Œåˆ‡ç ç‡ä¸åŒçš„åª’ä½“æµï¼Œæˆ–æ˜¯æ ¹æ®å†…å­˜å ç”¨æƒ…å†µé‡Šæ”¾ä¹‹å‰æ’­æ”¾è¿‡çš„åª’ä½“æµç­‰ç­‰ã€‚</p>
<p>è¿™æ˜¯ä¸€å¼ Media Sourceçš„ç»“æ„å›¾ï¼š<br><img src="http://ouazw12mz.bkt.clouddn.com/180223211232.png?imageslim" alt=""></p>
<h2 id="MediaSource"><a href="#MediaSource" class="headerlink" title="MediaSource"></a>MediaSource</h2><p><code>Media Source Extensions API</code>çš„<code>MediaSource</code>æ¥å£è¡¨ç¤º<code>HTMLMediaElement</code>å¯¹è±¡çš„åª’ä½“æ•°æ®æºã€‚<code>MediaSource</code>å¯¹è±¡å¯ä»¥é™„åŠ åˆ°<code>HTMLMediaElement</code>åœ¨å®¢æˆ·ç«¯ä¸­æ’­æ”¾ã€‚</p>
<h3 id="çŠ¶æ€"><a href="#çŠ¶æ€" class="headerlink" title="çŠ¶æ€"></a>çŠ¶æ€</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">enum ReadyState &#123;</span><br><span class="line">    <span class="comment">// è¯´æ˜åª’ä½“æºå½“å‰æœªé™„åŠ åˆ°åª’ä½“å…ƒç´ (HTMLMediaElement)</span></span><br><span class="line">    <span class="string">"closed"</span>,</span><br><span class="line">    <span class="comment">// åª’ä½“æºå·²è¢«åª’ä½“å…ƒç´ æ‰“å¼€ï¼Œå¹¶å‡†å¤‡å¥½å°†æ•°æ®æ·»åŠ åˆ°sourceBuffersä¸­çš„SourceBufferå¯¹è±¡</span></span><br><span class="line">    <span class="string">"open"</span>,</span><br><span class="line">    <span class="comment">// åª’ä½“æºä»ç„¶é™„åŠ åˆ°ä¸€ä¸ªåª’ä½“å…ƒç´ ä¸Šï¼Œä½†endOfStream()å·²è¢«è°ƒç”¨</span></span><br><span class="line">    <span class="string">"ended"</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="é”™è¯¯"><a href="#é”™è¯¯" class="headerlink" title="é”™è¯¯"></a>é”™è¯¯</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">enum EndOfStreamError &#123;</span><br><span class="line">    <span class="string">"network"</span>, <span class="comment">// ç½‘ç»œé”™è¯¯</span></span><br><span class="line">    <span class="string">"decode"</span> <span class="comment">// è§£ç é”™è¯¯</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="åŸºæœ¬ç»“æ„"><a href="#åŸºæœ¬ç»“æ„" class="headerlink" title="åŸºæœ¬ç»“æ„"></a>åŸºæœ¬ç»“æ„</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[Constructor]</span><br><span class="line">interface MediaSource : EventTarget &#123;</span><br><span class="line">  readonly attribute SourceBufferList sourceBuffers;</span><br><span class="line">  readonly attribute SourceBufferList activeSourceBuffers;</span><br><span class="line">  readonly attribute ReadyState readyState;</span><br><span class="line">  attribute unrestricted <span class="keyword">double</span> duration;</span><br><span class="line">  attribute EventHandler onsourceopen;</span><br><span class="line">  attribute EventHandler onsourceended;</span><br><span class="line">  attribute EventHandler onsourceclose;</span><br><span class="line">  <span class="function">SourceBuffer <span class="title">addSourceBuffer</span><span class="params">(DOMString type)</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">removeSourceBuffer</span><span class="params">(SourceBuffer sourceBuffer)</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">endOfStream</span><span class="params">(optional EndOfStreamError error)</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">setLiveSeekableRange</span><span class="params">(<span class="keyword">double</span> start, <span class="keyword">double</span> end)</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">clearLiveSeekableRange</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">static</span> boolean <span class="title">isTypeSupported</span><span class="params">(DOMString type)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h3><ul>
<li><p>sourceBuffersï¼šåªè¯»ï¼Œè¿”å›<code>SourceBufferList</code>ã€‚åŒ…å«ä¸æ­¤<code>MediaSource</code>å…³è”çš„<code>SourceBuffer</code>å¯¹è±¡çš„åˆ—è¡¨ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç </span></span><br><span class="line"><span class="keyword">if</span> mediaSource.readyState === <span class="string">'close'</span></span><br><span class="line">  <span class="keyword">return</span> SourceBufferList(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> mediaSource.readyState === <span class="string">'open'</span></span><br><span class="line">  <span class="comment">// length = mediaSource.addSourceBuffer(SourceBuffer).length</span></span><br><span class="line">  <span class="keyword">return</span> SourceBufferList(length);</span><br></pre></td></tr></table></figure>
</li>
<li><p>activeSourceBuffersï¼šåªè¯»ï¼Œè¿”å›<code>SourceBufferList</code>ã€‚åŒ…å«äº†æ‰€é€‰ä¸­çš„video trackï¼Œå¯ç”¨ä¸­çš„audio trackä»¥åŠæ˜¾ç¤ºæˆ–éšè—çš„text trackçš„<code>sourceBuffers</code>çš„å­é›†ã€‚æ­¤åˆ—è¡¨ä¸­çš„SourceBufferå¯¹è±¡å¿…é¡»æŒ‰ç…§å®ƒä»¬å‡ºç°åœ¨<code>sourceBuffers</code>å±æ€§ ä¸­çš„é¡ºåºå‡ºç°; ä¾‹å¦‚ï¼Œå¦‚æœåªæœ‰sourceBuffers [0]å’ŒsourceBuffers [3]åœ¨   <code>activeSourceBuffers</code>ä¸­ï¼Œåˆ™activeSourceBuffers [0]å¿…é¡»ç­‰äºsourceBuffers [0]ï¼ŒactiveSourceBuffers [1]å¿…é¡»ç­‰äºsourceBuffers [3]ã€‚</p>
</li>
<li><p>readyStateï¼šåªè¯»ï¼Œè¿”å›<code>ReadyState</code>ã€‚<code>MediaSource</code>å¯¹è±¡çš„å½“å‰çŠ¶æ€ã€‚<strong>å½“åˆ›å»ºåª’ä½“æºæ—¶ï¼Œå¿…é¡»å°†â€œreadyStateâ€è®¾ç½®ä¸ºâ€œcloseâ€</strong>ã€‚</p>
</li>
<li><p>durationï¼šè¿”å›doubleã€‚å½“<code>MediaSource</code>å¯¹è±¡åˆ›å»ºæ—¶ï¼Œdurationçš„åˆå§‹åŒ–å€¼ä¸ºNaNã€‚è·å–æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹çš„æ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç </span></span><br><span class="line"><span class="comment">// getter</span></span><br><span class="line"><span class="keyword">if</span> mediaSource.readyState === <span class="string">'close'</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">NaN</span></span><br><span class="line"><span class="keyword">return</span> dutation</span><br><span class="line"></span><br><span class="line"><span class="comment">// setter</span></span><br><span class="line"><span class="keyword">if</span> new_duration &lt; <span class="number">0</span> ||<span class="built_in">isNaN</span>(new_duration)</span><br><span class="line">  <span class="keyword">throw</span> <span class="built_in">TypeError</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> mediaSource.readyState !== <span class="string">'open'</span></span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> anyOneSourceBuffer(sourceBuffers).updating === <span class="literal">true</span></span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  run duration_change_algorithm</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼š</span></span><br><span class="line"><span class="number">1</span>ã€å¦‚æœå½“å‰bufferç¼–ç å¸§æœ‰è¾ƒé«˜çš„ç»“æŸæ—¶é—´ï¼Œåˆ™duration_change_algorithmä¹Ÿä¼šå°†durationè°ƒæ•´å¾—ç›¸å¯¹æ¯”è¾ƒé«˜ï¼›</span><br><span class="line"><span class="number">2</span>ã€appendBuffer()å’ŒendOfStream()å¯ä»¥åœ¨æŸäº›æƒ…å†µä¸‹æ›´æ–°æŒç»­æ—¶é—´ã€‚</span><br></pre></td></tr></table></figure>
</li>
<li><p>onsourceopenï¼Œonsourceendedï¼Œonsourcecloseï¼š<code>EventHandler</code>ç±»å‹ã€‚</p>
</li>
</ul>
<h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><ul>
<li><p>addSourceBufferï¼šæ·»åŠ æ–°çš„<code>SourceBuffer</code>åˆ°<code>sourceBuffers</code>ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.addSourceBuffer(type: DOMString): SourceBuffer</span><br></pre></td></tr></table></figure>
<p>å‡å¦‚æ–¹æ³•è¢«è°ƒç”¨ï¼Œåˆ™ä¼šæœ‰ä»¥ä¸‹çš„æ‰§è¡Œæ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç </span></span><br><span class="line"><span class="keyword">if</span> type === <span class="string">''</span></span><br><span class="line">  <span class="keyword">throw</span> <span class="built_in">TypeError</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> isNotSupportedMIME(type)</span><br><span class="line">  <span class="keyword">throw</span> NotSupportedError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> canNotHandlerMoreSourceBuffer || </span><br><span class="line">  (sb = addSourceBuffer(type) &amp;&amp; </span><br><span class="line">  isNotSupportedSourceBufferConfiguration(sb))</span><br><span class="line">  <span class="comment">// SourceBuffer Configurationï¼š1ã€å…·æœ‰1ä¸ªaudio trackå’Œ/æˆ–1ä¸ªvideo trackçš„å•ä¸ªSourceBufferï¼›2ã€ä¸¤ä¸ªSourceBuffersï¼Œä¸€ä¸ªå¤„ç†å•ä¸ªaudio trackï¼Œå¦ä¸€ä¸ªå¤„ç†å•ä¸ªvideo track</span></span><br><span class="line">  <span class="comment">// ä¸¾ä¸ªä¾‹å­ï¼Œ`HTMLMediaElement`ä¸­çš„`readyState`ä¸º[HAVE_METADATA](https://www.w3.org/TR/html51/semantics-embedded-content.html#dom-htmlmediaelement-have_metadata)ï¼Œå‡å¦‚æµè§ˆå™¨ä¸æ”¯æŒåœ¨æ’­æ”¾è¿‡ç¨‹ä¸­æ·»åŠ æ›´å¤šçš„trackï¼Œé‚£ä¹ˆåˆ™æœ‰å¯èƒ½ä¼šæŠ›å‡ºè¿™ç§å¼‚å¸¸ã€‚</span></span><br><span class="line">  <span class="keyword">throw</span> QuotaExceededError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> mediaSource.readyState !== <span class="string">'open'</span></span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"></span><br><span class="line">sb = <span class="keyword">new</span> SourceBuffer</span><br><span class="line">init generate_timestamps_flag</span><br><span class="line"><span class="keyword">if</span> generate_timestamps_flag === <span class="literal">true</span></span><br><span class="line">  sb.mode = <span class="string">'sequence'</span></span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">  sb.mode = <span class="string">'segments'</span></span><br><span class="line"></span><br><span class="line">sourceBuffers.addSourceBuffer(sb)</span><br><span class="line">sourceBuffers.fireEvent(<span class="string">'sourceBuffers'</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>removeSourceBufferï¼šä»<code>sourceBuffsers</code>åˆ é™¤<code>SourceBuffer</code>ã€‚æ‰§è¡Œæ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.removeSourceBuffer(sourceBuffer: SourceBuffer): <span class="keyword">void</span></span><br></pre></td></tr></table></figure>
<p>å‡å¦‚æ–¹æ³•è¢«è°ƒç”¨ï¼Œåˆ™ä¼šæœ‰ä»¥ä¸‹çš„æ‰§è¡Œæ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç </span></span><br><span class="line"><span class="keyword">if</span> sourceBuffer not <span class="keyword">in</span> sourceBuffers</span><br><span class="line">  <span class="keyword">throw</span> NotFoundError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> sourceBuffer.updating === <span class="literal">true</span></span><br><span class="line">  <span class="keyword">if</span> buffer_append_algorithm.isRunning === <span class="literal">true</span> <span class="keyword">return</span></span><br><span class="line">  sourceBuffer.updating = <span class="literal">false</span></span><br><span class="line">  sourceBuffer.fireEvent(<span class="string">'abort'</span>)</span><br><span class="line">  sourceBuffer.fireEvent(<span class="string">'updateend'</span>)</span><br><span class="line"></span><br><span class="line">sourceBufferAudioTracks = sourceBuffer.audioTracks</span><br><span class="line">sourceBufferVideoTracks = sourceBuffer.videoTracks</span><br><span class="line">sourceBufferTextTracks = sourceBuffer.textTracks</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sourceBufferAudioTracks.length &gt; <span class="number">0</span> || sourceBufferVideoTracks.length &gt; <span class="number">0</span> || sourceBufferTextTracks.length &gt; <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> sourceBufferAudioTracks/sourceBufferVideoTracks/sourceBufferTextTracks</span><br><span class="line">  sourceBufferAudioTracks[i].sourceBuffer = <span class="literal">null</span></span><br><span class="line">  sourceBufferVideoTracks[i].sourceBuffer = <span class="literal">null</span></span><br><span class="line">  sourceBufferTextTracks[i].sourceBuffer = <span class="literal">null</span></span><br><span class="line">  HTMLMediaElement.removeTracks(sourceBufferAudioTracks[i], sourceBufferVideoTracks[i], sourceBufferTextTracks[i])</span><br><span class="line">  sourceBuffer.removeTracks(sourceBufferAudioTracks[i], sourceBufferVideoTracks[i], sourceBufferTextTracks[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sourceBuffer <span class="keyword">in</span> activeSourceBuffers</span><br><span class="line">  activeSourceBuffers.remove(sourceBuffer)</span><br><span class="line">  activeSourceBuffers.fireEvent(<span class="string">'removesourcebuffer'</span>)</span><br><span class="line"></span><br><span class="line">destroy sourceBuffer.resource</span><br></pre></td></tr></table></figure>
</li>
<li><p>endOfStreamï¼šè¡¨ç¤ºåª’ä½“æµç»“æŸã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.endOfStream(error?: EndOfStreamError): <span class="keyword">void</span></span><br></pre></td></tr></table></figure>
<p>å‡å¦‚æ–¹æ³•è¢«è°ƒç”¨ï¼Œåˆ™ä¼šæœ‰ä»¥ä¸‹çš„æ‰§è¡Œæ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç </span></span><br><span class="line"><span class="keyword">if</span> mediaSource.readyState !== <span class="string">'open'</span></span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> anyOneSourceBuffer(sourceBuffers).updating === <span class="literal">true</span></span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"></span><br><span class="line">run end_of_stream_algorithm</span><br></pre></td></tr></table></figure>
</li>
<li><p>setLiveSeekableRangeï¼šæ›´æ–°<code>HTMLMediaElement Extensions</code>ä¸­çš„å¯seekèŒƒå›´ï¼Œä»è€Œè¾¾åˆ°ä¿®æ”¹<code>HTMLMediaElement.seekable</code>ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.setLiveSeekableRange(start: double, <span class="attr">end</span>: double): <span class="keyword">void</span></span><br></pre></td></tr></table></figure>
<p>å‡å¦‚æ–¹æ³•è¢«è°ƒç”¨ï¼Œåˆ™ä¼šæœ‰ä»¥ä¸‹çš„æ‰§è¡Œæ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç </span></span><br><span class="line"><span class="keyword">if</span> mediaSource.readyState !== <span class="string">'open'</span></span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> start &lt; <span class="number">0</span> || start &gt; end</span><br><span class="line">  <span class="keyword">throw</span> <span class="built_in">TypeError</span></span><br><span class="line"></span><br><span class="line">live_seekable_range = <span class="keyword">new</span> TimeRanges(end - start)</span><br><span class="line">HTMLMediaElement.seekable = live_seekable_range</span><br></pre></td></tr></table></figure>
</li>
<li><p>clearLiveSeekableRangeï¼šé¡¾åæ€ä¹‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.clearLiveSeekableRange(): <span class="keyword">void</span></span><br></pre></td></tr></table></figure>
<p>å‡å¦‚æ–¹æ³•è¢«è°ƒç”¨ï¼Œåˆ™ä¼šæœ‰ä»¥ä¸‹çš„æ‰§è¡Œæ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç </span></span><br><span class="line"><span class="keyword">if</span> mediaSource.readyState !== <span class="string">'open'</span></span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> TimeRanges()</span><br></pre></td></tr></table></figure>
</li>
<li><p>isTypeSupportedï¼š<strong>static</strong>ã€‚æ£€æŸ¥<code>MediaSource</code>æ˜¯å¦èƒ½å¤Ÿä¸ºæŒ‡å®šçš„MIMEç±»å‹åˆ›å»º<code>SourceBuffer</code>å¯¹è±¡ã€‚å¯ä»¥é€šè¿‡<a href="https://cconcolato.github.io/media-mime-support/" target="_blank" rel="noopener">Media MIME Support</a>æ¥æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„æµè§ˆå™¨å¯¹ä¸åŒçš„MIMEæ”¯æŒç¨‹åºã€‚æˆ–è€…é€šè¿‡<br><code>ffmpeg -i test.mp4</code>å¾—åˆ°çš„ä¿¡æ¯å»åŒ¹é…<a href="https://wiki.whatwg.org/wiki/Video_type_parameters" target="_blank" rel="noopener">Video type parameters - WHATWG Wiki</a>ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MediaSource.isTypeSupported(type: DOMString): <span class="keyword">void</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sourceopen  | Event | readyState = <span class="string">'closed'</span> =&gt; <span class="string">'open'</span> / <span class="string">'ended'</span> =&gt; <span class="string">'open'</span></span><br><span class="line"><span class="comment">// sourceopen</span></span><br><span class="line"><span class="keyword">let</span> mediaSource = <span class="keyword">new</span> MediaSource();</span><br><span class="line">videoElement.src = URL.createObjectURL(mediaSource);</span><br><span class="line">---------------------------------------------------</span><br><span class="line">sourceend   | Event | readyState = <span class="string">'open'</span> =&gt; <span class="string">'ended'</span></span><br><span class="line"><span class="comment">// sourceend</span></span><br><span class="line">mediaSource.endOfStream()</span><br><span class="line">---------------------------------------------------</span><br><span class="line">sourceclose | Event | readyState = <span class="string">'open'</span> =&gt; <span class="string">'closed'</span> / <span class="string">'ended'</span> =&gt; <span class="string">'closed'</span></span><br><span class="line"><span class="comment">// sourcrclose</span></span><br><span class="line">mediaSource.readyState = <span class="string">'closed'</span>;</span><br><span class="line">mediaSource.duration = <span class="literal">NaN</span>;</span><br><span class="line">mediaSource.removeSourceBuffer(activeSourceBuffers);</span><br><span class="line">mediaSource.removeSourceBuffer(sourceBuffers);</span><br></pre></td></tr></table></figure>
<h2 id="SourceBuffer"><a href="#SourceBuffer" class="headerlink" title="SourceBuffer"></a>SourceBuffer</h2><h3 id="æ·»åŠ æ¨¡å¼"><a href="#æ·»åŠ æ¨¡å¼" class="headerlink" title="æ·»åŠ æ¨¡å¼"></a>æ·»åŠ æ¨¡å¼</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">enum AppendMode &#123;</span><br><span class="line">    <span class="comment">// media segmentä¸­çš„æ—¶é—´æˆ³å†³å®šäº†ç¼–ç å¸§çš„ä½ç½®ï¼Œå³æŒ‰ pts æ¥æ’åºã€‚</span></span><br><span class="line">    <span class="string">"segments"</span>,</span><br><span class="line">    <span class="comment">// media segmentçš„æ—¶é—´æˆ³è·Ÿç¼–ç å¸§çš„ä½ç½®æ— å…³ã€‚æ–°çš„media segmentçš„ç¼–ç å¸§ä¼šè¿½åŠ åˆ°ä¸Šä¸€æ®µçš„media segmentçš„ç¼–ç å¸§åé¢ï¼Œå‡å¦‚ä¹‹é—´å­˜åœ¨é—´éš”ï¼Œåˆ™timestampOffsetä¼šè¢«é‡æ–°è®¾ç½®ç”¨æ¥å¼¥è¡¥è¿™æ®µé—´éš”ã€‚å› æ­¤timestampOffsetå¯ä»¥å°†ä¸€æ®µmedia segmentæ”¾åœ¨ä»»ä½•ä¸€ä¸ªä½ç½®ã€‚</span></span><br><span class="line">    <span class="string">"sequence"</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="åŸºç¡€ç»“æ„"><a href="#åŸºç¡€ç»“æ„" class="headerlink" title="åŸºç¡€ç»“æ„"></a>åŸºç¡€ç»“æ„</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">interface SourceBuffer : EventTarget &#123;</span><br><span class="line">    attribute AppendMode mode;</span><br><span class="line">    readonly attribute boolean updating;</span><br><span class="line">    readonly attribute TimeRanges buffered;</span><br><span class="line">    attribute <span class="keyword">double</span>  timestampOffset;</span><br><span class="line">    readonly attribute AudioTrackList audioTracks;</span><br><span class="line">    readonly attribute VideoTrackList videoTracks;</span><br><span class="line">    readonly attribute TextTrackList textTracks;</span><br><span class="line">    attribute <span class="keyword">double</span> appendWindowStart;</span><br><span class="line">    attribute unrestricted <span class="keyword">double</span> appendWindowEnd;</span><br><span class="line">    attribute EventHandler onupdatestart;</span><br><span class="line">    attribute EventHandler onupdate;</span><br><span class="line">    attribute EventHandler onupdateend;</span><br><span class="line">    attribute EventHandler onerror;</span><br><span class="line">    attribute EventHandler onabort;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">appendBuffer</span><span class="params">(BufferSource data)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">abort</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">double</span> start, unrestricted <span class="keyword">double</span> end)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="å±æ€§-1"><a href="#å±æ€§-1" class="headerlink" title="å±æ€§"></a>å±æ€§</h3><ul>
<li><p>modeï¼šå½“ä½¿ç”¨<code>MediaSource.addSourceBuffer()</code>åˆ›å»º<code>SourceBuffer</code>æ—¶ï¼Œä¼šç»™modeè®¾ç½®åˆå§‹å€¼ã€‚å¦‚æœmedia segmentå·²ç»å­˜åœ¨æ—¶é—´æˆ³ï¼Œåˆ™è¯¥å€¼å°†è¢«è®¾ç½®ä¸º<code>â€˜segmentsâ€™</code>ï¼Œåä¹‹åˆ™<code>sequence</code>ã€‚å½“è®¾ç½®æ—¶ï¼Œä¼šæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç å¦‚ä¸‹</span></span><br><span class="line"><span class="keyword">if</span> sourceBuffer not <span class="keyword">in</span> mediaSource.sourceBuffers</span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> updating === <span class="literal">true</span></span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> generate_timestamps_flag === <span class="literal">true</span> &amp;&amp; newMode === <span class="string">"segments"</span></span><br><span class="line">  <span class="keyword">throw</span> <span class="built_in">TypeError</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> mediaSource.readyState === <span class="string">'ended'</span></span><br><span class="line">  mediaSource.readyState = <span class="string">'open'</span></span><br><span class="line">  mediaSource.dispatch(<span class="string">'sourceopen'</span>)</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> append_state === PARSING_MEDIA_SEGMENT</span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> new_mode === <span class="string">"sequence"</span></span><br><span class="line">  group_start_timestamp = group_end_timestamp</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  sourceBuffer.mode = new_mode</span><br></pre></td></tr></table></figure>
</li>
<li><p>updatingï¼šåªè¯»ï¼Œbooleanç±»å‹ã€‚å½“æ‰§è¡Œå¼‚æ­¥æ“ä½œ<code>appendBuffer()</code>æˆ–<code>remove()</code>æ—¶ï¼Œè¿”å›trueï¼›åä¹‹falseï¼›</p>
</li>
<li><p>bufferedï¼šåªè¯»ï¼Œè¿”å›<code>TimeRanges</code>ã€‚è¡¨æ˜äº†<code>SourceBuffer</code>ä¸­ç¼“å†²äº†å“ªäº›<code>TimeRanges</code>ã€‚åˆ›å»ºè¯¥<code>SourceBuffer</code>å¯¹è±¡æ—¶ï¼Œè¯¥å±æ€§æœ€åˆè®¾ç½®ä¸ºç©ºçš„<code>TimeRanges</code>å¯¹è±¡ã€‚</p>
</li>
<li><p>timestampOffsetï¼šdoubleç±»å‹ã€‚ä¸»è¦æ˜¯æ§åˆ¶media segmentç‰‡æ®µä¹‹é—´çš„åç§»é‡ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ä¸Šä¸€ä¸ªçš„durationï¼Œåˆå§‹å€¼ä¸º0ã€‚å½“è®¾ç½®æ—¶ï¼Œä¼šæ‰§è¡Œä¸€ä¸‹æ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç å¦‚ä¸‹</span></span><br><span class="line"><span class="keyword">if</span> sourceBuffer not <span class="keyword">in</span> mediaSource.sourceBuffers</span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> sourceBuffer.updating === <span class="literal">true</span></span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> mediaSource.readyState === <span class="string">'ended'</span></span><br><span class="line">  mediaSource.readyState = <span class="string">'open'</span></span><br><span class="line">  mediaSource.dispatch(<span class="string">'sourceopen'</span>)</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> append_state === PARSING_MEDIA_SEGMENT</span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> mode === <span class="string">"sequence"</span></span><br><span class="line">  group_start_timestamp = new_timestampOffset</span><br><span class="line"></span><br><span class="line">sourceBuffer.timestampOffset = new_timestampOffset</span><br></pre></td></tr></table></figure>
</li>
<li><p>audioTracksï¼ŒvideoTracksï¼ŒtextTracksï¼šåˆ†åˆ«è¿”å›<code>AudioTrackList</code>ï¼Œ<code>VideoTrackList</code>å’Œ<code>TextTrackList</code>ã€‚</p>
</li>
<li><p>onupdatestartï¼Œonupdateï¼Œonupdateendï¼Œonerrorï¼Œonabortï¼š<code>EventHandler</code>ç±»å‹ã€‚</p>
</li>
</ul>
<h3 id="æ–¹æ³•-1"><a href="#æ–¹æ³•-1" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><ul>
<li><p>appendBufferï¼šå°†<code>BufferSource</code> ä¸­çš„æ•°æ®æ·»åŠ åˆ°source bufferã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.appendBuffer(data: BufferSource): <span class="keyword">void</span></span><br></pre></td></tr></table></figure>
<p>å‡å¦‚æ–¹æ³•è¢«è°ƒç”¨ï¼Œåˆ™ä¼šæœ‰ä»¥ä¸‹çš„æ‰§è¡Œæ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç </span></span><br><span class="line">run prepare_append_algorithm</span><br><span class="line">inputBuffer.push(data)</span><br><span class="line">sourceBuffer.updating = <span class="literal">true</span></span><br><span class="line">sourceBuffer.fireEvent(<span class="string">'updatestart'</span>)</span><br><span class="line"><span class="keyword">async</span> run buffer_append_algorithm</span><br></pre></td></tr></table></figure>
</li>
<li><p>abortï¼šä¸­æ­¢å¹¶é‡ç½®è§£æå™¨ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.abort(): <span class="keyword">void</span></span><br></pre></td></tr></table></figure>
<p>å‡å¦‚æ–¹æ³•è¢«è°ƒç”¨ï¼Œåˆ™ä¼šæœ‰ä»¥ä¸‹çš„æ‰§è¡Œæ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> sourceBuffer not <span class="keyword">in</span> mediaSource.sourceBuffers</span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> mediaSource.readyState !== <span class="string">'open'</span></span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> range_removal_algorithm.isRunning === <span class="literal">true</span></span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> sourceBuffer.updating === <span class="literal">true</span></span><br><span class="line">  <span class="keyword">if</span> buffer_append_algorithm.isRunning === <span class="literal">true</span></span><br><span class="line">    buffer_append_algorithm.abort()</span><br><span class="line">  sourceBuffer.updating = <span class="literal">false</span></span><br><span class="line">  sourceBuffer.fireEvent(<span class="string">'abort'</span>)</span><br><span class="line">  sourceBuffer.fireEvent(<span class="string">'updateend'</span>) </span><br><span class="line">run reset_parser_state_algorithm</span><br><span class="line">sourceBuffer.ptsStart = sourceBuffer.appendWindowStart</span><br><span class="line">sourceBuffer.appendWindowEnd = <span class="literal">Infinity</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>removeï¼šåˆ é™¤ç‰¹å®šæ—¶é—´æ®µçš„åª’ä½“ã€‚å‚æ•°ä¸­çš„å•ä½ä¸ºsã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.remove(start: double, <span class="attr">end</span>: unrestricted double): <span class="keyword">void</span></span><br></pre></td></tr></table></figure>
<p>å‡å¦‚æ–¹æ³•è¢«è°ƒç”¨ï¼Œåˆ™ä¼šæœ‰ä»¥ä¸‹çš„æ‰§è¡Œæ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> sourceBuffer not <span class="keyword">in</span> mediaSource.sourceBuffers</span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> sourceBuffer.updating === <span class="literal">true</span></span><br><span class="line">  <span class="keyword">throw</span> InvalidStateError</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">isNaN</span>(sourceBuffer.duration)</span><br><span class="line">  <span class="keyword">throw</span> <span class="built_in">TypeError</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> start &lt; <span class="number">0</span> || start &gt; sourceBuffer.duration</span><br><span class="line">  <span class="keyword">throw</span> <span class="built_in">TypeError</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> end &lt;= start || is(<span class="literal">NaN</span>)</span><br><span class="line">  <span class="keyword">throw</span> <span class="built_in">TypeError</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> mediaSource.readySate === <span class="string">'ended'</span></span><br><span class="line">  mediaSource.readySate = <span class="string">'open'</span></span><br><span class="line">  mediaSource.fireEvent(<span class="string">'sourceopen'</span>)</span><br><span class="line"></span><br><span class="line">run range_removal_algorithm(start, end)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Track-Buffers"><a href="#Track-Buffers" class="headerlink" title="Track Buffers"></a>Track Buffers</h3><p>Track Bufferä¸ºæ¯ä¸€ä¸ªç‹¬ç«‹çš„trackå‚¨å­˜å¯¹åº”çš„æè¿°å’Œç¼–ç å¸§ã€‚å°† track buffer æ›´æ–°ä¸ºåˆå§‹åŒ–ç‰‡æ®µï¼Œå¹¶å°†åª’ä½“ç‰‡æ®µæ·»åŠ åˆ° SourceBuffer ã€‚<br>æ¯ä¸€ä¸ªTrackéƒ½æ‹¥æœ‰ä»¥ä¸‹å±æ€§ï¼š</p>
<ul>
<li>last decode timestampï¼šå‚¨å­˜ç€å½“å‰è§£ç å¸§ç»„é‡Œé¢çš„æœ€åä¸€å¸§çš„dtsã€‚å½“æœªæ·»åŠ åˆ°SourceBufferæ—¶ï¼Œè¯¥å€¼ä¸ºç©ºã€‚</li>
<li>last frame durationï¼šå‚¨å­˜ç€å½“å‰è§£ç å¸§ç»„é‡Œé¢çš„æœ€åä¸€å¸§çš„å¸§æ—¶é•¿ã€‚å½“æœªæ·»åŠ åˆ°SourceBufferæ—¶ï¼Œè¯¥å€¼ä¸ºç©ºã€‚</li>
<li>highest end timestampï¼šå‚¨å­˜ç€å½“å‰è§£ç å¸§ç»„ä¸­å·²è¢«æ·»åŠ åˆ°SourceBufferçš„æ‰€æœ‰ç¼–ç å¸§ä¸­æœ€é«˜çš„ç»“æŸæ—¶é—´æˆ³ã€‚åŒæ ·åˆå§‹å€¼æœªç©ºã€‚</li>
<li>need random access point flagï¼šè¯¥å˜é‡åˆå§‹è®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºåœ¨æœ‰ä»€ä¹ˆæ·»åŠ åˆ°track bufferä¹‹å‰ï¼Œéƒ½éœ€è¦éšæœºè®¿é—®ç‚¹ç¼–ç å¸§ã€‚</li>
<li>track buffer rangesï¼šè¡¨ç¤ºå½“å‰å­˜å‚¨åœ¨track bufferä¸­çš„ç¼–ç å¸§å ç”¨çš„ptsèŒƒå›´ã€‚è¿™ä¸ªæˆ‘åœ¨<a href="x">æ•°æ®è½¬åŒ–</a>çš„<strong>éŸ³è§†é¢‘åŒæ­¥åŸç†</strong>é‚£é‡Œå…¶å®æœ‰è¯´è¿‡ï¼Œå…¶ä¸­çš„durationå°±æ˜¯è¯¥å€¼ã€‚</li>
</ul>
<h3 id="äº‹ä»¶-1"><a href="#äº‹ä»¶-1" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">updatestart  | Event | updating = <span class="function"><span class="params">false</span> =&gt;</span> <span class="literal">true</span></span><br><span class="line">---------------------------------------------------</span><br><span class="line">update | Event | updating = <span class="function"><span class="params">true</span> =&gt;</span> <span class="literal">false</span> <span class="comment">// appendæˆ–removeæˆåŠŸæ‰§è¡Œ</span></span><br><span class="line">---------------------------------------------------</span><br><span class="line">updateend | Event | <span class="comment">// appendæˆ–removeæ‰§è¡Œåˆ°æœ€å</span></span><br><span class="line">---------------------------------------------------</span><br><span class="line">error | Event | updating = <span class="function"><span class="params">true</span> =&gt;</span> <span class="literal">false</span> <span class="comment">// åœ¨appendçš„æ—¶å€™å‘ç”Ÿé”™è¯¯</span></span><br><span class="line">---------------------------------------------------</span><br><span class="line">abort | Event | updating = <span class="function"><span class="params">true</span> =&gt;</span> <span class="literal">false</span> <span class="comment">// appendæˆ–removeæ—¶è°ƒç”¨abort()æ–¹æ³•</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä»–çš„å°±ä¸å¤šè¯´äº†ã€‚åŸºæœ¬ä¸Šéƒ½æ˜¯å¯ä»¥ä»å®˜æ–¹æ–‡æ¡£ä¸Šæ‰¾å¾—åˆ°ç­”æ¡ˆçš„ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»ç»“å°±æ˜¯å¦‚ä¸‹çš„æ“ä½œé¡ºåºï¼Œä½†å®é™…æƒ…å†µè¿œä¸æ­¢å¦‚æ­¤ï¼Œè¿˜å¤æ‚å¾ˆå¤šï¼Œå¾—ä¾æ®åœºæ™¯æ¥åˆ†æã€‚</p>
<ol>
<li><p>åœ¨é¡µé¢çš„ HTML éƒ¨åˆ†ä¸­å®šä¹‰ <code>HTMLMediaElement</code> å…ƒç´ ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">id</span>=<span class="string">'vEle'</span> <span class="attr">autoplay</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨JavaScriptåˆ›å»º <code>MediaSource</code> å¯¹è±¡ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mediaSource = <span class="keyword">new</span> <span class="built_in">window</span>.MediaSource()</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ <code>URL.createObjectURL</code> åˆ›å»º BlobURLï¼Œå¹¶å°† MediaSource å¯¹è±¡ä½œä¸ºæºã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> url = URL.createObjectURL(mediaSource);</span><br></pre></td></tr></table></figure>
</li>
<li><p>å°†è™šæ‹Ÿ URL åˆ†é…åˆ°è§†é¢‘å…ƒç´ çš„ src å±æ€§ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v = <span class="built_in">document</span>.getElementById(<span class="string">'vEle'</span>);</span><br><span class="line">v.src = url;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ addSourceBuffer åˆ›å»º SourceBufferï¼ŒåŒ…å«ä½ æ·»åŠ çš„ MIME ç±»å‹çš„è§†é¢‘ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> videoSource = mediaSource.addSourceBuffer(<span class="string">'video/mp4'</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä»åª’ä½“æ–‡ä»¶è”æœºè·å–è§†é¢‘<code>initialization segment</code>ï¼Œå¹¶ä½¿ç”¨ <code>appendBuffer</code> å°†å…¶æ·»åŠ åˆ° <code>SourceBuffer</code> ä¸­ã€‚è€Œ<code>initialization segment</code>å°±æ˜¯ç›¸å½“äºfmp4ä¸­çš„ <code>ftyp + moov</code>ï¼Œæœ‰trackId, duration, width, heightç­‰åŸºç¡€ä¿¡æ¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">videoSource.appendBuffer(initialization_segment)</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä»åª’ä½“æ–‡ä»¶è·å–è§†é¢‘<code>media segment</code>ï¼Œå¹¶ä½¿ç”¨ <code>appendBuffer</code> å°†å…¶é™„åŠ åˆ° <code>SourceBuffer</code> ä¸­ã€‚è€Œ<code>media segment</code>å°±ç›¸å½“äºfmp4ä¸­çš„<code>moof + mdat</code>ï¼Œæ˜¯å®å®åœ¨åœ¨çš„éŸ³è§†é¢‘æ•°æ®ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">videoSource.appendBuffer(media_segment)</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ video å…ƒç´ ä¸Šè°ƒç”¨ play æ–¹æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var playPromise = v.play()</span><br><span class="line"></span><br><span class="line">if (playPromise !== undefined) &#123;</span><br><span class="line">  playPromise.then(_ =&gt; &#123;</span><br><span class="line">    v.pause()</span><br><span class="line">  &#125;).catch(error =&gt; &#123; &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>é‡å¤æ­¥éª¤ 7 ç›´åˆ°å®Œæˆã€‚</p>
</li>
<li>æ¸…é™¤ã€‚<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">videoSource.remove(start, end)</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘å­¦ä¹ -flvjsä¸­FLVè½¬FMP4ç®€å•æ¦‚æ‹¬]]></title>
      <url>https://lucius0.github.io/2018/01/27/archivers/media-study-09/</url>
      <content type="html"><![CDATA[<p>åœ¨<a href="https://lucius0.github.io/2018/01/16/archivers/media-study-08/">ä¸Šä¸€ç¯‡</a>æˆ‘ä»¬åªæ˜¯åˆ†æäº†fmp4çš„ç»“æ„ï¼Œä¹Ÿå°±æ˜¯boxçš„ç»“æ„ç»„æˆï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦è¿›è¡Œ<code>remuxer</code>æ‰å¯ä»¥å°†flvè½¬æˆfmp4ã€‚</p>
<h2 id="Metadata"><a href="#Metadata" class="headerlink" title="Metadata"></a>Metadata</h2><p>åœ¨flvé‚£è¾¹æˆ‘ä»¬æœ‰æåˆ°<code>parseAACAudioSpecificConfig</code>ã€<code>parseAVCDecoderConfigurationRecord</code>ï¼Œå…¶å®åœ¨é‚£é‡Œä¼šé€šè¿‡<code>this._onTrackMetadata</code>è¿™ä¸ªæ–¹æ³•å°†å¯¹åº”çš„éŸ³è§†é¢‘çš„<code>metadata</code>ä¼ ç»™<code>mp4-remuxer</code>å»å¤„ç†ã€‚è€Œ<code>script tag</code>çš„<code>metadata</code>æ²¡æœ‰äº¤ç»™fmp4å¤„ç†ï¼Œç›¸ä¿¡å¤§å®¶ä¹Ÿæ˜ç™½ï¼Œè¿™ä¸ªæ•°æ®ä¸»è¦æ˜¯ä¸€äº›åª’ä½“ä¿¡æ¯ã€‚</p>
<h3 id="Audio-Metadata"><a href="#Audio-Metadata" class="headerlink" title="Audio Metadata"></a>Audio Metadata</h3><p>è®©æˆ‘ä»¬å†å›åˆ°<code>flv-demuxer</code>ï¼Œåœ¨è§£æAudioæ—¶ä¼šä¼˜å…ˆè§£æ<strong>Audio Metadata</strong>ï¼Œä¹Ÿå°±æ˜¯éŸ³é¢‘çš„<code>Audio Object Type</code>ï¼Œ<code>channel</code>ï¼Œ<code>codec</code>ç­‰ä¿¡æ¯ã€‚è§£æå®Œæ¯•ä¹‹åä¼šå°†è¿™äº›ä¿¡æ¯éƒ½ä¼ é€’ç»™<code>mp4-remuxer</code>å»å¤„ç†ï¼Œç”Ÿæˆ<code>metabox</code>ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 'audio/mp4, codecs="codec"'</span></span><br><span class="line">metabox = MP4.generateInitSegment(metadata);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰€ä»¥ç¬¬ä¸€æ¬¡åˆå§‹åŒ– metadata çš„æ•°å€¼å¡«ç»™ fmp4 ä¸­çš„å¯¹åº”æ•°å€¼ï¼Œå…¶ä»–çš„éƒ½å¯ä»¥ä½¿ç”¨é»˜è®¤å€¼</span></span><br><span class="line">-&gt; ftyp å›ºå®šçš„ï¼Œè¿™éƒ¨åˆ†ä¸å¤šè¯´ï¼Œè§ä¸Šä¸€ç¯‡FMP4ç»“æ„é‚£ç¯‡æ–‡ç« </span><br><span class="line">-&gt; moov</span><br><span class="line">  -&gt; mvhd: timescale, duration</span><br><span class="line">  -&gt; trak</span><br><span class="line">    -&gt; tkhd: trackId, duration, width, height</span><br><span class="line">    -&gt; mdia</span><br><span class="line">    -&gt; mdhd: timescale, duration</span><br><span class="line">    -&gt; hdlr: hdlr_audio</span><br><span class="line">    -&gt; minf</span><br><span class="line">      -&gt; xmhd: smhd</span><br><span class="line">      -&gt; dinf</span><br><span class="line">      -&gt; dref</span><br><span class="line">      -&gt; stbl</span><br><span class="line">      -&gt; stsd</span><br><span class="line">        /-&gt; mp3: channelCount, sampleRate</span><br><span class="line">        /-&gt; mp4a(aac): channelCount, sampleRate</span><br><span class="line">         -&gt; esds: config, configSize</span><br><span class="line">      -&gt; stts</span><br><span class="line">      -&gt; stsc</span><br><span class="line">      -&gt; stsz</span><br><span class="line">      -&gt; stco</span><br><span class="line">  -&gt; mvex</span><br><span class="line">    -&gt; trex: trackId</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ°è¿™é‡Œå°±å®Œæˆäº† Audio çš„ InitSegmentã€‚</span></span><br><span class="line"><span class="keyword">this</span>._onInitSegment(type, &#123;</span><br><span class="line">    type: type,</span><br><span class="line">    data: metabox.buffer,</span><br><span class="line">    codec: codec,</span><br><span class="line">    container: <span class="string">`<span class="subst">$&#123;type&#125;</span>/<span class="subst">$&#123;container&#125;</span>`</span>,</span><br><span class="line">    mediaDuration: metadata.duration  <span class="comment">// in timescale 1000 (milliseconds)</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="Video-Metadata"><a href="#Video-Metadata" class="headerlink" title="Video Metadata"></a>Video Metadata</h3><p>åŒç†ï¼ŒVideoåœ¨è§£ææ•°æ®ä¹‹å‰ï¼Œç¬¬ä¸€ä¸ªä¼šæ˜¯<strong>AVC Decoder Configuration Record</strong>ï¼Œå³ä¼šæŠŠ<code>chromaFormat</code>ã€<code>duration</code>ã€<code>frameRate</code>ã€<code>presentHeight</code>ã€<code>presentWidth</code>ç­‰æ•°æ®ä¸€æ ·ä¼ é€’ç»™<code>mp4-remuxer</code>ï¼Œè·³è¿‡ ftyp ä¸è¯´ï¼Œä¼šè·ŸAudioä¸€æ ·äº§ç”Ÿä¸€ä¸ª moov çš„boxã€‚è¿™é‡ŒåªæŒ‘è·ŸAudioä¸åŒçš„æ•°æ®ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 'video'</span></span><br><span class="line">metabox = MP4.generateInitSegment(metadata);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Video metadata</span></span><br><span class="line">hdlr: hdlr_video</span><br><span class="line">xmhd: vmhd</span><br><span class="line">stsd</span><br><span class="line">  -&gt; avc1: avcc, width, height</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ä»¥çœ‹åˆ°ï¼Œå…¶å®åªè¦æœ‰metaä¼ å‚çš„åœ°æ–¹ï¼Œæ•°æ®éƒ½æ˜¯ä¸ä¸€æ ·çš„(éƒ¨åˆ†æ²¡å†™å‡ºæ¥)</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h2><p>è¯»å–å®Œ metadata ä¹‹åï¼Œä¹‹åè¯»å–åˆ° audio çš„ï¼Œå°±æ˜¯<strong>AAC raw frame data</strong>æ•°æ®äº†ï¼Œç„¶åå°†æ•°æ®ä¿å­˜åˆ° audio track ä¸­çš„ sample æ•°ç»„ï¼›å½“ç„¶ video ä¹Ÿæ˜¯ä¸€æ ·ï¼Œä¹‹åçš„æ•°æ®å°±æ˜¯<strong>nalus</strong>äº†ï¼Œç„¶ååŒæ—¶ä¹Ÿå°†æ•°æ®ä¿å­˜åˆ° video track ä¸­çš„ sample æ•°ç»„ã€‚å¾…æŠ“å–åˆ°çš„åª’ä½“æµæ•°æ®è§£æå®Œæˆä¹‹åï¼Œå°†è§£æå®Œçš„æ•°æ®å¸§å‘é€ç»™<code>remuxer</code>ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>._onDataAvailable(<span class="keyword">this</span>._audioTrack, <span class="keyword">this</span>._videoTrack);</span><br><span class="line"><span class="comment">// ===&gt;&gt;&gt; mp4-remuxer::remux</span></span><br><span class="line"><span class="keyword">this</span>._remuxVideo(videoTrack);</span><br><span class="line"><span class="keyword">this</span>._remuxAudio(audioTrack);</span><br></pre></td></tr></table></figure></p>
<p>åœ¨è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œåœ¨è¿›è¡Œ<code>remuxVideo</code>è·Ÿ<code>remuxAudio</code>ä¹‹å‰ï¼Œä¼šå…ˆè®¡ç®—ä¸€ä¸ª<code>base dts</code>ï¼Œè¿™ä¸ªæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¹‹åå†è¯´ã€‚</p>
<h3 id="Video-Data"><a href="#Video-Data" class="headerlink" title="Video Data"></a>Video Data</h3><p>æˆ‘ä»¬æ‹¿ video data æ¥åˆ†æï¼Œå®é™…ä¸Šåˆ†æäº† video dataï¼Œé‚£ä¹ˆ audio çš„éƒ¨åˆ†ä¹Ÿæ˜¯å¤§åŒå°å¼‚çš„äº†ã€‚è¿™é‡Œå…ˆå°† nal çš„æ•°æ®è½¬ä¸º mdat boxï¼Œè¿™éƒ¨åˆ†å‚è€ƒ<a href="https://lucius0.github.io/2018/01/16/archivers/media-study-08/">FMP4ç»“æ„</a>çš„<strong>BOX</strong>éƒ¨åˆ†ã€‚è¿™é‡Œå…ˆå†™å…¥çš„æ˜¯ nal çš„å¤´éƒ¨ä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯sizeã€typeè¿™äº›ã€‚å¹¶ä¸åŒ…æ‹¬çœŸæ­£çš„æ•°æ®ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> offset = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">let</span> mdatBytes = <span class="number">8</span> + videoTrack.length;</span><br><span class="line"><span class="keyword">let</span> mdatbox = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(mdatBytes);</span><br><span class="line">mdatbox[<span class="number">0</span>] = (mdatBytes &gt;&gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">mdatbox[<span class="number">1</span>] = (mdatBytes &gt;&gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">mdatbox[<span class="number">2</span>] = (mdatBytes &gt;&gt;&gt;  <span class="number">8</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">mdatbox[<span class="number">3</span>] = (mdatBytes) &amp; <span class="number">0xFF</span>;</span><br><span class="line">mdatbox.set(MP4.types.mdat, <span class="number">4</span>);</span><br></pre></td></tr></table></figure></p>
<p>ä¸ºäº†ä¿®æ­£åç»­çš„ samples èƒ½ä¸ä¸Šä¸€æ¬¡çš„ samples å½¢æˆè¿ç»­æ€§(MSEè¦æ±‚è¿ç»­çš„segmentsä¹‹é—´æ˜¯ä¸èƒ½å­˜åœ¨æ—¶é—´æˆ³é—´éš™)ï¼Œæ‰€ä»¥å–è¿™æ¬¡ samples ä¸­ç¬¬ä¸€ä¸ª sample çš„æ—¶é—´æˆ³ï¼Œè¿½åŠ åˆ°ä¸Šä¸€æ¬¡ samples æœ«å°¾çš„ä½ç½®ï¼Œæ ¹æ®å·®å€¼(dtsCorrection)ï¼Œåé¢æ‰€æœ‰ sample æ—¶é—´æˆ³åšç›¸åº”å¹³ç§»ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// calculate dtsCorrection</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>._videoNextDts) &#123;</span><br><span class="line">    dtsCorrection = firstSampleOriginalDts - <span class="keyword">this</span>._videoNextDts;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;  <span class="comment">// this._videoNextDts == undefined</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>._videoSegmentInfoList.isEmpty()) &#123;</span><br><span class="line">        dtsCorrection = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å‡å¦‚ _videoNextDts ä¸º undefinedï¼Œåˆ™æ ¹æ®æ—¶é—´æˆ³ä»_videoSegmentInfoList ä¸­æ‰¾åˆ°æœ€åä¸€ä¸ª sample çš„ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">let</span> lastSample = <span class="keyword">this</span>._videoSegmentInfoList.getLastSampleBefore(firstSampleOriginalDts);</span><br><span class="line">        <span class="keyword">if</span> (lastSample != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> distance = (firstSampleOriginalDts - (lastSample.originalDts + lastSample.duration));</span><br><span class="line">            <span class="keyword">if</span> (distance &lt;= <span class="number">3</span>) &#123;</span><br><span class="line">                distance = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">let</span> expectedDts = lastSample.dts + lastSample.duration + distance;</span><br><span class="line">            dtsCorrection = firstSampleOriginalDts - expectedDts;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// lastSample == null, cannot found</span></span><br><span class="line">            dtsCorrection = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¸‹é¢çš„ä¸€æ­¥å…¶å®ç›®çš„å°±å¾ˆæ˜äº†äº†ï¼Œå°±æ˜¯æ ¹æ®ä¸Šé¢äº§ç”Ÿçš„å·®å€¼ï¼Œæ¥ç»™æ¯ä¸€ä¸ª sample æ—¶é—´æˆ³åšç›¸å¯¹åº”çš„å¹³ç§»ã€‚å¹¶ä¸”è¾“å‡º mp4Samples ã€‚<br>è¿˜è®°å¾—ä¸Šé¢çš„<strong>mdatbox</strong>å—ï¼Ÿæˆ‘ä»¬ä¹‹å‰åªå¯¹å®ƒåšå¤´éƒ¨ä¿¡æ¯å¤„ç†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„ä¸€æ­¥å°±æ˜¯å¯¹å®ƒå¡«å……æˆ‘ä»¬å¤„ç†è¿‡åçš„æ•°æ®ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Write samples into mdatbox</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; mp4Samples.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> units = mp4Samples[i].units;</span><br><span class="line">    <span class="keyword">while</span> (units.length) &#123;</span><br><span class="line">        <span class="keyword">let</span> unit = units.shift();</span><br><span class="line">        <span class="keyword">let</span> data = unit.data;</span><br><span class="line">        mdatbox.set(data, offset);</span><br><span class="line">        offset += data.byteLength;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç”Ÿæˆ  moof boxã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-&gt; moof</span><br><span class="line">  -&gt; mfhd: sequence number</span><br><span class="line">  -&gt; traf</span><br><span class="line">    -&gt; tfhd: trackId</span><br><span class="line">    -&gt; tfdt: baseMediaDecodeTimeï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡ packets çš„firstDts</span><br><span class="line">    -&gt; sdtp: isLeadingï¼ŒdependsOnï¼ŒisDependedOnï¼ŒhasRedundancy</span><br><span class="line">    -&gt; trun: sampleCountï¼Œoffsetï¼Œsample(durationï¼Œsizeï¼Œflagsï¼Œcts)</span><br></pre></td></tr></table></figure></p>
<p>ç”Ÿæˆå®Œä¹‹åéœ€è¦å¯¹è¿™ä¸€æ¬¡çš„ sample list æ¸…ç©ºã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">track.samples = [];</span><br><span class="line">track.length = <span class="number">0</span>;</span><br></pre></td></tr></table></figure></p>
<p>æœ€åå°†æ•°æ®boxåˆå¹¶ï¼Œå¹¶å°†æ­¤æ¬¡çš„æ•°æ®æ´¾å‘å‡ºå»ã€‚</p>
<h3 id="Audio-Data"><a href="#Audio-Data" class="headerlink" title="Audio Data"></a>Audio Data</h3><p>Audioè¿™é‡Œåˆ†ä¸ºAACè·ŸMP3è¿™ä¸¤ç±»éŸ³é¢‘è§£ç æ ¼å¼ã€‚æˆ‘ä»¬å°±é’ˆå¯¹AACè¿™ä¸€ç±»æ¥ï¼ŒMP3ä¹Ÿæ˜¯å¤§åŒå°å¼‚çš„ï¼Œå› ä¸ºåªæœ‰Firefoxæ”¯æŒ<code>&#39;audio/mp4,codecs=&quot;mp3&quot;&#39;</code>ã€‚<br><code>calculate dtsCorrection</code> è¿™éƒ¨åˆ†å°±ä¸å¤šè®²äº†ã€‚è·Ÿä¸Šé¢ Video Data é“ç†ä¸€æ ·ã€‚ä½†æ˜¯è¿™é‡Œä½œè€…åšäº†ä¸€ä¸ªå…¼å®¹å¤„ç†ï¼Œå°±æ˜¯ä¸ºäº†è§£å†³ Edge seek åå¡ä½çš„ bugã€‚ä½œè€…è¿™ä¸€å—æ˜¯è¿™æ ·è§£é‡Šçš„ï¼š<br><img src="http://ouazw12mz.bkt.clouddn.com/180127162635.png?imageslim" alt=""><br>è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼š<code>videoSegment.beginDts &lt; firstSampleDts</code>ï¼Œå‡å¦‚è¯¥ç©ºéŸ³é¢‘æ˜¯åœ¨ç¬¬ä¸€å¸§ï¼Œé‚£ä¹ˆå°±æ²¡å¿…è¦è¡¥å¸§äº†(AAC.getSilentFrame)ï¼Œè¡¥å¸§çš„é“ç†ä¹Ÿæ˜¯ä¸ºäº†ä½¿å…¶æ•°æ®è¿ç»­æ€§ã€‚<code>Correct dts for each sample</code>è¿™ä¸€æ­¥è·ŸVideoçš„å¤„ç†å·®ä¸å¤šï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ª<code>large timestamp gap</code>çš„å¤„ç†ï¼Œè¿™ä¸ªä¼šäº§ç”ŸéŸ³è§†é¢‘ä¸åŒæ­¥ã€‚å‰©ä½™çš„åé¢ä¸è®²ã€‚å› ä¸ºçœ‹æ³¨é‡Šä»¥åŠè·ŸVideo dataå·®ä¸å¤šã€‚</p>
<h2 id="éŸ³è§†é¢‘åŒæ­¥åŸç†"><a href="#éŸ³è§†é¢‘åŒæ­¥åŸç†" class="headerlink" title="éŸ³è§†é¢‘åŒæ­¥åŸç†"></a>éŸ³è§†é¢‘åŒæ­¥åŸç†</h2><p>æœ€åè®²ä¸€ä¸‹éŸ³è§†é¢‘åŒæ­¥çš„åŸç†ã€‚<strong>æ¯ä¸€å¸§è§†é¢‘æˆ–éŸ³é¢‘éƒ½æœ‰ä¸€ä¸ªduration</strong>ï¼Œè®¤è¯†è¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚ç„¶å<strong>é‡‡æ ·ç‡(sample rate)</strong>æŒ‡çš„æ˜¯æ¯ç§’é’Ÿå¯¹éŸ³é¢‘ä¿¡å·çš„é‡‡æ ·æ¬¡æ•°ï¼Œé‡‡æ ·é¢‘ç‡è¶Šé«˜å£°éŸ³è¿˜åŸåº¦è¶Šé«˜ï¼Œå£°éŸ³æ›´åŠ è‡ªç„¶ã€‚å•ä½æ˜¯èµ«å…¹ Hzã€‚è¿™é‡Œæˆ‘ä»¬æ‹¿44.1kHzæ¥è®²ï¼Œå®é™…è¿˜æœ‰å…¶ä»–çš„ï¼Œå…·ä½“å¯ä»¥çœ‹<a href="https://lucius0.github.io/2017/12/27/archivers/media-study-03/">FLVè§£æ-AudioTag(1)</a>ã€‚</p>
<p>è§†é¢‘å¸§æ’­æ”¾æ—¶é—´ï¼š</p>
<ul>
<li>H.264ï¼š<code>duration = 1000 / fps</code>ï¼Œæˆ‘ä»¬å¸¸è§çš„ fps æœ‰25ï¼Œå½“ç„¶ä¹Ÿæœ‰è§è¿‡30çš„ã€‚é‚£ä¹ˆ duration å°±ä¸º40msï¼Œä¹Ÿå°±æ˜¯40msä¸€ä¸ªè§†é¢‘å¸§ã€‚</li>
</ul>
<p>éŸ³é¢‘å¸§æ’­æ”¾æ—¶é—´ï¼š</p>
<ul>
<li>AACï¼š<code>duration = 1024 / sample_rate</code>ï¼ŒAACéŸ³é¢‘ä¸€å¸§æœ‰1024ä¸ªé‡‡æ ·æ ·æœ¬ï¼Œæˆ‘ä»¬å‡å¦‚ sample rate ä¸º 44.1kHzï¼Œé‚£ä¹ˆ duration åº”è¯¥ä¸º 23.22mså·¦å³ã€‚</li>
<li>MP3ï¼š<code>duration = 1152 / sample_rate</code>ï¼ŒMP3éŸ³é¢‘ä¸€å¸§è·ŸAACä¸åŒï¼Œåªæœ‰1152ä¸ªé‡‡æ ·æ ·æœ¬ï¼ŒåŒæ ·å‡è®¾ sample rate ä¸º 44.1kHzï¼Œé‚£ä¹ˆ duration ä¸º 26.12msã€‚</li>
</ul>
<p>é‚£ä¹ˆç†è®ºä¸‹çš„éŸ³è§†é¢‘åŒæ­¥å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------------------------------------</span><br><span class="line">æ—¶é—´è½´ï¼š| 0 | 23.22 | 40 | 46.44 | 69.66 | 80 | ... | 116.1 |</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">éŸ³  é¢‘ï¼š| 0 | 23.22 |    | 46.44 | 69.66 |    | ... | 116.1 | </span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">è§†  é¢‘ï¼š| 0 |       | 40 |               | 80 | ... |       |</span><br><span class="line">--------------------------------------------------------------</span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹å¾—å‡ºï¼ŒéŸ³è§†é¢‘çš„æ’åˆ—æ˜¯æŒ‰ç…§<strong>èµ·å§‹æ—¶é—´æˆ³</strong>ä»å°åˆ°å¤§æ¥æ’åºçš„ï¼Œå½“ç„¶è¿™éƒ¨åˆ†å¯ä»¥å…è®¸äº›è®¸æ³¢åŠ¨ï¼Œä½†ä¹Ÿè¦æ³¨æ„ä¸€æ—¦å‡ºç°è¿‡å¤§å°±ä¼šå‘ç°éŸ³è§†é¢‘ä¸åŒæ­¥ã€‚ä¾‹å¦‚ï¼š<br><img src="http://ouazw12mz.bkt.clouddn.com/180127162849.png?imageslim" alt=""><br>å½“ç„¶è¿™æ˜¯ç†è®ºä¸Šï¼Œè¿˜éœ€è¦è€ƒè™‘åˆ°å…¶ä»–çš„å½±å“å› ç´ ï¼Œä¾‹å¦‚ç¡¬ä»¶ï¼Œç½‘é€Ÿä¹‹ç±»çš„æƒ…å†µã€‚</p>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å„ç§debugå·¥å…·åœ¨æ­¤æ±‡æ€»]]></title>
      <url>https://lucius0.github.io/2018/01/18/archivers/debug-tools/</url>
      <content type="html"><![CDATA[<h2 id="Charles-HTTPS-ä»£ç†"><a href="#Charles-HTTPS-ä»£ç†" class="headerlink" title="Charles HTTPS ä»£ç†"></a>Charles HTTPS ä»£ç†</h2><p>httpä»£ç†ä¸ç”¨è¯´äº†ã€‚æ²¡å•¥é—®é¢˜ã€‚è¿™é‡Œæ˜¯ä»¥pcç«¯ä¸ºä¾‹ã€‚</p>
<ol>
<li><p>å®‰è£…è¯ä¹¦ã€‚Help -&gt;  SSL Proxying -&gt; Install Charles Root Certificateã€‚å¹¶æ‰“å¼€keychainè¿›è¡Œå®‰å…¨ä¿¡ä»»ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180118191654.png?imageslim" alt=""></p>
</li>
<li><p>Proxy -&gt; macOS Proxy<br><img src="http://ouazw12mz.bkt.clouddn.com/180118191836.png?imageslim" alt=""></p>
</li>
<li><p>æ³¨æ„ä¸€ç‚¹çš„æ˜¯ã€‚å¼€å¯shadowsocksä¼šå½±å“Charlesã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180118191953.png?imageslim" alt=""><br>æ‰€ä»¥è¦æ”¹æˆä¸‹é¢ï¼Œæˆ–è€…å…³äº†shadowsockså†é‡æ–°æ‰“å¼€Charlesã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180118192057.png?imageslim" alt=""></p>
</li>
<li><p>å…¶å®è¿™æ—¶å€™å·²ç»å¯ä»¥ç”¨äº†ï¼Œå³é”®ä½ è¦ä»£ç†çš„ https åœ°å€ã€‚ä¾‹å¦‚æˆ‘ä»¬æŠ“<code>https://www.google.com</code><br><img src="http://ouazw12mz.bkt.clouddn.com/180118192154.png?imageslim" alt=""></p>
</li>
<li><p>è¿™æ—¶å€™ä½ å°±ä¼šåœ¨ Proxy -&gt; SSL Proxying Settings çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚ï¼ˆè¿™é‡Œæˆ‘ä¸å–œæ¬¢ç½‘ä¸Šè¯´çš„<code>*:443</code>ï¼Œå› ä¸ºè¿™æ ·ä¼šæŠŠå…¶ä»–æ— å…³çš„éƒ½å¸¦è¿›æ¥ï¼Œå‡ºç°ä¸€äº›è«åå…¶å¦™ç°è±¡ï¼Œä¾‹å¦‚æ ·å¼ï¼‰<br><img src="http://ouazw12mz.bkt.clouddn.com/180118192313.png?imageslim" alt=""></p>
</li>
<li><p>åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œä½ åº”è¯¥å°±å¯ä»¥æŒ‰ç…§httpçš„æ–¹å¼å»ä»£ç†ä½ æƒ³è¦çš„æ–‡ä»¶äº†ã€‚<strong>ä½†æ˜¯ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„é—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»£ç†åˆ°æœ¬åœ°ï¼Œæ–‡ä»¶å±…ç„¶æ˜¯ä¸å®Œæ•´çš„ã€‚è¿™è®©æˆ‘å¾ˆéƒé—·ã€‚å½“ç„¶æˆ‘æœ€åæ‰¾åˆ°è§£å†³æ–¹æ³•ï¼Œå°±æ˜¯å¼€å¯æœ¬åœ°æœåŠ¡å™¨ï¼Œä¸é‡‡å–Map Localï¼Œè€Œé‡‡å–Map Remoteï¼Œå°†æœåŠ¡å™¨æ–‡ä»¶ä»£ç†åˆ°æˆ‘çš„localhostè¿™é‡Œï¼Œå°±å¯ä»¥äº†</strong></p>
</li>
</ol>
<h2 id="whistle-æŸ¥çœ‹-websocket"><a href="#whistle-æŸ¥çœ‹-websocket" class="headerlink" title="whistle æŸ¥çœ‹ websocket"></a>whistle æŸ¥çœ‹ websocket</h2><p><strong>wireSharkä¹Ÿèƒ½åšè¿™æ ·çš„äº‹æƒ…ï¼Œå¹¶ä¸”åŠŸèƒ½æ–¹é¢è¿˜æ¯”è¿™ä¸ªå¼ºå¤§ï¼Œä½†æ˜¯æœ¬ç€æŠ˜è…¾çš„å¿ƒï¼Œæƒå½“ç©ç©çœ‹ã€‚</strong></p>
<ol>
<li><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://avwo.github.io/whistle/" target="_blank" rel="noopener">å®ç°åŸç† Â· GitBook</a></p>
</li>
<li><p>å®‰è£…whistle <code>npm install -g whistle</code></p>
</li>
<li><p>è¿è¡Œwhistleï¼Œå›å‡ºç°ä¸‹é¢çš„ä¿¡æ¯ <code>w2 start</code><br><img src="http://ouazw12mz.bkt.clouddn.com/180118192521.png?imageslim" alt=""></p>
</li>
<li><p>ä»£ç†SwitchyOmegaæ–°å»ºæƒ…æ™¯æ¨¡å¼ -&gt; ä»£ç†æœåŠ¡å™¨(whistle) -&gt;<br><img src="http://ouazw12mz.bkt.clouddn.com/180118192606.png?imageslim" alt=""></p>
</li>
<li><p>è¿™æ—¶å€™å°±å¯ä»¥æ‰“å¼€<code>http://local.whistlejs.com/</code><br><img src="http://ouazw12mz.bkt.clouddn.com/180118223728.png?imageslim" alt=""></p>
</li>
<li><p>wsæ‹¦æˆªï¼Œ<a href="https://avwo.github.io/whistle/webui/websocket.html" target="_blank" rel="noopener">WebSocket Â· GitBook</a>ã€‚å‡å¦‚æ²¡æœ‰æ‰§è¡Œè¿™ä¸€æ­¥ï¼Œä¼šçœ‹åˆ°wsçš„åè®®éƒ½æ˜¯æ˜¾ç¤º<code>tunnel</code>ã€‚</p>
</li>
</ol>
<h2 id="weinre"><a href="#weinre" class="headerlink" title="weinre"></a>weinre</h2><p>è¿™ä¸ªè·Ÿä¸‹é¢çš„<strong>m-console</strong>éƒ½æ˜¯åœ¨ä¹‹å‰è°ƒè¯•web ç§»åŠ¨æ’­æ”¾å™¨çš„æ—¶å€™ä½¿ç”¨åˆ°çš„ï¼Œå¥½åœ¨æœ¬åœ°æœ‰åšè®°å½•ï¼Œè¿™æ¬¡ä¹Ÿé¡ºä¾¿è®°å½•ä¸‹æ¥ã€‚</p>
<ol>
<li><p><strong>weinre</strong>ï¼š<code>npm -g install weinre</code></p>
</li>
<li><p><code>weinre --httpPort 8899 --boundHost your-local-host/-all-</code></p>
</li>
<li><p>æ‰“å¼€æµè§ˆå™¨å¹¶ä¸”è¾“å…¥ä½ çš„åœ°å€ <code>your-local-host:8899</code></p>
</li>
<li><p>ç„¶åä¼šå‡ºç°ä¸‹é¢çš„å›¾<br><img src="http://ouazw12mz.bkt.clouddn.com/180118224316.png?imageslim" alt=""></p>
</li>
<li><p>å°†Exampleä¸‹çš„åœ°å€å¤åˆ¶åˆ°ä½ è¦æµ‹è¯•çš„é¡µé¢å»ã€‚</p>
</li>
<li><p>æ¥ç€ç”¨ä½ çš„è®¾å¤‡é“¾æ¥ä½ çš„æœ¬åœ°å¼€å¯çš„æœåŠ¡å™¨ï¼Œå¦‚æˆ‘ç”¨xamppå¼€å¯äº†ä¸€ä¸ªæœåŠ¡å™¨ï¼Œç„¶åç”¨è®¾å¤‡ä»å¤–è®¿é—®æˆ‘çš„ç”µè„‘æœåŠ¡å™¨ï¼š<code>http://your-local-host/æµ‹è¯•é¡µé¢çš„åœ°å€</code></p>
</li>
<li><p>è¿”å›åˆšæ‰åœ¨ç¬¬3æ­¥æ‰“å¼€çš„é¡µé¢ï¼Œå¹¶ç‚¹å‡»Access Pointä¸‹çš„<br><code>http://192.168.0.101:8899/client/#anonymous</code>å°±å¯ä»¥çœ‹åˆ°æœ‰å“ªäº›è¿æ¥äº†æœ¬åœ°æœåŠ¡å™¨ã€‚</p>
</li>
</ol>
<h2 id="m-console"><a href="#m-console" class="headerlink" title="m-console"></a>m-console</h2><ol>
<li><p><strong>m-console</strong>ï¼š<code>npm -g install m-console</code></p>
</li>
<li><p>åŒæ ·å°†ç”Ÿæˆçš„jsæ–‡ä»¶å¤åˆ¶åˆ°æµ‹è¯•é¡µé¢å»</p>
</li>
<li><p>ç”¨æ‰‹æœºè¿æ¥æœ¬åœ°æœåŠ¡å™¨ï¼Œå°±å¯ä»¥åœ¨pcç«¯çš„ç½‘é¡µä¸Šçš„è¾“å‡ºäº†ï¼ˆå¦‚æ‰‹æœºæ‰“å¼€çš„æ˜¯<code>http://192.168.0.101/test.html</code>ï¼Œé‚£ä¹ˆpcç«¯ä¸Šæ‰“å¼€çš„ä¹Ÿæ˜¯åŒæ ·çš„ã€‚åªæ˜¯é‚£æ—¶å€™å·²ç»å¼€å§‹ç›‘å¬ç§»åŠ¨ç«¯çš„é¡µé¢è¾“å‡ºæƒ…å†µ</p>
</li>
</ol>
<p><strong>æ€»ç»“ï¼š</strong>é‚£ä¹ˆè¿™ä¸¤ä¸ªdebugè°ƒè¯•å·¥å…·æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ<code>weinre</code>å¯ä»¥çœ‹åˆ°é¡µé¢ä¸Šçš„å…ƒç´ å˜åŒ–ï¼Œä½†æ˜¯åœ¨æ—¥å¿—å‡ºä¹¦æ²¡æœ‰<code>m-console</code>å¥½ç”¨ã€‚æ‰€ä»¥æˆ‘ä¸€èˆ¬éƒ½æ˜¯ä¸¤ä¸ªå·¥å…·æ··ç€ä¸€èµ·ç”¨ã€‚æ®è¯´<code>whistle</code>æ˜¯ç»“åˆäº†ä¸¤è€…çš„ä¼˜ç‚¹ï¼Œæ‘’é™¤äº†ç¼ºç‚¹ï¼Œæ‰“ç®—ä¹‹åç†Ÿç»ƒäº†è‡ªç„¶ä¼šè®°å½•ä¸‹æ¥ã€‚</p>
]]></content>
      
        <categories>
            
            <category> tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> debug </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘å­¦ä¹ -FMP4ç»“æ„ä¹‹FMP4]]></title>
      <url>https://lucius0.github.io/2018/01/16/archivers/media-study-08/</url>
      <content type="html"><![CDATA[<p>åˆæ¬¡å­¦ä¹ æœ‰å…³éŸ³è§†é¢‘è¿™ä¸€å—çš„å¼€å‘ï¼Œä¸»è¦æ˜¯åŸºäº <strong><a href="https://github.com/Bilibili/flv.js" target="_blank" rel="noopener">flv.js</a></strong> çš„å­¦ä¹ ã€‚è¿™ä¸€å—çš„çŸ¥è¯†æ¦‚å¿µå®åœ¨æ˜¯å¤ªå¤šå¤ªæ·±äº†ï¼Œæ‰€ä»¥æœ¬äººæ˜¯å…ˆåœ¨æœ¬åœ°åšè®°å½•ï¼Œåé¢ä¼šæ•´ç†æ…¢æ…¢åœ°ä¸Šä¼ ä¸å„ä½åˆ†äº«ï¼Œå‡å¦‚æœ‰åœ°æ–¹è¯´é”™ï¼Œè¯·å‹˜è¯¯ã€‚è°¢è°¢æŒ‡ç‚¹ã€‚</p>
<p>æ¥ä¸Šç¯‡<a href="https://lucius0.github.io/2018/01/14/archivers/media-study-07/">éŸ³è§†é¢‘å­¦ä¹ -FMP4ç»“æ„ä¹‹MP4</a>ï¼Œè¿™ç¯‡æ¥è¯´ä¸‹FMP4çš„æ ¼å¼ã€‚åœ¨ä¸Šç¯‡æ–‡ç« ä¸­ï¼Œæœ‰åˆ—ä¸¾è¿‡FMP4ä¸MP4ä¹‹é—´çš„å·®å¼‚ï¼Œå…¶å®å°±å¯ä»¥é€šè¿‡å›¾ç‰‡çœ‹å‡ºä¸»è¦çš„å·®å¼‚æ€§ï¼ŒFMP4ä¸»è¦æ˜¯æœ‰<code>moof + mdat</code>æ¥ä½œä¸ºåª’ä½“æµæ•°æ®æºã€‚ä»å›¾ç‰‡ä¸Šçœ‹ï¼ŒFMP4æ¯”MP4å¤šäº†MVEX Box, MOOF Boxä»¥åŠMDAT Boxã€‚</p>
<h2 id="MOOV-MVEX"><a href="#MOOV-MVEX" class="headerlink" title="MOOV::MVEX"></a>MOOV::MVEX</h2><p>Movie Extends boxï¼Œè¯¥boxå¯èƒ½æœ‰moof(Movie Fragment Boxes)ï¼Œå¹¶ä¸”æ˜¯æŒ‰é¡ºåºè¯»å–ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aligned(<span class="number">8</span>) <span class="function">class MovieExtendsBox extends <span class="title">Box</span><span class="params">(â€˜mvexâ€™)</span></span>&#123; &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-MVEX-MEHD"><a href="#MOOV-MVEX-MEHD" class="headerlink" title="MOOV::MVEX::MEHD"></a>MOOV::MVEX::MEHD</h3><p>Movie extends header boxã€‚å¯æœ‰å¯æ— ï¼Œä¸»è¦æ˜¯æ˜¯Movieå¤´æ‰©å±•ç”¨çš„ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class MovieExtendsHeaderBox extends <span class="title">FullBox</span><span class="params">(â€˜mehdâ€™, version, <span class="number">0</span>)</span> </span>&#123; </span><br><span class="line">  <span class="keyword">if</span> (version==<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span>  fragment_duration</span>;</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123; <span class="comment">// version==0</span></span><br><span class="line">      <span class="keyword">unsigned</span> <span class="keyword">int</span>(<span class="number">32</span>)  fragment_duration;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-MVEX-TREX"><a href="#MOOV-MVEX-TREX" class="headerlink" title="MOOV::MVEX::TREX"></a>MOOV::MVEX::TREX</h3><p>Track Extends Boxã€‚è®¾ç½®äº†movie fragmentçš„é»˜è®¤å€¼ï¼Œå¯ä»¥ä¿å­˜æ¯ä¸ªtrackä¸­çš„ç©ºé—´å¤æ‚åº¦ã€‚<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class TrackExtendsBox extends <span class="title">FullBox</span><span class="params">(â€˜trexâ€™, <span class="number">0</span>, <span class="number">0</span>)</span></span>&#123; </span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> track_ID</span>;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> default_sample_description_index</span>;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> default_sample_duration</span>;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> default_sample_size</span>;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> default_sample_flags </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="MOOF"><a href="#MOOF" class="headerlink" title="MOOF"></a>MOOF</h2><h3 id="MOOF-TRAF"><a href="#MOOF-TRAF" class="headerlink" title="MOOF::TRAF"></a>MOOF::TRAF</h3><p>Track Fragment Boxã€‚å­˜æ”¾tfhdï¼Œtfdtï¼Œsdtpï¼Œtrunçš„å®¹å™¨ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class TrackFragmentBox extends <span class="title">Box</span><span class="params">(â€˜trafâ€™)</span></span>&#123; &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOF-TRAF-TFHD"><a href="#MOOF-TRAF-TFHD" class="headerlink" title="MOOF::TRAF::TFHD"></a>MOOF::TRAF::TFHD</h3><p>Track Fragment Header Boxã€‚ä¸»è¦æ˜¯å¯¹æŒ‡å®šçš„ trak è¿›è¡Œç›¸å…³çš„é»˜è®¤è®¾ç½®ã€‚ä¾‹å¦‚ï¼šsample çš„æ—¶é•¿ï¼Œå¤§å°ï¼Œåç§»é‡ç­‰ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½å¯ä»¥å¿½ç•¥ä¸è®¾ï¼Œåªè¦ä½ åœ¨å…¶å®ƒ box é‡Œé¢è®¾ç½®å®Œæ•´å³å¯ï¼š<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class TrackFragmentHeaderBox extends <span class="title">FullBox</span><span class="params">(â€˜tfhdâ€™, <span class="number">0</span>, tf_flags)</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> track_ID</span>;</span><br><span class="line">  <span class="comment">// all the following are optional fields</span></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> base_data_offset</span>;</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> sample_description_index</span>;</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> default_sample_duration</span>;</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> default_sample_size</span>;</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> default_sample_flags</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOF-TRAF-TFDT"><a href="#MOOF-TRAF-TFDT" class="headerlink" title="MOOF::TRAF::TFDT"></a>MOOF::TRAF::TFDT</h3><p>Track fragment decode timeã€‚ä¸»è¦æ˜¯ç”¨æ¥å­˜æ”¾ç›¸å…³ sample ç¼–ç çš„ç»å¯¹æ—¶é—´çš„ã€‚å› ä¸º FMP4 æ˜¯æµå¼çš„æ ¼å¼ï¼Œæ‰€ä»¥ï¼Œä¸åƒ MP4 ä¸€æ ·å¯ä»¥ç›´æ¥æ ¹æ® sample ç›´æ¥ seek åˆ°å…·ä½“ä½ç½®ã€‚è¿™é‡Œå°±éœ€è¦ä¸€ä¸ªæ ‡å‡†æ—¶é—´å‚è€ƒï¼Œæ¥å¿«é€Ÿå®šä½éƒ½æŸä¸ªå…·ä½“çš„ fragmentã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class TrackFragmentBaseMediaDecodeTimeBox extends <span class="title">FullBox</span><span class="params">(â€˜tfdtâ€™, version, <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (version==<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> baseMediaDecodeTime</span>; </span><br><span class="line">  &#125; <span class="keyword">else</span> &#123; <span class="comment">// version==0</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span>(<span class="number">32</span>) baseMediaDecodeTime;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOF-TRAF-TRUN"><a href="#MOOF-TRAF-TRUN" class="headerlink" title="MOOF::TRAF::TRUN"></a>MOOF::TRAF::TRUN</h3><p>Track Fragment Run Boxã€‚å­˜å‚¨è¯¥ moof é‡Œé¢ç›¸å…³çš„ sample å†…å®¹ã€‚ä¾‹å¦‚ï¼Œæ¯ä¸ª sample çš„ sizeï¼Œdurationï¼Œoffset ç­‰ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class TrackRunBox extends <span class="title">FullBox</span><span class="params">(â€˜trunâ€™, version, tr_flags)</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> sample_count</span>;</span><br><span class="line">  <span class="comment">// the following are optional fields</span></span><br><span class="line">  <span class="function"><span class="keyword">signed</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> data_offset</span>;</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> first_sample_flags</span>;</span><br><span class="line">  <span class="comment">// all fields in the following array are optional </span></span><br><span class="line">  &#123;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  sample_duration</span>;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  sample_size</span>;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  sample_flags</span></span><br><span class="line"><span class="function">      <span class="title">if</span> <span class="params">(version == <span class="number">0</span>)</span> </span>&#123; </span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> sample_composition_time_offset</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">      <span class="keyword">signed</span> <span class="keyword">int</span>(<span class="number">32</span>) sample_composition_time_offset;</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;[ sample_count ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥è¯´ï¼Œtrun ä¸Šé¢çš„å­—æ®µæ˜¯ traf é‡Œé¢æœ€é‡è¦çš„æ ‡è¯†å­—æ®µï¼š<br>tr_flags æ˜¯ç”¨æ¥è¡¨ç¤ºä¸‹åˆ— sample ç›¸å…³çš„æ ‡è¯†ç¬¦æ˜¯å¦åº”ç”¨åˆ°æ¯ä¸ªå­—æ®µä¸­ï¼š</p>
<ul>
<li>0x000001: data-offset-presentï¼Œåªåº”ç”¨ data-offset</li>
<li>0x000004: åªå¯¹ç¬¬ä¸€ä¸ª sample åº”ç”¨å¯¹åº”çš„ flagsã€‚å‰©ä½™ sample flags å°±ä¸ç®¡äº†ã€‚</li>
<li>0x000100: è¿™ä¸ªæ¯”è¾ƒé‡è¦ï¼Œè¡¨ç¤ºæ¯ä¸ª sample éƒ½æœ‰è‡ªå·±çš„ durationï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤çš„</li>
<li>0x000200: æ¯ä¸ª sample æœ‰è‡ªå·±çš„ sample_sizeï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤çš„ã€‚</li>
<li>0x000400: å¯¹æ¯ä¸ª sample ä½¿ç”¨è‡ªå·±çš„ flagsã€‚å¦åˆ™ï¼Œä½¿ç”¨é»˜è®¤çš„ã€‚</li>
<li>0x000800: æ¯ä¸ª sample éƒ½æœ‰è‡ªå·±çš„ cts å€¼<br>åé¢å­—æ®µï¼Œæˆ‘ä»¬è¿™ç®€å•ä»‹ç»ä¸€ä¸‹ã€‚</li>
<li>data_offset: ç”¨æ¥è¡¨ç¤ºå’Œè¯¥ moof é…å¥—çš„ mdat ä¸­å®é™…æ•°æ®å†…å®¹è· moof å¼€å¤´æœ‰å¤šå°‘ byteã€‚ç›¸å½“äºå°±æ˜¯ moof.byteLength + mdat.headerSizeã€‚</li>
<li>sample_count: ä¸€å…±æœ‰å¤šå°‘ä¸ª sample</li>
<li>first_sample_flags: ä¸»è¦é’ˆå¯¹ç¬¬ä¸€ä¸ª sampleã€‚ä¸€èˆ¬æ¥è¯´ï¼Œéƒ½å¯ä»¥é»˜è®¤è®¾ä¸º 0ã€‚<br>åé¢çš„å‡ ä¸ªå­—æ®µï¼Œæˆ‘å°±ä¸èµ˜è¿°äº†ï¼Œå¯¹äº†ï¼Œé‡Œé¢çš„ sample_flags æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ä¸œè¥¿ï¼Œå¸¸å¸¸ç”¨å®ƒæ¥è¡¨ç¤ºï¼Œåˆ°åº•å“ªä¸€ä¸ª sample æ˜¯å¯¹åº”çš„ keyFrameã€‚</li>
</ul>
<h3 id="MOOF-TRAF-SDTP"><a href="#MOOF-TRAF-SDTP" class="headerlink" title="MOOF::TRAF::SDTP"></a>MOOF::TRAF::SDTP</h3><p>Independent and Disposable Samples Boxã€‚ä¸»è¦æ˜¯ç”¨æ¥æè¿°å…·ä½“æŸä¸ª sample æ˜¯å¦æ˜¯ I å¸§ï¼Œæ˜¯å¦æ˜¯ leading frame ç­‰ç›¸å…³å±æ€§å€¼ï¼Œä¸»è¦ç”¨æ¥ä½œä¸ºå½“è¿›è¡Œç‚¹æ’­å›æ”¾æ—¶çš„åŒæ­¥å‚è€ƒä¿¡æ¯ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class SampleDependencyTypeBox extends <span class="title">FullBox</span><span class="params">(â€˜sdtpâ€™, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span>&#123; </span><br><span class="line">  <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; sample_count; i++)&#123;</span><br><span class="line">    <span class="comment">// æ˜¯å¦æ˜¯å¼€å¤´éƒ¨åˆ†</span></span><br><span class="line">    <span class="comment">// - 0: å½“å‰ sample çš„ leading å±æ€§æœªçŸ¥ï¼ˆç»å¸¸ç”¨åˆ°ï¼‰</span></span><br><span class="line">    <span class="comment">// - 1: å½“å‰ sample æ˜¯ leading sampleï¼Œå¹¶ä¸”ä¸èƒ½è¢« decoded</span></span><br><span class="line">    <span class="comment">// - 2: å½“å‰ sample å¹¶ä¸æ˜¯ leading sample</span></span><br><span class="line">    <span class="comment">// - 3: å½“å‰ sample æ˜¯ leading sampleï¼Œå¹¶ä¸”èƒ½è¢« decoded</span></span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">2</span>)</span> is_leading</span>;</span><br><span class="line">    <span class="comment">// æ˜¯å¦æ˜¯ I å¸§</span></span><br><span class="line">    <span class="comment">// - 0: è¯¥ sample ä¸çŸ¥é“æ˜¯å¦ä¾èµ–å…¶ä»–å¸§</span></span><br><span class="line">    <span class="comment">// - 1: è¯¥ sample æ˜¯ B/P å¸§</span></span><br><span class="line">    <span class="comment">// - 2: è¯¥ sample æ˜¯ I å¸§</span></span><br><span class="line">    <span class="comment">// - 3: ä¿ç•™å­—</span></span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">2</span>)</span> sample_depends_on</span>; </span><br><span class="line">    <span class="comment">// è¯¥å¸§æ˜¯å¦è¢«ä¾èµ–</span></span><br><span class="line">    <span class="comment">// - 0: ä¸çŸ¥é“æ˜¯å¦è¢«ä¾èµ–ï¼Œç‰¹æŒ‡ï¼ˆB/Pï¼‰</span></span><br><span class="line">    <span class="comment">// - 1: è¢«ä¾èµ–ï¼Œç‰¹æŒ‡ I å¸§</span></span><br><span class="line">    <span class="comment">// - 2: ä¿ç•™å­—</span></span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">2</span>)</span> sample_is_depended_on</span>; </span><br><span class="line">    <span class="comment">// æ˜¯å¦æœ‰å†—ä½™ç¼–ç </span></span><br><span class="line">    <span class="comment">// - 0: ä¸çŸ¥é“æ˜¯å¦æœ‰å†—ä½™</span></span><br><span class="line">    <span class="comment">// - 1: æœ‰å†—ä½™ç¼–ç </span></span><br><span class="line">    <span class="comment">// - 2: æ²¡æœ‰å†—ä½™ç¼–ç </span></span><br><span class="line">    <span class="comment">// - 3: ä¿ç•™å­—</span></span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">2</span>)</span> sample_has_redundancy</span>;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>sdtp å¯¹äº video æ¥è¯´å¾ˆé‡è¦ï¼Œå› ä¸ºï¼Œå…¶å†…å®¹å­—æ®µä¸»è¦å°±æ˜¯ç»™ video ç›¸å…³çš„å¸§è®¾è®¡çš„ã€‚è€Œ audioï¼Œä¸€èˆ¬ç›´æ¥é‡‡ç”¨é»˜è®¤å€¼ï¼š<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">isLeading: <span class="number">0</span>,</span><br><span class="line">dependsOn: <span class="number">1</span>, </span><br><span class="line">isDepended: <span class="number">0</span>,</span><br><span class="line">hasRedundancy: <span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<h2 id="MDAT"><a href="#MDAT" class="headerlink" title="MDAT"></a>MDAT</h2><p>Media Data Boxã€‚è¯¥boxåŒ…å«åª’ä½“æ•°æ®ã€‚å¯¹äºh264ï¼Œaacç¼–ç çš„åª’ä½“æ¥è¯´ï¼Œå…¶è§†é¢‘mdatä¸­å†…å®¹æ˜¯nalï¼Œå¯¹äºéŸ³é¢‘æ¥è¯´ï¼Œå…¶å†…å®¹ä¸ºaacçš„ä¸€å¸§ã€‚mdatä¸­çš„å¸§ä¾æ¬¡å­˜æ”¾ï¼Œæ¯ä¸ªå¸§çš„ä½ç½®ã€æ—¶é—´ã€é•¿åº¦éƒ½ç”±moovä¸­çš„ä¿¡æ¯æŒ‡å®šã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class MediaDataBox extends <span class="title">Box</span><span class="params">(â€˜mdatâ€™)</span> </span>&#123; </span><br><span class="line">  bit(<span class="number">8</span>) data[];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="https://www.villainhr.com/page/2017/08/21/%E5%AD%A6%E5%A5%BD%20MP4%EF%BC%8C%E8%AE%A9%E7%9B%B4%E6%92%AD%E6%9B%B4%E7%BB%99%E5%8A%9B#fragmented MP4" target="_blank" rel="noopener">å­¦å¥½ MP4ï¼Œè®©ç›´æ’­æ›´ç»™åŠ›</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘å­¦ä¹ -FMP4ç»“æ„ä¹‹MP4]]></title>
      <url>https://lucius0.github.io/2018/01/14/archivers/media-study-07/</url>
      <content type="html"><![CDATA[<p>åˆæ¬¡å­¦ä¹ æœ‰å…³éŸ³è§†é¢‘è¿™ä¸€å—çš„å¼€å‘ï¼Œä¸»è¦æ˜¯åŸºäº <strong><a href="https://github.com/Bilibili/flv.js" target="_blank" rel="noopener">flv.js</a></strong> çš„å­¦ä¹ ã€‚è¿™ä¸€å—çš„çŸ¥è¯†æ¦‚å¿µå®åœ¨æ˜¯å¤ªå¤šå¤ªæ·±äº†ï¼Œæ‰€ä»¥æœ¬äººæ˜¯å…ˆåœ¨æœ¬åœ°åšè®°å½•ï¼Œåé¢ä¼šæ•´ç†æ…¢æ…¢åœ°ä¸Šä¼ ä¸å„ä½åˆ†äº«ï¼Œå‡å¦‚æœ‰åœ°æ–¹è¯´é”™ï¼Œè¯·å‹˜è¯¯ã€‚è°¢è°¢æŒ‡ç‚¹ã€‚</p>
<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>MP4(MPEG-4 Part 14)æ˜¯ä¸€ç§å¸¸è§çš„å¤šåª’ä½“å®¹å™¨æ ¼å¼ï¼Œå®ƒæ˜¯åœ¨â€œISO/IEC 14496-14â€æ ‡å‡†æ–‡ä»¶ä¸­å®šä¹‰çš„ï¼Œå±äºMPEG-4çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯â€œISO/IEC 14496-12(MPEG-4 Part 12 ISO base media file format)â€æ ‡å‡†ä¸­æ‰€å®šä¹‰çš„åª’ä½“æ ¼å¼çš„ä¸€ç§å®ç°ï¼Œåè€…å®šä¹‰äº†ä¸€ç§é€šç”¨çš„åª’ä½“æ–‡ä»¶ç»“æ„æ ‡å‡†ã€‚MP4æ˜¯ä¸€ç§æè¿°è¾ƒä¸ºå…¨é¢çš„å®¹å™¨æ ¼å¼ï¼Œè¢«è®¤ä¸ºå¯ä»¥åœ¨å…¶ä¸­åµŒå…¥ä»»ä½•å½¢å¼çš„æ•°æ®ï¼Œå„ç§ç¼–ç çš„è§†é¢‘ã€éŸ³é¢‘ç­‰éƒ½ä¸åœ¨è¯ä¸‹ï¼Œä¸è¿‡æˆ‘ä»¬å¸¸è§çš„å¤§éƒ¨åˆ†çš„MP4æ–‡ä»¶å­˜æ”¾çš„AVC(H.264)æˆ–MPEG-4(Part 2)ç¼–ç çš„è§†é¢‘å’ŒAACç¼–ç çš„éŸ³é¢‘ã€‚MP4æ ¼å¼çš„å®˜æ–¹æ–‡ä»¶åç¼€åæ˜¯â€œ.mp4â€ï¼Œè¿˜æœ‰å…¶ä»–çš„ä»¥mp4ä¸ºåŸºç¡€è¿›è¡Œçš„æ‰©å±•æˆ–è€…æ˜¯ç¼©æ°´ç‰ˆæœ¬çš„æ ¼å¼ï¼ŒåŒ…æ‹¬ï¼šM4V,  3GP, F4Vç­‰ã€‚</p>
<p>åœ¨HTML5æ’­æ”¾å™¨ä¸­ï¼Œç›®å‰ä»…æ”¯æŒ<strong>WebM</strong>å’Œ<strong>MPEG H.264 AAC</strong>çš„ç¼–ç æ ¼å¼ï¼Œè€ŒWebMçš„åœ¨æµè§ˆå™¨çš„æ”¯æŒåº¦æ²¡æœ‰mp4çš„æ”¯æŒåº¦å¥½ã€‚è€Œfmp4åŒºåˆ«äºmp4ï¼Œä¸»è¦æ˜¯å› ä¸ºå¯ä»¥é€šè¿‡fmp4çš„<code>moof+mdat</code>çš„æ ¼å¼ç»“æ„ï¼Œå¾ˆå¥½çš„åœ¨ä¸åŒè´¨é‡çš„ç æµåšç ç‡åˆ‡æ¢ã€‚</p>
<p>MP4æ˜¯ç”±ä¸€ä¸ªä¸ªçš„Boxç»„æˆçš„ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥è¯´Boxæ˜¯MP4çš„æœ€å°å•å…ƒã€‚å®˜æ–¹æ–‡æ¡£å¯ä»¥æŸ¥çœ‹ï¼š<a href="http://l.web.umkc.edu/lizhu/teaching/2016sp.video-communication/ref/mp4.pdf" target="_blank" rel="noopener">ISO_IEC_14496-12</a>ã€‚è€ŒBoxçš„ç±»å‹æœ‰å¤ªå¤šå¤ªå¤šäº†ï¼Œå¯ä»¥è‡ªè¡ŒæŸ¥çœ‹æ–‡æ¡£ä¸­çš„<strong>Table 1 â€” Box types, structure, and cross-reference</strong>éƒ¨åˆ†ï¼Œè¿™é‡Œæˆ‘å°±ä¸è´´å‡ºæ¥äº†ã€‚</p>
<h2 id="BOX"><a href="#BOX" class="headerlink" title="BOX"></a>BOX</h2><p>ä»¥ä¸‹æ˜¯fmp4è·Ÿmp4çš„ç»“æ„å›¾ï¼Œå¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°ä¸¤è€…çš„åŒºåˆ«ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180114225134.png?imageslim" alt=""></p>
<p>ä»å®˜æ–¹æ–‡æ¡£çœ‹ï¼Œå¯ä»¥çŸ¥é“ï¼Œé™¤äº†Boxï¼Œè¿˜æœ‰ä¸€ç§Full Boxã€‚Boxçš„ç»“æ„å›¾å¦‚ä¸‹ï¼š<br><img src="http://ouazw12mz.bkt.clouddn.com/180114225303.png?imageslim" alt=""></p>
<p>Boxçš„å®˜æ–¹ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Box</span></span><br><span class="line"><span class="comment">// Boxåªä¼šç»™Header(sizeã€type)</span></span><br><span class="line">aligned(8) class Box (unsigned int(32) boxtype, optional unsigned int(8)[16] extended_type) &#123;</span><br><span class="line">   <span class="comment">// Boxå¤§å°ï¼ŒåŒ…æ‹¬Headerï¼Œæ‰€ä»¥ä¸Šé¢çš„ftypä¸­sizeä¸º8+24</span></span><br><span class="line">   <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> size</span>;</span><br><span class="line">   <span class="comment">// ftypï¼Œå°±æ˜¯typeï¼Œä¸€èˆ¬éƒ½æ˜¯4ä¸ªå­—æ¯ï¼Œæ‰€ä»¥é€šè¿‡charCodeAtè·å–å³å¯ã€‚</span></span><br><span class="line">   <span class="comment">// flv.jsä¸­çš„ä»£ç ç‰‡æ®µå®ç°å¦‚ä¸‹ã€‚</span></span><br><span class="line">   <span class="comment">// MP4.types[name] = [</span></span><br><span class="line">   <span class="comment">//   name.charCodeAt(0),</span></span><br><span class="line">   <span class="comment">//   name.charCodeAt(1),</span></span><br><span class="line">   <span class="comment">//   name.charCodeAt(2),</span></span><br><span class="line">   <span class="comment">//   name.charCodeAt(3)</span></span><br><span class="line">   <span class="comment">// ];</span></span><br><span class="line">   <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> type </span>= boxtype;</span><br><span class="line">   <span class="keyword">if</span> (size==<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> largesize</span>;</span><br><span class="line">   &#125; <span class="keyword">else</span> <span class="keyword">if</span> (size==<span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">// box extends to end of file</span></span><br><span class="line">   &#125;</span><br><span class="line">  <span class="comment">// ç”¨æˆ·æ‰©å±•ä½¿ç”¨æ‰©å±•ç±»å‹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç±»å‹å­—æ®µè®¾ç½®ä¸ºâ€œuuidâ€ï¼Œä¸è¿‡å‡ ä¹æ²¡é‡è¿‡</span></span><br><span class="line">  <span class="keyword">if</span> (boxtype==â€˜uuidâ€™) &#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span>(<span class="number">8</span>)[<span class="number">16</span>] usertype = extended_type;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// FullBoxï¼Œå¢åŠ äº†versionä»¥åŠflagsï¼Œä¸éš¾ç†è§£ï¼Œæ˜¯Boxçš„æ‰©å±•ã€‚FullBoxæ˜¯æ²¡æœ‰å­boxçš„ã€‚</span></span><br><span class="line">aligned(8) class FullBox(unsigned int(32) boxtype, unsigned int(8) v, bit(24) f) extends Box(boxtype) &#123;</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">8</span>)</span> version </span>= v; <span class="comment">//</span></span><br><span class="line">  bit(<span class="number">24</span>) flags = f;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>åœ¨<code>mp4-generator.js</code>ä¸­ï¼Œç”Ÿæˆboxçš„ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Generate a box</span></span><br><span class="line"><span class="keyword">static</span> box(type) &#123;</span><br><span class="line">  <span class="keyword">let</span> size = <span class="number">8</span>;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">let</span> datas = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">let</span> arrayCount = datas.length;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arrayCount; i++) &#123;</span><br><span class="line">    size += datas[i].byteLength;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  result = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(size);</span><br><span class="line">  result[<span class="number">0</span>] = (size &gt;&gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>;  <span class="comment">// size</span></span><br><span class="line">  result[<span class="number">1</span>] = (size &gt;&gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">  result[<span class="number">2</span>] = (size &gt;&gt;&gt;  <span class="number">8</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">  result[<span class="number">3</span>] = (size) &amp; <span class="number">0xFF</span>;</span><br><span class="line"></span><br><span class="line">  result.set(type, <span class="number">4</span>);  <span class="comment">// type</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> offset = <span class="number">8</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arrayCount; i++) &#123;  <span class="comment">// data body</span></span><br><span class="line">    result.set(datas[i], offset);</span><br><span class="line">    offset += datas[i].byteLength;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆ ftyp box</span></span><br><span class="line"><span class="keyword">let</span> ftyp = MP4.box(MP4.types.ftyp, MP4.constants.FTYP);</span><br></pre></td></tr></table></figure></p>
<h2 id="FTYP"><a href="#FTYP" class="headerlink" title="FTYP"></a>FTYP</h2><p>File Type Box<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class FileTypeBox extends <span class="title">Box</span><span class="params">(â€˜ftypâ€™)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ä¸»è¦æ¨èç‰ˆæœ¬</span></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> major_brand</span>;</span><br><span class="line">  <span class="comment">// æœ€ä½å…¼å®¹ç‰ˆæœ¬</span></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> minor_version</span>;</span><br><span class="line">  <span class="comment">// å…¼å®¹ç‰ˆæœ¬</span></span><br><span class="line">  unsigned int(32) compatible_brands[]; // to end of the box</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹æ ¼å¼</span></span><br><span class="line">[ftyp] size=<span class="number">8</span>+<span class="number">16</span></span><br><span class="line">  major_brand = qt  </span><br><span class="line">  minor_version = <span class="number">0</span></span><br><span class="line">  compatible_brand = qt  </span><br><span class="line">  compatible_brand = iso5</span><br></pre></td></tr></table></figure></p>
<h2 id="MOOV"><a href="#MOOV" class="headerlink" title="MOOV"></a>MOOV</h2><p>Movie Boxï¼Œç»§æ‰¿boxï¼Œé‚£ä¹ˆå°±å¯ä»¥çŸ¥é“æœ‰4ä¸ªå­—èŠ‚ï¼Œè¿™4ä¸ªå­—èŠ‚æ˜¯å­boxçš„é•¿åº¦ã€‚å¯ä»¥åœ¨ä¸Šå›¾çœ‹åˆ°ï¼Œmoovä¸»è¦æ˜¯ä¸ºäº†å­˜æ”¾trakã€mvhdï¼Œfmp4è¿˜ä¼šå­˜æ”¾mvex boxã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="class"><span class="keyword">class</span> <span class="title">MovieBox</span> <span class="keyword">extends</span> <span class="title">Box</span>(â€˜<span class="title">moov</span>â€™)</span>&#123; &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-MVHD"><a href="#MOOV-MVHD" class="headerlink" title="MOOV::MVHD"></a>MOOV::MVHD</h3><p>Movie Header Boxï¼Œè¯¥boxæœ‰ä¸”åªæœ‰ä¸€ä¸ªï¼Œä¸»è¦æ˜¯è®°å½•æ•´ä¸ªå®¹å™¨çš„å„ç§ä¿¡æ¯ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class MovieHeaderBox extends <span class="title">FullBox</span><span class="params">(â€˜mvhdâ€™, version, <span class="number">0</span>)</span> </span>&#123; </span><br><span class="line">  <span class="comment">// MVHD çš„ç‰ˆæœ¬å·ï¼Œé»˜è®¤ 0</span></span><br><span class="line">  <span class="keyword">if</span> (version==<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span>  creation_time</span>;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span>  modification_time</span>;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  timescale</span>;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span>  duration</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123; <span class="comment">// version==0</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºæ—¶é—´ï¼Œä»1904å¼€å§‹ï¼Œæ•´æ•°ï¼Œå•ä½s</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span>(<span class="number">32</span>)  creation_time;</span><br><span class="line">    <span class="comment">// æœ€è¿‘ä¿®æ”¹æ—¶é—´ï¼ŒåŒæ ·ä»1904å¼€å§‹ï¼Œæ•´æ•°ï¼Œå•ä½s</span></span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  modification_time</span>;</span><br><span class="line">    <span class="comment">// æ–‡ä»¶åª’ä½“åœ¨ 1s æ—¶é—´å†…çš„åˆ»åº¦å€¼ï¼Œå¯ä»¥ç†è§£ä¸º 1s é•¿åº¦çš„æ—¶é—´å•å…ƒæ•°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è§†é¢‘éƒ½æ˜¯1000</span></span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  timescale</span>;</span><br><span class="line">    <span class="comment">// æŒç»­æ—¶é—´ï¼Œä¸€èˆ¬æ¥è¯´ç”µå½±æ—¶é—´ = duration / timescale</span></span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  duration</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">// æ’­æ”¾é€Ÿç‡ï¼Œä¸€èˆ¬ä¸º 1ï¼Œé«˜16å’Œä½16åˆ†åˆ«è¡¨ç¤ºå°æ•°ç‚¹å‰åæ•´æ•°éƒ¨åˆ†å’Œå°æ•°éƒ¨åˆ†</span></span><br><span class="line"><span class="function"><span class="keyword">template</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> rate </span>= <span class="number">0x00010000</span>; <span class="comment">// typically 1.0</span></span><br><span class="line"><span class="comment">// éŸ³é‡ï¼Œæœ€å¤§ä¸º100ï¼Œé«˜8ä½å’Œä½8ä½åˆ†åˆ«è¡¨ç¤ºå°æ•°ç‚¹å‰åæ•´æ•°å’Œå°æ•°éƒ¨åˆ†</span></span><br><span class="line"><span class="function"><span class="keyword">template</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> volume </span>= <span class="number">0x0100</span>; <span class="comment">// typically, full volume</span></span><br><span class="line"><span class="comment">// ä¿ç•™å­—</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> <span class="title">bit</span><span class="params">(<span class="number">16</span>)</span> reserved </span>= <span class="number">0</span>; </span><br><span class="line">const unsigned int(32)[2] reserved = 0;</span><br><span class="line"><span class="comment">// è§†é¢‘å˜åŒ–çŸ©é˜µ Unity matrix</span></span><br><span class="line">template int(32)[9] matrix = &#123; </span><br><span class="line">  <span class="number">0x00010000</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">  <span class="number">0</span>,<span class="number">0x00010000</span>,<span class="number">0</span>,</span><br><span class="line">  <span class="number">0</span>,<span class="number">0</span>,<span class="number">0x40000000</span></span><br><span class="line">&#125;;</span><br><span class="line">bit(<span class="number">32</span>)[<span class="number">6</span>]  pre_defined = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// ä¸‹ä¸€ä¸ª track ä½¿ç”¨çš„id å·</span></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  next_track_ID</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹æ ¼å¼</span></span><br><span class="line">[mvhd] size=<span class="number">12</span>+<span class="number">96</span></span><br><span class="line">  timescale = <span class="number">1000</span></span><br><span class="line">  duration = <span class="number">51952</span></span><br><span class="line">  duration(ms) = <span class="number">51952</span></span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK"><a href="#MOOV-TRAK" class="headerlink" title="MOOV::TRAK"></a>MOOV::TRAK</h3><p>Track Boxï¼Œä¸»è¦æ˜¯å­˜ä¸€ä¸ªæˆ–å¤šä¸ªmedia boxçš„ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aligned(<span class="number">8</span>) <span class="function">class TrackBox extends <span class="title">Box</span><span class="params">(â€˜trakâ€™)</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-TKHD"><a href="#MOOV-TRAK-TKHD" class="headerlink" title="MOOV::TRAK::TKHD"></a>MOOV::TRAK::TKHD</h3><p>Track Header Boxï¼Œtrak box çš„ç¬¬ä¸€ä¸ªboxï¼Œä¸»è¦æ˜¯è®°å½•ä»¥ä¸‹ä¿¡æ¯ï¼ˆä¸€å¼€å§‹æˆ‘è¿˜ä»¥ä¸ºä¸ä¸Šé¢çš„å†²çªäº†ï¼‰ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class TrackHeaderBox extends <span class="title">FullBox</span><span class="params">(â€˜tkhdâ€™, version, flags)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (version==<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> creation_time</span>;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> modification_time</span>;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> track_ID</span>;</span><br><span class="line">    <span class="function"><span class="keyword">const</span> <span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> reserved </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> duration</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123; <span class="comment">// version==0</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span>(<span class="number">32</span>) creation_time;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> modification_time</span>;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> track_ID</span>; <span class="comment">// å½“å‰trackçš„ID</span></span><br><span class="line">    <span class="function"><span class="keyword">const</span> <span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> reserved </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> duration</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  const unsigned int(32)[2] reserved = 0;</span><br><span class="line">  <span class="comment">// è§†é¢‘trackçš„å‰åæ’åºï¼Œç±»ä¼¼photoshopä¸­å›¾å±‚çš„æ¦‚å¿µï¼Œæ•°å€¼å°çš„åœ¨æ’­æ”¾æ—¶æ›´è´´è¿‘ç”¨æˆ·ï¼Œ0ä¸ºé»˜è®¤å€¼</span></span><br><span class="line">  <span class="function"><span class="keyword">template</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> layer </span>= <span class="number">0</span>; </span><br><span class="line">  <span class="comment">// å¤‡ç”¨åˆ†ç»„IDï¼Œ0è¡¨ç¤ºæ— å¤‡ç”¨ã€‚å¦åˆ™è¯¥ track å¯èƒ½ä¼šæœ‰é›¶åˆ°å¤šä¸ªå¤‡ä»½trackã€‚å½“æ’­æ”¾æ—¶ç›¸åŒgroup IDçš„trackåªé€‰æ‹©ä¸€ä¸ªè¿›è¡Œæ’­æ”¾ã€‚</span></span><br><span class="line">  <span class="function"><span class="keyword">template</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> alternate_group </span>= <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// éŸ³é‡</span></span><br><span class="line">  <span class="function"><span class="keyword">template</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> volume </span>= &#123;<span class="keyword">if</span> track_is_audio <span class="number">0x0100</span> <span class="keyword">else</span> <span class="number">0</span>&#125;;</span><br><span class="line">  <span class="function"><span class="keyword">const</span> <span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> reserved </span>= <span class="number">0</span>;</span><br><span class="line">  template int(32)[9] matrix=&#123; </span><br><span class="line">    <span class="number">0x00010000</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">0x00010000</span>,<span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">0</span>,<span class="number">0x40000000</span> </span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// unity matrix</span></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> width</span>;  <span class="comment">// å®½</span></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> height</span>; <span class="comment">// é«˜</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹æ ¼å¼</span></span><br><span class="line">[tkhd] size=<span class="number">12</span>+<span class="number">80</span>, flags=<span class="number">7</span></span><br><span class="line">  enabled = <span class="number">1</span></span><br><span class="line">  id = <span class="number">1</span></span><br><span class="line">  duration = <span class="number">51952</span></span><br><span class="line">  width = <span class="number">856.000000</span></span><br><span class="line">  height = <span class="number">720.000000</span></span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-EDTS"><a href="#MOOV-TRAK-EDTS" class="headerlink" title="MOOV::TRAK::EDTS"></a>MOOV::TRAK::EDTS</h3><p>Edit Boxï¼Œä¸æ˜¯å¿…è¦çš„ï¼Œä¸»è¦æ˜¯å°†æ—¶é—´çº¿æ˜ å°„åˆ°mediaæ—¶é—´çº¿ä¸Šï¼Œæ˜¯Edit List Boxçš„å®¹å™¨ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class EditBox extends <span class="title">Box</span><span class="params">(â€˜edtsâ€™)</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-EDTS-ELST"><a href="#MOOV-TRAK-EDTS-ELST" class="headerlink" title="MOOV::TRAK::EDTS::ELST"></a>MOOV::TRAK::EDTS::ELST</h3><p>Edit List Boxï¼Œä¸æ˜¯å¿…è¦çš„ï¼Œä¸»è¦æ˜¯ä¿å­˜åˆ‡ç¡®çš„æ—¶é—´è¡¨ï¼Œä½¿å¾—æŸä¸ªtrackçš„æ—¶é—´æˆ³äº§ç”Ÿåç§»ï¼Œèƒ½è¾¾åˆ°å»¶è¿Ÿæ’­æ”¾çš„ä½œç”¨ã€‚<a href="http://blog.jianchihu.net/mp4-elst-box.html" target="_blank" rel="noopener">mp4æ–‡ä»¶elstç ”ç©¶</a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class EditListBox extends <span class="title">FullBox</span><span class="params">(â€˜elstâ€™, version, <span class="number">0</span>)</span> </span>&#123; </span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_count</span>;</span><br><span class="line">  <span class="keyword">for</span> (i=<span class="number">1</span>; i &lt;= entry_count; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (version==<span class="number">1</span>) &#123;</span><br><span class="line">       <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> segment_duration</span>;</span><br><span class="line">       <span class="keyword">int</span>(<span class="number">64</span>) media_time;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// version==0</span></span><br><span class="line">       <span class="comment">// è¡¨è¯¥boxçš„æ—¶é•¿ï¼Œä»¥Movie Header Boxä¸­çš„timescaleä¸ºå•ä½ã€‚</span></span><br><span class="line">       <span class="keyword">unsigned</span> <span class="keyword">int</span>(<span class="number">32</span>) segment_duration;</span><br><span class="line">       <span class="comment">// è¯¥boxçš„èµ·å§‹æ—¶é—´ï¼Œä»¥ track ä¸­Media Header Boxä¸­çš„timescale ä¸ºå•ä½ã€‚å¦‚æœå€¼ä¸º-1ï¼Œè¡¨ç¤ºæ˜¯ç©ºedit boxï¼Œä¸€ä¸ª track ä¸­æœ€åä¸€ä¸ª edit ä¸èƒ½ä¸ºç©ºã€‚</span></span><br><span class="line">       <span class="keyword">int</span>(<span class="number">32</span>)  media_time;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é€Ÿç‡ã€‚ä¸º0çš„è¯ï¼Œç›¸å½“äº'dwell'ï¼Œå³ç”»é¢åœæ­¢ã€‚</span></span><br><span class="line">    <span class="keyword">int</span>(<span class="number">16</span>) media_rate_integer;</span><br><span class="line">    <span class="keyword">int</span>(<span class="number">16</span>) media_rate_fraction = <span class="number">0</span>;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-MDIA"><a href="#MOOV-TRAK-MDIA" class="headerlink" title="MOOV::TRAK::MDIA"></a>MOOV::TRAK::MDIA</h3><p>Media Boxï¼Œä¿å­˜åª’ä½“ä¿¡æ¯çš„å®¹å™¨ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class MediaBox extends <span class="title">Box</span><span class="params">(â€˜mdiaâ€™)</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-MDIA-MDHD"><a href="#MOOV-TRAK-MDIA-MDHD" class="headerlink" title="MOOV::TRAK::MDIA::MDHD"></a>MOOV::TRAK::MDIA::MDHD</h3><p>Media Header Boxï¼Œå­˜æ”¾åª’ä½“ä¿¡æ¯ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class MediaHeaderBox extends <span class="title">FullBox</span><span class="params">(â€˜mdhdâ€™, version, <span class="number">0</span>)</span> </span>&#123; </span><br><span class="line">  <span class="keyword">if</span> (version==<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span>  creation_time</span>;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span>  modification_time</span>;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  timescale</span>;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span>  duration</span>;</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123; <span class="comment">// version==0</span></span><br><span class="line">      <span class="keyword">unsigned</span> <span class="keyword">int</span>(<span class="number">32</span>)  creation_time;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  modification_time</span>;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  timescale</span>;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  duration</span>;</span><br><span class="line">&#125;</span><br><span class="line">  bit(<span class="number">1</span>) pad = <span class="number">0</span>;</span><br><span class="line">  unsigned int(5)[3] language; // ISO-639-2/T language code</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> pre_defined </span>= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹æ ¼å¼</span></span><br><span class="line">[mdia] size=<span class="number">8</span>+<span class="number">415</span></span><br><span class="line">  [mdhd] size=<span class="number">12</span>+<span class="number">20</span></span><br><span class="line">    timescale = <span class="number">600</span></span><br><span class="line">    duration = <span class="number">0</span></span><br><span class="line">    duration(ms) = <span class="number">0</span></span><br><span class="line">    language = und</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-MDIA-HDLR"><a href="#MOOV-TRAK-MDIA-HDLR" class="headerlink" title="MOOV::TRAK::MDIA::HDLR"></a>MOOV::TRAK::MDIA::HDLR</h3><p>Handler Reference Boxï¼Œä¸»è¦æ˜¯ç”¨æ¥è·Ÿè¸ªä¸­åª’ä½“æ•°æ®è¢«å‘ˆç°çš„è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œvideo trackå°†ç”±video handler boxå¤„ç†ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class HandlerBox extends <span class="title">FullBox</span><span class="params">(â€˜hdlrâ€™, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span>&#123; </span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> pre_defined </span>= <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// hanler typeæœ‰ä»¥ä¸‹å‡ ç§æ ¼å¼ï¼š</span></span><br><span class="line">  <span class="comment">// â€˜videâ€™ Video track</span></span><br><span class="line">  <span class="comment">// â€˜sounâ€™ Audio track</span></span><br><span class="line">  <span class="comment">// â€˜hintâ€™ Hint track</span></span><br><span class="line">  <span class="comment">// â€˜metaâ€™ Timed Metadata track</span></span><br><span class="line">  <span class="comment">// â€˜auxvâ€™ Auxiliary Video track</span></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> handler_type</span>;</span><br><span class="line">  const unsigned int(32)[3] reserved = 0;</span><br><span class="line">  <span class="built_in">string</span> name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹æ ¼å¼</span></span><br><span class="line">[hdlr] size=<span class="number">12</span>+<span class="number">41</span></span><br><span class="line">  handler_type = vide</span><br><span class="line">  handler_name = Bento4 Video Handler</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-MDIA-MINF"><a href="#MOOV-TRAK-MDIA-MINF" class="headerlink" title="MOOV::TRAK::MDIA::MINF"></a>MOOV::TRAK::MDIA::MINF</h3><p>Media Information Boxã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aligned(<span class="number">8</span>) <span class="function">class MediaInformationBox extends <span class="title">Box</span><span class="params">(â€˜minfâ€™)</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-MDIA-VMHD-SMHD-HMHD-NMHD"><a href="#MOOV-TRAK-MDIA-VMHD-SMHD-HMHD-NMHD" class="headerlink" title="MOOV::TRAK::MDIA::VMHD/SMHD/HMHD/NMHD"></a>MOOV::TRAK::MDIA::VMHD/SMHD/HMHD/NMHD</h3><p>Media Information Header Boxesã€‚æ¯ç§éŸ³è½¨ç±»å‹éƒ½æœ‰ä¸åŒçš„åª’ä½“ä¿¡æ¯å¤´ï¼ˆå¯¹åº”media handler-typeï¼‰; åŒ¹é…çš„å¤´æ–‡ä»¶åº”è¯¥å­˜åœ¨ï¼Œå¯ä»¥æ˜¯è¿™é‡Œå®šä¹‰çš„å¤´æ–‡ä»¶ä¹‹ä¸€ï¼Œæˆ–è€…æ´¾ç”Ÿçš„è§„èŒƒä¸­å®šä¹‰çš„å¤´æ–‡ä»¶ä¹‹ä¸€ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="class"><span class="keyword">class</span> <span class="title">VideoMediaHeaderBox</span></span></span><br><span class="line"><span class="class"><span class="title">extends</span> <span class="title">FullBox</span>(â€˜<span class="title">vmhd</span>â€™, <span class="title">version</span> = 0, 1) &#123;</span></span><br><span class="line">  <span class="function"><span class="keyword">template</span> <span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> graphicsmode </span>= <span class="number">0</span>; <span class="comment">// copy, see below </span></span><br><span class="line">  template unsigned int(16)[3] opcolor = &#123;0, 0, 0&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">aligned(<span class="number">8</span>) <span class="class"><span class="keyword">class</span> <span class="title">SoundMediaHeaderBox</span></span></span><br><span class="line"><span class="class">   <span class="title">extends</span> <span class="title">FullBox</span>(â€˜<span class="title">smhd</span>â€™, <span class="title">version</span> = 0, 0) &#123;</span></span><br><span class="line">   <span class="function"><span class="keyword">template</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> balance </span>= <span class="number">0</span>;</span><br><span class="line">   <span class="function"><span class="keyword">const</span> <span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span>  reserved </span>= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹æ ¼å¼</span></span><br><span class="line">[vmhd] size=<span class="number">12</span>+<span class="number">8</span>, flags=<span class="number">1</span></span><br><span class="line">  graphics_mode = <span class="number">0</span></span><br><span class="line">  op_color = <span class="number">0000</span>,<span class="number">0000</span>,<span class="number">0000</span></span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-MDIA-MINF-DINF"><a href="#MOOV-TRAK-MDIA-MINF-DINF" class="headerlink" title="MOOV::TRAK::MDIA::MINF::DINF"></a>MOOV::TRAK::MDIA::MINF::DINF</h3><p>Data Information Boxã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class DataInformationBox extends <span class="title">Box</span><span class="params">(â€˜dinfâ€™)</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-MDIA-MINF-DINF-DREF"><a href="#MOOV-TRAK-MDIA-MINF-DINF-DREF" class="headerlink" title="MOOV::TRAK::MDIA::MINF::DINF::DREF"></a>MOOV::TRAK::MDIA::MINF::DINF::DREF</h3><p>Data Reference Boxã€‚æœ‰ä¸‰ç§å­boxç±»å‹ï¼Œâ€˜url â€˜, â€˜urn â€˜, â€˜drefâ€™ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="class"><span class="keyword">class</span> <span class="title">DataReferenceBox</span></span></span><br><span class="line"><span class="class">   <span class="title">extends</span> <span class="title">FullBox</span>(â€˜<span class="title">dref</span>â€™, <span class="title">version</span> = 0, 0) &#123;</span></span><br><span class="line">   <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  entry_count</span>;</span><br><span class="line">   <span class="keyword">for</span> (i=<span class="number">1</span>; i &lt;= entry_count; i++) &#123;</span><br><span class="line">    <span class="comment">// URL box / URN box</span></span><br><span class="line">    <span class="comment">// entry_versionï¼šå£°æ˜entry boxæ ¼å¼çš„ç‰ˆæœ¬</span></span><br><span class="line">    <span class="comment">// entry_flagsï¼šæ ‡è¯†ï¼Œå…¶ä¸­0x000001è¡¨ç¤ºmedia boxä¸åŒ…å«æ­¤æ•°æ®çš„å¼•ç”¨çš„media box(moof)ç›¸åŒã€‚</span></span><br><span class="line">    DataEntryBox(entry_version, entry_flags) data_entry; </span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹æ ¼å¼</span></span><br><span class="line">[dinf] size=<span class="number">8</span>+<span class="number">28</span></span><br><span class="line">  [dref] size=<span class="number">12</span>+<span class="number">16</span></span><br><span class="line">    [url] size=<span class="number">12</span>+<span class="number">0</span>, flags=<span class="number">1</span></span><br><span class="line">      location = [local to file]</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-MDIA-MINF-DINF-DREF-URL-URN"><a href="#MOOV-TRAK-MDIA-MINF-DINF-DREF-URL-URN" class="headerlink" title="MOOV::TRAK::MDIA::MINF::DINF::DREF::URL/URN"></a>MOOV::TRAK::MDIA::MINF::DINF::DREF::URL/URN</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(8) class DataEntryUrlBox (bit(24) flags) extends FullBox(â€˜url â€™, version = 0, flags) &#123; </span><br><span class="line">  <span class="built_in">string</span> location;</span><br><span class="line">&#125;</span><br><span class="line">aligned(8) class DataEntryUrnBox (bit(24) flags) extends FullBox(â€˜urn â€™, version = 0, flags) &#123; </span><br><span class="line">  <span class="built_in">string</span> name;</span><br><span class="line">  <span class="built_in">string</span> location;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="MOOV-TRAK-MDIA-MINF-STBL"><a href="#MOOV-TRAK-MDIA-MINF-STBL" class="headerlink" title="MOOV::TRAK::MDIA::MINF::STBL"></a>MOOV::TRAK::MDIA::MINF::STBL</h3><p>Sample Table Boxã€‚ç”±å›¾å¯ä»¥çœ‹å‡ºï¼Œæ˜¯ä½œä¸ºä¸€ä¸ªå®¹å™¨å­˜åœ¨ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aligned(<span class="number">8</span>) <span class="function">class SampleTableBox extends <span class="title">Box</span><span class="params">(â€˜stblâ€™)</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-MDIA-MINF-STBL-STSD"><a href="#MOOV-TRAK-MDIA-MINF-STBL-STSD" class="headerlink" title="MOOV::TRAK::MDIA::MINF::STBL::STSD"></a>MOOV::TRAK::MDIA::MINF::STBL::STSD</h3><p>Sample Description Boxã€‚ box headerå’Œversionå­—æ®µåä¼šæœ‰ä¸€ä¸ªentry countå­—æ®µï¼Œæ ¹æ®entryçš„ä¸ªæ•°ï¼Œæ¯ä¸ªentryä¼šæœ‰typeä¿¡æ¯ï¼Œå¦‚â€œvideâ€ã€â€œsundâ€ç­‰ï¼Œæ ¹æ®typeä¸åŒsample descriptionä¼šæä¾›ä¸åŒçš„ä¿¡æ¯ï¼Œä¾‹å¦‚å¯¹äºvideo trackï¼Œä¼šæœ‰â€œVisualSampleEntryâ€ç±»å‹ä¿¡æ¯ï¼Œå¯¹äºaudio trackä¼šæœ‰â€œAudioSampleEntryâ€ç±»å‹ä¿¡æ¯ã€‚<br>è§†é¢‘çš„ç¼–ç ç±»å‹ã€å®½é«˜ã€é•¿åº¦ï¼ŒéŸ³é¢‘çš„å£°é“ã€é‡‡æ ·ç­‰ä¿¡æ¯éƒ½ä¼šå‡ºç°åœ¨è¿™ä¸ªboxä¸­ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(8) class SampleDescriptionBox (unsigned int(32) handler_type) extends FullBox('stsd', 0, 0) &#123;</span><br><span class="line">  <span class="keyword">int</span> i ;</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_count</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= entry_count ; i++) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (handler_type) &#123;</span><br><span class="line">      <span class="keyword">case</span> â€˜sounâ€™: <span class="comment">// for audio tracks</span></span><br><span class="line">        AudioSampleEntry();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> â€˜videâ€™: <span class="comment">// for video tracks</span></span><br><span class="line">        VisualSampleEntry();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> â€˜hintâ€™: <span class="comment">// Hint track</span></span><br><span class="line">              HintSampleEntry();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> â€˜metaâ€™: <span class="comment">// Metadata track</span></span><br><span class="line">              MetadataSampleEntry();</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">       &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹æ ¼å¼</span></span><br><span class="line">[stbl] size=<span class="number">8</span>+<span class="number">258</span></span><br><span class="line">  [stsd] size=<span class="number">12</span>+<span class="number">178</span></span><br><span class="line">    entry-count = <span class="number">1</span></span><br><span class="line">    [avc1] size=<span class="number">8</span>+<span class="number">166</span></span><br><span class="line">      data_reference_index = <span class="number">1</span></span><br><span class="line">      width = <span class="number">856</span></span><br><span class="line">      height = <span class="number">720</span></span><br><span class="line">      compressor = H<span class="number">.264</span></span><br><span class="line">      [avcC] size=<span class="number">8</span>+<span class="number">46</span></span><br><span class="line">        Configuration Version = <span class="number">1</span></span><br><span class="line">        Profile = Main</span><br><span class="line">        Profile Compatibility = <span class="number">0</span></span><br><span class="line">        Level = <span class="number">31</span></span><br><span class="line">        NALU Length Size = <span class="number">4</span></span><br><span class="line">        Sequence Parameter = [<span class="number">27</span> <span class="number">4</span>d <span class="number">00</span> <span class="number">1f</span> <span class="number">89</span> <span class="number">8b</span> <span class="number">60</span> <span class="number">6</span>c <span class="number">0b</span> <span class="number">7</span>c be <span class="number">02</span> d4 <span class="number">04</span> <span class="number">04</span> <span class="number">04</span> c0 c0 <span class="number">01</span> <span class="number">77</span> <span class="number">00</span> <span class="number">00</span> <span class="number">5</span>d c1 <span class="number">7b</span> df <span class="number">07</span> c2 <span class="number">21</span> <span class="number">1b</span> <span class="number">80</span>]</span><br><span class="line">        Picture Parameter = [<span class="number">28</span> ee <span class="number">1f</span> <span class="number">20</span>]</span><br><span class="line">      [colr] size=<span class="number">8</span>+<span class="number">10</span></span><br><span class="line">      [pasp] size=<span class="number">8</span>+<span class="number">8</span></span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-MDIA-MINF-STBL-STTS"><a href="#MOOV-TRAK-MDIA-MINF-STBL-STTS" class="headerlink" title="MOOV::TRAK::MDIA::MINF::STBL::STTS"></a>MOOV::TRAK::MDIA::MINF::STBL::STTS</h3><p>Decoding Time to Sample Boxã€‚å­˜å‚¨äº†sampleçš„durationï¼Œæè¿°äº†sampleæ—¶åºçš„æ˜ å°„æ–¹æ³•ï¼Œæˆ‘ä»¬é€šè¿‡å®ƒå¯ä»¥æ‰¾åˆ°ä»»ä½•æ—¶é—´çš„sampleã€‚â€œsttsâ€å¯ä»¥åŒ…å«ä¸€ä¸ªå‹ç¼©çš„è¡¨æ¥æ˜ å°„æ—¶é—´å’Œsampleåºå·ï¼Œç”¨å…¶ä»–çš„è¡¨æ¥æä¾›æ¯ä¸ªsampleçš„é•¿åº¦å’ŒæŒ‡é’ˆã€‚è¡¨ä¸­æ¯ä¸ªæ¡ç›®æä¾›äº†åœ¨åŒä¸€ä¸ªæ—¶é—´åç§»é‡é‡Œé¢è¿ç»­çš„sampleåºå·ï¼Œä»¥åŠsamplesçš„åç§»é‡ã€‚é€’å¢è¿™äº›åç§»é‡ï¼Œå°±å¯ä»¥å»ºç«‹ä¸€ä¸ªå®Œæ•´çš„time to sampleè¡¨ã€‚<br>æ¯ä¸ªsampleçš„æ˜¾ç¤ºæ—¶é—´å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å…¬å¼å¾—åˆ°ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D(n+<span class="number">1</span>) = D(n) + STTS(n)</span><br></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ï¼ŒSTTS(n)æ˜¯sample nçš„æ—¶é—´é—´éš”ï¼ŒåŒ…å«åœ¨è¡¨æ ¼ä¸­ï¼›D(n)æ˜¯sample nçš„æ˜¾ç¤ºæ—¶é—´ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180114231843.png?imageslim" alt=""><br>å› æ­¤æœ‰DT(2) = DT(1) + STTS(1)ï¼Œå…¶ä¸­STTSå°±æ˜¯Decode delta(1)=10ã€‚é‚£ä¹ˆsample_countè·Ÿsample_deltaçš„å…³ç³»å°±æ˜¯å¦‚ä¸‹è¡¨ï¼š<br><img src="http://ouazw12mz.bkt.clouddn.com/180114231904.png?imageslim" alt=""><br>é‚£ä¹ˆentry_countæ˜¯ä»€ä¹ˆï¼Ÿå‡å¦‚è¿™ä¸ªåª’ä½“æµå­˜åœ¨9ä¸ªsamplesï¼Œè¿™é‡Œçš„entryå’Œchunkä¸æ˜¯å¯¹åº”çš„ã€‚sample 4ã€5å’Œ6åœ¨åŒä¸€ä¸ªchunkä¸­ï¼Œä½†æ˜¯ï¼Œç”±äºä»–ä»¬çš„æ—¶é•¿ä¸ä¸€æ ·ï¼Œsample 4çš„æ—¶é•¿ä¸º3ï¼Œè€Œsample 5å’Œ6çš„æ—¶é•¿ä¸º1ï¼Œå› æ­¤ï¼Œé€šè¿‡ä¸åŒçš„entryæ¥æè¿°ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180114231922.png?imageslim" alt=""><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="class"><span class="keyword">class</span> <span class="title">TimeToSampleBox</span></span></span><br><span class="line"><span class="class">   <span class="title">extends</span> <span class="title">FullBox</span>(â€™<span class="title">stts</span>â€™, <span class="title">version</span> = 0, 0) &#123;</span></span><br><span class="line">   <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  entry_count</span>;</span><br><span class="line">   <span class="keyword">int</span> i;</span><br><span class="line">   <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; entry_count; i++) &#123;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  sample_count</span>;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  sample_delta</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-MDIA-MINF-STBL-CTTS"><a href="#MOOV-TRAK-MDIA-MINF-STBL-CTTS" class="headerlink" title="MOOV::TRAK::MDIA::MINF::STBL::CTTS"></a>MOOV::TRAK::MDIA::MINF::STBL::CTTS</h3><p>Composition Time to Sample Boxã€‚æ¯ä¸€ä¸ªè§†é¢‘sampleéƒ½æœ‰ä¸€ä¸ªè§£ç é¡ºåºå’Œä¸€ä¸ªæ˜¾ç¤ºé¡ºåºã€‚å¯¹äºä¸€ä¸ªsampleæ¥è¯´ï¼Œè§£ç é¡ºåºå’Œæ˜¾ç¤ºé¡ºåºå¯èƒ½ä¸ä¸€è‡´ï¼Œæ¯”å¦‚H.264æ ¼å¼ï¼Œå› æ­¤ï¼ŒCTTSå°±æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹è¢«ä½¿ç”¨çš„ã€‚</p>
<ol>
<li>å¦‚æœè§£ç é¡ºåºå’Œæ˜¾ç¤ºé¡ºåºæ˜¯ä¸€è‡´çš„ï¼ŒCTTSå°±ä¸ä¼šå‡ºç°ã€‚STTSæ—¢æä¾›äº†è§£ç é¡ºåºä¹Ÿæä¾›äº†æ˜¾ç¤ºé¡ºåºï¼Œå¹¶èƒ½å¤Ÿè®¡ç®—å‡ºæ¯ä¸ªsampleçš„å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ã€‚</li>
<li>å¦‚æœè§£ç é¡ºåºå’Œæ˜¾ç¤ºé¡ºåºä¸ä¸€è‡´ï¼Œé‚£ä¹ˆSTTSæ—¢æä¾›è§£ç é¡ºåºï¼ŒCTTSåˆ™é€šè¿‡å·®å€¼çš„å½¢å¼æ¥æä¾›æ˜¾ç¤ºæ—¶é—´ã€‚<br>ä¾æ—§çœ‹<strong>Table 2</strong>ï¼Œé‚£ä¹ˆsample_countè·Ÿsample_offsetçš„å…³ç³»å¦‚ä¸‹ï¼š<br><img src="http://ouazw12mz.bkt.clouddn.com/180114232102.png?imageslim" alt=""><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class CompositionOffsetBox extends <span class="title">FullBox</span><span class="params">(â€˜cttsâ€™, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span>&#123; </span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_count</span>;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line">  <span class="keyword">if</span> (version==<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; entry_count; i++) &#123;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  sample_count</span>;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  sample_offset</span>;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (version == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; entry_count; i++) &#123;</span><br><span class="line">      <span class="keyword">unsigned</span> <span class="keyword">int</span>(<span class="number">32</span>)  sample_count;</span><br><span class="line">      <span class="function"><span class="keyword">signed</span>   <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  sample_offset</span>;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="MOOV-TRAK-MDIA-MINF-STBL-STCO"><a href="#MOOV-TRAK-MDIA-MINF-STBL-STCO" class="headerlink" title="MOOV::TRAK::MDIA::MINF::STBL::STCO"></a>MOOV::TRAK::MDIA::MINF::STBL::STCO</h3><p>Chunk Offset Boxã€‚Chunkçš„åç§»é‡è¡¨ï¼ŒæŒ‡å®šäº†æ¯ä¸ªchunkåœ¨æ–‡ä»¶ä¸­çš„ä½ç½®ã€‚å¦‚ä¸‹å›¾ï¼š<br><img src="http://ouazw12mz.bkt.clouddn.com/180114232325.png?imageslim" alt=""><br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œboxä¸­åªæ˜¯ç»™å‡ºäº†æ¯ä¸ªchunkçš„åç§»é‡ï¼Œå¹¶æ²¡æœ‰ç»™å‡ºæ¯ä¸ªsampleçš„åç§»é‡ã€‚å› æ­¤ï¼Œå¦‚æœè¦è·å¾—æ¯ä¸ªsampleçš„åç§»é‡ï¼Œè¿˜éœ€è¦ç”¨åˆ°Sample Size Boxå’ŒSample-To-Chunk Boxã€‚</p>
<p>stco æœ‰ä¸¤ç§å½¢å¼ï¼Œå¦‚æœä½ çš„è§†é¢‘è¿‡å¤§çš„è¯ï¼Œå°±æœ‰å¯èƒ½é€ æˆ chunkoffset è¶…è¿‡ 32bit çš„é™åˆ¶ã€‚æ‰€ä»¥ï¼Œè¿™é‡Œé’ˆå¯¹å¤§ Video é¢å¤–åˆ›å»ºäº†ä¸€ä¸ª co64 çš„ Boxã€‚å®ƒçš„åŠŸæ•ˆç­‰ä»·äº stcoï¼Œä¹Ÿæ˜¯ç”¨æ¥è¡¨ç¤º sample åœ¨ mdat box ä¸­çš„ä½ç½®ã€‚åªæ˜¯ï¼Œé‡Œé¢ chunk_offset æ˜¯ 64bit çš„ã€‚åŸºæœ¬æ ¼å¼ä¸ºï¼š<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line"><span class="comment">// 32ä½</span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="class"><span class="keyword">class</span> <span class="title">ChunkOffsetBox</span></span></span><br><span class="line"><span class="class"><span class="title">extends</span> <span class="title">FullBox</span>(â€˜<span class="title">stco</span>â€™, <span class="title">version</span> = 0, 0) &#123;</span> </span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_count</span>;</span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">1</span>; i u entry_count; i++) &#123;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  chunk_offset</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 64ä½</span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class ChunkLargeOffsetBox extends <span class="title">FullBox</span><span class="params">(â€˜co64â€™, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span>&#123; </span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_count</span>;</span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">1</span>; i u entry_count; i++) &#123;</span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span>  chunk_offset</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MOOV-TRAK-MDIA-MINF-STBL-STSC"><a href="#MOOV-TRAK-MDIA-MINF-STBL-STSC" class="headerlink" title="MOOV::TRAK::MDIA::MINF::STBL::STSC"></a>MOOV::TRAK::MDIA::MINF::STBL::STSC</h3><p>Sample To Chunk Boxã€‚ç”¨chunkç»„ç»‡sampleå¯ä»¥æ–¹ä¾¿ä¼˜åŒ–æ•°æ®è·å–ï¼Œä¸€ä¸ªchunkåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªsampleã€‚â€œstscâ€ä¸­ç”¨ä¸€ä¸ªè¡¨æè¿°äº†sampleä¸chunkçš„æ˜ å°„å…³ç³»ï¼ŒæŸ¥çœ‹è¿™å¼ è¡¨å°±å¯ä»¥æ‰¾åˆ°åŒ…å«æŒ‡å®šsampleçš„thunkï¼Œä»è€Œæ‰¾åˆ°è¿™ä¸ªsampleï¼Œå½“ç„¶æ¯ä¸ªtable entryå¯èƒ½åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªchunkã€‚ä»¥ä¸‹æ˜¯table entryå¸ƒå±€ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180114232505.png?imageslim" alt=""><br>æ¯ä¸ªtable entryåŒ…å«ä¸€ç»„chunkï¼Œenrtyä¸­çš„æ¯ä¸ªchunkåŒ…å«ç›¸åŒæ•°ç›®çš„sampleã€‚è€Œä¸”ï¼Œè¿™äº›chunkä¸­çš„æ¯ä¸ªsampleéƒ½å¿…é¡»ä½¿ç”¨ç›¸åŒçš„sample descriptionã€‚ä»»ä½•æ—¶å€™ï¼Œå¦‚æœchunkä¸­çš„sampleæ•°ç›®æˆ–è€…sample descriptionæ”¹å˜ï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°çš„table entryã€‚å¦‚æœæ‰€æœ‰çš„chunkåŒ…å«çš„sampleæ•°ç›®ç›¸åŒï¼Œé‚£ä¹ˆè¯¥tableåªæœ‰ä¸€ä¸ªentryã€‚<br>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚å›¾ä¸­çœ‹ä¸å‡ºæ¥æ€»å…±æœ‰å¤šå°‘ä¸ªchunkï¼Œå› ä¸ºentryä¸­åªåŒ…å«ç¬¬ä¸€ä¸ªchunkå·ï¼Œå› æ­¤ï¼Œå¯¹äºæœ€åä¸€ä¸ªentryï¼Œåœ¨æŸäº›æƒ…å†µä¸‹éœ€è¦ç‰¹æ®Šçš„å¤„ç†ï¼Œå› ä¸ºæ— æ³•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™ç»“æŸã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180114232522.png?imageslim" alt=""><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="class"><span class="keyword">class</span> <span class="title">SampleToChunkBox</span></span></span><br><span class="line"><span class="class">   <span class="title">extends</span> <span class="title">FullBox</span>(â€˜<span class="title">stsc</span>â€™, <span class="title">version</span> = 0, 0) &#123;</span></span><br><span class="line">   <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  entry_count</span>;</span><br><span class="line">   <span class="keyword">for</span> (i=<span class="number">1</span>; i &lt;= entry_count; i++) &#123;</span><br><span class="line">    <span class="comment">// æ¯ä¸€ä¸ª entry å¼€å§‹çš„ chunk ä½ç½®ã€‚</span></span><br><span class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> first_chunk</span>;</span><br><span class="line">    <span class="comment">// æ¯ä¸€ä¸ª chunk é‡Œé¢åŒ…å«å¤šå°‘çš„ sample</span></span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> samples_per_chunk</span>; </span><br><span class="line">    <span class="comment">// æ¯ä¸€ä¸ª sample çš„æè¿°ã€‚ä¸€èˆ¬å¯ä»¥é»˜è®¤è®¾ç½®ä¸º 1ã€‚</span></span><br><span class="line">      <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> sample_description_index</span>;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è¿™ 3 ä¸ªå­—æ®µå®é™…ä¸Šå†³å®šäº†ä¸€ä¸ª MP4 ä¸­æœ‰å¤šå°‘ä¸ª chunksï¼Œæ¯ä¸ª chunks æœ‰å¤šå°‘ä¸ª samplesã€‚è¿™é‡Œé¡ºä¾¿æ™®åŠä¸€ä¸‹ chunk å’Œ sample çš„ç›¸å…³æ¦‚å¿µã€‚åœ¨ MP4 æ–‡ä»¶ä¸­ï¼Œæœ€å°çš„åŸºæœ¬å•ä½æ˜¯ Chunk è€Œä¸æ˜¯ Sampleã€‚</p>
<ul>
<li>sample: åŒ…å«æœ€å°å•å…ƒæ•°æ®çš„ sliceã€‚é‡Œé¢æœ‰å®é™…çš„ NAL æ•°æ®ã€‚</li>
<li>chunk: é‡Œé¢åŒ…å«çš„æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„ sampleã€‚ä¸ºäº†æ˜¯ä¼˜åŒ–æ•°æ®çš„è¯»å–ï¼Œè®© I/O æ›´æœ‰æ•ˆç‡ã€‚<br>å‰é¢è¯´äº†ï¼Œåœ¨ MP4 ä¸­æœ€å°çš„å•ä½æ˜¯ chunksï¼Œé‚£ä¹ˆé€šè¿‡ stco ä¸­å®šä¹‰çš„ chunk_offsets å­—æ®µï¼Œå®ƒæè¿°çš„å°±æ˜¯ chunks åœ¨ mdat ä¸­çš„ä½ç½®ã€‚æ¯ä¸€ä¸ª stco chunk_offset å°±å¯¹åº”äºæŸä¸€ä¸ª index çš„ chunksã€‚é‚£ä¹ˆï¼Œfirst_chunk å°±æ˜¯ç”¨æ¥å®šä¹‰è¯¥ chunk entry å¼€å§‹çš„ä½ç½®ã€‚é‚£è¿™æ ·çš„è¯ï¼Œstsc éœ€è¦å¯¹æ¯ä¸€ä¸ª chunk è¿›è¡Œå®šä¹‰å—ï¼Ÿä¸éœ€è¦ï¼Œå› ä¸º stsc æ˜¯å®šä¹‰ä¸€æ•´ä¸ª entryï¼Œå³ï¼Œå¦‚æœä»–ä»¬çš„samples_per_chunkï¼Œsample_description_index ä¸å˜çš„è¯ï¼Œé‚£ä¹ˆåç»­çš„ chunks éƒ½æ˜¯ç”¨ä¸€æ ·çš„æ¨¡å¼ã€‚<br>å³ï¼Œå¦‚æœä½ çš„ stsc åªæœ‰ï¼š<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">first_chunk: <span class="number">1</span></span><br><span class="line">samples_per_chunk: <span class="number">4</span></span><br><span class="line">sample_description_index: <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä»ç¬¬ä¸€ä¸ª chunk å¼€å§‹ï¼Œæ¯é€šè¿‡åˆ‡åˆ† 4 ä¸ª sample åˆ’åˆ†ä¸ºä¸€ä¸ª chunkï¼Œå¹¶ä¸”æ¯ä¸ª sample çš„è¡¨è¿°ä¿¡æ¯éƒ½æ˜¯ 1ã€‚å®ƒä¼šæŒ‰ç…§è¿™æ ·åˆ’åˆ†æ–¹æ³•ä¸€ç›´æŒç»­åˆ°æœ€åã€‚å½“ç„¶ï¼Œå¦‚æœä½ çš„ sample æœ€åä¸èƒ½è¢« 4 æ•´é™¤ï¼Œæœ€åçš„å‡ æ®µ sample å°±ä¼šå½“åšç‰¹ä¾‹è¿›è¡Œå¤„ç†ã€‚<br>é€šå¸¸æƒ…å†µä¸‹ï¼Œstsc çš„å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼š<br><img src="http://ouazw12mz.bkt.clouddn.com/180114232618.png?imageslim" alt=""><br>æŒ‰ç…§ä¸Šé¢çš„æƒ…å†µå°±æ˜¯ï¼Œç¬¬ 1 ä¸ª chunk åŒ…å« 2 ä¸ª samplesã€‚ç¬¬ 2-4 ä¸ª chunk åŒ…å« 1 ä¸ª sampleï¼Œç¬¬ 5 ä¸ª chunk åŒ…å«ä¸¤ä¸ª chunkï¼Œç¬¬ 6 ä¸ªåˆ°æœ€åä¸€ä¸ª chunk åŒ…å«ä¸€ä¸ª sampleã€‚</p>
<h3 id="MOOV-TRAK-MDIA-MINF-STBL-STSZ"><a href="#MOOV-TRAK-MDIA-MINF-STBL-STSZ" class="headerlink" title="MOOV::TRAK::MDIA::MINF::STBL::STSZ"></a>MOOV::TRAK::MDIA::MINF::STBL::STSZ</h3><p>Sample Size Boxesã€‚æŒ‡å®šäº†æ¯ä¸ªsampleçš„sizeã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£ä»£ç </span></span><br><span class="line">aligned(<span class="number">8</span>) <span class="function">class SampleSizeBox extends <span class="title">FullBox</span><span class="params">(â€˜stszâ€™, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span>&#123; </span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> sample_size</span>;</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> sample_count</span>;</span><br><span class="line">  <span class="keyword">if</span> (sample_size==<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>; i &lt;= sample_count; i++) &#123;</span><br><span class="line">     <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span>  entry_size</span>;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œå°±æ˜¯mp4çš„ä¸€ä¸ªå¤§è‡´çš„ç»“æ„ï¼Œä¸‹ä¸€ç¯‡æˆ‘ä¼šç»™å‡ºå‰©ä¸‹çš„ï¼Œä¹Ÿå°±æ˜¯FMP4åŒºåˆ«äºMP4çš„ç»“æ„éƒ¨åˆ†ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="http://blog.csdn.net/yu_yuan_1314/article/details/9078287" target="_blank" rel="noopener">MOVåŠMP4æ–‡ä»¶æ ¼å¼ä¸­å‡ ä¸ªé‡è¦çš„Table</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘å­¦ä¹ -flvä¹‹VideoTag(2)]]></title>
      <url>https://lucius0.github.io/2018/01/11/archivers/media-study-06/</url>
      <content type="html"><![CDATA[<p>åˆæ¬¡å­¦ä¹ æœ‰å…³éŸ³è§†é¢‘è¿™ä¸€å—çš„å¼€å‘ï¼Œä¸»è¦æ˜¯åŸºäº <strong><a href="https://github.com/Bilibili/flv.js" target="_blank" rel="noopener">flv.js</a></strong> çš„å­¦ä¹ ã€‚è¿™ä¸€å—çš„çŸ¥è¯†æ¦‚å¿µå®åœ¨æ˜¯å¤ªå¤šå¤ªæ·±äº†ï¼Œæ‰€ä»¥æœ¬äººæ˜¯å…ˆåœ¨æœ¬åœ°åšè®°å½•ï¼Œåé¢ä¼šæ•´ç†æ…¢æ…¢åœ°ä¸Šä¼ ä¸å„ä½åˆ†äº«ï¼Œå‡å¦‚æœ‰åœ°æ–¹è¯´é”™ï¼Œè¯·å‹˜è¯¯ã€‚è°¢è°¢æŒ‡ç‚¹ã€‚</p>
<p>åœ¨ä¸Šä¸€ç¯‡è®²è§£äº†å…³äºH.264çš„åŸºæœ¬æ¦‚å¿µï¼Œå¯ä»¥å¾ˆå¥½çš„ç†è§£H.264æ˜¯ä»€ä¹ˆã€‚æ¥ä¸‹æ¥å°±è®²è§£ä¸‹Flvæ ¼å¼ä¸‹çš„VideoDataã€‚</p>
<p>åœ¨ç¬¬ä¸€ç¯‡æ–‡ç« <a href="https://lucius0.github.io/2017/12/25/archivers/media-study-01/">FLVè§£æ-åˆæ­¥è®¤è¯†</a>æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œ<strong>Tag Header</strong>ä¸­çš„Typeä¸º<code>0x09</code>æ—¶è¡¨ç¤ºVideoDataï¼Œè€Œ<strong>Video Tag Data</strong>å¦‚ä¸‹å›¾ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-----------------------------------------------------------------------------------</span><br><span class="line">|                    è§†é¢‘å‚æ•°(<span class="number">8</span>bit)                 |            è§†é¢‘æ•°æ®           |</span><br><span class="line">-----------------------------------------------------------------------------------</span><br><span class="line">|     æ ‡è¯†å¸§ç±»å‹(<span class="number">4</span>bit)     |    æ ‡è¯†è§†é¢‘ç¼–ç (<span class="number">4</span>bit)     |             æ•°æ®             |</span><br><span class="line">------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure></p>
<p>è€Œè§†é¢‘å‚æ•°ä¹Ÿåœ¨ä¹‹å‰çš„æ–‡ç« æåˆ°ï¼Œåœ¨è¿™é‡Œé‡æ¸©ä¸€ä¸‹ï¼š</p>
<ul>
<li>å‰4ä½æ ‡è¯†å¸§ç±»å‹ã€‚<ul>
<li>1ï¼škeyframe (for AVC, a seekable frame)ï¼› </li>
<li>2ï¼šinter frame (for AVC, a nonseekable frame)ï¼› </li>
<li>3ï¼šdisposable inter frame (H.263 only)ï¼› </li>
<li>4ï¼šgenerated keyframe (reserved for server use only)ï¼› </li>
<li>5ï¼švideo info/command frame</li>
</ul>
</li>
<li>å4ä½æ ‡è¯†è§†é¢‘ç¼–ç ã€‚<ul>
<li>1ï¼šJPEG (currently unused) ï¼›</li>
<li>2ï¼šSorenson H.263ï¼› </li>
<li>3ï¼šScreen videoï¼› </li>
<li>4ï¼šOn2 VP6ï¼› </li>
<li>5ï¼šOn2 VP6 with alpha channelï¼›</li>
<li>6ï¼šScreen video version 2ï¼› </li>
<li>7ï¼šAVC</li>
</ul>
</li>
</ul>
<p>å…³äºæ ‡è¯†è§†é¢‘ç¼–ç ï¼Œæˆ‘ä»¬åªè¯´AVCï¼Œä¹Ÿå°±æ˜¯æ ‡è¯†è§†é¢‘ç¼–ç ä¸º7è¿™ä¸ªç¼–ç ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> frameType = (spec &amp; <span class="number">240</span>) &gt;&gt;&gt; <span class="number">4</span>; <span class="comment">// æ ‡è¯†å¸§ç±»å‹</span></span><br><span class="line"><span class="keyword">let</span> codecId = spec &amp; <span class="number">15</span>; <span class="comment">// æ ‡è¯†è§†é¢‘ç¼–ç </span></span><br><span class="line"><span class="comment">// 0x17 =&gt; frameType: 1; codecId: 7</span></span><br></pre></td></tr></table></figure></p>
<p><strong>è§†é¢‘æ•°æ®(VideoData)</strong></p>
<ul>
<li>codecId=2ï¼šH263VideoPacketï¼›</li>
<li>codecId=3ï¼šScreenVideopacketï¼›</li>
<li>codecId=4ï¼Œä¸ºVP6FLVVideoPacketï¼›</li>
<li>codecId=5ï¼Œä¸ºVP6FLVAlphaVideoPacketï¼›</li>
<li>codecId=6ï¼Œä¸ºScreenV2VideoPacketï¼›</li>
<li>codecId=7ï¼Œä¸ºAVCVideoPacketï¼ˆè¿™é‡Œæˆ‘ä»¬åªé’ˆå¯¹è¿™ä¸ªåšåˆ†æï¼‰ã€‚</li>
</ul>
<h2 id="AVCVIDEOPACKET"><a href="#AVCVIDEOPACKET" class="headerlink" title="AVCVIDEOPACKET"></a>AVCVIDEOPACKET</h2><ul>
<li>AVCPacketTypeï¼š1ä¸ªå­—èŠ‚ã€‚<ul>
<li>0x00ï¼šAVCSequence Headerï¼Œåºåˆ—å¤´ã€‚</li>
<li>0x01ï¼šAVC NALU</li>
<li>0x02ï¼šAVC end ofsequenceï¼Œåºåˆ—ç»“æŸã€‚</li>
</ul>
</li>
<li>CTS(CompostionTimes)ï¼š~SI24ï¼Œæœ‰ç¬¦å·24ä½æ•´æ•°~ã€‚å¦‚æœAVCPacketTypeä¸ºAVC NALUï¼Œ ä¸ºç›¸å¯¹æ—¶é—´æˆ³ï¼›å¦åˆ™ä¸º0ã€‚<br>  <strong>è§£é‡Šï¼š</strong>åœ¨<strong>Tag Header</strong>é‡Œæ‹¿åˆ°è¿‡ä¸€ä¸ª <code>timestamp</code>ï¼Œè¿™ä¸ªåœ¨è§†é¢‘é‡Œå¯¹åº”äºDTS(decoder timestamps)ï¼Œå°±æ˜¯è§£ç æ—¶é—´æˆ³ï¼Œè€ŒCTSå®é™…ä¸Šæ˜¯ä¸€ä¸ªoffsetï¼Œè¡¨ç¤º PTSç›¸å¯¹äºDTSçš„åç§»é‡ï¼Œå°±æ˜¯ PTSå’ŒDTSçš„å·®å€¼ã€‚å½“å¸¦æœ‰Bå¸§çš„Nalusæµå°è£…åï¼Œå†æ¬¡è§£ç æ˜¾ç¤ºï¼Œæ­¤æ—¶PTS å’Œ DTS ä¸èƒ½ä¸€ä¸€å¯¹åº”ï¼Œå› ä¸ºBå¸§çš„æ—¶é—´æˆ³å°äºPå¸§ï¼Œæ­¤æ—¶CTS å¯ä»¥è®°å½•è¿™ä¸ªåå·®ï¼Œç”¨ä»¥å›å¤è§£ç çš„æ—¶é—´æˆ³ã€‚<a href="http://l.web.umkc.edu/lizhu/teaching/2016sp.video-communication/ref/mp4.pdf" target="_blank" rel="noopener">ISO 14496-12 8.15.3</a></li>
<li>Dataï¼šnä¸ªå­—èŠ‚ã€‚ä¸ºè´Ÿè½½æ•°æ®ã€‚<ul>
<li>AVCPacketType=0x00ï¼šDataä¸ºAVCDecorderConfigurationRecord(åœ¨ ISO/IEC 14496-15 ä¸­å®šä¹‰)ï¼Œå³è§£ç å™¨é…ç½®ï¼ŒSPSï¼ŒPPSã€‚</li>
<li>AVCPacketType=0x01ï¼šNALUs</li>
<li>AVCPacketType=0x02ï¼šç©º</li>
</ul>
</li>
</ul>
<p>ä»£ç å¦‚ä¸‹ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> packetType = v.getUint8(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">let</span> cts = v.getUint32(<span class="number">0</span>, !le) &amp; <span class="number">0x00FFFFFF</span>; <span class="comment">// è¿™é‡Œä¸ºä»€ä¹ˆæ˜¯getUint32ï¼Œåœ¨å®˜æ–¹æ–‡æ¡£ä¸­ï¼Œä¸æ˜¯SI24å—ï¼Ÿ@1</span></span><br><span class="line"></span><br><span class="line">@<span class="number">1</span>: è¿™é‡Œåœ¨åæ¥çš„v1<span class="number">.3</span><span class="number">.4</span>ç‰ˆæœ¬ä½œè€…æ”¹äº†ï¼Œåšäº†ä»¥ä¸‹å¤„ç†ã€‚</span><br><span class="line"><span class="keyword">let</span> cts_unsigned = v.getUint32(<span class="number">0</span>, !le) &amp; <span class="number">0x00FFFFFF</span>;</span><br><span class="line"><span class="keyword">let</span> cts = (cts_unsigned &lt;&lt; <span class="number">8</span>) &gt;&gt; <span class="number">8</span>;  <span class="comment">// convert to 24-bit signed int</span></span><br></pre></td></tr></table></figure></p>
<p><strong>æ³¨æ„ï¼š</strong> </p>
<blockquote>
<p>FLV æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ª <strong>Video Tag</strong> çš„<strong>Video Data</strong> çš„<strong>AVCVIDEOPACKET</strong> çš„ Data æ€»æ˜¯ <strong>AVCDecoderConfigurationRecord</strong>ï¼Œè·Ÿ<strong>Audio Tag</strong>çš„ <strong>AAC sequence header</strong> å¦‚å‡ºä¸€è¾™ï¼Œå‰è€…æ˜¯VideoMetaï¼Œåè€…åˆ™æ˜¯AudioMetaã€‚å› æ­¤ç¬¬ä¸€ä¸ª<strong>Video Tag</strong>çš„äºŒè¿›åˆ¶æ–‡ä»¶ä½ å¯ä»¥çœ‹åˆ°æ˜¯è¿™æ ·çš„ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹äºŒè¿›åˆ¶ç‰‡æ®µ</span></span><br><span class="line"><span class="number">0900002</span>A <span class="number">00000000</span> <span class="number">00000017</span> <span class="number">00000000</span> <span class="number">014</span>D401F FFE10016 <span class="number">674</span>D401F </span><br><span class="line">DA014016 E8400000 <span class="number">03004000</span> <span class="number">000</span>C83C6 <span class="number">0</span>CA80100 <span class="number">0468</span>EF3C <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 0x17: è§†é¢‘å‚æ•°</span></span><br><span class="line"><span class="comment">// 0x00: åºåˆ—å¤´</span></span><br><span class="line"><span class="comment">// 0x0000 00: CTS</span></span><br><span class="line"><span class="comment">// ...: Data</span></span><br></pre></td></tr></table></figure>
<h3 id="AVCDecorderConfigurationRecord"><a href="#AVCDecorderConfigurationRecord" class="headerlink" title="AVCDecorderConfigurationRecord"></a>AVCDecorderConfigurationRecord</h3><p>H.264çš„è§†é¢‘ä¿¡æ¯å¤´ï¼ŒåŒ…å«äº†SPS(SequenceParameterSets)ä»¥åŠPPS(PictureParameterSets)ï¼Œè¯¥ä¿¡æ¯ä¸ºH.264çš„æ ‡å‡†ã€‚ä¸‹é¢æ˜¯æ•°æ®ç»“æ„ä»£ç ï¼š<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">aligned(<span class="number">8</span>) <span class="class"><span class="keyword">class</span> <span class="title">AVCDecoderConfigurationRecord</span> &#123;</span></span><br><span class="line">  <span class="comment">// ç‰ˆæœ¬å·</span></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">8</span>)</span> configurationVersion </span>= <span class="number">1</span>;</span><br><span class="line">  <span class="comment">// SPS[1]</span></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">8</span>)</span> AVCProfileIndication</span>;</span><br><span class="line">  <span class="comment">// SPS[2]</span></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">8</span>)</span> profile_compatibility</span>;</span><br><span class="line">  <span class="comment">// SPS[3]</span></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">8</span>)</span> AVCLevelIndication</span>;</span><br><span class="line">  bit(<span class="number">6</span>) reserved = â€˜<span class="number">111111</span>â€™b;</span><br><span class="line">  <span class="comment">// H.264 è§†é¢‘ä¸­ NALU çš„é•¿åº¦ï¼Œè®¡ç®—æ–¹æ³•æ˜¯ 1 + (lengthSizeMinusOne &amp; 3)</span></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">2</span>)</span> lengthSizeMinusOne</span>;</span><br><span class="line">  bit(<span class="number">3</span>) reserved = â€˜<span class="number">111</span>â€™b;</span><br><span class="line">  <span class="comment">// SPS çš„é•¿åº¦ï¼Œè®¡ç®—æ–¹æ³•æ˜¯ numOfSequenceParameterSets &amp; 0x1F</span></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">5</span>)</span> numOfSequenceParameterSets</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; numOfSequenceParameterSets; i++) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> sequenceParameterSetLength</span>;</span><br><span class="line">    bit(<span class="number">8</span> * sequenceParameterSetLength) sequenceParameterSetNALUnit;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">8</span>)</span> numOfPictureParameterSets</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; numOfPictureParameterSets; i++) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> pictureParameterSetLength</span>;</span><br><span class="line">    bit(<span class="number">8</span> * pictureParameterSetLength) pictureParameterSetNALUnit;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å› æ­¤ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­çš„Dataéƒ¨åˆ†åº”ä¸ºï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹äºŒè¿›åˆ¶ç‰‡æ®µ</span></span><br><span class="line"><span class="number">0900002</span>A <span class="number">00000000</span> <span class="number">00000017</span> <span class="number">00000000</span> <span class="number">014</span>D401F FFE10016 <span class="number">674</span>D401F </span><br><span class="line">DA014016 E8400000 <span class="number">03004000</span> <span class="number">000</span>C83C6 <span class="number">0</span>CA80100 <span class="number">0468</span>EF3C <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 0x01: configurationVersion</span></span><br><span class="line"><span class="comment">// 0x4D: AVCProfileIndication</span></span><br><span class="line"><span class="comment">//       enum profile_e &#123; // AVCProfileIndication</span></span><br><span class="line"><span class="comment">//          PROFILE_BASELINE = 66,</span></span><br><span class="line"><span class="comment">//          PROFILE_MAIN     = 77,</span></span><br><span class="line"><span class="comment">//          PROFILE_HIGH    = 100,</span></span><br><span class="line"><span class="comment">//          PROFILE_HIGH10  = 110,</span></span><br><span class="line"><span class="comment">//          PROFILE_HIGH422 = 122,</span></span><br><span class="line"><span class="comment">//          PROFILE_HIGH444_PREDICTIVE = 244,</span></span><br><span class="line"><span class="comment">//      &#125;;</span></span><br><span class="line"><span class="comment">// 0x40: profile_compatibility</span></span><br><span class="line"><span class="comment">// 0x1F: AVCLevelIndication</span></span><br><span class="line"><span class="comment">// ç”¨äºå£°æ˜H.264çš„levelã€‚levelå†³å®šäº†è§£ç å™¨çš„è§£ç èƒ½åŠ›ï¼Œå³æœ€å¤§å¤šå¤§çš„åˆ†è¾¨ç‡ã€å¸§ç‡ã€ç ç‡ã€‚å®é™…è®¾ç½®æ—¶ï¼Œå°±æ˜¯levelå€¼ä¹˜ä»¥10ï¼Œä¾‹å¦‚level 1.0ï¼Œè®¾ç½®å€¼å°±æ˜¯0x0Aã€‚level 3.0ï¼Œè®¾ç½®å€¼å°±æ˜¯0x1Eã€‚æ¯”è¾ƒä¾‹å¤–çš„æ˜¯level 1bï¼Œè®¾ç½®å€¼æ˜¯0x09</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 0xFF: 6bits(111111) reserved &amp; lengthSizeMinusOne=4</span></span><br><span class="line"><span class="comment">// 0xE1: 3bits(111) reserved &amp; numOfSequenceParameterSets=1</span></span><br><span class="line"><span class="comment">// 0x0016: sequenceParameterSetLength=22</span></span><br><span class="line"><span class="comment">// 0x674D ~ 0CA8: sequenceParameterSetNALUnit</span></span><br><span class="line"><span class="comment">// 0x01: numOfPictureParameterSets=1</span></span><br><span class="line"><span class="comment">// 0x0004: pictureParameterSetLength=4</span></span><br><span class="line"><span class="comment">// 0x68EF3C 80: pictureParameterSetNALUnit</span></span><br></pre></td></tr></table></figure>
<h2 id="SPS-amp-PPS"><a href="#SPS-amp-PPS" class="headerlink" title="SPS &amp; PPS"></a>SPS &amp; PPS</h2><p>SPSï¼šåŒ…å«äº†åˆå§‹åŒ–H.264è§£ç å™¨æ‰€éœ€è¦çš„ä¿¡æ¯å‚æ•°ï¼ŒåŒ…æ‹¬ç¼–ç æ‰€ç”¨çš„profileï¼Œlevelï¼Œè§†é¢‘åˆ†è¾¨ç‡ï¼Œå¸§ç‡ï¼Œå›¾åƒé‡‡æ ·æ–¹å¼ç­‰ã€‚</p>
<p>PPSï¼šä¸€èˆ¬æ²¡ä»€ä¹ˆç”¨ï¼Œæ²¡æœ‰ä»»ä½•å¯ä»¥å–ç”¨çš„è§†é¢‘ä¿¡æ¯ã€‚<br>å…³äºSPSParserè¿™ä¸€å—ï¼Œå¯ä»¥å‚è€ƒé›·æ•™ä¸»çš„<a href="http://blog.csdn.net/leixiaohua1020/article/details/45001033" target="_blank" rel="noopener">FFmpegçš„H.264è§£ç å™¨æºä»£ç ç®€å•åˆ†æï¼šè§£æå™¨ï¼ˆParserï¼‰</a>ä¸­çš„<code>ff_h264_decode_seq_parameter_set</code></p>
<h2 id="AVCVideoData"><a href="#AVCVideoData" class="headerlink" title="AVCVideoData"></a>AVCVideoData</h2><p>ç”±ä¸Šæ–‡çš„ï¼Œ<code>lengthSizeMinusOne</code>å¯çŸ¥ï¼ŒNALåŒ…é•¿åº¦ä¸º4ï¼Œæ‰€ä»¥å‰é¢4ä¸ªå­—èŠ‚æ˜¯é•¿åº¦ã€‚ç¬¬5ä¸ªå­—èŠ‚çš„å‰äº”ä½ä¸ºNALåŒ…çš„ç±»å‹ï¼Œå¦‚ä¸‹ï¼š</p>
<ul>
<li>NALU_TYPE_SLICE 1</li>
<li>NALU_TYPE_DPA 2</li>
<li>NALU_TYPE_DPB 3</li>
<li>NALU_TYPE_DPC 4</li>
<li>NALU_TYPE_IDR 5</li>
<li>NALU_TYPE_SEI 6</li>
<li>NALU_TYPE_SPS 7</li>
<li>NALU_TYPE_PPS 8</li>
<li>NALU_TYPE_AUD 9 // è®¿é—®åˆ†éš”ç¬¦</li>
<li>NALU_TYPE_EOSEQ 10</li>
<li>NALU_TYPE_EOSTREAM 11</li>
<li>NALU_TYPE_FILL 12<br>å› æ­¤å‰é¢è§£æçš„æ—¶å€™ï¼ŒSPSå¤´å­—èŠ‚ä¸º67ï¼Œ<code>0x67 &amp; 0x1F</code>ä¸º7ï¼›PPSå¤´å­—èŠ‚ä¸º68ï¼Œ<code>0x68 &amp; 0x1F</code>ä¸º8ã€‚<code>0x6F &amp; 0x1F</code>ä¸º5ï¼ŒIå¸§ï¼›<code>0x41 &amp; 0x1F</code>ä¸º1ï¼ŒPå¸§ã€‚<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹äºŒè¿›åˆ¶ç‰‡æ®µ</span></span><br><span class="line"><span class="comment">// Video Tag Data</span></span><br><span class="line"><span class="number">17010000</span> <span class="number">0000023</span>E <span class="number">66658882</span> <span class="number">02</span>BFF89C F12749F8 <span class="number">097290</span>A6 </span><br><span class="line">F881DD1A <span class="number">8E65</span>A5B4 <span class="number">89922</span>C82 B31F13D4 <span class="number">1E6</span>F996B DCCC7828 ...</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0x17010000 00: ä¸Šæ–‡æœ‰ä»‹ç»ï¼ŒVideo Tagå‚æ•°ä¹‹ç±»çš„</span></span><br><span class="line"><span class="comment">// 0x00023E 66: NAL length=147046</span></span><br><span class="line"><span class="comment">// 0x65: 0x6F &amp; 0x1F=5ï¼ŒIå¸§</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>ç›®å‰ä¸ºæ­¢ï¼Œflvçš„æ ¼å¼åˆ†æå·²ç»ç»“æŸã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="https://en.wikipedia.org/wiki/H.264/MPEG-4_AVC" target="_blank" rel="noopener">H.264/MPEG-4 AVC - Wikipedia</a></li>
<li><a href="https://www.adobe.com/content/dam/acom/en/devnet/flv/video_file_format_spec_v10.pdf" target="_blank" rel="noopener">video_file_format_spec_v10</a>ï¼›</li>
<li><a href="http://guoh.org/lifelog/2013/10/exp-golomb-coding/" target="_blank" rel="noopener">Exponential-Golomb coding â€“ å¤å¤©äººå­—æ‹–</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘å­¦ä¹ -flvä¹‹VideoTag(1)[è½¬]]]></title>
      <url>https://lucius0.github.io/2018/01/08/archivers/media-study-05/</url>
      <content type="html"><![CDATA[<p>åˆæ¬¡å­¦ä¹ æœ‰å…³éŸ³è§†é¢‘è¿™ä¸€å—çš„å¼€å‘ï¼Œä¸»è¦æ˜¯åŸºäº <strong><a href="https://github.com/Bilibili/flv.js" target="_blank" rel="noopener">flv.js</a></strong> çš„å­¦ä¹ ã€‚è¿™ä¸€å—çš„çŸ¥è¯†æ¦‚å¿µå®åœ¨æ˜¯å¤ªå¤šå¤ªæ·±äº†ï¼Œæ‰€ä»¥æœ¬äººæ˜¯å…ˆåœ¨æœ¬åœ°åšè®°å½•ï¼Œåé¢ä¼šæ•´ç†æ…¢æ…¢åœ°ä¸Šä¼ ä¸å„ä½åˆ†äº«ï¼Œå‡å¦‚æœ‰åœ°æ–¹è¯´é”™ï¼Œè¯·å‹˜è¯¯ã€‚è°¢è°¢æŒ‡ç‚¹ã€‚</p>
<p>è¿™é‡Œä¸»è¦è®²çš„æ˜¯FLVçš„è§†é¢‘æ ¼å¼H.264ï¼Œè€ŒH.264è·ŸMPEG-4 Part 10ã€ISO/IEC 14496-10ã€MPEG-4 AVCå…¶å®éƒ½æ˜¯åŒä¸€ä¸ªè§†é¢‘æ ¼å¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„H.264æˆ–AVCã€‚é‚£ä¹ˆæˆ‘ä»¬å¸¸è¯´çš„MPEG-4å…¶å®æ˜¯æŒ‡MPEG-4 Part 2(æ³¨æ„è·ŸMPEG-2æ˜¯ä¸¤ä¸ªæ¦‚å¿µ)ã€‚æ›´å¤šçš„ç»†èŠ‚å¯ä»¥æŸ¥çœ‹<a href="https://zh.wikipedia.org/wiki/MPEG-4" target="_blank" rel="noopener">MPEG-4 - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦</a>ã€<a href="https://zh.wikipedia.org/wiki/H.264/MPEG-4_AVC" target="_blank" rel="noopener">H.264/MPEG-4 AVC - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦</a>ã€‚æ€»çš„æ¥è®²ï¼ŒH.264å…·æœ‰é«˜å‹ç¼©æ¯”ï¼ŒåŒæ—¶ä¹Ÿå¯¹ç½‘ç»œçš„å…¼å®¹æ€§å¥½ã€‚</p>
<p>ä»¥ä¸‹å†…å®¹è½¬è‡ª<a href="https://maxwellqi.github.io/ios-h264-summ/" target="_blank" rel="noopener">H.264ç æµä»¥åŠH.264ç¼–è§£ç çš„åŸºæœ¬æ¦‚å¿µ</a>ã€‚</p>
<h2 id="è½¯ç¼–ç å’Œç¡¬ç¼–ç çš„æ¦‚å¿µ"><a href="#è½¯ç¼–ç å’Œç¡¬ç¼–ç çš„æ¦‚å¿µ" class="headerlink" title="è½¯ç¼–ç å’Œç¡¬ç¼–ç çš„æ¦‚å¿µ"></a>è½¯ç¼–ç å’Œç¡¬ç¼–ç çš„æ¦‚å¿µ</h2><p>è½¯ç¼–ç ï¼šä½¿ç”¨CPUè¿›è¡Œç¼–ç ã€‚</p>
<p>ç¡¬ç¼–ç ï¼šä¸ä½¿ç”¨CPUè¿›è¡Œç¼–ç ï¼Œä½¿ç”¨æ˜¾å¡GPU,ä¸“ç”¨çš„DSPã€FPGAã€ASICèŠ¯ç‰‡ç­‰ç¡¬ä»¶è¿›è¡Œç¼–ç ã€‚</p>
<h2 id="è½¯ç¼–ç å’Œç¡¬ç¼–ç çš„æ¯”è¾ƒ"><a href="#è½¯ç¼–ç å’Œç¡¬ç¼–ç çš„æ¯”è¾ƒ" class="headerlink" title="è½¯ç¼–ç å’Œç¡¬ç¼–ç çš„æ¯”è¾ƒ"></a>è½¯ç¼–ç å’Œç¡¬ç¼–ç çš„æ¯”è¾ƒ</h2><p>è½¯ç¼–ç ï¼šå®ç°ç›´æ¥ã€ç®€å•ï¼Œå‚æ•°è°ƒæ•´æ–¹ä¾¿ï¼Œå‡çº§æ˜“ï¼Œä½†CPUè´Ÿè½½é‡ï¼Œæ€§èƒ½è¾ƒç¡¬ç¼–ç ä½ï¼Œä½ç ç‡ä¸‹è´¨é‡é€šå¸¸æ¯”ç¡¬ç¼–ç è¦å¥½ä¸€ç‚¹ã€‚</p>
<p>ç¡¬ç¼–ç ï¼šæ€§èƒ½é«˜ï¼Œä½ç ç‡ä¸‹é€šå¸¸è´¨é‡ä½äºç¡¬ç¼–ç å™¨ï¼Œä½†éƒ¨åˆ†äº§å“åœ¨GPUç¡¬ä»¶å¹³å°ç§»æ¤äº†ä¼˜ç§€çš„è½¯ç¼–ç ç®—æ³•ï¼ˆå¦‚X264ï¼‰çš„ï¼Œè´¨é‡åŸºæœ¬ç­‰åŒäºè½¯ç¼–ç ã€‚</p>
<h2 id="H-264ç¼–ç åŸç†ä»¥åŠIå¸§Bå¸§På¸§"><a href="#H-264ç¼–ç åŸç†ä»¥åŠIå¸§Bå¸§På¸§" class="headerlink" title="H.264ç¼–ç åŸç†ä»¥åŠIå¸§Bå¸§På¸§"></a>H.264ç¼–ç åŸç†ä»¥åŠIå¸§Bå¸§På¸§</h2><h3 id="H-264ç¼–ç åŸç†"><a href="#H-264ç¼–ç åŸç†" class="headerlink" title="H.264ç¼–ç åŸç†"></a>H.264ç¼–ç åŸç†</h3><p>H264æ˜¯æ–°ä¸€ä»£çš„ç¼–ç æ ‡å‡†ï¼Œä»¥é«˜å‹ç¼©é«˜è´¨é‡å’Œæ”¯æŒå¤šç§ç½‘ç»œçš„æµåª’ä½“ä¼ è¾“è‘—ç§°ï¼Œåœ¨ç¼–ç æ–¹é¢ï¼Œæˆ‘ç†è§£çš„ä»–çš„ç†è®ºä¾æ®æ˜¯ï¼šå‚ç…§ä¸€æ®µæ—¶é—´å†…å›¾åƒçš„ç»Ÿè®¡ç»“æœè¡¨æ˜ï¼Œåœ¨ç›¸é‚»å‡ å¹…å›¾åƒç”»é¢ä¸­ï¼Œä¸€èˆ¬æœ‰å·®åˆ«çš„åƒç´ åªæœ‰10%ä»¥å†…çš„ç‚¹,äº®åº¦å·®å€¼å˜åŒ–ä¸è¶…è¿‡2%ï¼Œè€Œè‰²åº¦å·®å€¼çš„å˜åŒ–åªæœ‰1%ä»¥å†…ã€‚æ‰€ä»¥å¯¹äºä¸€æ®µå˜åŒ–ä¸å¤§å›¾åƒç”»é¢ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç¼–ç å‡ºä¸€ä¸ªå®Œæ•´çš„å›¾åƒå¸§Aï¼Œéšåçš„Bå¸§å°±ä¸ç¼–ç å…¨éƒ¨å›¾åƒï¼Œåªå†™å…¥ä¸Aå¸§çš„å·®åˆ«ï¼Œè¿™æ ·Bå¸§çš„å¤§å°å°±åªæœ‰å®Œæ•´å¸§çš„1/10æˆ–æ›´å°ï¼Bå¸§ä¹‹åçš„Cå¸§å¦‚æœå˜åŒ–ä¸å¤§ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ä»¥å‚è€ƒBçš„æ–¹å¼ç¼–ç Cå¸§ï¼Œè¿™æ ·å¾ªç¯ä¸‹å»ã€‚è¿™æ®µå›¾åƒæˆ‘ä»¬ç§°ä¸ºä¸€ä¸ªåºåˆ—ï¼ˆåºåˆ—å°±æ˜¯æœ‰ç›¸åŒç‰¹ç‚¹çš„ä¸€æ®µæ•°æ®ï¼‰ï¼Œå½“æŸä¸ªå›¾åƒä¸ä¹‹å‰çš„å›¾åƒå˜åŒ–å¾ˆå¤§ï¼Œæ— æ³•å‚è€ƒå‰é¢çš„å¸§æ¥ç”Ÿæˆï¼Œé‚£æˆ‘ä»¬å°±ç»“æŸä¸Šä¸€ä¸ªåºåˆ—ï¼Œå¼€å§‹ä¸‹ä¸€æ®µåºåˆ—ï¼Œä¹Ÿå°±æ˜¯å¯¹è¿™ä¸ªå›¾åƒç”Ÿæˆä¸€ä¸ªå®Œæ•´å¸§A1ï¼Œéšåçš„å›¾åƒå°±å‚è€ƒA1ç”Ÿæˆï¼Œåªå†™å…¥ä¸A1çš„å·®åˆ«å†…å®¹ã€‚</p>
<p>åœ¨H264åè®®é‡Œå®šä¹‰äº†ä¸‰ç§å¸§ï¼Œå®Œæ•´ç¼–ç çš„å¸§å«Iå¸§ï¼Œå‚è€ƒä¹‹å‰çš„Iå¸§ç”Ÿæˆçš„åªåŒ…å«å·®å¼‚éƒ¨åˆ†ç¼–ç çš„å¸§å«På¸§ï¼Œè¿˜æœ‰ä¸€ç§å‚è€ƒå‰åçš„å¸§ç¼–ç çš„å¸§å«Bå¸§ã€‚</p>
<p>H264é‡‡ç”¨çš„æ ¸å¿ƒç®—æ³•æ˜¯å¸§å†…å‹ç¼©å’Œå¸§é—´å‹ç¼©ï¼Œå¸§å†…å‹ç¼©æ˜¯ç”ŸæˆIå¸§çš„ç®—æ³•ï¼Œå¸§é—´å‹ç¼©æ˜¯ç”ŸæˆBå¸§å’ŒPå¸§çš„ç®—æ³•ã€‚</p>
<h3 id="å¯¹åºåˆ—çš„è¯´æ˜"><a href="#å¯¹åºåˆ—çš„è¯´æ˜" class="headerlink" title="å¯¹åºåˆ—çš„è¯´æ˜"></a>å¯¹åºåˆ—çš„è¯´æ˜</h3><p>åœ¨H264ä¸­å›¾åƒä»¥åºåˆ—ä¸ºå•ä½è¿›è¡Œç»„ç»‡ï¼Œä¸€ä¸ªåºåˆ—æ˜¯ä¸€æ®µå›¾åƒç¼–ç åçš„æ•°æ®æµï¼Œä»¥Iå¸§å¼€å§‹ï¼Œåˆ°ä¸‹ä¸€ä¸ªIå¸§ç»“æŸã€‚<br>ä¸€ä¸ªåºåˆ—çš„ç¬¬ä¸€ä¸ªå›¾åƒå«åš IDR å›¾åƒï¼ˆç«‹å³åˆ·æ–°å›¾åƒï¼‰ï¼ŒIDR å›¾åƒéƒ½æ˜¯ I å¸§å›¾åƒã€‚H.264 å¼•å…¥ IDR å›¾åƒæ˜¯ä¸ºäº†è§£ç çš„é‡åŒæ­¥ï¼Œå½“è§£ç å™¨è§£ç åˆ° IDR å›¾åƒæ—¶ï¼Œç«‹å³å°†å‚è€ƒå¸§é˜Ÿåˆ—æ¸…ç©ºï¼Œå°†å·²è§£ç çš„æ•°æ®å…¨éƒ¨è¾“å‡ºæˆ–æŠ›å¼ƒï¼Œé‡æ–°æŸ¥æ‰¾å‚æ•°é›†ï¼Œå¼€å§‹ä¸€ä¸ªæ–°çš„åºåˆ—ã€‚è¿™æ ·ï¼Œå¦‚æœå‰ä¸€ä¸ªåºåˆ—å‡ºç°é‡å¤§é”™è¯¯ï¼Œåœ¨è¿™é‡Œå¯ä»¥è·å¾—é‡æ–°åŒæ­¥çš„æœºä¼šã€‚IDRå›¾åƒä¹‹åçš„å›¾åƒæ°¸è¿œä¸ä¼šä½¿ç”¨IDRä¹‹å‰çš„å›¾åƒçš„æ•°æ®æ¥è§£ç ã€‚<br>ä¸€ä¸ªåºåˆ—å°±æ˜¯ä¸€æ®µå†…å®¹å·®å¼‚ä¸å¤ªå¤§çš„å›¾åƒç¼–ç åç”Ÿæˆçš„ä¸€ä¸²æ•°æ®æµã€‚å½“è¿åŠ¨å˜åŒ–æ¯”è¾ƒå°‘æ—¶ï¼Œä¸€ä¸ªåºåˆ—å¯ä»¥å¾ˆé•¿ï¼Œå› ä¸ºè¿åŠ¨å˜åŒ–å°‘å°±ä»£è¡¨å›¾åƒç”»é¢çš„å†…å®¹å˜åŠ¨å¾ˆå°ï¼Œæ‰€ä»¥å°±å¯ä»¥ç¼–ä¸€ä¸ªIå¸§ï¼Œç„¶åä¸€ç›´På¸§ã€Bå¸§äº†ã€‚å½“è¿åŠ¨å˜åŒ–å¤šæ—¶ï¼Œå¯èƒ½ä¸€ä¸ªåºåˆ—å°±æ¯”è¾ƒçŸ­äº†ï¼Œæ¯”å¦‚å°±åŒ…å«ä¸€ä¸ªIå¸§å’Œ3ã€4ä¸ªPå¸§ã€‚</p>
<h3 id="å¯¹ä¸‰ç§å¸§çš„ä»‹ç»"><a href="#å¯¹ä¸‰ç§å¸§çš„ä»‹ç»" class="headerlink" title="å¯¹ä¸‰ç§å¸§çš„ä»‹ç»"></a>å¯¹ä¸‰ç§å¸§çš„ä»‹ç»</h3><ul>
<li><p><strong>Iå¸§</strong><br>ä¸ºäº†æ›´å¥½åœ°ç†è§£Iå¸§çš„æ¦‚å¿µï¼Œæˆ‘ç½—åˆ—äº†ä¸¤ç§è§£é‡Šï¼š</p>
<ul>
<li>å¸§å†…ç¼–ç å¸§ ï¼ŒIå¸§è¡¨ç¤ºå…³é”®å¸§ï¼Œä½ å¯ä»¥ç†è§£ä¸ºè¿™ä¸€å¸§ç”»é¢çš„å®Œæ•´ä¿ç•™ï¼›è§£ç æ—¶åªéœ€è¦æœ¬å¸§æ•°æ®å°±å¯ä»¥å®Œæˆï¼ˆå› ä¸ºåŒ…å«å®Œæ•´ç”»é¢ï¼‰ã€‚</li>
<li><p>å¸§å†…ç¼–ç å¸§ åˆç§°intra pictureï¼ŒI å¸§é€šå¸¸æ˜¯æ¯ä¸ª GOPï¼ˆMPEG æ‰€ä½¿ç”¨çš„ä¸€ç§è§†é¢‘å‹ç¼©æŠ€æœ¯ï¼‰çš„ç¬¬ä¸€ä¸ªå¸§ï¼Œç»è¿‡é€‚åº¦åœ°å‹ç¼©ï¼Œåšä¸ºéšæœºè®¿é—®çš„å‚è€ƒç‚¹ï¼Œå¯ä»¥å½“æˆå›¾è±¡ã€‚Iå¸§å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªå›¾åƒç»è¿‡å‹ç¼©åçš„äº§ç‰©ã€‚</p>
<p><strong>Iå¸§çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å®ƒæ˜¯ä¸€ä¸ªå…¨å¸§å‹ç¼©ç¼–ç å¸§ã€‚å®ƒå°†å…¨å¸§å›¾åƒä¿¡æ¯è¿›è¡ŒJPEGå‹ç¼©ç¼–ç åŠä¼ è¾“</li>
<li>è§£ç æ—¶ä»…ç”¨Iå¸§çš„æ•°æ®å°±å¯é‡æ„å®Œæ•´å›¾åƒ</li>
<li>Iå¸§æè¿°äº†å›¾åƒèƒŒæ™¯å’Œè¿åŠ¨ä¸»ä½“çš„è¯¦æƒ…</li>
<li>Iå¸§ä¸éœ€è¦å‚è€ƒå…¶ä»–ç”»é¢è€Œç”Ÿæˆ</li>
<li>Iå¸§æ˜¯På¸§å’ŒBå¸§çš„å‚è€ƒå¸§(å…¶è´¨é‡ç›´æ¥å½±å“åˆ°åŒç»„ä¸­ä»¥åå„å¸§çš„è´¨é‡)</li>
<li>Iå¸§æ˜¯å¸§ç»„GOPçš„åŸºç¡€å¸§(ç¬¬ä¸€å¸§),åœ¨ä¸€ç»„ä¸­åªæœ‰ä¸€ä¸ªIå¸§</li>
<li>Iå¸§ä¸éœ€è¦è€ƒè™‘è¿åŠ¨çŸ¢é‡</li>
<li>Iå¸§æ‰€å æ•°æ®çš„ä¿¡æ¯é‡æ¯”è¾ƒå¤§</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>På¸§</strong><br>ä¸ºäº†æ›´å¥½åœ°ç†è§£På¸§çš„æ¦‚å¿µï¼Œæˆ‘ä¹Ÿç½—åˆ—äº†ä¸¤ç§è§£é‡Šï¼š</p>
<ul>
<li>å‰å‘é¢„æµ‹ç¼–ç å¸§ã€‚På¸§è¡¨ç¤ºçš„æ˜¯è¿™ä¸€å¸§è·Ÿä¹‹å‰çš„ä¸€ä¸ªå…³é”®å¸§ï¼ˆæˆ–På¸§ï¼‰çš„å·®åˆ«ï¼Œè§£ç æ—¶éœ€è¦ç”¨ä¹‹å‰ç¼“å­˜çš„ç”»é¢å åŠ ä¸Šæœ¬å¸§å®šä¹‰çš„å·®åˆ«ï¼Œç”Ÿæˆæœ€ç»ˆç”»é¢ã€‚ï¼ˆä¹Ÿå°±æ˜¯å·®åˆ«å¸§ï¼ŒPå¸§æ²¡æœ‰å®Œæ•´ç”»é¢æ•°æ®ï¼Œåªæœ‰ä¸å‰ä¸€å¸§çš„ç”»é¢å·®åˆ«çš„æ•°æ®ï¼‰</li>
<li><p>å‰å‘é¢„æµ‹ç¼–ç å¸§ åˆç§°predictive-frameï¼Œé€šè¿‡å……åˆ†å°†ä½äºå›¾åƒåºåˆ—ä¸­å‰é¢å·²ç¼–ç å¸§çš„æ—¶é—´å†—ä½™ä¿¡æ¯æ¥å‹ç¼©ä¼ è¾“æ•°æ®é‡çš„ç¼–ç å›¾åƒï¼Œä¹Ÿå«é¢„æµ‹å¸§</p>
<p><strong>På¸§çš„é¢„æµ‹ä¸é‡æ„ï¼š</strong>På¸§æ˜¯ä»¥Iå¸§ä¸ºå‚è€ƒå¸§,åœ¨Iå¸§ä¸­æ‰¾å‡ºPå¸§â€œæŸç‚¹â€çš„é¢„æµ‹å€¼å’Œè¿åŠ¨çŸ¢é‡,å–é¢„æµ‹å·®å€¼å’Œè¿åŠ¨çŸ¢é‡ä¸€èµ·ä¼ é€ã€‚åœ¨æ¥æ”¶ç«¯æ ¹æ®è¿åŠ¨çŸ¢é‡ä»Iå¸§ä¸­æ‰¾å‡ºPå¸§â€œæŸç‚¹â€çš„é¢„æµ‹å€¼å¹¶ä¸å·®å€¼ç›¸åŠ ä»¥å¾—åˆ°På¸§â€œæŸç‚¹â€æ ·å€¼,ä»è€Œå¯å¾—åˆ°å®Œæ•´çš„På¸§ã€‚</p>
<p><strong>På¸§ç‰¹ç‚¹:</strong></p>
<ul>
<li>På¸§æ˜¯Iå¸§åé¢ç›¸éš”1~2å¸§çš„ç¼–ç å¸§</li>
<li>På¸§é‡‡ç”¨è¿åŠ¨è¡¥å¿çš„æ–¹æ³•ä¼ é€å®ƒä¸å‰é¢çš„Iæˆ–På¸§çš„å·®å€¼åŠè¿åŠ¨çŸ¢é‡(é¢„æµ‹è¯¯å·®)</li>
<li>è§£ç æ—¶å¿…é¡»å°†Iå¸§ä¸­çš„é¢„æµ‹å€¼ä¸é¢„æµ‹è¯¯å·®æ±‚å’Œåæ‰èƒ½é‡æ„å®Œæ•´çš„På¸§å›¾åƒ</li>
<li>På¸§å±äºå‰å‘é¢„æµ‹çš„å¸§é—´ç¼–ç ã€‚å®ƒåªå‚è€ƒå‰é¢æœ€é è¿‘å®ƒçš„Iå¸§æˆ–På¸§</li>
<li>På¸§å¯ä»¥æ˜¯å…¶åé¢På¸§çš„å‚è€ƒå¸§,ä¹Ÿå¯ä»¥æ˜¯å…¶å‰åçš„Bå¸§çš„å‚è€ƒå¸§</li>
<li>ç”±äºPå¸§æ˜¯å‚è€ƒå¸§,å®ƒå¯èƒ½é€ æˆè§£ç é”™è¯¯çš„æ‰©æ•£</li>
<li>ç”±äºæ˜¯å·®å€¼ä¼ é€,På¸§çš„å‹ç¼©æ¯”è¾ƒé«˜</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>Bå¸§</strong><br>ä¸ºäº†æ›´å¥½åœ°ç†è§£På¸§çš„æ¦‚å¿µï¼Œæˆ‘ä¾ç„¶ç½—åˆ—äº†ä¸¤ç§è§£é‡Šï¼š</p>
<ul>
<li>åŒå‘é¢„æµ‹å†…æ’ç¼–ç å¸§ã€‚Bå¸§æ˜¯åŒå‘å·®åˆ«å¸§ï¼Œä¹Ÿå°±æ˜¯Bå¸§è®°å½•çš„æ˜¯æœ¬å¸§ä¸å‰åå¸§çš„å·®åˆ«ï¼ˆå…·ä½“æ¯”è¾ƒå¤æ‚ï¼Œæœ‰4ç§æƒ…å†µï¼Œä½†æˆ‘è¿™æ ·è¯´ç®€å•äº›ï¼‰ï¼Œæ¢è¨€ä¹‹ï¼Œè¦è§£ç Bå¸§ï¼Œä¸ä»…è¦å–å¾—ä¹‹å‰çš„ç¼“å­˜ç”»é¢ï¼Œè¿˜è¦è§£ç ä¹‹åçš„ç”»é¢ï¼Œé€šè¿‡å‰åç”»é¢çš„ä¸æœ¬å¸§æ•°æ®çš„å åŠ å–å¾—æœ€ç»ˆçš„ç”»é¢ã€‚Bå¸§å‹ç¼©ç‡é«˜ï¼Œä½†æ˜¯è§£ç æ—¶CPUä¼šæ¯”è¾ƒç´¯ã€‚</li>
<li><p>åŒå‘é¢„æµ‹å†…æ’ç¼–ç å¸§ åˆç§°bi-directional interpolated prediction frameï¼Œæ—¢è€ƒè™‘ä¸æºå›¾åƒåºåˆ—å‰é¢å·²ç¼–ç å¸§ï¼Œä¹Ÿé¡¾åŠæºå›¾åƒåºåˆ—åé¢å·²ç¼–ç å¸§ä¹‹é—´çš„æ—¶é—´å†—ä½™ä¿¡æ¯æ¥å‹ç¼©ä¼ è¾“æ•°æ®é‡çš„ç¼–ç å›¾åƒï¼Œä¹Ÿå«åŒå‘é¢„æµ‹å¸§ï¼›</p>
<p><strong>Bå¸§çš„é¢„æµ‹ä¸é‡æ„ï¼š</strong>Bå¸§ä»¥å‰é¢çš„Iæˆ–På¸§å’Œåé¢çš„På¸§ä¸ºå‚è€ƒå¸§,â€œæ‰¾å‡ºâ€Bå¸§â€œæŸç‚¹â€çš„é¢„æµ‹å€¼å’Œä¸¤ä¸ªè¿åŠ¨çŸ¢é‡,å¹¶å–é¢„æµ‹å·®å€¼å’Œè¿åŠ¨çŸ¢é‡ä¼ é€ã€‚æ¥æ”¶ç«¯æ ¹æ®è¿åŠ¨çŸ¢é‡åœ¨ä¸¤ä¸ªå‚è€ƒå¸§ä¸­â€œæ‰¾å‡º(ç®—å‡º)â€é¢„æµ‹å€¼å¹¶ä¸å·®å€¼æ±‚å’Œ,å¾—åˆ°Bå¸§â€œæŸç‚¹â€æ ·å€¼,ä»è€Œå¯å¾—åˆ°å®Œæ•´çš„Bå¸§ã€‚</p>
<p><strong>Bå¸§çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>Bå¸§æ˜¯ç”±å‰é¢çš„Iæˆ–På¸§å’Œåé¢çš„På¸§æ¥è¿›è¡Œé¢„æµ‹çš„</li>
<li>Bå¸§ä¼ é€çš„æ˜¯å®ƒä¸å‰é¢çš„Iæˆ–På¸§å’Œåé¢çš„På¸§ä¹‹é—´çš„é¢„æµ‹è¯¯å·®åŠè¿åŠ¨çŸ¢é‡</li>
<li>Bå¸§æ˜¯åŒå‘é¢„æµ‹ç¼–ç å¸§</li>
<li>Bå¸§å‹ç¼©æ¯”æœ€é«˜,å› ä¸ºå®ƒåªåæ˜ ä¸™å‚è€ƒå¸§é—´è¿åŠ¨ä¸»ä½“çš„å˜åŒ–æƒ…å†µ,é¢„æµ‹æ¯”è¾ƒå‡†ç¡®</li>
<li>Bå¸§ä¸æ˜¯å‚è€ƒå¸§,ä¸ä¼šé€ æˆè§£ç é”™è¯¯çš„æ‰©æ•£</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Iã€Bã€På„å¸§æ˜¯æ ¹æ®å‹ç¼©ç®—æ³•çš„éœ€è¦ï¼Œæ˜¯äººä¸ºå®šä¹‰çš„,å®ƒä»¬éƒ½æ˜¯å®å®åœ¨åœ¨çš„ç‰©ç†å¸§ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒIå¸§çš„å‹ç¼©ç‡æ˜¯7ï¼ˆè·ŸJPGå·®ä¸å¤šï¼‰ï¼ŒPå¸§æ˜¯20ï¼ŒBå¸§å¯ä»¥è¾¾åˆ°50ã€‚å¯è§ä½¿ç”¨Bå¸§èƒ½èŠ‚çœå¤§é‡ç©ºé—´ï¼ŒèŠ‚çœå‡ºæ¥çš„ç©ºé—´å¯ä»¥ç”¨æ¥ä¿å­˜å¤šä¸€äº›Iå¸§ï¼Œè¿™æ ·åœ¨ç›¸åŒç ç‡ä¸‹ï¼Œå¯ä»¥æä¾›æ›´å¥½çš„ç”»è´¨ã€‚</p>
<h3 id="å¯¹å‹ç¼©ç®—æ³•çš„è¯´æ˜"><a href="#å¯¹å‹ç¼©ç®—æ³•çš„è¯´æ˜" class="headerlink" title="å¯¹å‹ç¼©ç®—æ³•çš„è¯´æ˜"></a>å¯¹å‹ç¼©ç®—æ³•çš„è¯´æ˜</h3><p>h264çš„å‹ç¼©æ–¹æ³•:</p>
<ol>
<li>åˆ†ç»„:æŠŠå‡ å¸§å›¾åƒåˆ†ä¸ºä¸€ç»„(GOPï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªåºåˆ—),ä¸ºé˜²æ­¢è¿åŠ¨å˜åŒ–,å¸§æ•°ä¸å®œå–å¤šã€‚</li>
<li>å®šä¹‰å¸§:å°†æ¯ç»„å†…å„å¸§å›¾åƒå®šä¹‰ä¸ºä¸‰ç§ç±»å‹,å³Iå¸§ã€Bå¸§å’ŒPå¸§;</li>
<li>é¢„æµ‹å¸§:ä»¥Iå¸§åšä¸ºåŸºç¡€å¸§,ä»¥Iå¸§é¢„æµ‹På¸§,å†ç”±Iå¸§å’ŒPå¸§é¢„æµ‹Bå¸§;</li>
<li>æ•°æ®ä¼ è¾“:æœ€åå°†Iå¸§æ•°æ®ä¸é¢„æµ‹çš„å·®å€¼ä¿¡æ¯è¿›è¡Œå­˜å‚¨å’Œä¼ è¾“ã€‚</li>
</ol>
<p>å¸§å†…ï¼ˆIntraframeï¼‰å‹ç¼©ä¹Ÿç§°ä¸ºç©ºé—´å‹ç¼©ï¼ˆSpatial compressionï¼‰ã€‚å½“å‹ç¼©ä¸€å¸§å›¾åƒæ—¶ï¼Œä»…è€ƒè™‘æœ¬å¸§çš„æ•°æ®è€Œä¸è€ƒè™‘ç›¸é‚»å¸§ä¹‹é—´çš„å†—ä½™ä¿¡æ¯ï¼Œè¿™å®é™…ä¸Šä¸é™æ€å›¾åƒå‹ç¼©ç±»ä¼¼ã€‚å¸§å†…ä¸€èˆ¬é‡‡ç”¨æœ‰æŸå‹ç¼©ç®—æ³•ï¼Œç”±äºå¸§å†…å‹ç¼©æ˜¯ç¼–ç ä¸€ä¸ªå®Œæ•´çš„å›¾åƒï¼Œæ‰€ä»¥å¯ä»¥ç‹¬ç«‹çš„è§£ç ã€æ˜¾ç¤ºã€‚å¸§å†…å‹ç¼©ä¸€èˆ¬è¾¾ä¸åˆ°å¾ˆé«˜çš„å‹ç¼©ï¼Œè·Ÿç¼–ç jpegå·®ä¸å¤šã€‚</p>
<p>å¸§é—´ï¼ˆInterframeï¼‰å‹ç¼©çš„åŸç†æ˜¯ï¼šç›¸é‚»å‡ å¸§çš„æ•°æ®æœ‰å¾ˆå¤§çš„ç›¸å…³æ€§ï¼Œæˆ–è€…è¯´å‰åä¸¤å¸§ä¿¡æ¯å˜åŒ–å¾ˆå°çš„ç‰¹ç‚¹ã€‚ä¹Ÿå³è¿ç»­çš„è§†é¢‘å…¶ç›¸é‚»å¸§ä¹‹é—´å…·æœ‰å†—ä½™ä¿¡æ¯,æ ¹æ®è¿™ä¸€ç‰¹æ€§ï¼Œå‹ç¼©ç›¸é‚»å¸§ä¹‹é—´çš„å†—ä½™é‡å°±å¯ä»¥è¿›ä¸€æ­¥æé«˜å‹ç¼©é‡ï¼Œå‡å°å‹ç¼©æ¯”ã€‚å¸§é—´å‹ç¼©ä¹Ÿç§°ä¸ºæ—¶é—´å‹ç¼©ï¼ˆTemporal compressionï¼‰ï¼Œå®ƒé€šè¿‡æ¯”è¾ƒæ—¶é—´è½´ä¸Šä¸åŒå¸§ä¹‹é—´çš„æ•°æ®è¿›è¡Œå‹ç¼©ã€‚å¸§é—´å‹ç¼©ä¸€èˆ¬æ˜¯æ— æŸçš„ã€‚å¸§å·®å€¼ï¼ˆFrame differencingï¼‰ç®—æ³•æ˜¯ä¸€ç§å…¸å‹çš„æ—¶é—´å‹ç¼©æ³•ï¼Œå®ƒé€šè¿‡æ¯”è¾ƒæœ¬å¸§ä¸ç›¸é‚»å¸§ä¹‹é—´çš„å·®å¼‚ï¼Œä»…è®°å½•æœ¬å¸§ä¸å…¶ç›¸é‚»å¸§çš„å·®å€¼ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§å‡å°‘æ•°æ®é‡ã€‚</p>
<p>é¡ºä¾¿è¯´ä¸‹æœ‰æŸï¼ˆLossy ï¼‰å‹ç¼©å’Œæ— æŸï¼ˆLossy lessï¼‰å‹ç¼©ã€‚æ— æŸå‹ç¼©ä¹Ÿå³å‹ç¼©å‰å’Œè§£å‹ç¼©åçš„æ•°æ®å®Œå…¨ä¸€è‡´ã€‚å¤šæ•°çš„æ— æŸå‹ç¼©éƒ½é‡‡ç”¨RLEè¡Œç¨‹ç¼–ç ç®—æ³•ã€‚æœ‰æŸå‹ç¼©æ„å‘³ç€è§£å‹ç¼©åçš„æ•°æ®ä¸å‹ç¼©å‰çš„æ•°æ®ä¸ä¸€è‡´ã€‚åœ¨å‹ç¼©çš„è¿‡ç¨‹ä¸­è¦ä¸¢å¤±ä¸€äº›äººçœ¼å’Œäººè€³æ‰€ä¸æ•æ„Ÿçš„å›¾åƒæˆ–éŸ³é¢‘ä¿¡æ¯,è€Œä¸”ä¸¢å¤±çš„ä¿¡æ¯ä¸å¯æ¢å¤ã€‚å‡ ä¹æ‰€æœ‰é«˜å‹ç¼©çš„ç®—æ³•éƒ½é‡‡ç”¨æœ‰æŸå‹ç¼©,è¿™æ ·æ‰èƒ½è¾¾åˆ°ä½æ•°æ®ç‡çš„ç›®æ ‡ã€‚ä¸¢å¤±çš„æ•°æ®ç‡ä¸å‹ç¼©æ¯”æœ‰å…³,å‹ç¼©æ¯”è¶Šå°ï¼Œä¸¢å¤±çš„æ•°æ®è¶Šå¤š,è§£å‹ç¼©åçš„æ•ˆæœä¸€èˆ¬è¶Šå·®ã€‚æ­¤å¤–,æŸäº›æœ‰æŸå‹ç¼©ç®—æ³•é‡‡ç”¨å¤šæ¬¡é‡å¤å‹ç¼©çš„æ–¹å¼,è¿™æ ·è¿˜ä¼šå¼•èµ·é¢å¤–çš„æ•°æ®ä¸¢å¤±ã€‚</p>
<h3 id="ä¸‰ç§å¸§çš„ä¸åŒ"><a href="#ä¸‰ç§å¸§çš„ä¸åŒ" class="headerlink" title="ä¸‰ç§å¸§çš„ä¸åŒ"></a>ä¸‰ç§å¸§çš„ä¸åŒ</h3><ul>
<li>I frame:è‡ªèº«å¯ä»¥é€šè¿‡è§†é¢‘è§£å‹ç®—æ³•è§£å‹æˆä¸€å¼ å•ç‹¬çš„å®Œæ•´çš„å›¾ç‰‡ã€‚</li>
<li>P frameï¼šéœ€è¦å‚è€ƒå…¶å‰é¢çš„ä¸€ä¸ªI frame æˆ–è€…P frameæ¥ç”Ÿæˆä¸€å¼ å®Œæ•´çš„å›¾ç‰‡ã€‚</li>
<li>B frame:åˆ™è¦å‚è€ƒå…¶å‰ä¸€ä¸ªIæˆ–è€…På¸§åŠå…¶åé¢çš„ä¸€ä¸ªPå¸§æ¥ç”Ÿæˆä¸€å¼ å®Œæ•´çš„å›¾ç‰‡ã€‚</li>
<li>ä¸¤ä¸ªI frameä¹‹é—´å½¢æˆä¸€ä¸ªGOPï¼Œåœ¨x264ä¸­åŒæ—¶å¯ä»¥é€šè¿‡å‚æ•°æ¥è®¾å®šbfçš„å¤§å°ï¼Œå³ï¼šIå’ŒPæˆ–è€…ä¸¤ä¸ªPä¹‹é—´Bçš„æ•°é‡ã€‚</li>
<li>é€šè¿‡ä¸Šè¿°åŸºæœ¬å¯ä»¥è¯´æ˜å¦‚æœæœ‰B frame å­˜åœ¨çš„æƒ…å†µä¸‹ä¸€ä¸ªGOPçš„æœ€åä¸€ä¸ªframeä¸€å®šæ˜¯P.</li>
</ul>
<h3 id="DTSå’ŒPTSçš„ä¸åŒ"><a href="#DTSå’ŒPTSçš„ä¸åŒ" class="headerlink" title="DTSå’ŒPTSçš„ä¸åŒ"></a>DTSå’ŒPTSçš„ä¸åŒ</h3><p>DTSä¸»è¦ç”¨äºè§†é¢‘çš„è§£ç ,åœ¨è§£ç é˜¶æ®µä½¿ç”¨.PTSä¸»è¦ç”¨äºè§†é¢‘çš„åŒæ­¥å’Œè¾“å‡º.åœ¨displayçš„æ—¶å€™ä½¿ç”¨.åœ¨æ²¡æœ‰B frameçš„æƒ…å†µä¸‹.DTSå’ŒPTSçš„è¾“å‡ºé¡ºåºæ˜¯ä¸€æ ·çš„ã€‚</p>
<p>ä¾‹å­:<br>ä¸‹é¢ç»™å‡ºä¸€ä¸ªGOPä¸º15çš„ä¾‹å­,å…¶è§£ç çš„å‚ç…§frameåŠå…¶è§£ç çš„é¡ºåºéƒ½åœ¨é‡Œé¢:<br><img src="http://ouazw12mz.bkt.clouddn.com/180108004838.png?imageslim" alt=""><br>å¦‚ä¸Šå›¾ï¼šI frame çš„è§£ç ä¸ä¾èµ–äºä»»ä½•çš„å…¶å®ƒçš„å¸§.è€Œp frameçš„è§£ç åˆ™ä¾èµ–äºå…¶å‰é¢çš„I frameæˆ–è€…P frame.B frameçš„è§£ç åˆ™ä¾èµ–äºå…¶å‰çš„æœ€è¿‘çš„ä¸€ä¸ªI frameæˆ–è€…P frame åŠå…¶åçš„æœ€è¿‘çš„ä¸€ä¸ªP frame.</p>
<h2 id="H-264æµæ•°æ®"><a href="#H-264æµæ•°æ®" class="headerlink" title="H.264æµæ•°æ®"></a>H.264æµæ•°æ®</h2><p>åœ¨H.264çš„è¯­æ³•ä¸­ï¼Œæœ‰ä¸€ä¸ªæœ€åŸºç¡€çš„å±‚ï¼Œå«åšNetwork Abstraction Layer, ç®€ç§°ä¸ºNALã€‚H.264æµæ•°æ®æ­£æ˜¯ç”±ä¸€ç³»åˆ—çš„NALå•å…ƒ(NAL Unit, ç®€ç§°NAUL)ç»„æˆçš„ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180108004954.png?imageslim" alt=""><br>H264çš„ç æµç”±NALUå•å…ƒç»„æˆ,ä¸€ä¸ªNALUå¯èƒ½åŒ…å«æœ‰ï¼š</p>
<ul>
<li><p><strong>è§†é¢‘å¸§</strong><br>è§†é¢‘å¸§ä¹Ÿå°±æ˜¯è§†é¢‘ç‰‡æ®µï¼Œå…·ä½“æœ‰ På¸§, Iå¸§ï¼ŒBå¸§<br><img src="http://ouazw12mz.bkt.clouddn.com/180108005022.png?imageslim" alt=""></p>
</li>
<li><p><strong>H.264å±æ€§åˆé›†-FormatDesc(åŒ…å« SPSå’ŒPPS)</strong><br>æµæ•°æ®ä¸­ï¼Œå±æ€§é›†åˆå¯èƒ½æ˜¯è¿™æ ·çš„ï¼š<br><img src="http://ouazw12mz.bkt.clouddn.com/180108005131.png?imageslim" alt=""></p>
</li>
</ul>
<h3 id="NALU-header"><a href="#NALU-header" class="headerlink" title="NALU header"></a>NALU header</h3><p>å¯¹äºæµæ•°æ®æ¥è¯´ï¼Œä¸€ä¸ªNAULçš„Headerä¸­ï¼Œå¯èƒ½æ˜¯<code>0x00 00 01</code>æˆ–è€…æ˜¯<code>0x00 00 00 01</code>ä½œä¸ºå¼€å¤´(ä¸¤è€…éƒ½æœ‰å¯èƒ½ï¼Œä¸‹é¢ä»¥0x00 00 01ä½œä¸ºä¾‹å­)ã€‚0x00 00 01å› æ­¤è¢«ç§°ä¸ºå¼€å§‹ç (Start code).<br><img src="http://ouazw12mz.bkt.clouddn.com/180108005156.png?imageslim" alt=""></p>
<p>æ€»ç»“ä»¥ä¸ŠçŸ¥è¯†ï¼Œæˆ‘ä»¬çŸ¥é“H264çš„ç æµç”±NALUå•å…ƒç»„æˆï¼ŒNALUå•å…ƒåŒ…å«è§†é¢‘å›¾åƒæ•°æ®å’ŒH264çš„å‚æ•°ä¿¡æ¯ã€‚å…·ä½“æ¥è¯´å‚æ•°ä¿¡æ¯åŒ…å«SPSï¼ˆSequence Parameter Setï¼‰å’ŒPPSï¼ˆPicture Parameter Setï¼‰.å¦‚ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªH.264ç æµç»“æ„ï¼š<br><img src="http://ouazw12mz.bkt.clouddn.com/180108005317.png?imageslim" alt=""></p>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘å­¦ä¹ -flvä¹‹AudioTag(2)]]></title>
      <url>https://lucius0.github.io/2018/01/03/archivers/media-study-04/</url>
      <content type="html"><![CDATA[<p>åˆæ¬¡å­¦ä¹ æœ‰å…³éŸ³è§†é¢‘è¿™ä¸€å—çš„å¼€å‘ï¼Œä¸»è¦æ˜¯åŸºäº <strong><a href="https://github.com/Bilibili/flv.js" target="_blank" rel="noopener">flv.js</a></strong> çš„å­¦ä¹ ã€‚è¿™ä¸€å—çš„çŸ¥è¯†æ¦‚å¿µå®åœ¨æ˜¯å¤ªå¤šå¤ªæ·±äº†ï¼Œæ‰€ä»¥æœ¬äººæ˜¯å…ˆåœ¨æœ¬åœ°åšè®°å½•ï¼Œåé¢ä¼šæ•´ç†æ…¢æ…¢åœ°ä¸Šä¼ ä¸å„ä½åˆ†äº«ï¼Œå‡å¦‚æœ‰åœ°æ–¹è¯´é”™ï¼Œè¯·å‹˜è¯¯ã€‚è°¢è°¢æŒ‡ç‚¹ã€‚</p>
<p>ä¸Šä¸€ç¯‡è®²è§£äº†AACæ ¼å¼çš„éŸ³é¢‘æ ¼å¼ï¼Œè¿™ç¯‡å°±æ¥è®²è§£ä¸‹MP3ï¼Œä¸è¿‡ç°åœ¨å‡ ä¹éƒ½æ˜¯é‡‡å–H.264 è§†é¢‘ + AACéŸ³é¢‘ï¼Œå› ä¸ºç›¸ä¼¼çš„ç ç‡æ¥è®²ï¼ŒAACæ¯”MP3ä¼˜ç§€ï¼ˆä½ç ç‡ä¸‹ï¼ŒMP3åœ¨é«˜é¢‘æ®µä¼šç»å¸¸å‘ç”Ÿä¸¢å¤±ï¼Œè€ŒAACåˆ™ä¼šæœ‰æ›´é«˜çš„é«˜é¢‘å»¶å±•ï¼‰ï¼ŒMP3çš„å‹ç¼©ç‡10ï¼š1 - 12ï¼š1ï¼Œè€ŒAACçš„å‹ç¼©ç‡18ï¼š1 - 20ï¼š1ã€‚<strong>MP3 æ–‡ä»¶çš„æœ€å°ç»„æˆå•ä½æ˜¯å¸§ã€‚</strong></p>
<h2 id="MP3"><a href="#MP3" class="headerlink" title="MP3"></a>MP3</h2><p>mp3çš„<strong>Audio Tag Body</strong>çš„åˆ†æè·Ÿaacä¸€æ ·ï¼Œè¿™é‡Œæ— éœ€å¤šè®²ã€‚mp3çš„æ–‡ä»¶ç»“æ„å›¾å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">---------------</span><br><span class="line">|  ID3V2 Tag  |</span><br><span class="line">---------------</span><br><span class="line">|  MP3 Header | \</span><br><span class="line">---------------   å¸§ç»“æ„(Frame)</span><br><span class="line">|  MP3 Data   | /</span><br><span class="line">---------------</span><br><span class="line">|  ......     |</span><br><span class="line">---------------</span><br><span class="line">|  MP3 Header |</span><br><span class="line">---------------</span><br><span class="line">|  MP3 Data   |</span><br><span class="line">---------------</span><br><span class="line">|  ID3V1 Tag  |</span><br><span class="line">---------------</span><br></pre></td></tr></table></figure></p>
<p>å› æ­¤è¦ä»<strong>ID3V2 Tag</strong>ï¼Œ<strong>Frame</strong>ï¼Œ<strong>ID3V1 Tag</strong>è¿™ä¸‰æ–¹é¢å…¥æ‰‹ã€‚ä½†æ˜¯å› ä¸º<strong>ID3V2</strong>ç»å†äº†4ä¸ªç‰ˆæœ¬ï¼Œè€Œç°ä»£æµè§ˆå™¨å¤§å¤šæ”¯æŒç¬¬3ç‰ˆï¼Œæ‰€ä»¥<strong>ID3V2</strong>ä¸€èˆ¬æŒ‡<strong>ID3V2.3</strong>ã€‚å…¶ä¸­<strong>ID3V2</strong>æ˜¯<strong>ID3V1</strong>çš„è¡¥å……ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„MP3éƒ½æœ‰<strong>ID3V2</strong>è¡¥å……ï¼Œæ‰€ä»¥ä¸æ˜¯æ‰€æœ‰çš„MP3æ–‡ä»¶éƒ½æœ‰<strong>ID3V2</strong>ã€‚</p>
<p>ç¤ºä¾‹ç‰‡æ®µï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">49443303</span> <span class="number">0000000</span>C <span class="number">462</span>C5453 <span class="number">53450000</span> <span class="number">000</span>D0000 <span class="number">004</span>C6176 <span class="number">6635362</span>E </span><br><span class="line"><span class="number">342E3130</span> <span class="number">3154504</span>F <span class="number">53000000</span> <span class="number">05000001</span> FFFE3100 <span class="number">5452434</span>B <span class="number">00000007</span> </span><br><span class="line"><span class="number">000001</span>FF FE320030 <span class="number">00415049</span> <span class="number">4300031</span>E C5000000 <span class="number">696</span>D6167 <span class="number">652</span>F6A70 </span><br><span class="line"><span class="number">67000000</span> FFD8FFE0 <span class="number">00104</span>A46 <span class="number">49460001</span> <span class="number">01010048</span> <span class="number">00480000</span> FFDB0043 </span><br><span class="line"><span class="number">00020101</span> <span class="number">01010102</span> <span class="number">01010102</span> <span class="number">02020202</span> <span class="number">04030202</span> <span class="number">02020504</span> <span class="number">04030406</span> </span><br><span class="line"><span class="number">05060606</span> <span class="number">05060606</span> <span class="number">07090806</span> <span class="number">07090706</span> <span class="number">06080</span>B08 <span class="number">090</span>A0A0A <span class="number">0</span>A0A0608 </span><br><span class="line"><span class="number">0B0</span>C0B0A <span class="number">0</span>C090A0A <span class="number">0</span>AFFDB00 <span class="number">43010202</span> <span class="number">02020202</span> <span class="number">05030305</span> <span class="number">0</span>A070607 </span><br><span class="line"><span class="number">0</span>A0A0A0A <span class="number">0</span>A0A0A0A <span class="number">0</span>A0A0A0A <span class="number">0</span>A0A0A0A <span class="number">0</span>A0A0A0A <span class="number">0</span>A0A0A0A <span class="number">0</span>A0A0A0A </span><br><span class="line"><span class="number">0</span>A0A0A0A <span class="number">0</span>A0A0A0A <span class="number">0</span>A0A0A0A <span class="number">0</span>A0A0A0A <span class="number">0</span>A0A0A0A <span class="number">0</span>A0AFFC0 <span class="number">00110802</span> </span><br><span class="line"><span class="number">80028003</span> <span class="number">01110002</span> <span class="number">11010311</span> <span class="number">01</span>FFC400 <span class="number">1E000000</span> <span class="number">07010101</span> <span class="number">01000000</span> </span><br><span class="line"><span class="number">00000000</span> <span class="number">00000304</span> <span class="number">05060708</span> <span class="number">09020100</span> <span class="number">0</span>AFFC400 <span class="number">4</span>B100002 <span class="number">01020502</span></span><br></pre></td></tr></table></figure></p>
<h3 id="ID3V2-Tag"><a href="#ID3V2-Tag" class="headerlink" title="ID3V2 Tag"></a>ID3V2 Tag</h3><p>ID3V2æ˜¯å˜é•¿æ ‡ç­¾ï¼Œè¿™ä¹Ÿç»™äº†å®ƒå¾ˆå¥½çš„æ‰©å±•æ€§ï¼ŒåŒ…å«äº†ä½œè€…ï¼Œä½œæ›²ï¼Œä¸“è¾‘ç­‰ä¿¡æ¯ï¼Œæ‰©å±•äº†ID3V1çš„ä¿¡æ¯é‡ã€‚å¤§ç«¯åºæ’åºã€‚</p>
<p><strong>æ ‡ç­¾å¤´(10bytes)</strong></p>
<ul>
<li>æ ‡è¯†ï¼š3ä¸ªå­—èŠ‚ã€‚å¤´éƒ¨ä¿¡æ¯ï¼Œå¿…é¡»ä¸ºâ€˜ID3â€™ï¼Œå¦åˆ™è®¤ä¸ºæ ‡ç­¾ä¸å­˜åœ¨ï¼Œåå…­è¿›åˆ¶ä¸º<code>494433</code>ã€‚</li>
<li>ç‰ˆæœ¬å·ï¼š1ä¸ªå­—èŠ‚ã€‚</li>
<li>å‰¯ç‰ˆæœ¬å·ï¼š1ä¸ªå­—èŠ‚ã€‚</li>
<li>æ ‡å¿—ï¼š1ä¸ªå­—èŠ‚ã€‚æ ‡å¿—ï¼Œå¦‚abc0 0000ã€‚<ul>
<li>aï¼šéåŒæ­¥ç¼–ç </li>
<li>bï¼šæ‰©å±•æ ‡ç­¾å¤´ï¼ˆè¯¥ä¾‹å­ä¸º0ï¼Œæ‰€ä»¥æ²¡æœ‰ä¸‹é¢çš„æ‰©å±•æ ‡ç­¾å¤´ï¼‰</li>
<li>cï¼šæµ‹è¯•æŒ‡ç¤ºä¸º</li>
</ul>
</li>
<li>å¤§å°ï¼š4ä¸ªå­—èŠ‚ã€‚é•¿åº¦(åŒ…å«æ ‡ç­¾å¸§)ï¼Œæ ¼å¼å¦‚<code>0xxxxxxx 0xxxxxxx 0xxxxxxx 0xxxxxxx</code>ã€‚æ‰€ä»¥sizeçš„è®¡ç®—æ–¹å¼ï¼š<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 000C462C</span></span><br><span class="line">total_size = </span><br><span class="line">    <span class="comment">// (0x00 &amp; 0x7F) * 0x200000 = 0</span></span><br><span class="line">    (Size[<span class="number">0</span>] &amp; <span class="number">0x7F</span>) * <span class="number">0x200000</span> </span><br><span class="line">    <span class="comment">// (0x0C &amp; 0x7F) * 0x4000 = 0x30000</span></span><br><span class="line">ã€€ã€€+(Size[<span class="number">1</span>] &amp; <span class="number">0x7F</span>) * <span class="number">0x4000</span> </span><br><span class="line">    <span class="comment">// (0x46 &amp; 0x7F) * 0x80 = 0x2300</span></span><br><span class="line">ã€€ã€€+(Size[<span class="number">2</span>] &amp; <span class="number">0x7F</span>) * <span class="number">0x80</span> </span><br><span class="line">    <span class="comment">// (0x2C &amp; 0x7F) = 0x2C</span></span><br><span class="line">ã€€ã€€+(Size[<span class="number">3</span>] &amp; <span class="number">0x7F</span>)</span><br><span class="line"><span class="comment">// 0x3232C = 205612</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>æ‰©å±•æ ‡ç­¾å¤´(10bytes)</strong></p>
<ul>
<li>å¤§å°ï¼š4ä¸ªå­—èŠ‚ã€‚size = byte0 <em> 0x200000 + byte1 </em> 0x4000 + byte2 * 0x80 + byte3</li>
<li>æ ‡å¿—ï¼š2ä¸ªå­—èŠ‚ã€‚</li>
<li>è¡¥ç©ºå¤§å°    ï¼š4ä¸ªå­—èŠ‚ã€‚ä½ å¯ä»¥åœ¨æ‰€æœ‰çš„æ ‡ç­¾å¸§åé¢æ·»åŠ è¡¥ç©ºæ•°æ®ï¼Œä¹Ÿå¯ä»¥é¢„ç•™ç©ºé—´å­˜æ”¾é¢å¤–çš„å¸§ï¼Œä½¿å¾—æ•´ä¸ªæ ‡ç­¾å¤§å°æ¯”æ ‡ç­¾å¤´ä¸­çš„å¤§å°è¦æ›´å¤§ï¼Œè¿™é‡Œè®°å½•çš„å°±æ˜¯å¢åŠ çš„å¤§å°ï¼Œä¸€èˆ¬ä¸ç”¨ã€‚</li>
</ul>
<p><strong>æ ‡ç­¾å¸§</strong></p>
<ul>
<li><p>å¸§æ ‡è¯†ï¼š4ä¸ªå­—èŠ‚</p>
<ul>
<li>TIT2=æ ‡é¢˜ è¡¨ç¤ºå†…å®¹ä¸ºè¿™é¦–æ­Œçš„æ ‡é¢˜ï¼Œä¸‹åŒ</li>
<li>TPE1=ä½œè€…</li>
<li>TALB=ä¸“é›†</li>
<li>TRCK=éŸ³è½¨ æ ¼å¼ï¼šN/M å…¶ä¸­Nä¸ºä¸“é›†ä¸­çš„ç¬¬Né¦–ï¼ŒMä¸ºä¸“é›†ä¸­å…±Mé¦–ï¼ŒNå’ŒMä¸ºASCIIç è¡¨ç¤ºçš„æ•°å­—</li>
<li>TYER=å¹´ä»£ æ˜¯ç”¨ASCIIç è¡¨ç¤ºçš„æ•°å­—</li>
<li>TCON=ç±»å‹ ç›´æ¥ç”¨å­—ç¬¦ä¸²è¡¨ç¤º</li>
<li>COMM=å¤‡æ³¨ æ ¼å¼ï¼šâ€eng\0å¤‡æ³¨å†…å®¹â€ï¼Œå…¶ä¸­engè¡¨ç¤ºå¤‡æ³¨æ‰€ä½¿ç”¨çš„è‡ªç„¶è¯­è¨€<br>ä¾‹å­ç‰‡æ®µ1ä¸ºï¼š<code>5453 5345 // TSSE</code>ï¼›<br>ä¾‹å­ç‰‡æ®µ2ä¸ºï¼š<code>5450 4F53 // TPOS</code>ã€‚<br>â€¦â€¦</li>
</ul>
</li>
<li><p>å¸§å¤§å°ï¼š4ä¸ªå­—èŠ‚ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">size = size[<span class="number">0</span>] * <span class="number">0x1000000</span> + </span><br><span class="line">    size[<span class="number">1</span>] * <span class="number">0x10000</span> + </span><br><span class="line">    size[<span class="number">2</span>] * <span class="number">0x100</span> + </span><br><span class="line">    size[<span class="number">3</span>]; <span class="comment">// 0x0D = 13</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ ‡å¿—ï¼š2ä¸ªå­—èŠ‚ã€‚å¦‚ï¼šabc00000ijk00000</p>
<ul>
<li>aï¼šæ ‡ç­¾ä¿æŠ¤æ ‡å¿—ï¼Œè®¾ç½®æ—¶è®¤ä¸ºæ­¤å¸§ä½œåºŸ</li>
<li>bï¼šæ–‡ä»¶ä¿æŠ¤æ ‡å¿—ï¼Œè®¾ç½®æ—¶è®¤ä¸ºæ­¤å¸§ä½œåºŸ</li>
<li>cï¼šåªè¯»æ ‡å¿—ï¼Œè®¾ç½®æ—¶è®¤ä¸ºæ­¤å¸§ä¸èƒ½ä¿®æ”¹(ä½†æˆ‘æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªè½¯ä»¶ç†ä¼šè¿™ä¸ªæ ‡å¿—)</li>
<li>iï¼šå‹ç¼©æ ‡å¿—ï¼Œè®¾ç½®æ—¶ä¸€ä¸ªå­—èŠ‚å­˜æ”¾ä¸¤ä¸ªBCD ç è¡¨ç¤ºæ•°å­—</li>
<li>jï¼šåŠ å¯†æ ‡å¿—(æ²¡æœ‰è§è¿‡å“ªä¸ªMP3 æ–‡ä»¶çš„æ ‡ç­¾ç”¨äº†åŠ å¯†)</li>
<li>kï¼šç»„æ ‡å¿—ï¼Œè®¾ç½®æ—¶è¯´æ˜æ­¤å¸§å’Œå…¶ä»–çš„æŸå¸§æ˜¯ä¸€ç»„</li>
</ul>
</li>
<li>å¸§æ•°æ®ï¼šå¸§å¤§å°sizeä¸ªå­—èŠ‚ã€‚(ä¾‹å­ç‰‡æ®µä¸ºï¼š<code>004C6176 6635362E 342E3130 31</code>)</li>
</ul>
<h3 id="ID3V1-Tag"><a href="#ID3V1-Tag" class="headerlink" title="ID3V1 Tag"></a>ID3V1 Tag</h3><p>åŒ…å«äº†ä½œè€…ï¼Œä½œæ›²ï¼Œä¸“è¾‘ç­‰ä¿¡æ¯ï¼Œå›ºå®šé•¿åº¦ä¸º128bytesã€‚</p>
<ul>
<li>Headerï¼š3bytesï¼Œä¸ºâ€™TAGâ€™</li>
<li>Titleï¼š30bytes</li>
<li>Artistï¼š30bytes</li>
<li>Albumï¼š30bytes</li>
<li>Yearï¼š4bytes</li>
<li>Commentï¼š28bytes</li>
<li>Reserveï¼š1byteï¼Œä¿ç•™</li>
<li>Trackï¼š1byte</li>
<li>Genreï¼š1byte</li>
</ul>
<h3 id="Frame"><a href="#Frame" class="headerlink" title="Frame"></a>Frame</h3><p>æ¯ä¸ªå¸§éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå®ƒç”±å¸§å¤´ã€é™„åŠ ä¿¡æ¯å’Œå£°éŸ³æ•°æ®ç»„æˆï¼Œå…¶é•¿åº¦éšä½ç‡çš„ä¸åŒè€Œä¸ç­‰ï¼Œé€šå¸¸æ¯ä¸ªå¸§çš„æ’­æ”¾æ—¶é—´ä¸º26msç§’ï¼Œä¸”éŸ³é¢‘é•¿åº¦ä¸ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Length(MAIN_DATA) = ((version == MPEG1) ? 144 : 72) * bitrate / frequency + padding;</span><br></pre></td></tr></table></figure></p>
<p>MP3å¸§ç»“æ„å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-------------------------</span><br><span class="line">| å¸§ |    å¸§å¤´(4bytes)   |</span><br><span class="line">|    | ------------------</span><br><span class="line">| ç»“ |  CRC,å¯é€‰(2bytes) |</span><br><span class="line">|    | ------------------</span><br><span class="line">| æ„ |      éŸ³é¢‘æ•°æ®     |</span><br><span class="line">-------------------------</span><br></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥å¸§å¤´ï¼ˆAAAAAAAA  AAABBCCD  EEEEFFGH  IIJJKLMM ï¼‰ç»“æ„å¦‚ä¸‹ï¼š<br>syncï¼š11ä½ã€‚å¸§åŒæ­¥æ•°æ®ï¼Œå¯ä»¥é€šè¿‡æŸ¥æ‰¾åŒæ­¥ä½æ¥ç¡®å®šå¸§çš„èµ·å§‹ä½ç½®ï¼Œé€šå¸¸æƒ…å†µä¸‹å…¨éƒ¨è¢«è®¾ç½®ä¸º1</p>
<ul>
<li>versionï¼š2ä½ã€‚MPEGéŸ³é¢‘ç‰ˆæœ¬å·<ul>
<li>00ï¼šMPEG 2.5ï¼Œéå®˜æ–¹ç‰ˆæœ¬</li>
<li>01ï¼šä¿ç•™</li>
<li>10ï¼šMPEG 2</li>
<li>11ï¼šMPEG 1</li>
</ul>
</li>
<li>layerï¼š2ä½ã€‚å±‚<ul>
<li>00ï¼šä¿ç•™</li>
<li>01ï¼šLayer 3</li>
<li>10ï¼šLayer 2</li>
<li>11ï¼šLayer 1</li>
</ul>
</li>
<li>errorProtectionï¼š1ä½ã€‚CRCæ ¡éªŒä½ã€‚0åˆ™ä¼šæœ‰2ä¸ªå­—èŠ‚çš„CRCæ ¡éªŒä½ï¼›1åˆ™æ— </li>
<li>bitRateIndexï¼š4ä½ã€‚æ¯”ç‰¹ç‡ç´¢å¼•å€¼ï¼Œå•ä½kbpsã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180103001123.png?imageslim" alt=""></li>
<li>sampleRateIndexï¼š2ä½ã€‚é‡‡æ ·ç‡ç´¢å¼•ï¼Œå•ä½Hzã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/180103001206.png?imageslim" alt=""></li>
<li>paddingï¼š1ä½ã€‚è¡¥å……ä½ã€‚0è¡¨ç¤ºæ— å¡«å……ï¼Œ1åˆ™æœ‰å¡«å……ã€‚å¯¹äºLayer 1ï¼Œå¡«å……ä½é•¿åº¦ä¸º4ä¸ªå­—èŠ‚ï¼›Layer2 å’ŒLayer3 çš„å¡«å……ä½é•¿åº¦åˆ™æœ‰1ä¸ªå­—èŠ‚ã€‚</li>
<li>extensionï¼š1ä½ã€‚ç§æœ‰æ ‡å¿—ä½ã€‚</li>
<li>channelModeï¼š2ä½ã€‚å£°é“æ¨¡å¼ã€‚<ul>
<li>00ï¼šç«‹ä½“å£°</li>
<li>01ï¼šè”åˆç«‹ä½“å£°</li>
<li>10ï¼šåŒå£°é“</li>
<li>11ï¼šå•å£°é“</li>
</ul>
</li>
<li>modeExtensionï¼š2ä½ã€‚æ¨¡å¼çš„æ‰©å±•ï¼Œåªæœ‰å£°é“ä¸ºè”åˆç«‹ä½“å£°æ—¶æ‰æœ‰æ„ä¹‰ã€‚</li>
<li>copyrightï¼š1ä½ã€‚ç‰ˆæƒæ ‡å¿—ã€‚</li>
<li>originalï¼š1ä½ã€‚åŸç‰ˆæ ‡å¿—ã€‚</li>
<li>emphasisï¼šå¼ºè°ƒæ–¹å¼ã€‚</li>
</ul>
<h2 id="å…³äºflv-js"><a href="#å…³äºflv-js" class="headerlink" title="å…³äºflv.js"></a>å…³äºflv.js</h2><p>æˆ‘åœ¨ç¬¬ä¸€ç¯‡çš„æ—¶å€™è¯´è¿‡ï¼Œflvæ˜¯éŸ³é¢‘æ ¼å¼åªæœ‰aacï¼Œè€Œf4vçš„éŸ³é¢‘æ ¼å¼æ‰æœ‰äº†æ”¯æŒaacè·Ÿmp3ã€‚ç„¶åæˆ‘åœ¨<a href="http://download.macromedia.com/f4v/video_file_format_spec_v10_1.pdf" target="_blank" rel="noopener">video_file_format_spec</a>å´æ²¡æœ‰æ‰¾åˆ°å…³äºmp3çš„è§£æï¼Œåè€Œé€šè¿‡äº†åˆ†æå·¥å…·æ‰è·çŸ¥å‡å¦‚éŸ³é¢‘ä¸ºmp3ï¼Œåˆ™æ˜¯ä¸éœ€è¦è§£æID3é‚£éƒ¨åˆ†çš„ï¼Œç›´æ¥è§£æ<strong>Frame</strong>è¿™ä¸€éƒ¨åˆ†ã€‚æ‰€ä»¥flv.jsä»£ç ç‰‡æ®µä¸ºï¼Œè€Œè¿™éƒ¨åˆ†çš„è§£é‡Šå‚è€ƒä¸Šé¢<strong>Frame</strong>éƒ¨åˆ†ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (array[<span class="number">0</span>] !== <span class="number">0xFF</span>) &#123;</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> ver = (array[<span class="number">1</span>] &gt;&gt;&gt; <span class="number">3</span>) &amp; <span class="number">0x03</span>;</span><br><span class="line"><span class="keyword">let</span> layer = (array[<span class="number">1</span>] &amp; <span class="number">0x06</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> bitrate_index = (array[<span class="number">2</span>] &amp; <span class="number">0xF0</span>) &gt;&gt;&gt; <span class="number">4</span>;</span><br><span class="line"><span class="keyword">let</span> sampling_freq_index = (array[<span class="number">2</span>] &amp; <span class="number">0x0C</span>) &gt;&gt;&gt; <span class="number">2</span>;</span><br><span class="line"><span class="keyword">let</span> channel_mode = (array[<span class="number">3</span>] &gt;&gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x03</span>;</span><br><span class="line"><span class="keyword">let</span> channel_count = channel_mode !== <span class="number">3</span> ? <span class="number">2</span> : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> sample_rate = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> bit_rate = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> object_type = <span class="number">34</span>;  <span class="comment">// Layer-3, listed in MPEG-4 Audio Object Types</span></span><br><span class="line"><span class="keyword">let</span> codec = <span class="string">'mp3'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(ver) &#123;</span><br><span class="line">	sample_rate = <span class="keyword">this</span>._mpegAudioV25SampleRateTable[sampling_freq_index];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(layer) &#123;</span><br><span class="line">	bit_rate = <span class="keyword">this</span>._mpegAudioL3BitRateTable[bitrate_index];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="http://wiki.gimoo.net/view/10352.html" target="_blank" rel="noopener">ID3_æŠ€æœ¯ç™¾ç§‘</a></li>
<li><a href="http://blog.csdn.net/u014294166/article/details/53153507" target="_blank" rel="noopener">åˆ†æID3æ ¼å¼ - CSDNåšå®¢</a></li>
<li><a href="http://blog.csdn.net/u013904227/article/details/52184038" target="_blank" rel="noopener">MP3æ–‡ä»¶æ ¼å¼å…¨è§£ - YellowMax        - CSDNåšå®¢</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘å­¦ä¹ -flvä¹‹AudioTag(1)]]></title>
      <url>https://lucius0.github.io/2017/12/27/archivers/media-study-03/</url>
      <content type="html"><![CDATA[<p>åˆæ¬¡å­¦ä¹ æœ‰å…³éŸ³è§†é¢‘è¿™ä¸€å—çš„å¼€å‘ï¼Œä¸»è¦æ˜¯åŸºäº <strong><a href="https://github.com/Bilibili/flv.js" target="_blank" rel="noopener">flv.js</a></strong> çš„å­¦ä¹ ã€‚è¿™ä¸€å—çš„çŸ¥è¯†æ¦‚å¿µå®åœ¨æ˜¯å¤ªå¤šå¤ªæ·±äº†ï¼Œæ‰€ä»¥æœ¬äººæ˜¯å…ˆåœ¨æœ¬åœ°åšè®°å½•ï¼Œåé¢ä¼šæ•´ç†æ…¢æ…¢åœ°ä¸Šä¼ ä¸å„ä½åˆ†äº«ï¼Œå‡å¦‚æœ‰åœ°æ–¹è¯´é”™ï¼Œè¯·å‹˜è¯¯ã€‚è°¢è°¢æŒ‡ç‚¹ã€‚</p>
<p>åœ¨ç¬¬ä¸€ç¯‡<a href="https://lucius0.github.io/2017/12/25/archivers/media-study-01/">flvåˆè®¤è¯†</a>ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè§£æ<strong>Tag Header</strong>çš„å…¶å®æ— è®ºæ˜¯ScriptTagï¼ŒAudioTagï¼Œè¿˜æ˜¯VideoTagï¼Œå®é™…ä¸Šçš„è§„èŒƒéƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯11ä¸ªå­—èŠ‚çš„<strong>Tag Header</strong>ï¼Œå”¯ä¸€åŒºåˆ†ç±»å‹çš„å°±æ˜¯ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tagType = v.getUint8(<span class="number">0</span>); <span class="comment">// 0x08è¡¨ç¤ºéŸ³é¢‘Tag</span></span><br></pre></td></tr></table></figure></p>
<p><strong>Audio Tag Body</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> soundSpec = v.getUint8(<span class="number">0</span>); <span class="comment">// ç¬¬1ä¸ªå­—èŠ‚ï¼ŒéŸ³é¢‘å‚æ•°æ ¼å¼</span></span><br><span class="line"><span class="keyword">let</span> soundFormat = soundSpec &gt;&gt;&gt; <span class="number">4</span>; <span class="comment">// å‰4ä½ï¼Œæ ‡è¯†éŸ³é¢‘æ•°æ®çš„æ ¼å¼ï¼Œè¿™é‡Œåªå¯¹AACè·ŸMP3åšå¤„ç†ã€‚</span></span><br><span class="line"><span class="keyword">let</span> soundRateIndex = (soundSpec &amp; <span class="number">12</span>) &gt;&gt;&gt; <span class="number">2</span>; <span class="comment">// 5ã€6ä½ï¼ŒéŸ³é¢‘é‡‡æ ·ç‡ï¼Œflv</span></span><br><span class="line"><span class="keyword">if</span> (soundRateIndex &gt;= <span class="number">0</span> &amp;&amp; soundRateIndex &lt;= <span class="number">4</span>) &#123;</span><br><span class="line">    soundRate = [<span class="number">5500</span>, <span class="number">11025</span>, <span class="number">22050</span>, <span class="number">44100</span>, <span class="number">48000</span>][soundRateIndex];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> soundSize = (soundSpec &amp; <span class="number">2</span>) &gt;&gt;&gt; <span class="number">1</span>; <span class="comment">// ç¬¬7ä½ï¼Œé‡‡æ ·ç²¾åº¦</span></span><br><span class="line"><span class="keyword">let</span> soundType = (soundSpec &amp; <span class="number">1</span>); <span class="comment">// ç¬¬8ä½ï¼ŒéŸ³é¢‘ç±»å‹</span></span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œæˆ‘äº§ç”Ÿç–‘é—®äº†ã€‚flvä¸æ˜¯åªæ”¯æŒ5500, 11025, 22050, 44100çš„é‡‡æ ·ç‡å—ï¼Ÿä¸ºä»€ä¹ˆä½œè€…è¿˜å¤šåŠ äº†ä¸€ä¸ª48000ï¼Ÿ è¿™é‡Œå¯ä»¥æŸ¥åˆ°é‡‡æ ·ç‡çš„ä¿¡æ¯<a href="https://www.adobe.com/content/dam/acom/en/devnet/flv/video_file_format_spec_v10.pdf" target="_blank" rel="noopener">video_file_format_spec_v10</a>ï¼Œ@1ã€‚æœ‰çŸ¥é“çš„èƒ–å‹éº»çƒ¦å‘ŠçŸ¥ä¸€ä¸‹ï¼Œè°¢è°¢ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/171227220536.png?imageslim" alt=""></p>
<h2 id="AAC"><a href="#AAC" class="headerlink" title="AAC"></a>AAC</h2><blockquote>
<p>AACæ˜¯é«˜çº§éŸ³é¢‘ç¼–ç ï¼ˆAdvanced Audio Codingï¼‰çš„ç¼©å†™ï¼Œå‡ºç°äº1997å¹´ï¼Œæœ€åˆæ˜¯åŸºäºMPEG-2çš„éŸ³é¢‘ç¼–ç æŠ€æœ¯ã€‚ç”±Fraunhofer IISã€Dolby Laboratoriesã€AT&amp;Tã€Sonyç­‰å…¬å¸å…±åŒå¼€å‘ï¼Œç›®çš„æ˜¯å–ä»£MP3æ ¼å¼ã€‚2000å¹´ï¼ŒMPEG-4æ ‡å‡†å‡ºå°ï¼ŒAACé‡æ–°é›†æˆäº†å…¶å®ƒæŠ€æœ¯ï¼ˆPS,SBRï¼‰ï¼Œä¸ºåŒºåˆ«äºä¼ ç»Ÿçš„MPEG-2 AAC(MPEG-2 Part7)ï¼Œæ•…å«æœ‰SBRæˆ–PSç‰¹æ€§çš„AACåˆç§°ä¸ºMPEG-4 AAC(MPEG-4 Part3)ã€‚<br>AACæ˜¯æ–°ä¸€ä»£çš„éŸ³é¢‘æœ‰æŸå‹ç¼©æŠ€æœ¯ï¼Œå®ƒé€šè¿‡ä¸€äº›é™„åŠ çš„ç¼–ç æŠ€æœ¯ï¼ˆæ¯”å¦‚PS,SBRç­‰ï¼‰ï¼Œè¡ç”Ÿå‡ºäº†LC-AAC,HE-AAC,HE-AACv2ä¸‰ç§ä¸»è¦çš„ç¼–ç ï¼ŒLC-AACå°±æ˜¯æ¯”è¾ƒä¼ ç»Ÿçš„AACã€‚</p>
</blockquote>
<p>AACå³ä¸ºä¸Šæ–‡æåˆ°çš„<code>soundFormat</code>ä¸º0xAçš„éŸ³é¢‘æ ¼å¼ï¼Œè€ŒAACAudioDataæ˜¯åœ¨Flash Player 9ä»¥ä¸Šæ”¯æŒçš„ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/171227220925.png?imageslim" alt=""><br>ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡å» soundSpec</span></span><br><span class="line">parseAACAudioData(arrayBuffer, dataOffset + <span class="number">1</span>, dataSize - <span class="number">1</span>); </span><br><span class="line"><span class="comment">// 0: AAC sequence header</span></span><br><span class="line"><span class="comment">// 1: AAC raw</span></span><br><span class="line"><span class="comment">// ä¸€èˆ¬Sequence Headerä¸ºç¬¬ä¸€ä¸ªAudio Tagï¼Œå¹¶ä¸”å…¨æ–‡ä»¶åªå‡ºç°ä¸€æ¬¡</span></span><br><span class="line">result.packetType = array[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// è¿™é‡Œåªé’ˆå¯¹äº†AAC sequence headerä½œäº†å¤„ç†ï¼Œè€ŒAAC rawåˆ™å°±æ˜¯Audio payloadã€‚dataOffset+1ï¼Œè·³è¿‡äº†ä¸Šæ–‡æåˆ°çš„AACPacketTypeï¼Œ1ä¸ªå­—èŠ‚</span></span><br><span class="line"><span class="comment">// ADTS</span></span><br><span class="line">parseAACAudioSpecificConfig(arrayBuffer, dataOffset + <span class="number">1</span>, dataSize - <span class="number">1</span>);</span><br></pre></td></tr></table></figure></p>
<p><strong>AAC sequence header</strong>åŒ…å«äº†AudioSpecificConfigï¼Œæœ‰æ›´è¯¦ç»†éŸ³é¢‘çš„ä¿¡æ¯ï¼Œä½†è¿™ç§åŒ…åªå‡ºç°ä¸€æ¬¡ï¼Œè€Œä¸”æ˜¯ç¬¬ä¸€ä¸ªAudio Tagï¼Œå› ä¸ºåé¢çš„éŸ³é¢‘ESæµéœ€è¦è¯¥headerçš„ADST(Audio Data Transport Stream)å¤´ã€‚<strong>AAC raw</strong>åˆ™åŒ…å«éŸ³é¢‘ESæµäº†ï¼Œä¹Ÿå°±æ˜¯audio payloadï¼Œä¹Ÿå°±æ˜¯è¯´ADTSå¤´å¯ä»¥çœ‹æˆAACçš„frameheaderã€‚<a href="http://blog.csdn.net/tx3344/article/details/7414543" target="_blank" rel="noopener">ã€å¤šåª’ä½“å°è£…æ ¼å¼è¯¦è§£ã€‘â€” AAC ADTSæ ¼å¼åˆ†æ</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------------------------------------</span><br><span class="line">|                         ADTS AAC                           |</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">| ADTS_header	| AAC ES |     ...    | ADTS_header | AAC ES |</span><br><span class="line">--------------------------------------------------------------</span><br></pre></td></tr></table></figure></p>
<p>å…³äºAudio Specific Configï¼Œå¯ä»¥çœ‹<a href="http://read.pudn.com/downloads98/doc/comm/401153/14496/ISO_IEC_14496-3%20Part%203%20Audio/C036083E_SUB1.PDF" target="_blank" rel="noopener">ISO 14496-3</a>ï¼Œä¹Ÿå¯ä»¥åœ¨ffmpegä¸­æ‰¾åˆ°å¯¹åº”çš„è§£æå‡½æ•°ï¼Œ<code>ff_mpeg4audio_get_config()</code><br><img src="http://ouazw12mz.bkt.clouddn.com/171227221451.png?imageslim" alt=""><br>Audio Object Typeså’ŒSampling Frequency Indexåœ¨<a href="https://wiki.multimedia.cx/index.php?title=MPEG-4_Audio" target="_blank" rel="noopener">MPEG-4_Audio</a>æ–‡ç« ä¸­æœ‰è¯¦ç»†æè¿°ã€‚</p>
<h3 id="Audio-Object-Types"><a href="#Audio-Object-Types" class="headerlink" title="Audio Object Types"></a>Audio Object Types</h3><ul>
<li>0: Null</li>
<li>1: AAC Main</li>
<li>2: AAC LC (Low Complexity)</li>
<li>3: AAC SSR (Scalable Sample Rate)</li>
<li>4: AAC LTP (Long Term Prediction)</li>
<li>5: HE-AAC / AAC SBR (Spectral Band Replication)</li>
<li>6: AAC Scalable</li>
<li>7: TwinVQ</li>
<li>â€¦</li>
</ul>
<h3 id="Sampling-Frequency-Index"><a href="#Sampling-Frequency-Index" class="headerlink" title="Sampling Frequency Index"></a>Sampling Frequency Index</h3><ul>
<li>0: 96000 Hz</li>
<li>1: 88200 Hz</li>
<li>2: 64000 Hz</li>
<li>3: 48000 Hz</li>
<li>4: 44100 Hz</li>
<li>5: 32000 Hz</li>
<li>6: 24000 Hz</li>
<li>7: 22050 Hz</li>
<li>8: 16000 Hz</li>
<li>9: 12000 Hz</li>
<li>10: 11025 Hz</li>
<li>11: 8000 Hz</li>
<li>12: 7350 Hz</li>
<li>13: Reserved</li>
<li>14: Reserved</li>
<li>15: frequency is written explicitly</li>
</ul>
<h3 id="Channel-Configurations"><a href="#Channel-Configurations" class="headerlink" title="Channel Configurations"></a>Channel Configurations</h3><ul>
<li>0: Defined in AOT Specifc Config    </li>
<li>1: 1 channel: front-center</li>
<li>2: 2 channels: front-left, front-right</li>
<li>3: 3 channels: front-center, front-left, front-right</li>
<li>4: 4 channels: front-center, front-left, front-right, back-center</li>
<li>5: 5 channels: front-center, front-left, front-right, back-left, back-right</li>
<li>6: 6 channels: front-center, front-left, front-right, back-left, back-right, LFE-channel</li>
<li>7: 8 channels: front-center, front-left, front-right, side-left, side-right, back-left, back-right, LFE-channel</li>
<li>8-15: Reserved</li>
</ul>
<p>ä¼ªä»£ç ä¸ºï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span> bits: object type</span><br><span class="line"><span class="number">4</span> bits: frequency index</span><br><span class="line"><span class="keyword">if</span> (frequency index == <span class="number">15</span>)</span><br><span class="line">    <span class="number">24</span> bits: frequency</span><br><span class="line"><span class="number">4</span> bits: channel configuration</span><br><span class="line"><span class="number">1</span> bit: frame length flag</span><br><span class="line"><span class="number">1</span> bit: dependsOnCoreCoder</span><br><span class="line"><span class="number">1</span> bit: extensionFlag</span><br><span class="line"></span><br><span class="line"><span class="number">5</span> bits: <span class="number">2</span> (<span class="number">00010</span>) <span class="comment">// Audio Object Type - AAC LC</span></span><br><span class="line"><span class="number">4</span> bits: <span class="number">4</span> (<span class="number">0100</span>)  <span class="comment">// Sampling Frequency Index - 44kHz</span></span><br><span class="line"><span class="number">4</span> bits: <span class="number">2</span> (<span class="number">0010</span>)  <span class="comment">// Channel - leftï¼Œright</span></span><br><span class="line"><span class="number">3</span> bits: <span class="number">0</span> (<span class="number">000</span>)   <span class="comment">// Reserved</span></span><br><span class="line"></span><br><span class="line">Byte <span class="number">1</span>: <span class="number">00010010</span></span><br><span class="line">Byte <span class="number">2</span>: <span class="number">00010000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 bytes</span></span><br><span class="line"><span class="number">00010</span>|<span class="number">010</span> <span class="number">0</span>|<span class="number">0010</span>|<span class="number">000</span></span><br><span class="line"> [<span class="number">2</span>]   [<span class="number">4</span>]   [<span class="number">2</span>] [<span class="number">0</span>]</span><br></pre></td></tr></table></figure></p>
<p>ç°åœ¨æˆ‘ä»¬å†æ¥çœ‹çœ‹flv.jså¯¹äºè¿™ä¸€å—çš„å¤„ç†ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 5 bits Audio Object Type</span></span><br><span class="line">audioObjectType = originalAudioObjectType = array[<span class="number">0</span>] &gt;&gt;&gt; <span class="number">3</span>;</span><br><span class="line"><span class="comment">// 4 bits Sampling Frequency Index</span></span><br><span class="line">samplingIndex = ((array[<span class="number">0</span>] &amp; <span class="number">0x07</span>) &lt;&lt; <span class="number">1</span>) | (array[<span class="number">1</span>] &gt;&gt;&gt; <span class="number">7</span>);</span><br><span class="line"><span class="comment">// 4 bits Channel Config</span></span><br><span class="line">channelConfig = (array[<span class="number">1</span>] &amp; <span class="number">0x78</span>) &gt;&gt;&gt; <span class="number">3</span>;</span><br></pre></td></tr></table></figure></p>
<p>é’ˆå¯¹å„è®¾å¤‡çš„å…¼å®¹æ€§å¤„ç†ï¼Œ<code>audioObjectType</code>çš„å¤„ç†å¯ä»¥å‚è€ƒè¿™é‡Œ<a href="https://cconcolato.github.io/media-mime-support/" target="_blank" rel="noopener">Media MIME Support</a>ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// firefox - firefox: freq less than 24kHz = AAC SBR (HE-AAC)</span></span><br><span class="line"><span class="comment">// Android: always use AAC</span></span><br><span class="line"><span class="comment">// for other browsers (Chrome/Vivaldi/Opera ...): always force audio type to be HE-AAC SBR, as some browsers do not support audio codec switch properly (like Chrome ...)</span></span><br></pre></td></tr></table></figure></p>
<p>è€Œ<code>extensionSamplingIndex</code>ï¼Œè¿™é‡Œå…¶å®æˆ‘ä¹Ÿå¾ˆè¿·ç³Šä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå¤„ç†ï¼Œç²¾åŠ›æœ‰é™ä¹Ÿæ²¡æœ‰æ·±å…¥å»æ‰¾èµ„æ–™äº†ï¼Œæœ‰çŸ¥é“çš„æœ‹å‹è¯·æ•™ä¸€ä¸‹ã€‚è°¢è°¢äº†ã€‚å”¯ä¸€æ¸…æ¥šæ‰¾åˆ°çš„æ˜¯åœ¨hlsjsä¸­ä¹Ÿæœ‰ç›¸å…³çš„ä»£ç ï¼Œä½œè€…è¿™ä¸€å—æ˜¯å‚è€ƒhlsjsçš„ã€‚ @2</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éŸ³é¢‘å¸§é‡‡æ ·æ—¶é—´è¦è·Ÿé‡‡æ ·ç‡æœ‰å…³çš„å€¼ä¸€è‡´ã€‚å¦åˆ™ï¼Œæµè§ˆå™¨å°†å¼ºåˆ¶è°ƒæ•´æ’­æ”¾æ—¶é—´æˆ³ä»¥ä½¿éŸ³é¢‘æ— ç¼æ’­æ”¾ï¼Œè¿™å¯èƒ½å¯¼è‡´A / Vå¼‚æ­¥ã€‚</span></span><br><span class="line">meta.refSampleDuration = <span class="number">1024</span> / meta.audioSampleRate * meta.timescale</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‚è€ƒä¸‹å›¾ï¼š<br><img src="http://ouazw12mz.bkt.clouddn.com/171227222007.png?imageslim" alt=""></p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="https://www.adobe.com/content/dam/acom/en/devnet/flv/video_file_format_spec_v10.pdf" target="_blank" rel="noopener">video_file_format_spec_v10</a></li>
<li><a href="https://xiaozhuanlan.com/topic/6253091478" target="_blank" rel="noopener">AAC Audio Data</a></li>
<li><a href="https://wiki.multimedia.cx/index.php/Understanding_AAC" target="_blank" rel="noopener">Understanding_AAC</a></li>
<li><a href="https://wiki.multimedia.cx/index.php?title=MPEG-4_Audio" target="_blank" rel="noopener">MPEG-4_Audio</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E9%80%B2%E9%9A%8E%E9%9F%B3%E8%A8%8A%E7%B7%A8%E7%A2%BC" target="_blank" rel="noopener">é«˜çº§éŸ³é¢‘ç¼–ç  - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦</a></li>
<li><a href="https://stackoverflow.com/questions/18603605/what-are-the-limitations-of-html5-audio-on-android-and-ios" target="_blank" rel="noopener">html - What are the limitations of HTML5 audio on Android and iOS? - Stack Overflow</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘å­¦ä¹ -flvä¹‹ScriptTag]]></title>
      <url>https://lucius0.github.io/2017/12/26/archivers/media-study-02/</url>
      <content type="html"><![CDATA[<p>åˆæ¬¡å­¦ä¹ æœ‰å…³éŸ³è§†é¢‘è¿™ä¸€å—çš„å¼€å‘ï¼Œä¸»è¦æ˜¯åŸºäº <strong><a href="https://github.com/Bilibili/flv.js" target="_blank" rel="noopener">flv.js</a></strong> çš„å­¦ä¹ ã€‚è¿™ä¸€å—çš„çŸ¥è¯†æ¦‚å¿µå®åœ¨æ˜¯å¤ªå¤šå¤ªæ·±äº†ï¼Œæ‰€ä»¥æœ¬äººæ˜¯å…ˆåœ¨æœ¬åœ°åšè®°å½•ï¼Œåé¢ä¼šæ•´ç†æ…¢æ…¢åœ°ä¸Šä¼ ä¸å„ä½åˆ†äº«ï¼Œå‡å¦‚æœ‰åœ°æ–¹è¯´é”™ï¼Œè¯·å‹˜è¯¯ã€‚è°¢è°¢æŒ‡ç‚¹ã€‚</p>
<h2 id="è§£æFLV-Header-9bytes"><a href="#è§£æFLV-Header-9bytes" class="headerlink" title="è§£æFLV-Header(9bytes)"></a>è§£æFLV-Header(9bytes)</h2><p>åœ¨<a href="https://lucius0.github.io/2017/12/25/archivers/media-study-01/">ä¸Šä¸€ç¯‡</a>ä¸­æˆ‘ä»¬å¾—çŸ¥ï¼ŒFLV-Headerå…¶å®å¾ˆå¥½è§£æï¼Œæ— éå°±æ˜¯è¯»å‡ºå‰é¢çš„9ä¸ªå­—èŠ‚ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(buffer);<span class="comment">// bufferä¸ºè¯»å–çš„äºŒè¿›åˆ¶ç¼“å†²åŒº</span></span><br><span class="line">data[<span class="number">0</span>]; <span class="comment">// 0x46</span></span><br><span class="line">data[<span class="number">1</span>]; <span class="comment">// 0x4C</span></span><br><span class="line">data[<span class="number">2</span>]; <span class="comment">// 0x56</span></span><br><span class="line">data[<span class="number">3</span>]; <span class="comment">// 0x01</span></span><br><span class="line"><span class="comment">// ä»¥ä¸Šå››ä¸ªå­—èŠ‚å°±æ˜¯å‰æ–‡æåˆ°çš„ï¼Œåˆ†åˆ«ä»£è¡¨ç±»å‹æ ‡å¿—ç¬¦'F','L','V'åŠç‰ˆæœ¬å·0x01</span></span><br><span class="line"></span><br><span class="line">data[<span class="number">4</span>]; <span class="comment">// 0x05è¡¨ç¤ºéŸ³è§†é¢‘tagéƒ½æœ‰ï¼Œ0x04è¡¨ç¤ºåªæœ‰éŸ³é¢‘tagï¼Œ0x01è¡¨ç¤ºåªæœ‰è§†é¢‘tag</span></span><br><span class="line"><span class="comment">// hasAudio = (data[4] &amp; 0x04 === 4)</span></span><br><span class="line"><span class="comment">// hasVideo = (data[4] &amp; 0x01 === 1)</span></span><br><span class="line"></span><br><span class="line">data.slice(<span class="number">5</span>, <span class="number">5</span> + <span class="number">4</span>); <span class="comment">// 0x09ï¼Œå››ä¸ªå­—èŠ‚ï¼ŒHeaderSize</span></span><br></pre></td></tr></table></figure></p>
<h2 id="è§£æFLV-Body"><a href="#è§£æFLV-Body" class="headerlink" title="è§£æFLV-Body"></a>è§£æFLV-Body</h2><h3 id="Previous-Tag-Size-0"><a href="#Previous-Tag-Size-0" class="headerlink" title="Previous Tag Size #0"></a>Previous Tag Size #0</h3><p>å› ä¸ºç¬¬ä¸€ä¸ª<code>Previous Tag Size</code>åŸºæœ¬ä¸Šéƒ½æ˜¯å›ºå®šçš„ï¼Œå ç”¨4ä¸ªå­—èŠ‚ï¼Œå¯ä»¥ç•¥è¿‡çš„äº†ã€‚å…³äºå¤§ç«¯å°ç«¯ï¼š<a href="http://imweb.io/topic/57fe263b2a25000c315a3d8a" target="_blank" rel="noopener">ç½‘ç»œåºï¼Ÿæœ¬åœ°åºï¼Ÿå‚»å‚»åˆ†ä¸æ¸…æ¥š</a>ï¼Œè€Œflvæ˜¯é‡‡å–å¤§ç«¯åºçš„ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> v = <span class="keyword">new</span> <span class="built_in">DataView</span>(chunk, offset);</span><br><span class="line"><span class="keyword">let</span> prevTagSize0 = v.getUint32(<span class="number">0</span>, !le); <span class="comment">// 4ä¸ªå­—èŠ‚ï¼Œå¹¶ä¸”ä»¥å¤§ç«¯è¯»å–</span></span><br><span class="line"><span class="comment">// v.getUint32(0, false); // ä¹Ÿæ˜¯è¡¨ç¤ºä»¥å¤§ç«¯è¯»å–</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Tag-1-ScriptTag"><a href="#Tag-1-ScriptTag" class="headerlink" title="Tag # 1( ScriptTag )"></a>Tag # 1( ScriptTag )</h3><p><strong>Tag Header(11bytes)</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 11bytes</span></span><br><span class="line"><span class="keyword">let</span> tagType = v.getUint8(<span class="number">0</span>); <span class="comment">// ä»ç¬¬1ä¸ªå­—èŠ‚è¯»å–ä¸€ä¸ª8ä½æ— ç¬¦å·æ•´æ•°</span></span><br><span class="line"><span class="keyword">let</span> dataSize = v.getUint32(<span class="number">0</span>, !le) &amp; <span class="number">0x00FFFFFF</span>; <span class="comment">// å¤§ç«¯è¯»å–ï¼Œæˆªå–3ä¸ªå­—èŠ‚</span></span><br><span class="line"><span class="comment">// è·å– timestamp</span></span><br><span class="line"><span class="keyword">let</span> ts2 = v.getUint8(<span class="number">4</span>);</span><br><span class="line"><span class="keyword">let</span> ts1 = v.getUint8(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">let</span> ts0 = v.getUint8(<span class="number">6</span>);</span><br><span class="line"><span class="keyword">let</span> ts3 = v.getUint8(<span class="number">7</span>);</span><br><span class="line"><span class="keyword">let</span> timestamp = ts0 | (ts1 &lt;&lt; <span class="number">8</span>) | (ts2 &lt;&lt; <span class="number">16</span>) | (ts3 &lt;&lt; <span class="number">24</span>);</span><br><span class="line"><span class="comment">// è·å–streamId</span></span><br><span class="line"><span class="keyword">let</span> streamId = v.getUint32(<span class="number">7</span>, !le) &amp; <span class="number">0x00FFFFFF</span>;</span><br></pre></td></tr></table></figure></p>
<p><strong>Tag Body</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸Šé¢çš„å­—èŠ‚æ€»å…±ä¸º11ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥offset + 11ï¼Œåº”è¯¥ä¸º24</span></span><br><span class="line"><span class="keyword">let</span> dataOffset = offset + <span class="number">11</span>;</span><br></pre></td></tr></table></figure></p>
<p>æ ¹æ®ä¸Šä¸€ç¯‡çš„ç»“æ„å›¾ï¼Œè¿™é‡Œå°±æ˜¯ScriptTagçš„Tag Dataä¸­çš„keyï¼Œå…³äº<a href="https://en.wikipedia.org/wiki/Action_Message_Format" target="_blank" rel="noopener">AMF</a><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AMFParser</span></span><br><span class="line"><span class="keyword">let</span> name = AMF.parseValue(arrayBuffer, dataOffset, dataSize);</span><br><span class="line">------------------------ parseValue ------------------------</span><br><span class="line"><span class="comment">// ç”±ä¸Šä¸€ç¯‡çŸ¥é“ï¼Œç¬¬1ä¸ªå­—èŠ‚typeä¸ºAMF Stringç±»å‹ï¼Œ0x02</span></span><br><span class="line"><span class="keyword">let</span> offset = <span class="number">1</span>; </span><br><span class="line"><span class="keyword">let</span> type = v.getUint8(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">let</span> value;</span><br><span class="line"><span class="keyword">let</span> amfstr = AMF.parseString(arrayBuffer, dataOffset + <span class="number">1</span>, dataSize - <span class="number">1</span>); <span class="comment">// é™¤å»typeé•¿åº¦</span></span><br><span class="line">value = amfstr.data;</span><br><span class="line">offset += amfstr.size;</span><br><span class="line">------------------------ parseString ------------------------</span><br><span class="line"><span class="keyword">let</span> v = <span class="keyword">new</span> <span class="built_in">DataView</span>(arrayBuffer, dataOffset, dataSize);</span><br><span class="line"><span class="comment">// é•¿åº¦å æ®2ä¸ªå­—èŠ‚ï¼Œ0x0000A</span></span><br><span class="line"><span class="comment">// å¤§äºä¸”åŒ…æ‹¬ä¸¤ä¸ªå­—èŠ‚ä¸€èˆ¬éƒ½éœ€è¦æŒ‡å®šå­˜å‚¨æ–¹å¼</span></span><br><span class="line"><span class="keyword">let</span> length = v.getUint16(<span class="number">0</span>, !le); </span><br><span class="line"><span class="comment">// è¯»å–keyå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºonMetaDataã€‚</span></span><br><span class="line">str = decodeUTF8(<span class="keyword">new</span> <span class="built_in">Uint8Array</span>(arrayBuffer, dataOffset + <span class="number">2</span>, length));</span><br></pre></td></tr></table></figure></p>
<p>ScriptTagçš„Tag Dataä¸­çš„valueã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> value = AMF.parseValue(arrayBuffer, dataOffset + name.size, dataSize - name.size);</span><br><span class="line">------------------------ parseValue ------------------------</span><br><span class="line"><span class="keyword">let</span> offset = <span class="number">1</span>; </span><br><span class="line"><span class="keyword">let</span> value = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> type = v.getUint8(<span class="number">0</span>); <span class="comment">// 0x08ï¼ŒECMA array</span></span><br><span class="line">offset += <span class="number">4</span>;  <span class="comment">// ECMAArrayLength(UI32)</span></span><br><span class="line"><span class="keyword">let</span> terminal = <span class="number">0</span>;  <span class="comment">// workaround for malformed MixedArrays which has missing ScriptDataObjectEndï¼ˆä½œè€…å·²ç»è¯´æ˜äº†ï¼Œè¿™ä¸€å—æ˜¯ä¸ºäº†è§£å†³æœ‰äº›æ··åˆæ•°ç»„ç¼ºå¤±ScriptDataObjectEndæ•°æ®ï¼Œå› æ­¤åœ¨ä¸‹é¢å¯¹terminalä»¥åŠoffsetä½œäº†å…¼å®¹å¤„ç†)</span></span><br><span class="line"><span class="comment">// ä¸Šä¸€ç¯‡å·²ç»è¯´äº†ï¼Œæœ€åçš„3ä¸ªå­—èŠ‚å›ºå®šå€¼0x000009è¡¨ç¤ºvalueå€¼ç»“æŸ</span></span><br><span class="line"><span class="keyword">if</span> ((v.getUint32(dataSize - <span class="number">4</span>, !le) &amp; <span class="number">0x00FFFFFF</span>) === <span class="number">9</span>) &#123;</span><br><span class="line">    terminal = <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 8 === type(UI8) + ECMAArrayLength(UI32) + ScriptDataVariableEnd(UI24)</span></span><br><span class="line"><span class="keyword">while</span> (offset &lt; dataSize - <span class="number">8</span>) &#123;  </span><br><span class="line">    <span class="keyword">let</span> amfvar = AMF.parseVariable(arrayBuffer, dataOffset + offset, dataSize - offset - terminal);</span><br><span class="line">    <span class="keyword">if</span> (amfvar.objectEnd) <span class="keyword">break</span>;</span><br><span class="line">    value[amfvar.data.name] = amfvar.data.value;</span><br><span class="line">    offset += amfvar.size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>åé¢å³ä¸ºå„å…ƒç´ çš„å°è£…ï¼Œä¸ºä¸€ä¸€å¯¹åº”çš„é”®å€¼å¯¹ï¼Œå¸¸è§çš„MetaDataå¦‚ä¸‹ï¼š</p>
<ul>
<li>durationï¼šæ—¶é•¿</li>
<li>widthï¼šè§†é¢‘å®½åº¦</li>
<li>heightï¼šè§†é¢‘é«˜åº¦</li>
<li>videodatarateï¼šè§†é¢‘ç ç‡</li>
<li>framerateï¼šè§†é¢‘å¸§ç‡</li>
<li>videocodecidï¼šè§†é¢‘ç¼–ç æ–¹å¼</li>
<li>audiosamplerateï¼šéŸ³é¢‘é‡‡æ ·ç‡</li>
<li>audiosamplesizeï¼šéŸ³é¢‘é‡‡æ ·ç²¾åº¦</li>
<li>stereoï¼šæ˜¯å¦ä¸ºç«‹ä½“å£°</li>
<li>audiocodecidï¼šéŸ³é¢‘ç¼–ç æ–¹å¼</li>
<li>filesizeï¼šæ–‡ä»¶å¤§å°</li>
</ul>
<p>æœ€åç”¨3ä¸ªå­—èŠ‚çš„å›ºå®šå€¼0000 09è¡¨ç¤ºvalueå€¼ç»“æŸã€‚</p>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘å­¦ä¹ -flvåˆè®¤è¯†]]></title>
      <url>https://lucius0.github.io/2017/12/25/archivers/media-study-01/</url>
      <content type="html"><![CDATA[<p>åˆæ¬¡å­¦ä¹ æœ‰å…³éŸ³è§†é¢‘è¿™ä¸€å—çš„å¼€å‘ï¼Œä¸»è¦æ˜¯åŸºäº <strong><a href="https://github.com/Bilibili/flv.js" target="_blank" rel="noopener">flv.js</a></strong> çš„å­¦ä¹ ã€‚è¿™ä¸€å—çš„çŸ¥è¯†æ¦‚å¿µå®åœ¨æ˜¯å¤ªå¤šå¤ªæ·±äº†ï¼Œæ‰€ä»¥æœ¬äººæ˜¯å…ˆåœ¨æœ¬åœ°åšè®°å½•ï¼Œåé¢ä¼šæ•´ç†æ…¢æ…¢åœ°ä¸Šä¼ ä¸å„ä½åˆ†äº«ï¼Œå‡å¦‚æœ‰åœ°æ–¹è¯´é”™ï¼Œè¯·å‹˜è¯¯ã€‚è°¢è°¢æŒ‡ç‚¹ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯FLVï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯FLVï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯FLVï¼Ÿ"></a>ä»€ä¹ˆæ˜¯FLVï¼Ÿ</h2><blockquote>
<p>Flash Videoï¼ˆç®€ç§°FLVï¼‰ï¼Œæ˜¯ä¸€ç§ç½‘ç»œè§†é¢‘æ ¼å¼ï¼Œç”¨ä½œä¸²æµåª’ä½“æ ¼å¼ï¼Œå®ƒçš„å‡ºç°æœ‰æ•ˆåœ°è§£å†³äº†è§†é¢‘æ–‡ä»¶å¯¼å…¥Flashåï¼Œä½¿å¯¼å‡ºçš„SWFæ–‡ä»¶ä½“ç§¯åºå¤§ï¼Œä¸èƒ½åœ¨ç½‘ç»œä¸Šæœ‰æ•ˆä½¿ç”¨ç­‰ç¼ºç‚¹ã€‚<br>ä¸€èˆ¬FLVæ–‡ä»¶åŒ…åœ¨SWF PLAYERçš„å£³é‡Œï¼Œå¹¶ä¸”FLVå¯ä»¥å¾ˆå¥½çš„ä¿æŠ¤åŸå§‹åœ°å€ï¼Œä¸å®¹æ˜“è¢«ä¸‹è½½åˆ°ï¼Œä»è€Œèµ·åˆ°ä¿æŠ¤ç‰ˆæƒçš„ä½œç”¨ã€‚ä½†è¿˜æ˜¯æœ‰äº›è§†é¢‘æ ¼å¼è½¬æ¢è½¯ä»¶å°†FLVè½¬æˆä¸€èˆ¬çš„è§†é¢‘æ ¼å¼ï¼Œå¦‚ä¸­å›½çš„è½¯ä»¶æ ¼å¼å·¥å‚ã€‚éšç€è§†é¢‘ç½‘ç«™çš„ä¸°å¯Œï¼Œåœ¨2008å¹´æ—¶è¿™ä¸ªæ ¼å¼å·²ç»éå¸¸æ™®åŠï¼ŒåŒ…æ‹¬YouTubeã€NICONICOåŠ¨ç”»ã€Google Videoã€Yahoo! Videoã€MySpaceï¼Œä»¥åŠä¸­å›½çš„ä¼˜é…·ã€é…·6ç­‰å¤§éƒ¨åˆ†è§†é¢‘åˆ†äº«ç½‘ç«™å‡é‡‡ç”¨è¿™ä¸ªæ ¼å¼ã€‚â€”â€”- wikiç™¾ç§‘</p>
</blockquote>
<h2 id="FLVçš„åˆ†ç±»"><a href="#FLVçš„åˆ†ç±»" class="headerlink" title="FLVçš„åˆ†ç±»"></a>FLVçš„åˆ†ç±»</h2><p>é™¤äº† flvï¼ˆH264è§†é¢‘æ ¼å¼ã€AACéŸ³é¢‘æ ¼å¼ï¼‰ï¼Œè¿˜æœ‰ f4vï¼Œä¸»è¦æ˜¯ä¸ºäº†çªç ´ flv çš„é™åˆ¶ã€‚ f4v æ”¯æŒ H.264 è§†é¢‘æ ¼å¼ä¹‹å¤–ï¼Œè¿˜æ”¯æŒ GIFã€PNG ä»¥åŠ JPEGï¼›éŸ³é¢‘æ ¼å¼åˆ™æœ‰ AAC ä»¥åŠ MP3 ã€‚<br><strong>PSï¼š</strong> Adobeçš„è§„èŒƒä¸­ï¼ŒUB è¡¨ç¤ºUnsigned Bitï¼ŒUB(2)è¡¨ç¤º2ä¸ªbitï¼ŒUI è¡¨ç¤ºUnsigned Integerï¼ŒUI24 è¡¨ç¤º24ä½æ•´æ•°ï¼Œä¹Ÿå°±æ˜¯3ä¸ªByteã€‚</p>
<h2 id="FLVçš„ç»“æ„"><a href="#FLVçš„ç»“æ„" class="headerlink" title="FLVçš„ç»“æ„"></a>FLVçš„ç»“æ„</h2><p>å…ˆçœ‹ä¸€ä¸‹flvçš„ä¸€å°ç‰‡æ®µï¼Œè¿™æ˜¯ä¸€ä»½äºŒè¿›åˆ¶æ–‡ä»¶ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">464</span>c <span class="number">5601</span> <span class="number">0500</span> <span class="number">0000</span> <span class="number">0900</span> <span class="number">0000</span> <span class="number">0012</span> <span class="number">0000</span></span><br><span class="line"><span class="number">3</span>f00 <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0200</span> <span class="number">0</span>a6f <span class="number">6e4</span>d <span class="number">6574</span></span><br><span class="line"><span class="number">6144</span> <span class="number">6174</span> <span class="number">6108</span> <span class="number">0000</span> <span class="number">0002</span> <span class="number">0008</span> <span class="number">6475</span> <span class="number">7261</span></span><br><span class="line"><span class="number">7469</span> <span class="number">6</span>f6e <span class="number">0040</span> <span class="number">27</span>c8 b439 <span class="number">5810</span> <span class="number">6200</span> <span class="number">0</span>c76</span><br><span class="line"><span class="number">6964</span> <span class="number">656</span>f <span class="number">636</span>f <span class="number">6465</span> <span class="number">6369</span> <span class="number">6400</span> <span class="number">4000</span> <span class="number">0000</span></span><br><span class="line"><span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0900</span> <span class="number">0000</span> <span class="number">4</span>a08 <span class="number">0000</span> <span class="number">0400</span></span><br><span class="line"><span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> af00 <span class="number">1208</span> <span class="number">0000</span> <span class="number">000</span>f <span class="number">0900</span></span><br><span class="line"><span class="number">0043</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0017</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0142</span></span><br><span class="line"><span class="number">001</span>f <span class="number">0301</span> <span class="number">002</span>f <span class="number">6742</span> <span class="number">801</span>f <span class="number">9652</span> <span class="number">0283</span> f602</span><br><span class="line">a100 <span class="number">0003</span> <span class="number">0001</span> <span class="number">0000</span> <span class="number">0300</span> <span class="number">32e0</span> <span class="number">6003</span> <span class="number">0</span>d40</span><br><span class="line"><span class="number">0046</span> <span class="number">30</span>ff <span class="number">18e3</span> <span class="number">0300</span> <span class="number">186</span>a <span class="number">0002</span> <span class="number">3187</span> f8c7</span><br><span class="line"><span class="number">0</span>ed0 a152 <span class="number">4001</span> <span class="number">0004</span> <span class="number">68</span>cb <span class="number">8</span>d48 <span class="number">0000</span> <span class="number">004</span>e</span><br><span class="line"><span class="number">0900</span> <span class="number">0</span>d1c <span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0017</span> <span class="number">0100</span> <span class="number">029</span>d</span><br><span class="line"><span class="number">0000</span> <span class="number">0</span>d13 <span class="number">6588</span> <span class="number">8040</span> <span class="number">0</span>db1 <span class="number">185</span>c <span class="number">0008</span> <span class="number">2</span>d1f</span><br><span class="line"><span class="number">7893</span> de24 f789 f785 c2c4 f8a6 d3e2 <span class="number">43</span>fa</span><br><span class="line">f177 <span class="number">85</span>ea f377 a930 f991 ea7c <span class="number">4</span>f2a f0b9</span><br></pre></td></tr></table></figure></p>
<p>å®ƒçš„ç»“æ„å›¾æ˜¯è¿™æ ·çš„ã€‚<br><img src="http://ouazw12mz.bkt.clouddn.com/171225224159.png?imageslim" alt=""></p>
<p>FLV Headerè‡ªç„¶æ—¶ä¸ç”¨å¤šè¯´ï¼Œä¸Šé¢çš„ç»“æ„å›¾éƒ½ä¸€ç›®äº†ç„¶ã€‚é‡ç‚¹è®²ä¸‹Flv Bodyä¸‹çš„Tagçš„ä¸‰ç§ç±»å‹ã€‚</p>
<h3 id="Script-Tag"><a href="#Script-Tag" class="headerlink" title="Script Tag"></a>Script Tag</h3><p><strong>KEY</strong><br>1ã€ç¬¬1ä¸ªå­—èŠ‚ä¸ºAMFç±»å‹ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹çš„ç±»å‹ï¼š</p>
<ul>
<li>0 = Number</li>
<li>1 = Boolean</li>
<li>2 = String</li>
<li>3 = Object</li>
<li>4 = MovieClip (reserved, not supported)</li>
<li>5 = Null</li>
<li>6 = Undefined</li>
<li>7 = Reference</li>
<li>8 = ECMA array</li>
<li>9 = Object end marker</li>
<li>10 = Strict array</li>
<li>11 = Date</li>
<li>12 = Long string</li>
</ul>
<p>å› æ­¤ç¬¬ä¸€ä¸ªTag Data <code>onMetaData</code> çš„ç±»å‹ä¸º0x02ã€‚</p>
<p>2ã€ç¬¬2-3ä¸ªå­—èŠ‚è¡¨ç¤ºæ ‡è¯†å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªä¸º0x0000Aã€‚</p>
<p>3ã€æ¥ç€æ˜¯ä¸ºkeyçš„å…·ä½“å­—ç¬¦ä¸²ï¼Œå› æ­¤ç¬¬ä¸€ä¸ªä¸º<code>onMetaData</code>ã€‚</p>
<p><strong>Value</strong><br>1ã€ç´§æ¥ç€åé¢åˆ™ä¸ºScriptTagçš„valueå€¼ï¼Œç¬¬1ä¸ªå­—èŠ‚åŒæ ·ä¹Ÿæ˜¯AMFç±»å‹ï¼Œä¸€èˆ¬ä¸º0x08ï¼Œè¡¨ç¤ºECMA Arrayã€‚</p>
<p>2ã€ç¬¬2-5ä¸ªå­—èŠ‚è¡¨ç¤ºæ•°ç»„å…ƒç´ çš„ä¸ªæ•°ã€‚</p>
<p>3ã€åé¢å³ä¸ºå„å…ƒç´ çš„å°è£…ï¼Œä¸ºä¸€ä¸€å¯¹åº”çš„é”®å€¼å¯¹ï¼Œå¸¸è§çš„MetaDataå¦‚ä¸‹ï¼š</p>
<ul>
<li>durationï¼šæ—¶é•¿</li>
<li>widthï¼šè§†é¢‘å®½åº¦</li>
<li>heightï¼šè§†é¢‘é«˜åº¦</li>
<li>videodatarateï¼šè§†é¢‘ç ç‡</li>
<li>framerateï¼šè§†é¢‘å¸§ç‡</li>
<li>videocodecidï¼šè§†é¢‘ç¼–ç æ–¹å¼</li>
<li>audiosamplerateï¼šéŸ³é¢‘é‡‡æ ·ç‡</li>
<li>audiosamplesizeï¼šéŸ³é¢‘é‡‡æ ·ç²¾åº¦</li>
<li>stereoï¼šæ˜¯å¦ä¸ºç«‹ä½“å£°</li>
<li>audiocodecidï¼šéŸ³é¢‘ç¼–ç æ–¹å¼</li>
<li>filesizeï¼šæ–‡ä»¶å¤§å°</li>
</ul>
<p>4ã€æœ€åç”¨3ä¸ªå­—èŠ‚çš„å›ºå®šå€¼0000 09è¡¨ç¤ºvalueå€¼ç»“æŸã€‚</p>
<h3 id="Audio-Tag"><a href="#Audio-Tag" class="headerlink" title="Audio Tag"></a>Audio Tag</h3><p>Audio Tag Dataå¼€å§‹çš„ç¬¬ä¸€ä¸ªå­—èŠ‚åŒ…å«äº†éŸ³é¢‘æ•°æ®çš„å‚æ•°ä¿¡æ¯ï¼Œç¬¬äºŒä¸ªå­—èŠ‚å¼€å§‹ä¸ºéŸ³é¢‘æµæ•°æ®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------------------------------------</span><br><span class="line">|                    éŸ³é¢‘å‚æ•°(8bit)                 | éŸ³é¢‘æ•°æ® |</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">|éŸ³é¢‘ç¼–ç ç±»å‹(4bit)| é‡‡æ ·ç‡(2bit)|ç²¾åº¦(1bit)|ç±»å‹(1bit)|   æ•°æ®  |</span><br><span class="line">--------------------------------------------------------------</span><br></pre></td></tr></table></figure>
<p><strong>ç¬¬1å­—èŠ‚ï¼š</strong><br>1ã€å‰4ä½æ ‡è¯†éŸ³é¢‘æ•°æ®çš„æ ¼å¼ï¼Œå¦‚ï¼š0x2è¡¨ç¤ºçš„æ˜¯MP3æ•°æ®ï¼Œå½“å‰åˆæ³•çš„æ•°å€¼ä¸º0ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼Œ7ï¼Œ8ï¼Œ9ï¼Œ10ï¼Œ11ï¼Œ14ï¼Œ15ï¼ˆ7ï¼Œ8ï¼Œ14ï¼Œ15ä¿ç•™ä¸ºå†…éƒ¨ä½¿ç”¨ï¼‰</p>
<ul>
<li>0ï¼šLinear PCMï¼Œplatform endian</li>
<li>1ï¼šADPCM</li>
<li>2ï¼šMP3</li>
<li>3ï¼šLinear PCMï¼Œlittle endian</li>
<li>4ï¼šNellymoser 16-kHz mono</li>
<li>5ï¼šNellymoser 8-kHz mono</li>
<li>6ï¼šNellymoser</li>
<li>7ï¼šG.711 A-law logarithmic PCM</li>
<li>8ï¼šG.711 mu-law logarithmic PCM</li>
<li>9ï¼šreserved</li>
<li>10ï¼šAAC</li>
<li>14ï¼šMP3 8-Khz</li>
<li>15ï¼šDevice-specific sound</li>
</ul>
<p>2ã€ç¬¬5ï¼Œ6ä½bitè¡¨ç¤ºé‡‡æ ·ç‡ï¼ˆAACï¼Œæ€»æ˜¯3ï¼‰</p>
<ul>
<li>0ï¼š5.5kHz</li>
<li>1ï¼š11KHz</li>
<li>2ï¼š22 kHz</li>
<li>3ï¼š44 kHz</li>
</ul>
<p>3ã€ç¬¬7ä½ï¼Œé‡‡æ ·ç²¾åº¦ï¼Œ 0ä¸º8bitsï¼Œ 1ä¸º16bits</p>
<p>4ã€ç¬¬8ä½ï¼ŒéŸ³é¢‘ç±»å‹ï¼Œmono=0ï¼Œ stereo=1</p>
<h3 id="Video-Tag"><a href="#Video-Tag" class="headerlink" title="Video Tag"></a>Video Tag</h3><p>å’ŒéŸ³é¢‘ä¸€æ ·ï¼Œå…¶ç¬¬ä¸€ä¸ªå­—èŠ‚åŒ…å«çš„æ˜¯è§†é¢‘å‚æ•°ä¿¡æ¯ï¼Œç¬¬äºŒå­—èŠ‚å¼€å§‹ä¸ºè§†é¢‘æµæ•°æ®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------------------------------------</span><br><span class="line">|                    è§†é¢‘å‚æ•°(8bit)                 | è§†é¢‘æ•°æ® |</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">|     æ ‡è¯†å¸§ç±»å‹(4bit)     |    æ ‡è¯†è§†é¢‘ç¼–ç (4bit)     |   æ•°æ®  |</span><br><span class="line">--------------------------------------------------------------</span><br></pre></td></tr></table></figure></p>
<p><strong>ç¬¬1å­—èŠ‚ï¼š</strong></p>
<ul>
<li>å‰4ä½æ ‡è¯†å¸§ç±»å‹ã€‚<ul>
<li>1ï¼škeyframe (for AVC, a seekable frame)ï¼› </li>
<li>2ï¼šinter frame (for AVC, a nonseekable frame)ï¼› </li>
<li>3ï¼šdisposable inter frame (H.263 only)ï¼› </li>
<li>4ï¼šgenerated keyframe (reserved for server use only)ï¼› </li>
<li>5ï¼švideo info/command frame</li>
</ul>
</li>
<li>å4ä½æ ‡è¯†è§†é¢‘ç¼–ç ã€‚<ul>
<li>1ï¼šJPEG (currently unused) ï¼›</li>
<li>2ï¼šSorenson H.263ï¼› </li>
<li>3ï¼šScreen videoï¼› </li>
<li>4ï¼šOn2 VP6ï¼› </li>
<li>5ï¼šOn2 VP6 with alpha channelï¼›</li>
<li>6ï¼šScreen video version 2ï¼› </li>
<li>7ï¼šAVC</li>
</ul>
</li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="https://www.adobe.com/content/dam/acom/en/devnet/flv/video_file_format_spec_v10.pdf" target="_blank" rel="noopener">video_file_format_spec</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å…³äºhtmlå…ƒç´ çš„å°ºå¯¸ä»¥åŠä½ç½®çš„é—®é¢˜]]></title>
      <url>https://lucius0.github.io/2017/06/01/archivers/html-element-dimensions-and-position/</url>
      <content type="html"><![CDATA[<h2 id="Position-pageX-clientX-screenX-offsetX"><a href="#Position-pageX-clientX-screenX-offsetX" class="headerlink" title="Position (pageX/clientX/screenX/offsetX)"></a>Position (pageX/clientX/screenX/offsetX)</h2><h3 id="pageX-pageY"><a href="#pageX-pageY" class="headerlink" title="pageX/pageY"></a>pageX/pageY</h3><p>é¼ æ ‡ç›¸å¯¹äºæ•´ä¸ªé¡µé¢çš„X/Yåæ ‡ã€‚å¦‚é¡µå®½1000pxï¼Œé¡µé«˜10000pxï¼Œé‚£ä¹ˆpageXæœ€å¤§å€¼åˆ™ä¸º1000pxï¼ŒpageYåˆ™ä¸º10000pxã€‚</p>
<h3 id="clientX-clientY"><a href="#clientX-clientY" class="headerlink" title="clientX/clientY"></a>clientX/clientY</h3><p>äº‹ä»¶å‘ç”Ÿæ—¶é¼ æ ‡åœ¨æµè§ˆå™¨å†…å®¹åŒºåŸŸçš„X/Yåæ ‡ï¼ˆä¸åŒ…å«æ»šåŠ¨æ¡ï¼‰ã€‚å³å¯è§†åŒºåŸŸã€‚(æ”¾å¤§ç¼©å°ä¹Ÿä¼šæ”¹å˜è¿™ä¸ªå€¼ï¼Œè€Œä¸”å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒIEçš„æœ€å°å€¼ä¸æ˜¯0è€Œæ˜¯2ï¼‰</p>
<h3 id="screenX-screenY"><a href="#screenX-screenY" class="headerlink" title="screenX/screenY"></a>screenX/screenY</h3><p>é¼ æ ‡åœ¨å±å¹•ä¸Šçš„åæ ‡ã€‚screenX,screenYçš„æœ€å¤§å€¼ä¸ä¼šè¶…è¿‡å±å¹•åˆ†è¾¨ç‡ã€‚</p>
<h3 id="offsetX-offsetY"><a href="#offsetX-offsetY" class="headerlink" title="offsetX/offsetY"></a>offsetX/offsetY</h3><p>é¼ æ ‡ç›¸å¯¹äºäº‹ä»¶æºå…ƒç´ ï¼ˆsrcElementï¼‰çš„X,Yåæ ‡ï¼Œåªæœ‰IEäº‹ä»¶æœ‰è¿™2ä¸ªå±æ€§ï¼Œæ ‡å‡†äº‹ä»¶æ²¡æœ‰å¯¹åº”çš„å±æ€§ã€‚</p>
<h2 id="Dimensions-offsetWidth-clientWidth-scrollWidth"><a href="#Dimensions-offsetWidth-clientWidth-scrollWidth" class="headerlink" title="Dimensions(offsetWidth/clientWidth/scrollWidth)"></a>Dimensions(offsetWidth/clientWidth/scrollWidth)</h2><p>CSS ç›’æ¨¡å‹æ˜¯ç›¸å½“å¤æ‚çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨æ»šåŠ¨å†…å®¹çš„æ—¶å€™ã€‚å½“æµè§ˆå™¨ä½¿ç”¨ä½ ç»™çš„cssæ ·å¼æ¥ç»˜åˆ¶ç›’æ¨¡å‹æ—¶ï¼Œé‚£å¦‚æœä½ åªæœ‰cssï¼Œç”¨jsæ¥ç¡®å®šæ‰€æœ‰çš„å°ºå¯¸åˆ™ä¸æ˜¯é‚£ä¹ˆçš„ç›´æˆªäº†å½“ã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸ºäº†ä½ çš„ä½¿ç”¨æ–¹ä¾¿ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ‹¥æœ‰6ç§DOMå±æ€§ï¼š<code>offsetWidth</code>ï¼Œ<code>offsetHeight</code>ï¼Œ<code>clientWidth</code>ï¼Œ<code>clientHeight</code>ï¼Œ<code>scrollWidth</code>ï¼Œ<code>scrollHeight</code>ã€‚è¿™äº›è¡¨ç¤ºå½“å‰è§†å›¾å¸ƒå±€çš„å±æ€§æ˜¯ä¸èƒ½ä¿®æ”¹çš„ï¼Œå³åªè¯»ï¼Œå¹¶ä¸”è¿˜å…¨éƒ½æ˜¯æ•´æ•°ï¼ˆå› æ­¤    å¾ˆæœ‰å¯èƒ½ä¼šå—åˆ°å››èˆäº”å…¥çš„è¯¯å·®å½±å“ï¼‰</p>
<p>è®©æˆ‘ä»¬æ¥è¯¦ç»†çš„äº†è§£ä¸€ä¸‹ï¼š</p>
<ul>
<li><p><code>offsetWidth</code>ï¼Œ<code>offsetHeight</code>ï¼šè¯¥è§†å›¾ç›’å­åŒ…å«äº†æ‰€æœ‰çš„è¾¹ç•Œå¤§å°(border)ã€‚å‡å¦‚è¯¥å…ƒç´ ä¸º<code>display: block</code>ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡<code>width/height</code> + <code>paddings</code> + <code>borders</code>æ¥è®¡ç®—å‡ºè¯¥å…ƒç´ çš„<code>offsetWidth/offsetHeight</code>ã€‚</p>
</li>
<li><p><code>clientWidth</code>ï¼Œ<code>clientHeight</code>ï¼šè¯¥ç›’å­çš„è§†è§‰éƒ¨åˆ†ï¼Œä¸ä»…ä¸åŒ…æ‹¬è¾¹ç•Œ(border)ï¼ŒåŒæ—¶ä¹Ÿä¸åŒ…æ‹¬æ»šåŠ¨æ¡(scroll)ï¼Œä½†æ˜¯åŒ…æ‹¬å†…è¾¹è·(padding)ã€‚ä¸èƒ½ç›´æ¥çš„é€šè¿‡CSSæ¥è®¡ç®—ï¼Œä¾èµ–äºç³»ç»Ÿæ»šåŠ¨æ¡çš„å°ºå¯¸ã€‚</p>
</li>
<li><p><code>scrollWidth</code>ï¼Œ<code>scrollHeight</code>ï¼šæ‰€æœ‰ç›’å­çš„å†…å®¹å°ºå¯¸ï¼ŒåŒ…æ‹¬æº¢å‡ºæ»šåŠ¨åŒºåŸŸçš„éšè—éƒ¨åˆ†ã€‚åŒæ ·ä¹Ÿæ˜¯ä¸èƒ½ç›´æ¥é€šè¿‡CSSè®¡ç®—ï¼Œä¾èµ–äºå†…å®¹éƒ¨åˆ†ã€‚</p>
</li>
</ul>
<p><img src="/images/javascript/js-29.png" alt=""></p>
<p>å°è¯•ä¸€ä¸‹ï¼š<a href="http://jsfiddle.net/y8Y32/25/" target="_blank" rel="noopener">jsFiddle</a></p>
<p>ç”±äº<code>clientWidht</code>æŠŠ scroll bar çš„å®½åº¦ä¹Ÿè®¡ç®—åœ¨å“ªï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å…¬å¼è®¡ç®—å‡ºæ»šåŠ¨æ¡çš„å®½åº¦</p>
<p><code>scrollbarWidth = offsetWidth - clientWidth - getComputedStyle().borderLeftWidth - getComputedStyle().borderRightWidth</code></p>
<p>ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå—åˆ°å››èˆäº”å…¥çš„è¯¯å·®å½±å“ï¼Œå› ä¸º<code>offsetWidth</code>å’Œ<code>clientWidth</code>æ€»æ˜¯æ•´æ•°ï¼Œè€Œå®é™…çš„å¤§å°å¯èƒ½æ˜¯å°æ•°ï¼Œç¼©æ”¾çº§åˆ«ä¸æ˜¯1ã€‚</p>
<p>æ³¨æ„è¿™ä¸ªï¼š</p>
<p><code>scrollbarWidth = getComputedStyle().width + getComputedStyle().paddingLeft + getComputedStyle().paddingRight - clientWidth</code></p>
<p>è¿™ä¸ªåœ¨chromeä¸­æ— æ³•å¯é çš„è¿è¡Œï¼Œå› ä¸ºchromeè¿”å›æ¥çš„<code>width</code>å·²ç»å‡å»äº†scrollbarçš„éƒ¨åˆ†ï¼ˆæ­¤å¤–ï¼Œchromeè¿˜ä¼šå°†paddingBottomå¡«å……åˆ°æ»šåŠ¨å†…å®¹çš„åº•éƒ¨ï¼Œä½†æ˜¯å…¶ä»–çš„æµè§ˆå™¨åˆ™ä¸ä¼šè¿™æ ·ï¼‰ã€‚    </p>
<h2 id="è·å–é¡µé¢å…ƒç´ çš„ä½ç½®"><a href="#è·å–é¡µé¢å…ƒç´ çš„ä½ç½®" class="headerlink" title="è·å–é¡µé¢å…ƒç´ çš„ä½ç½®"></a>è·å–é¡µé¢å…ƒç´ çš„ä½ç½®</h2><p>ç›¸å¯¹ä½ç½®ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> X = <span class="keyword">this</span>.getBoundingClientRect().left;</span><br><span class="line"><span class="keyword">var</span> Y = <span class="keyword">this</span>.getBoundingClientRect().top;</span><br></pre></td></tr></table></figure>
<p>ç»å¯¹ä½ç½®ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> X = <span class="keyword">this</span>.getBoundingClientRect().left + <span class="built_in">document</span>.documentElement.scrollLeft || <span class="built_in">document</span>.body.scrollLeft;</span><br><span class="line"><span class="keyword">var</span> Y = <span class="keyword">this</span>.getBoundingClientRect().top + <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop;</span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„ï¼š</strong> åœ¨æ–‡æ¡£ä½¿ç”¨äº†DTDæ—¶ï¼Œ<code>document.body.scrollTop</code>çš„å€¼ä¸º0ï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨<code>document.documentElement.scrollTop</code>æ¥è·å–æ»šåŠ¨æ¡æ»šè¿‡çš„é•¿åº¦ï¼›åœ¨æœªä½¿ç”¨DTDå®šä¹‰æ–‡æ¡£æ—¶ï¼Œä½¿ç”¨<code>document.body.scrollTop</code>è·å–å€¼ã€‚</p>
<p>å‚è€ƒï¼š</p>
<ul>
<li><p><a href="http://www.cnblogs.com/xesam/archive/2011/12/08/2280509.html" target="_blank" rel="noopener">http://www.cnblogs.com/xesam/archive/2011/12/08/2280509.html</a></p>
</li>
<li><p><a href="https://stackoverflow.com/questions/21064101/understanding-offsetwidth-clientwidth-scrollwidth-and-height-respectively" target="_blank" rel="noopener">Understanding offsetWidth, clientWidth, scrollWidth and -Height, respectively</a></p>
</li>
<li><p><a href="http://www.ruanyifeng.com/blog/2009/09/find_element_s_position_using_javascript.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2009/09/find_element_s_position_using_javascript.html</a></p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[streaming media]]></title>
      <url>https://lucius0.github.io/2017/05/21/archivers/streaming-media/</url>
      <content type="html"><![CDATA[<blockquote>
<p>æ‰€è°“æµåª’ä½“æ˜¯æŒ‡é‡‡ç”¨æµå¼ä¼ è¾“çš„æ–¹å¼åœ¨Internetæ’­æ”¾çš„åª’ä½“æ ¼å¼ã€‚ æµåª’ä½“åˆå«æµå¼åª’ä½“ï¼Œå®ƒæ˜¯æŒ‡å•†å®¶ç”¨ä¸€ä¸ªè§†é¢‘ä¼ é€æœåŠ¡å™¨æŠŠèŠ‚ç›®å½“æˆæ•°æ®åŒ…å‘å‡ºï¼Œä¼ é€åˆ°ç½‘ç»œä¸Šã€‚ç”¨æˆ·é€šè¿‡è§£å‹è®¾å¤‡å¯¹è¿™äº›æ•°æ®è¿›è¡Œè§£å‹åï¼ŒèŠ‚ç›®å°±ä¼šåƒå‘é€å‰é‚£æ ·æ˜¾ç¤ºå‡ºæ¥ã€‚ â€“ æ¥è‡ªã€Šç™¾åº¦ç™¾ç§‘ã€‹</p>
</blockquote>
<p>ç®€å•æ¥è¯´ï¼Œæµåª’ä½“è·Ÿåª’ä½“æ–‡ä»¶çš„åŒºåˆ«å°±åœ¨äºï¼Œå‰è€…æ˜¯éœ€è¦æœåŠ¡å™¨æ”¯æŒçš„ï¼Œå¦‚RTSPã€httpæµåª’ä½“æœåŠ¡å™¨ï¼Œé€šè¿‡è§£ç ï¼Œç„¶åé€åŒ…çš„å‘é€ç»™æ’­æ”¾å™¨è¿›è¡Œæ’­æ”¾ï¼Œ<strong>è¾¹ä¸‹è¾¹æ”¾</strong>ï¼Œè€Œåè€…åˆ™æ˜¯ä¸ä¾èµ–ç½‘ç»œï¼Œä¹Ÿä¸ä¾èµ–æœåŠ¡å™¨ï¼Œåªè¦æœ‰å¯¹åº”è§£ç å™¨çš„æ’­æ”¾å™¨å°±å¯ä»¥äº†ã€‚</p>
<h2 id="æµå¼ä¼ è¾“"><a href="#æµå¼ä¼ è¾“" class="headerlink" title="æµå¼ä¼ è¾“"></a>æµå¼ä¼ è¾“</h2><p>æµåª’ä½“æŒ‡åœ¨Internet/Intranetä¸­ä½¿ç”¨æµå¼ä¼ è¾“æŠ€æœ¯çš„è¿ç»­æ—¶åŸºåª’ä½“ï¼Œå¦‚ï¼šéŸ³é¢‘ã€è§†é¢‘æˆ–å¤šåª’ä½“æ–‡ä»¶ã€‚æµå¼åª’ä½“åœ¨æ’­æ”¾å‰å¹¶ä¸ä¸‹è½½æ•´ä¸ªæ–‡ä»¶ï¼Œåªå°†å¼€å§‹éƒ¨åˆ†å†…å®¹å­˜å…¥å†…å­˜ï¼Œæµå¼åª’ä½“çš„æ•°æ®æµéšæ—¶ä¼ é€éšæ—¶æ’­æ”¾ï¼Œåªæ˜¯åœ¨å¼€å§‹æ—¶æœ‰ä¸€äº›å»¶è¿Ÿã€‚æµåª’ä½“å®ç°çš„å…³é”®æŠ€æœ¯å°±æ˜¯æµå¼ä¼ è¾“ã€‚</p>
<h2 id="é¡ºåºæµå¼ä¼ è¾“"><a href="#é¡ºåºæµå¼ä¼ è¾“" class="headerlink" title="é¡ºåºæµå¼ä¼ è¾“"></a>é¡ºåºæµå¼ä¼ è¾“</h2><p>é¡ºåºæµå¼ä¼ è¾“æ˜¯é¡ºåºä¸‹è½½ï¼Œåœ¨ä¸‹è½½æ–‡ä»¶çš„åŒæ—¶ç”¨æˆ·å¯è§‚çœ‹åœ¨çº¿åª’ä½“ï¼Œåœ¨ç»™å®šæ—¶åˆ»ï¼Œç”¨æˆ·åªèƒ½è§‚çœ‹å·²ä¸‹è½½çš„é‚£éƒ¨åˆ†ï¼Œè€Œä¸èƒ½è·³åˆ°è¿˜æœªä¸‹è½½çš„å‰å¤´éƒ¨åˆ†ï¼Œé¡ºåºæµå¼ä¼ è¾“ä¸è±¡å®æ—¶æµå¼ä¼ è¾“åœ¨ä¼ è¾“æœŸé—´æ ¹æ®ç”¨æˆ·è¿æ¥çš„é€Ÿåº¦åšè°ƒæ•´ã€‚ç”±äºæ ‡å‡†çš„HTTPæœåŠ¡å™¨å¯å‘é€è¿™ç§å½¢å¼çš„æ–‡ä»¶ï¼Œä¹Ÿä¸éœ€è¦å…¶ä»–ç‰¹æ®Šåè®®ï¼Œå®ƒç»å¸¸è¢«ç§°ä¸ºHTTPæµå¼ä¼ è¾“ã€‚é¡ºåºæµå¼ä¼ è¾“ä¸é€‚åˆé•¿ç‰‡æ®µå’Œæœ‰éšæœºè®¿é—®è¦æ±‚çš„è§†é¢‘ã€‚</p>
<h2 id="å®æ—¶æµå¼ä¼ è¾“"><a href="#å®æ—¶æµå¼ä¼ è¾“" class="headerlink" title="å®æ—¶æµå¼ä¼ è¾“"></a>å®æ—¶æµå¼ä¼ è¾“</h2><p>å®æ—¶æµå¼ä¼ è¾“æŒ‡ä¿è¯åª’ä½“ä¿¡å·å¸¦å®½ä¸ç½‘ç»œè¿æ¥é…åŒ¹ï¼Œä½¿åª’ä½“å¯è¢«å®æ—¶è§‚çœ‹åˆ°ã€‚å®æ—¶æµä¸HTTPæµå¼ä¼ è¾“ä¸åŒï¼Œä»–éœ€è¦ä¸“ç”¨çš„æµåª’ä½“æœåŠ¡å™¨ä¸ä¼ è¾“åè®®ã€‚å®æ—¶æµå¼ä¼ è¾“æ€»æ˜¯å®æ—¶ä¼ é€ï¼Œç‰¹åˆ«é€‚åˆç°åœºäº‹ä»¶ï¼Œä¹Ÿæ”¯æŒéšæœºè®¿é—®ï¼Œç”¨æˆ·å¯å¿«è¿›æˆ–åé€€ä»¥è§‚çœ‹å‰é¢æˆ–åé¢çš„å†…å®¹ã€‚è¿™æ ·ä¼šå¾ˆä¾èµ–ç½‘ç»œç¯å¢ƒï¼Œä¸€æ—¦ç½‘ç»œæ‹¥æŒ¤åˆ™ä¼šé€ æˆç”»åƒä¿¡æ¯ä¸¢å¤±æˆ–è€…å›¾åƒè´¨é‡å·®ã€‚å®æ—¶æµå¼ä¼ è¾“è¿˜éœ€è¦ç‰¹æ®Šç½‘ç»œåè®®ï¼Œå¦‚ï¼šRTSP (Realtime Streaming Protocol)æˆ–MMS (Microsoft Media Server)ã€‚è¿™äº›åè®®åœ¨æœ‰é˜²ç«å¢™æ—¶æœ‰æ—¶ä¼šå‡ºç°é—®é¢˜ï¼Œå¯¼è‡´ç”¨æˆ·ä¸èƒ½çœ‹åˆ°ä¸€äº›åœ°ç‚¹çš„å®æ—¶å†…å®¹ã€‚</p>
<h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>é¦–å…ˆï¼Œå¤šåª’ä½“æ•°æ®è¿›è¡Œé¢„å¤„ç†æ‰èƒ½é€‚åˆæµå¼ä¼ è¾“ï¼Œè¿™æ˜¯å› ä¸ºç›®å‰çš„ç½‘ç»œå¸¦å®½å¯¹å¤šåª’ä½“å·¨å¤§çš„æ•°æ®æµé‡æ¥è¯´è¿˜æ˜¾å¾—è¿œè¿œä¸å¤Ÿã€‚é¢„å¤„ç†ä¸»è¦åŒ…æ‹¬ä¸¤æ–¹é¢ï¼šä¸€æ˜¯é™ä½è´¨é‡ï¼›äºŒæ˜¯é‡‡ç”¨å…ˆè¿›é«˜æ•ˆçš„å‹ç¼©ç®—æ³•ã€‚</p>
<p>å…¶æ¬¡ï¼Œæµå¼ä¼ è¾“çš„å®ç°éœ€è¦ç¼“å­˜ã€‚è¿™æ˜¯å› ä¸ºInternetä»¥åŒ…ä¼ è¾“ä¸ºåŸºç¡€è¿›è¡Œè¿ç»­çš„å¼‚æ­¥ä¼ è¾“ï¼Œå¯¹ä¸€ä¸ªå®æ—¶A/Væºæˆ–å­˜å‚¨çš„A/Væ–‡ä»¶ï¼Œåœ¨ä¼ è¾“ä¸­å®ƒä»¬è¦è¢«åˆ†è§£ä¸ºè®¸å¤šåŒ…ï¼Œç”±äºç½‘ç»œæ˜¯åŠ¨æ€å˜åŒ–çš„ï¼Œæ¯ä¸ªåŒ…é€‰æ‹©çš„è·¯ç”±å¯èƒ½ä¸å°½ç›¸åŒï¼Œæ•…åˆ°è¾¾å®¢æˆ·ç«¯çš„æ—¶é—´å»¶è¿Ÿä¹Ÿå°±ä¸ç­‰ï¼Œç”šè‡³å…ˆå‘çš„æ•°æ®åŒ…è¿˜æœ‰å¯èƒ½ååˆ°ã€‚ä¸ºæ­¤ï¼Œä½¿ç”¨ç¼“å­˜ç³»ç»Ÿæ¥å¼¥è¡¥å»¶è¿Ÿå’ŒæŠ–åŠ¨çš„å½±å“ï¼Œå¹¶ä¿è¯æ•°æ®åŒ…çš„é¡ºåºæ­£ç¡®ï¼Œä»è€Œä½¿åª’ä½“æ•°æ®èƒ½è¿ç»­è¾“å‡ºï¼Œè€Œä¸ä¼šå› ä¸ºç½‘ç»œæš‚æ—¶é˜»å¡ä½¿æ’­æ”¾å‡ºç°åœé¡¿ã€‚é€šå¸¸é«˜é€Ÿç¼“å­˜æ‰€éœ€å®¹é‡å¹¶ä¸å¤§ã€‚è¿™æ˜¯å› ä¸ºé«˜é€Ÿç¼“å­˜ä½¿ç”¨ç¯è¡Œé“¾è¡¨ç»“æ„æ¥å­˜å‚¨æ•°æ®ï¼šé€šè¿‡ä¸¢å¼ƒå·²ç»æ’­æ”¾çš„å†…å®¹ï¼Œâ€æµâ€å¯ä»¥é‡æ–°åˆ©ç”¨ç©ºå‡ºçš„é«˜é€Ÿç¼“å­˜ç©ºé—´æ¥ç¼“å­˜åç»­å°šæœªæ’­æ”¾çš„å†…å®¹ã€‚</p>
<p>å†æ¬¡ï¼Œæµå¼ä¼ è¾“çš„å®ç°éœ€è¦åˆé€‚çš„ä¼ è¾“åè®®ã€‚WWWæŠ€æœ¯æ˜¯ä»¥HTTPåè®®ä¸ºåŸºç¡€çš„ï¼Œè€ŒHTTPåˆå»ºç«‹åœ¨TCPåè®®åŸºç¡€ä¹‹ä¸Šã€‚ç”±äºTCPéœ€è¦è¾ƒå¤šçš„å¼€é”€ï¼Œæ•…ä¸å¤ªé€‚åˆä¼ è¾“å®æ—¶æ•°æ®ï¼Œåœ¨æµå¼ä¼ è¾“çš„å®ç°æ–¹æ¡ˆä¸­ï¼Œä¸€èˆ¬é‡‡ç”¨HTTP/TCPæ¥ä¼ è¾“æ§åˆ¶ä¿¡æ¯ï¼Œè€Œç”¨RTP/UDPæ¥ä¼ è¾“å®æ—¶å£°éŸ³æ•°æ®ã€‚</p>
<h2 id="ä¼ è¾“åè®®"><a href="#ä¼ è¾“åè®®" class="headerlink" title="ä¼ è¾“åè®®"></a>ä¼ è¾“åè®®</h2><table>
<thead>
<tr>
<th>åç§°</th>
<th>æ¨å‡ºæœºæ„</th>
<th>ä¼ è¾“å±‚åè®®</th>
<th>å®¢æˆ·ç«¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>RTSP+RTP</td>
<td>IETF</td>
<td>TCP+UDP</td>
<td>VLC, WMP</td>
</tr>
<tr>
<td>RTMP</td>
<td>Adobe Inc.</td>
<td>TCP</td>
<td>Flash</td>
</tr>
<tr>
<td>RTMFP</td>
<td>Adobe Inc.</td>
<td>UDP</td>
<td>Flash</td>
</tr>
<tr>
<td>MMS</td>
<td>Microsoft Inc.</td>
<td>TCP/UDP</td>
<td>WMP</td>
</tr>
<tr>
<td>HTTP</td>
<td>WWW+IETF</td>
<td>TCP</td>
<td>Flash</td>
</tr>
<tr>
<td>HLS</td>
<td>Apple</td>
<td>TCP</td>
<td>IOS/éƒ¨åˆ†Android</td>
</tr>
</tbody>
</table>
<h2 id="æ‰§è¡Œæ­¥éª¤"><a href="#æ‰§è¡Œæ­¥éª¤" class="headerlink" title="æ‰§è¡Œæ­¥éª¤"></a>æ‰§è¡Œæ­¥éª¤</h2><ul>
<li><p>åœ¨ç½‘ç»œä¸Šè§‚çœ‹è§†é¢‘ï¼Œåˆ™éœ€è¦ï¼šè§£åè®®ï¼Œè§£å°è£…ï¼Œè§£ç è§†éŸ³é¢‘ï¼Œè§†éŸ³é¢‘åŒæ­¥ã€‚</p>
</li>
<li><p>åœ¨æœ¬åœ°ä¸Šè§‚çœ‹è§†é¢‘ï¼Œåˆ™éœ€è¦ï¼šè§£å°è£…ï¼Œè§£ç è§†éŸ³é¢‘ï¼Œè§†éŸ³é¢‘åŒæ­¥ã€‚</p>
</li>
</ul>
<p><strong>å‚è€ƒèµ„æ–™ï¼š</strong></p>
<ul>
<li><p><a href="http://baike.baidu.com/link?url=KmhsT7Th2RZN1I-eCn2at0u71EvDsVbNBe7Xy7uqPzQPJYEJarUsPpd7_N7JT1D3DB5XuPYAXd_PF1k4aprfRGWx6OCDHcRXmRW1JFaTSJSH60pj1pwefMWaCW6-ji4i" target="_blank" rel="noopener">ç™¾åº¦ç™¾ç§‘</a></p>
</li>
<li><p><a href="http://www.kuqin.com/stream-media/20070904/864.html" target="_blank" rel="noopener">http://www.kuqin.com/stream-media/20070904/864.html</a></p>
</li>
<li><p><a href="https://github.com/ossrs/srs/wiki/v1_CN_RTMP.PK.HTTP" target="_blank" rel="noopener">RTMP VS HTTP</a></p>
</li>
<li><p><a href="http://blog.ucloud.cn/archives/author/usmd" target="_blank" rel="noopener">å…³äºç›´æ’­ï¼Œæ‰€æœ‰çš„æŠ€æœ¯ç»†èŠ‚éƒ½åœ¨è¿™é‡Œäº†</a></p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> media </category>
            
        </categories>
        
        
        <tags>
            
            <tag> media </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[axio-form dataé—®é¢˜]]></title>
      <url>https://lucius0.github.io/2017/05/16/archivers/axio-form-data/</url>
      <content type="html"><![CDATA[<p>ä»Šæ—¥åœ¨ç”¨<code>axio</code>è¯·æ±‚æ•°æ®æ—¶ï¼Œé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå³<code>post</code>æ—¶ï¼Œdataä¸ºå¯¹è±¡ï¼Œä½†æ˜¯åœ¨è¯·æ±‚æ—¶çš„è¯·æ±‚æ•°æ®ä¸€ç›´æ˜¯<code>request payload</code>ï¼Œè€Œä¸æ˜¯æˆ‘æƒ³è¦çš„<code>form data</code>ï¼Œå¹¶ä¸”è¯·æ±‚ä½“ä¸ºè¡¨å•å½¢å¼ï¼Œå³<code>a=1&amp;b=2&amp;c=3</code>ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">axios(&#123;</span><br><span class="line">	url: <span class="string">`<span class="subst">$&#123;API.URL&#125;</span>`</span>,</span><br><span class="line">    method: <span class="string">'post'</span>,</span><br><span class="line">    data,</span><br><span class="line">    responseType: <span class="string">'json'</span>,</span><br><span class="line">    withCredentials: <span class="literal">true</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="/images/javascript/js-25.jpeg" alt=""></p>
<p><img src="/images/javascript/js-26.jpeg" alt=""></p>
<p><strong>è§£å†³æ–¹æ¡ˆ1ï¼š</strong></p>
<p>åœ¨nodeç¯å¢ƒä¸­å¯ä»¥ä½¿ç”¨<code>qs</code>æ¨¡å—çš„<code>qs.stringify(data)</code>æ¥å¤„ç†ï¼Œå³</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> qs = <span class="built_in">require</span>(<span class="string">'qs'</span>);</span><br><span class="line">axios(&#123;</span><br><span class="line">	...</span><br><span class="line">	headers: &#123; <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span> &#125;,</span><br><span class="line">	data: qs.stringify(data)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³æ–¹æ¡ˆ2ï¼š</strong></p>
<p>åœ¨énodeç¯å¢ƒä¸‹å¯ä»¥ä½¿ç”¨<code>axios</code>çš„ä¸€ä¸ªè¯·æ±‚é…ç½®é¡¹<code>transformRequest</code>ï¼Œå³</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">axios(&#123;</span><br><span class="line">  ...</span><br><span class="line">  headers: &#123; <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span> &#125;,</span><br><span class="line">  transformRequest: [<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> ret = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> it <span class="keyword">in</span> data) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(data, it)) &#123;</span><br><span class="line">        ret = <span class="string">`<span class="subst">$&#123;ret + <span class="built_in">encodeURIComponent</span>(it)&#125;</span>=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(data[it])&#125;</span>&amp;`</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">  &#125;],</span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="/images/javascript/js-27.jpeg" alt=""></p>
<p><img src="/images/javascript/js-28.jpeg" alt=""></p>
<p><strong>æ€»ç»“ï¼š</strong></p>
<p><code>headers: { &#39;Content-Type&#39;: &#39;application/x-www-form-urlencoded&#39; }</code>æ˜¯å°†è¯·æ±‚ç±»å‹<code>request payload</code>è½¬æ¢æˆ<code>form data</code>ã€‚è€Œ<code>qs</code>æ¨¡å—è·Ÿ<code>transformRequest</code>åˆ™æ˜¯å°†å¯¹è±¡æ ¼å¼<code>{a: &#39;1&#39;, b: &#39;2&#39;, c: &#39;3&#39;}</code>è½¬ä¸ºè¡¨å•æ ¼å¼<code>a=1&amp;b=2&amp;c=3</code>ã€‚</p>
<p>axiosï¼š<a href="https://www.awesomes.cn/repo/mzabriskie/axios" target="_blank" rel="noopener">https://www.awesomes.cn/repo/mzabriskie/axios</a></p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
            <tag> axio </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScript é¼ æ ‡ä»ä¸åŒæ–¹å‘ç§»å…¥ç§»å‡ºåˆ¤æ–­]]></title>
      <url>https://lucius0.github.io/2017/05/08/archivers/mouse-direction/</url>
      <content type="html"><![CDATA[<p><img src="/images/workshop/004.gif" alt=""></p>
<h2 id="è§£æ³•ä¸€"><a href="#è§£æ³•ä¸€" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h2><p>å…³äºè¿™ä¸ªæˆ‘åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†ç­”æ¡ˆï¼Œå¸¸è§çš„è§£æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = (e.pageX - <span class="keyword">this</span>.offsetLeft - (w / <span class="number">2</span>)) * (w &gt; h ? (h / w) : <span class="number">1</span>); </span><br><span class="line"><span class="keyword">var</span> y = (e.pageY - <span class="keyword">this</span>.offsetTop - (h / <span class="number">2</span>)) * (h &gt; w ? (w / h) : <span class="number">1</span>); </span><br><span class="line"><span class="keyword">var</span> direction = <span class="built_in">Math</span>.round((((<span class="built_in">Math</span>.atan2(y, x) * (<span class="number">180</span> / <span class="built_in">Math</span>.PI)) + <span class="number">180</span>) / <span class="number">90</span>) + <span class="number">3</span>) % <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// e.pageX 			é¼ æ ‡çš„xåæ ‡</span></span><br><span class="line"><span class="comment">// this.offsetLeft 	ç§»åŠ¨çš„å®¹å™¨è·ç¦»å·¦è¾¹çš„ä½ç½®ï¼Œä¹Ÿå¯ä»¥è¯´xåæ ‡</span></span><br></pre></td></tr></table></figure>
<p>è§£é¢˜æ€è·¯ï¼š</p>
<p><img src="/images/javascript/js-23.png" alt=""></p>
<p>1ã€ä¸»è¦æ˜¯å°†è¿™ä¸ªé—®é¢˜åŒ–ä¸ºè§’åº¦æ¥ç®—ï¼›</p>
<p>2ã€æˆ‘ä»¬å°†Pè®¾ä¸ºåŸç‚¹<code>(this.offetLeft, this.offetTop)</code>ï¼Œoè®¾ä¸ºåœ†å¿ƒ<code>ï¼ˆthis.offsetLeft + (w / 2), this.offsetTop + (h / 2)ï¼‰</code>ï¼›</p>
<p>3ã€é¼ æ ‡ç§»å…¥è¯¥å®¹å™¨ç›¸å¯¹äºåœ†å¿ƒoçš„åæ ‡ä¸º<code>ï¼ˆe.pageX - o.x, e.pageY - o.yï¼‰</code>ï¼Œå³ä¸Šæ–‡çš„<code>(e.pageX - this.offsetLeft - (w / 2))</code>ä¸<code>(e.pageY - this.offsetTop - (h / 2))</code>ï¼›</p>
<p>4ã€<code>(w &gt; h ? (h / w) : 1)</code>ä¸<code>(h &gt; w ? (w / h) : 1)</code>çš„æ„æ€å°±æ˜¯å°†<strong>çŸ©å½¢æ¢ç®—ä¸ºæ­£æ–¹å½¢</strong>ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ªå®½3xï¼Œé«˜æ˜¯xçš„çŸ©å½¢ï¼Œç›¸å¯¹åŸç‚¹Pçš„å³ä¸‹è§’åæ ‡å°±æ˜¯{x:3x,y:1x}ï¼Œæ¢ç®—æˆæ­£æ–¹å½¢ï¼Œå³åæ ‡ç‚¹ä¸ºæ­£æ–¹å½¢çš„å³ä¸‹è§’ï¼ŒçŸ©å½¢çš„å››ä¸ªè§’å³ä¸€ä¸€å¯¹ä¸€ä¸ªæ­£æ–¹å½¢çš„å››ä¸ªè§’å½¢æˆæ­£æ–¹å½¢ABCDï¼›</p>
<p>5ã€<code>Math.atan2(x, y)</code>è¿”å›è§’åº¦å€¼ï¼Œæ¢ç®—æˆå¼§åº¦åˆ™ä¸º<code>((Math.atan2(y, x) * (180 / Math.PI))</code>ï¼Œç»“æœä¸º(-180, 180)ï¼ŒåŠ ä¸Š180ï¼Œå°±æ˜¯(0, 360)ã€‚</p>
<p>6ã€é™¤ä»¥90ï¼Œå³è·Ÿ4ä¸€æ ·é“ç†ï¼ŒAoDï¼ŒDoCï¼ŒCoBï¼ŒBoAéƒ½æ˜¯90åº¦è§’ï¼Œç›®çš„å°±æ˜¯å°†çŸ©é˜µçš„è§’åº¦è·Ÿæ–¹å½¢çš„è§’åº¦åšä¸ªæ¢ç®—ã€‚</p>
<p>7ã€åŠ 3æ˜¯å› ä¸ºæƒ³è®©è®¡ç®—çš„é¡ºåºä¸ºä¸Šï¼Œä¹‹å‰æˆ‘ä»¬çš„è§’åº¦åŒºé—´æ˜¯ä»å³è¾¹å¼€å§‹ï¼Œé‚£ä¹ˆåŠ 3å°±ä¼šä»ä¸Šå¼€å§‹è®¡ç®—ï¼Œä¹Ÿå°±æ˜¯ä¸Šï¼Œå³ï¼Œä¸‹ï¼Œå·¦çš„é¡ºåºï¼›</p>
<p>8ã€Math.roundä»¥åŠ4å–æ¨¡ä½¿å¾—è®¡ç®—ç»“æœä¸º0ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšå‘¢ï¼ŸMath.roundä½¿å¾—åæ ‡è½´45åº¦è§’åˆ’åˆ†å››ä¸ªè±¡é™ï¼Œè€Œ4å–æ¨¡å°±å¯ä»¥çŸ¥é“é¼ æ ‡ç§»å…¥ç§»å‡ºæ˜¯åœ¨è®¡ç®—è¿‡åçš„å“ªä¸ªè±¡é™äº†ã€‚</p>
<h2 id="è§£æ³•äºŒ"><a href="#è§£æ³•äºŒ" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h2><p>æ ¹æ®æ–œç‡ï¼Œè½¬è‡ª<a href="http://www.cnblogs.com/lyzg/p/5689761.html" target="_blank" rel="noopener">http://www.cnblogs.com/lyzg/p/5689761.html</a></p>
<p><img src="/images/javascript/js-24.png" alt=""></p>
<p>1ã€ä¸Šå›¾ä»¥æµè§ˆå™¨å¯è§†åŒºåŸŸå·¦ä¸Šè§’ä¸ºåŸç‚¹å»ºç«‹åæ ‡ç³»ï¼Œåæ ‡ç³»ä¸æ•°å­¦åæ ‡ç³»æ–¹å‘ä¸€è‡´ï¼Œå¾€å³è¡¨ç¤ºxè½´æ­£æ–¹å‘ï¼Œå¾€ä¸‹è¡¨ç¤ºyè½´è´Ÿæ–¹å‘ï¼›</p>
<p>2ã€å›¾ä¸­ç‚¹(x1,y1)ä»£è¡¨å…ƒç´ æ¡†å·¦ä¸Šè§’ï¼Œ(x4,y4)ä»£è¡¨å…ƒç´ æ¡†å³ä¸‹è§’ï¼Œ(x0,y0)ä»£è¡¨å…ƒç´ æ¡†çš„ä¸­å¿ƒç‚¹ï¼Œï¼ˆx,yï¼‰è¡¨ç¤ºé¼ æ ‡ç§»å…¥ç§»å‡ºæ—¶ä¸å…ƒç´ æ¡†çš„è¾¹çš„äº¤ç‚¹ï¼›</p>
<p>3ã€æ ¹æ®ä¸‹é¢çš„å…¬å¼ï¼š(y2 - y1) / (x2 - x1)</p>
<p>å¯å¾—(x1,y1)ä¸ï¼ˆx4,y4)è¿™æ¡å¯¹è§’çº¿çš„æ–œç‡ä¸º k = (y1-y4)/(x1-x4)ã€‚ç”±äºå¯¹ç§°æ€§ï¼Œå…ƒç´ æ¡†å¦å¤–ä¸€æ¡å¯¹è§’çº¿çš„æ–œç‡ä¸€å®šæ˜¯ -kã€‚</p>
<p>åŒæ—¶ç”±äº(x1,y1)ä¸ï¼ˆx4,y4)è¿™æ¡å¯¹è§’çº¿åœ¨åæ ‡ç³»ä¸­ä¸€å®šç»è¿‡çš„æ˜¯ç¬¬äºŒå’Œç¬¬å››è±¡é™ï¼Œæ‰€ä»¥kè‚¯å®šæ˜¯è´Ÿå€¼ï¼Œè€Œ -kä¸€å®šæ˜¯æ­£å€¼ã€‚</p>
<p>4ã€æ ¹æ®åŒæ ·çš„å…¬å¼ï¼Œå½“é¼ æ ‡ç§»å…¥ç§»å‡ºæ—¶çš„ç¬é—´ï¼Œä¸å…ƒç´ è¾¹æ¡†çš„äº¤ç‚¹ä¸å…ƒç´ æ¡†ä¸­å¿ƒç‚¹çš„æ–œç‡ k1 = (y-y0)/(x-x0)ã€‚</p>
<p>5ã€ç”±å›¾å¯çŸ¥ï¼Œå½“ k &lt; k1 &lt; â€“kæ—¶ï¼Œé¼ æ ‡ä¸€å®šæ˜¯ä»å…ƒç´ çš„å·¦å³æ–¹å‘ç§»åŠ¨çš„ï¼›åä¹‹ï¼Œä¸€å®šæ˜¯ä»ä¸Šä¸‹æ–¹å‘ç§»åŠ¨çš„ã€‚</p>
<p>å½“é¼ æ ‡æ˜¯ä»å·¦å³æ–¹å‘ç§»åŠ¨æ—¶ï¼Œå¦‚æœx &gt; x0ï¼Œé‚£ä¹ˆé¼ æ ‡å°±æ˜¯ä»å³è¾¹ç§»åŠ¨çš„ï¼Œåä¹‹å°±æ˜¯ä»å·¦è¾¹ç§»åŠ¨çš„ï¼›</p>
<p>å½“é¼ æ ‡æ˜¯ä»ä¸Šä¸‹æ–¹å‘ç§»åŠ¨æ—¶ï¼Œå¦‚æœy &gt; y0æ—¶ï¼Œé‚£ä¹ˆé¼ æ ‡å°±æ˜¯ä»ä¸Šè¾¹ç§»åŠ¨çš„ï¼Œåä¹‹å°±æ˜¯ä»ä¸‹è¾¹ç§»åŠ¨çš„ã€‚</p>
<p>æ³¨æ„ï¼šåæ ‡ç³»ä¸­æ‰€æœ‰çš„yå€¼éƒ½æ˜¯è´Ÿçš„ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™ä¸ªæ¨¡å—å®Œæˆé¼ æ ‡æ–¹å‘åˆ¤æ–­çš„åŠŸèƒ½</span></span><br><span class="line"><span class="keyword">var</span> MouseDirection = <span class="function"><span class="keyword">function</span> (<span class="params">element, opts</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> $element = $(element);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//enter leaveä»£è¡¨é¼ æ ‡ç§»å…¥ç§»å‡ºæ—¶çš„å›è°ƒ</span></span><br><span class="line">    opts = $.extend(&#123;&#125;, &#123;</span><br><span class="line">        enter: $.noop,</span><br><span class="line">        leave: $.noop</span><br><span class="line">    &#125;, opts || &#123;&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> dirs = [<span class="string">'top'</span>, <span class="string">'right'</span>, <span class="string">'bottom'</span>, <span class="string">'left'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> calculate = <span class="function"><span class="keyword">function</span> (<span class="params">element, e</span>) </span>&#123;</span><br><span class="line">        <span class="comment">/*ä»¥æµè§ˆå™¨å¯è§†åŒºåŸŸçš„å·¦ä¸Šè§’å»ºç«‹åæ ‡ç³»*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¡¨ç¤ºå·¦ä¸Šè§’å’Œå³ä¸‹è§’åŠä¸­å¿ƒç‚¹åæ ‡</span></span><br><span class="line">        <span class="keyword">var</span> x1, y1, x4, y4, x0, y0;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¡¨ç¤ºå·¦ä¸Šè§’å’Œå³ä¸‹è§’çš„å¯¹è§’çº¿æ–œç‡</span></span><br><span class="line">        <span class="keyword">var</span> k;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç”¨getBoundingClientRectæ¯”è¾ƒçœäº‹ï¼Œè€Œä¸”å®ƒçš„å…¼å®¹æ€§è¿˜ä¸é”™</span></span><br><span class="line">        <span class="keyword">var</span> rect = element.getBoundingClientRect();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!rect.width) &#123;</span><br><span class="line">            rect.width = rect.right - rect.left;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!rect.height) &#123;</span><br><span class="line">            rect.height = rect.bottom - rect.top;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ±‚å„ä¸ªç‚¹åæ ‡ æ³¨æ„yåæ ‡åº”è¯¥è½¬æ¢ä¸ºè´Ÿå€¼ï¼Œå› ä¸ºæµè§ˆå™¨å¯è§†åŒºåŸŸå·¦ä¸Šè§’ä¸º(0,0)ï¼Œæ•´ä¸ªå¯è§†åŒºåŸŸå±äºç¬¬å››è±¡é™</span></span><br><span class="line">        x1 = rect.left;</span><br><span class="line">        y1 = -rect.top;</span><br><span class="line"></span><br><span class="line">        x4 = rect.left + rect.width;</span><br><span class="line">        y4 = -(rect.top + rect.height);</span><br><span class="line"></span><br><span class="line">        x0 = rect.left + rect.width / <span class="number">2</span>;</span><br><span class="line">        y0 = -(rect.top + rect.height / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//çŸ©å½¢ä¸å¤Ÿå¤§ï¼Œä¸è€ƒè™‘</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Math</span>.abs(x1 - x4) &lt; <span class="number">0.0001</span>) <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¡ç®—å¯¹è§’çº¿æ–œç‡</span></span><br><span class="line">        k = (y1 - y4) / (x1 - x4);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> range = [k, -k];</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¡¨ç¤ºé¼ æ ‡å½“å‰ä½ç½®çš„ç‚¹åæ ‡</span></span><br><span class="line">        <span class="keyword">var</span> x, y;</span><br><span class="line"></span><br><span class="line">        x = e.clientX;</span><br><span class="line">        y = -e.clientY;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¡¨ç¤ºé¼ æ ‡å½“å‰ä½ç½®çš„ç‚¹ä¸å…ƒç´ ä¸­å¿ƒç‚¹è¿çº¿çš„æ–œç‡</span></span><br><span class="line">        <span class="keyword">var</span> kk;</span><br><span class="line"></span><br><span class="line">        kk = (y - y0) / (x - x0);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœæ–œç‡åœ¨rangeèŒƒå›´å†…ï¼Œåˆ™é¼ æ ‡æ˜¯ä»å·¦å³æ–¹å‘ç§»å…¥ç§»å‡ºçš„</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isFinite</span>(kk) &amp;&amp; range[<span class="number">0</span>] &lt; kk &amp;&amp; kk &lt; range[<span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="comment">//æ ¹æ®xä¸x0åˆ¤æ–­å·¦å³</span></span><br><span class="line">            <span class="keyword">return</span> x &gt; x0 ? <span class="number">1</span> : <span class="number">3</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//æ ¹æ®yä¸y0åˆ¤æ–­ä¸Šä¸‹</span></span><br><span class="line">            <span class="keyword">return</span> y &gt; y0 ? <span class="number">0</span> : <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    $element.on(<span class="string">'mouseenter'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> r = calculate(<span class="keyword">this</span>, e);</span><br><span class="line">        opts.enter($element, dirs[r]);</span><br><span class="line">    &#125;).on(<span class="string">'mouseleave'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> r = calculate(<span class="keyword">this</span>, e);</span><br><span class="line">        opts.leave($element, dirs[r]);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>æ€»ç»“ï¼šæˆ‘è§‰å¾—ç¬¬äºŒç§æ–¹æ³•å¾ˆç®€å•æ›´èƒ½ç†è§£ï¼Œåªæ˜¯åœ¨å®ç°èµ·æ¥ä»£ç é‡ä¼šæ›´å¤šç‚¹ã€‚</strong></p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[h5æ’­æ”¾å™¨å­¦ä¹ ]]></title>
      <url>https://lucius0.github.io/2017/05/05/archivers/h5-video-learning/</url>
      <content type="html"><![CDATA[<p><code>video</code>çš„æ¦‚å¿µåœ¨h5å·²ç»æ˜¯å­˜åœ¨äº†å¾ˆä¹…äº†ï¼Œä½†æ˜¯ç­‰åˆ°å°è§†é¢‘ã€çŸ­è§†é¢‘å…ƒå¹´çš„å¤§ç«å¤§çƒ­ä¹‹åï¼Œå›½å†…æ‰æ…¢æ…¢çš„è¿›å…¥æ·˜æ±°flashæ’­æ”¾å™¨åŠ ç´§è„šæœ¬å­¦ä¹ h5æ’­æ”¾å™¨ã€‚ç„¶è€Œåœ¨å›½å¤–ï¼ˆYouTubeï¼‰æ—©å·²ç”¨ä¸Šäº†h5æ’­æ”¾å™¨ï¼Œå› æ­¤æˆ‘ä¹Ÿä¸èƒ½è½åï¼Œå¾—åŠ ç´§æ—¶é—´å­¦ä¹ ï¼Œä¸ç„¶å°±æ²¡é¥­åƒäº†ã€‚</p>
<p>å¥½äº†ï¼Œåœ¨äº†è§£html5æ’­æ”¾å™¨çš„çŸ¥è¯†ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹ä»¥ä¸‹çš„å‰ç½®çŸ¥è¯†ï¼Œå½“ä½œæ‰©å……ä¸€ä¸‹è‡ªå·±çš„çŸ¥è¯†åº“ã€‚</p>
<h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><h3 id="å°è£…æ ¼å¼"><a href="#å°è£…æ ¼å¼" class="headerlink" title="å°è£…æ ¼å¼"></a>å°è£…æ ¼å¼</h3><p>å°†ä¸€äº›<strong>è§†é¢‘ä¿¡æ¯</strong>ï¼Œ<strong>éŸ³é¢‘ä¿¡æ¯</strong>ï¼Œ<strong>æ—¶é—´ç </strong>ï¼Œ<strong>ç¼–ç å™¨ä¿¡æ¯</strong>ï¼Œæ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ï¼Œä¾¿äºç®¡ç†ä»¥åŠç¼–è¾‘ï¼Œå¸¸è§çš„æœ‰AVIï¼ŒRMVBï¼ŒMOVï¼ŒMP4ï¼ŒFLVç­‰ã€‚ä¸ºä»€ä¹ˆè¦æœ‰è¿™ä¹ˆå¤šå°è£…æ ¼å¼å‘¢ï¼Ÿå¯ä»¥æƒ³ä¸‹ä¸ºä»€ä¹ˆå›¾ç‰‡æœ‰é‚£ä¹ˆå¤šå°è£…æ ¼å¼å‘¢ï¼Ÿå¦‚PNGï¼ŒJPGï¼ŒGIFç­‰ï¼Œé“ç†æ˜¯ä¸€ä¸ªæ ·çš„ã€‚</p>
<h3 id="ç¼–ç æ–¹å¼"><a href="#ç¼–ç æ–¹å¼" class="headerlink" title="ç¼–ç æ–¹å¼"></a>ç¼–ç æ–¹å¼</h3><p>ç®€å•æ¥è¯´ï¼Œç¼–ç æ–¹å¼å°±æ˜¯æˆ‘ä»¬å‹ç¼©æˆ–è€…è§£å‹éŸ³è§†é¢‘æ•°æ®çš„ä¸€ä¸ªç®—æ³•ã€‚MPEG 2ï¼ŒMPEG 4ï¼ŒProres 422ï¼ŒProres 444ï¼ŒH.265 ä»¥åŠå¸¸ç”¨çš„ H.264ã€‚ä¸åŒçš„ç¼–ç æ–¹å¼ä¼šè®©è§†é¢‘å‘ˆç°å‡ºä¸åŒçš„åˆ†è¾¨ç‡ä»¥åŠè§†é¢‘å¤§å°ï¼Œå°è£…æ ¼å¼ä»¥åŠç¼–ç æ–¹å¼éƒ½ä¼šå½±å“è§†é¢‘çš„è´¨é‡ã€‚</p>
<p>åœ¨æ¯ä¸ªå½±ç‰‡å®¹å™¨ä¸­ï¼ŒéŸ³é¢‘å’Œè§†é¢‘è½¨é“éƒ½ä½¿ç”¨ä¸åŒçš„ç¼–è§£ç å™¨æ¥ç¼–ç ã€‚ç¼–è§£ç å™¨å†³å®šäº†æµè§ˆå™¨åœ¨æ’­æ”¾æ—¶åº”è¯¥å¦‚ä½•è§£ç éŸ³é¢‘å’Œè§†é¢‘ã€‚</p>
<h3 id="ç ç‡"><a href="#ç ç‡" class="headerlink" title="ç ç‡"></a>ç ç‡</h3><p>ç ç‡å°±æ˜¯æŒ‡è§†é¢‘æˆ–è€…éŸ³é¢‘æ¯ç§’é’Ÿçš„æ•°æ®é‡ï¼Œå•ä½æ˜¯MBPSæˆ–è€…KBPSã€‚ç ç‡è¶Šé«˜è§†é¢‘å°±è¶Šæ¸…æ™°ï¼Œä½†æ˜¯ç ç‡åŒæ—¶ä¼šå—åˆ†è¾¨ç‡å’Œå¸§é€Ÿç‡å½±å“ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<ul>
<li><p><em>ä¸€ä¸ªè§†é¢‘åˆ†è¾¨ç‡ä¸º 1080Pï¼Œç ç‡ä¸º5MBPS</em> ä¼šæ¯” <em>ä¸€ä¸ªè§†é¢‘åˆ†è¾¨ç‡ä¸º 4Kï¼Œç ç‡ç…§æ ·ä¸º5MBPS</em>çš„æ¸…æ™°ã€‚å› ä¸ºåˆ†è¾¨ç‡æ›´é«˜çš„åŒæ—¶ï¼Œæ˜¯éœ€è¦é«˜ç ç‡æ¥åšæ”¯æ’‘çš„ï¼Œä¹Ÿå°±æ˜¯åŒç ç‡çš„æƒ…å†µä¸‹ï¼Œåˆ†è¾¨ç‡è¶Šé«˜è§†é¢‘è¶Šä¸æ¸…æ™°ã€‚</p>
</li>
<li><p><em>ä¸€ä¸ªè§†é¢‘å¸§é€Ÿç‡ä¸º 30å¸§ï¼Œç ç‡ä¸º5MBPS</em> ä¼šæ¯” <em>ä¸€ä¸ªè§†é¢‘å¸§é€Ÿç‡ä¸º 60å¸§ï¼Œç ç‡ç…§æ ·ä¸º5MBPS</em>çš„æ¸…æ™°ã€‚å› ä¸ºå¸§é€Ÿç‡æ›´é«˜çš„åŒæ—¶ï¼Œæ˜¯éœ€è¦é«˜ç ç‡æ¥åšæ”¯æ’‘çš„ï¼Œä¹Ÿå°±æ˜¯åŒç ç‡çš„æƒ…å†µä¸‹ï¼Œå¸§é€Ÿç‡è¶Šé«˜è§†é¢‘è¶Šä¸æ¸…æ™°ã€‚</p>
</li>
</ul>
<p>ç ç‡åˆ†ä¸ºï¼šCBRï¼ˆå›ºå®šç ç‡ï¼‰ï¼ŒVBRï¼ˆå¯å˜ç ç‡ï¼‰ã€‚</p>
<ul>
<li><p>CBRï¼ˆå›ºå®šç ç‡ï¼‰ï¼šæŒ‡çš„æ˜¯æ¯ä¸€ç§’ç ç‡éƒ½æ˜¯ç›¸åŒçš„ã€‚å‡å¦‚åœ¨ç½‘ç»œè§‚çœ‹è§†é¢‘ä¸”ç½‘é€Ÿæ¯”è¾ƒå¿«çš„æƒ…å†µä¸‹ï¼Œå°±ä¸ä¼šå‡ºç°å¡é¡¿çš„æƒ…å†µï¼Œä½†æ˜¯ï¼Œç”»é¢è‹¥æ¯”è¾ƒå•è–„ï¼Œç”»é¢ä¿¡æ¯æ¯”è¾ƒå°‘ï¼Œçªç„¶é¢œè‰²å˜ä¸°å¯Œäº†ï¼Œç”»é¢ä¿¡æ¯çªç„¶å¤šäº†ï¼Œé‚£ä¹ˆè¿™ä¸‹å­å¯èƒ½ä¼šå‡ºç°æ¨¡ç³Šçš„æƒ…å†µã€‚</p>
</li>
<li><p>VBRï¼ˆå¯å˜ç ç‡ï¼‰ï¼šæŒ‡çš„æ˜¯æ¯ä¸€ç§’ç ç‡éƒ½æ˜¯å˜åŒ–ä¸å›ºå®šçš„ã€‚å¯å˜ç ç‡ä¼šæ ¹æ®ä½ è§†é¢‘å½“ä¸­ç”»é¢çš„ä¿¡æ¯é‡ï¼Œæ¥è‡ªåŠ¨è°ƒæ•´ç ç‡ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°çªç„¶é¢œè‰²å˜ä¸°å¯Œå¯¼è‡´çš„æ¨¡ç³Šç°è±¡ã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬è§‚çœ‹çš„è§†é¢‘å¯¹ç½‘é€Ÿæœ‰ä¸€å®šçš„è¦æ±‚ï¼Œç ç‡å¿½é«˜å¿½ä½æ—¶ï¼Œé‚£ä¹ˆå¯èƒ½å°±ä¼šé€ æˆå¡é¡¿çš„æƒ…å†µã€‚</p>
</li>
</ul>
<h3 id="åˆ†è¾¨ç‡"><a href="#åˆ†è¾¨ç‡" class="headerlink" title="åˆ†è¾¨ç‡"></a>åˆ†è¾¨ç‡</h3><p>æŒ‡çš„æ˜¯å•ä½é•¿åº¦å†…ï¼Œè§†é¢‘åŒ…å«çš„åƒç´ æ•°é‡ã€‚å¸¸è§çš„æœ‰ 1280 x 720ï¼Œ1920 x 1080ï¼Œ2560 x 1440ï¼ˆ2Kï¼‰ï¼Œ4096 x 2304ï¼ˆ4Kï¼‰ã€‚</p>
<p><strong>å°ç»“ï¼š</strong></p>
<p>ä¸€ä¸ªå®Œæ•´çš„è§†é¢‘å¤§æ¦‚ä¼šæ‹¥æœ‰<em>metaä¿¡æ¯ï¼Œè§†é¢‘ç¼–ç å™¨(H.264, MPEG 4)ï¼ŒéŸ³é¢‘ç¼–ç å™¨(AAC,OGG)ï¼Œå­—å¹•ï¼Œæè¿°ä¿¡æ¯ç­‰</em></p>
<h2 id="Flash"><a href="#Flash" class="headerlink" title="Flash"></a>Flash</h2><p>åœ¨h5æ²¡æœ‰å‡ºæ¥ä¹‹å‰ï¼Œå¸‚é¢ä¸Šçš„æ’­æ”¾å™¨å‡ ä¹éƒ½æ˜¯Flashæ¥æ’­æ”¾è§†é¢‘çš„ã€‚æœ€å¼€å§‹æ˜¯ä½¿ç”¨<code>embed</code>çš„æ–¹å¼åµŒå…¥æ’­æ”¾å™¨ï¼Œå…¶ä¼šè°ƒç”¨ç³»ç»Ÿçš„åŸç”Ÿæ’­æ”¾å™¨ï¼Œå¦‚windowsçš„media playerï¼Œmacçš„quick timeç­‰ã€‚</p>
<p><code>embed</code>è™½ç„¶åªéœ€è¦ä¸€è¡Œä»£ç </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">embed</span> <span class="attr">src</span>=<span class="string">"src/player.swf"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯å®ƒå®Œå…¨å°±åƒé»‘ç›’å­ï¼Œæ— æ³•è·å–å®ƒé‡Œé¢çš„åŠ¨æ€ä¿¡æ¯ï¼Œç”šè‡³æ— æ³•è·Ÿå®ƒäº¤äº’ã€‚ä½†æ˜¯è¿˜å¯ä»¥ç”¨<code>object</code>çš„å½¢å¼</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">object</span> <span class="attr">type</span>=<span class="string">"application/x-shockwave-flash"</span> <span class="attr">class</span>=<span class="string">"player"</span> <span class="attr">data</span>=<span class="string">"//static.hdslb.com/play.swf"</span> <span class="attr">width</span>=<span class="string">"950"</span> <span class="attr">height</span>=<span class="string">"482"</span> <span class="attr">id</span>=<span class="string">"player_placeholder"</span> <span class="attr">style</span>=<span class="string">"visibility: visible;"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"bgcolor"</span> <span class="attr">value</span>=<span class="string">"#ffffff"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"allowfullscreeninteractive"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"allowfullscreen"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"quality"</span> <span class="attr">value</span>=<span class="string">"high"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"allowscriptaccess"</span> <span class="attr">value</span>=<span class="string">"always"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"wmode"</span> <span class="attr">value</span>=<span class="string">"direct"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"flashvars"</span> <span class="attr">value</span>=<span class="string">"cid=17022717&amp;amp;aid=10303607&amp;amp;pre_ad=0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>flashæ’­æ”¾flvï¼Œæ˜¯å› ä¸ºflashæœ¬èº«å°±å†…å»ºäº†H.264ï¼Œè€Œh5åˆ™éœ€è¦æµè§ˆå™¨äº§å•†å¦‚chromeå»æ”¯æŒï¼Œä½†æ˜¯ï¼Œè¦æƒ³è®©åµŒå…¥çš„ä»£ç å‘æŒ¥ä½œç”¨ï¼Œæµè§ˆå™¨å¿…é¡»å®‰è£…ç›¸å¯¹åº”çš„æ’ä»¶ï¼Œè€Œä¸”è¿˜ç‰ˆæœ¬åˆé€‚ã€‚æ’ä»¶æ˜¯åœ¨ä¸€ä¸ªå°é—­çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œé€šè¿‡è„šæœ¬æ— æ³•ä¿®æ”¹æˆ–è€…æ“ä½œè§†é¢‘å†…å®¹ã€‚å¦‚æœæ’ä»¶æ²¡æœ‰æä¾›APIï¼Œé‚£ä¹ˆæ’ä»¶è¿è¡Œç¯å¢ƒæ— å¼‚äºæ–‡æ¡£ä¸­ä¸€ä¸ªç‹¬ç«‹ç‹å›½ã€‚</p>
<h2 id="Video"><a href="#Video" class="headerlink" title="Video"></a>Video</h2><p>å…ˆä¸Šdemoä»£ç </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">"src/player.mp4"</span> <span class="attr">controls</span>&gt;</span></span><br><span class="line">	æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ video æ ‡ç­¾ã€‚</span><br><span class="line"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ç›®å‰<code>video</code>åªæ”¯æŒçš„è§†é¢‘æ ¼å¼æœ‰ï¼šMP4(MPEG 4æ–‡ä»¶ä½¿ç”¨H264è§†é¢‘ç¼–è§£ç å™¨å’ŒAACéŸ³é¢‘ç¼–è§£ç å™¨)ï¼ŒWebM(WebMæ–‡ä»¶ä½¿ç”¨VP8è§†é¢‘ç¼–è§£ç å™¨å’ŒVorbiséŸ³é¢‘ç¼–è§£ç å™¨)ï¼ŒOgg(Oggæ–‡ä»¶ä½¿ç”¨Theorashipç¼–è§£ç å™¨å’ŒVorbiséŸ³é¢‘ç¼–è§£ç å™¨)ï¼Œå¹¶ä¸”åœ¨ä¸åŒæµè§ˆå™¨ä¸Šä¸åŒè¡¨ç°ã€‚å®é™…ä¸Šh5è¿˜å¯ä»¥æ”¯æŒm3u8ï¼Œä½†m3u8æ˜¯macä¸“æœ‰çš„è§†é¢‘æ ¼å¼ï¼Œæ‰€ä»¥mac\iosä¸‹çš„æµè§ˆå™¨éƒ½æ”¯æŒm3u8çš„æ’­æ”¾ï¼Œè€Œå…¶ä»–æµè§ˆå™¨åˆ™éœ€è¦ç¬¬ä¸‰æ–¹æ”¯æŒè§£ç ã€‚</p>
<h3 id="Browser-Support"><a href="#Browser-Support" class="headerlink" title="Browser Support"></a>Browser Support</h3><table>
<thead>
<tr>
<th>Browser</th>
<th>MP4</th>
<th>WebM</th>
<th>Ogg</th>
</tr>
</thead>
<tbody>
<tr>
<td>IE</td>
<td>YES</td>
<td>NO</td>
<td>NO</td>
</tr>
<tr>
<td>Chrome</td>
<td>YES</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr>
<td>Firefox</td>
<td>YES</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr>
<td>Safari</td>
<td>YES</td>
<td>NO</td>
<td>NO</td>
</tr>
<tr>
<td>Opera</td>
<td>YES(&gt;=25)</td>
<td>YES</td>
<td>YES</td>
</tr>
</tbody>
</table>
<p>æ³¨æ„ï¼š<code>video</code>å¯ä»¥æ·»åŠ å¤šä¸ªsourceæºæ¥è¿›è¡Œå…¼å®¹é€‚é…ï¼Œè¿™æ ·å½“ç¬¬ä¸€ä¸ªä¸å…¼å®¹å¯ä»¥å¾€ä¸‹è¯»å–ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥å…¼å®¹flashæ’­æ”¾å™¨</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">controls</span> <span class="attr">width</span>=<span class="string">"600"</span> <span class="attr">height</span>=<span class="string">"400"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"src/test.mp4"</span> <span class="attr">type</span>=<span class="string">"video/mp4"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"src/test.webm"</span> <span class="attr">type</span>=<span class="string">"video/webm"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">track</span> <span class="attr">src</span>=<span class="string">"src/lyric.vtt"</span> <span class="attr">srclang</span>=<span class="string">"en"</span> <span class="attr">kind</span>=<span class="string">"subtitles"</span> <span class="attr">label</span>=<span class="string">"English"</span> <span class="attr">default</span>&gt;</span> <span class="comment">&lt;!-- å­—å¹• --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">object</span> <span class="attr">id</span>=<span class="string">"flowplayer"</span> <span class="attr">width</span>=<span class="string">"600"</span> <span class="attr">height</span>=<span class="string">"400"</span> <span class="attr">data</span>=<span class="string">"player.swf"</span> <span class="attr">type</span>=<span class="string">"application/x-shockwave-flash"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"movie"</span> <span class="attr">value</span>=<span class="string">"player.swf"</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"flashvars"</span> <span class="attr">value</span>=<span class="string">'config=&#123;"url":"src/test.mp4"&#125;'</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒæ­¤è§†é¢‘<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Media-Type"><a href="#Media-Type" class="headerlink" title="Media Type"></a>Media Type</h3><table>
<thead>
<tr>
<th>File Format</th>
<th>Media Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>MP4</td>
<td>video/mp4</td>
</tr>
<tr>
<td>WebM</td>
<td>video/webm</td>
</tr>
<tr>
<td>Ogg</td>
<td>video/ogg</td>
</tr>
</tbody>
</table>
<h3 id="Events"><a href="#Events" class="headerlink" title="Events"></a>Events</h3><p>å› ä¸ºpcã€androidã€ioså­˜åœ¨å·®å¼‚æ€§ï¼Œåœ¨è¿™é‡Œåªç½—åˆ—pcçš„äº‹ä»¶</p>
<table>
<thead>
<tr>
<th>#</th>
<th>event(PC)</th>
<th>readyState</th>
<th>è§†é¢‘çŠ¶æ€</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>loadstart</td>
<td>NOTHING</td>
<td>-</td>
</tr>
<tr>
<td>2</td>
<td>suspend</td>
<td>NOTHING</td>
<td>-</td>
</tr>
<tr>
<td>3</td>
<td>play</td>
<td>NOTHING</td>
<td>-</td>
</tr>
<tr>
<td>4</td>
<td>waiting</td>
<td>NOTHING</td>
<td>-</td>
</tr>
<tr>
<td>5</td>
<td>durationchange</td>
<td>METADATA</td>
<td>è·å–åˆ°è§†é¢‘é•¿åº¦</td>
</tr>
<tr>
<td>6</td>
<td>loadedmetadata</td>
<td>METADATA</td>
<td>è·å–åˆ°å…ƒæ•°æ®</td>
</tr>
<tr>
<td>7</td>
<td>loadeddata</td>
<td>ENOUGHDATA</td>
<td>-</td>
</tr>
<tr>
<td>8</td>
<td>canplay</td>
<td>ENOUGHDATA</td>
<td>-</td>
</tr>
<tr>
<td>9</td>
<td>playing</td>
<td>ENOUGHDATA</td>
<td>å¼€å§‹æ’­æ”¾</td>
</tr>
<tr>
<td>10</td>
<td>canplaythrough</td>
<td>ENOUGHDATA</td>
<td>å¯ä»¥æµç•…æ’­æ”¾</td>
</tr>
<tr>
<td>11</td>
<td>progress</td>
<td>ENOUGHDATA</td>
<td>æŒç»­ä¸‹è½½</td>
</tr>
<tr>
<td>12</td>
<td>timeupdate</td>
<td>ENOUGHDATA</td>
<td>æ’­æ”¾è¿›åº¦å˜åŒ–</td>
</tr>
<tr>
<td>..</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
</tr>
<tr>
<td>23</td>
<td>progress</td>
<td>ENOUGHDATA</td>
<td>ä¸‹è½½å®Œæ¯•</td>
</tr>
<tr>
<td>24</td>
<td>suspend</td>
<td>ENOUGHDATA</td>
<td>-</td>
</tr>
<tr>
<td>25</td>
<td>timeupdate</td>
<td>ENOUGHDATA</td>
<td>ç»§ç»­æ’­æ”¾ä¸­</td>
</tr>
<tr>
<td>..</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
</tr>
<tr>
<td>48</td>
<td>timeupdate</td>
<td>ENOUGHDATA</td>
<td>-</td>
</tr>
<tr>
<td>49</td>
<td>timeupdate</td>
<td>ENOUGHDATA</td>
<td>-</td>
</tr>
<tr>
<td>50</td>
<td>seeking</td>
<td>METADATA</td>
<td>-</td>
</tr>
<tr>
<td>51</td>
<td>waiting</td>
<td>METADATA</td>
<td>-</td>
</tr>
<tr>
<td>52</td>
<td>timeupdate</td>
<td>ENOUGHDATA</td>
<td>-</td>
</tr>
<tr>
<td>53</td>
<td>seeked</td>
<td>ENOUGHDATA</td>
<td>æ’­æ”¾å®Œæ¯•è¿›åº¦å›åˆ°èµ·ç‚¹</td>
</tr>
<tr>
<td>54</td>
<td>canplay</td>
<td>ENOUGHDATA</td>
<td>-</td>
</tr>
<tr>
<td>55</td>
<td>playing</td>
<td>ENOUGHDATA</td>
<td>å¾ªç¯æ’­æ”¾</td>
</tr>
<tr>
<td>56</td>
<td>canplaythrough</td>
<td>ENOUGHDATA</td>
<td>-</td>
</tr>
<tr>
<td>57</td>
<td>timeupdate</td>
<td>ENOUGHDATA</td>
<td>-</td>
</tr>
<tr>
<td>..</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
</tr>
</tbody>
</table>
<h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><p><strong><a href="https://github.com/Lucius0/100-days-of-css/blob/master/lucius-013/index.html" target="_blank" rel="noopener">github ==&gt; </a></strong></p>
<p><strong>å‚è€ƒèµ„æ–™ï¼š</strong></p>
<ul>
<li><p><a href="http://ask.dcloud.net.cn/article/569" target="_blank" rel="noopener">http://ask.dcloud.net.cn/article/569</a></p>
</li>
<li><p><a href="https://segmentfault.com/a/1190000006461476" target="_blank" rel="noopener">https://segmentfault.com/a/1190000006461476</a></p>
</li>
<li><p><a href="https://www.w3schools.com/html/html5_video.asp" target="_blank" rel="noopener">https://www.w3schools.com/html/html5_video.asp</a></p>
</li>
<li><p><a href="https://en.wikipedia.org/wiki/HTML5_video" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/HTML5_video</a></p>
</li>
<li><p><a href="http://www.xuanfengge.com/html5-video-play.html" target="_blank" rel="noopener">http://www.xuanfengge.com/html5-video-play.html</a></p>
</li>
<li><p><a href="https://www.zhihu.com/question/20997688" target="_blank" rel="noopener">https://www.zhihu.com/question/20997688</a></p>
</li>
<li><p><a href="http://yanhaijing.com/html/2016/03/12/html5-video/" target="_blank" rel="noopener">http://yanhaijing.com/html/2016/03/12/html5-video/</a></p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> video </tag>
            
            <tag> html5 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[csså¸¸è§çš„å‰ç«¯å¸ƒå±€]]></title>
      <url>https://lucius0.github.io/2017/05/01/archivers/css-layouts/</url>
      <content type="html"><![CDATA[<h2 id="æ°´å¹³å±…ä¸­"><a href="#æ°´å¹³å±…ä¸­" class="headerlink" title="æ°´å¹³å±…ä¸­"></a>æ°´å¹³å±…ä¸­</h2><h3 id="margin-å®šå®½"><a href="#margin-å®šå®½" class="headerlink" title="margin + å®šå®½"></a>margin + å®šå®½</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.child</span> &#123;</span></span><br><span class="line"><span class="undefined">  width: 100px;</span></span><br><span class="line"><span class="undefined">  margin: 0 auto;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>é€‚ç”¨å®šå®½</li>
</ul>
<h3 id="table-margin"><a href="#table-margin" class="headerlink" title="table + margin"></a>table + margin</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.child</span> &#123;</span></span><br><span class="line"><span class="undefined">  display: table;</span></span><br><span class="line"><span class="undefined">  margin: 0 auto;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>display: table</code> è¡¨ç°ç±»ä¼¼<code>block</code>ï¼Œä½†æ˜¯å®½åº¦ä¸º<strong>å†…å®¹å®½</strong></p>
</li>
<li><p>æ— éœ€è®¾ç½®çˆ¶å…ƒç´ æ ·å¼ï¼ˆæ”¯æŒIE8åŠå…¶ä»¥ä¸Šç‰ˆæœ¬ï¼ŒIE8ä»¥ä¸‹åˆ™éœ€è¦åµŒå…¥<code>&lt;table&gt;</code></p>
</li>
</ul>
<h3 id="inline-block-text-align"><a href="#inline-block-text-align" class="headerlink" title="inline-block + text-align"></a>inline-block + text-align</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span></span><br><span class="line">    Demo</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.child</span> &#123;</span></span><br><span class="line"><span class="undefined">  display: inline-block;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">  text-align: center;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å…¼å®¹IE6</li>
</ul>
<h3 id="absolute-margin-left"><a href="#absolute-margin-left" class="headerlink" title="absolute + margin-left"></a>absolute + margin-left</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span>  &#123;</span></span><br><span class="line"><span class="undefined">  position: relative;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.child</span> &#123;</span></span><br><span class="line"><span class="undefined">  position: absolute;</span></span><br><span class="line"><span class="undefined">  left: 50%;</span></span><br><span class="line"><span class="undefined">  width: 100px;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">margin-left</span>: <span class="selector-tag">-50px</span>; <span class="comment">/* width/2 */</span></span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>å›ºå®šå®½åº¦</p>
</li>
<li><p>ç›¸æ¯”<code>transform</code>ï¼Œå…¼å®¹æ€§æ›´å¥½</p>
</li>
</ul>
<h3 id="absolute-transform"><a href="#absolute-transform" class="headerlink" title="absolute + transform"></a>absolute + transform</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">  position: relative;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.child</span> &#123;</span></span><br><span class="line"><span class="undefined">  position: absolute;</span></span><br><span class="line"><span class="undefined">  left: 50%;</span></span><br><span class="line"><span class="undefined">  transform: translateX(-50%);</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>ç»å¯¹å®šä½è„±ç¦»æ–‡æ¡£æµï¼Œä¸ä¼šå¯¹åç»­å¸ƒå±€é€ æˆå½±å“</p>
</li>
<li><p><code>transform</code>ä¸ºCSS3å±æ€§ï¼Œå­˜åœ¨å…¼å®¹é—®é¢˜</p>
</li>
</ul>
<h3 id="flex-justify-content"><a href="#flex-justify-content" class="headerlink" title="flex + justify-content"></a>flex + justify-content</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span>  &#123;</span></span><br><span class="line"><span class="undefined">  display: flex;</span></span><br><span class="line"><span class="undefined">  justify-content: center;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>åªéœ€è¦è®¾ç½®çˆ¶èŠ‚ç‚¹</p>
</li>
<li><p><code>flex</code>æœ‰å…¼å®¹é—®é¢˜</p>
</li>
</ul>
<h2 id="å‚ç›´å±…ä¸­"><a href="#å‚ç›´å±…ä¸­" class="headerlink" title="å‚ç›´å±…ä¸­"></a>å‚ç›´å±…ä¸­</h2><h3 id="table-cell-vertical-align"><a href="#table-cell-vertical-align" class="headerlink" title="table-cell + vertical-align"></a>table-cell + vertical-align</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">  display: table-cell;</span></span><br><span class="line"><span class="undefined">  vertical-align: middle;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å…¼å®¹æ€§å¥½ï¼ŒIE8ä»¥ä¸‹ç‰ˆæœ¬éœ€è¦è°ƒæ•´é¡µé¢ç»“æ„<code>table</code></li>
</ul>
<h3 id="absolute-transform-1"><a href="#absolute-transform-1" class="headerlink" title="absolute + transform"></a>absolute + transform</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">    position: relative;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.child</span> &#123;</span></span><br><span class="line"><span class="undefined">    position: absolute;</span></span><br><span class="line"><span class="undefined">    top: 50%;</span></span><br><span class="line"><span class="undefined">    transform: translateY(-50%);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>ç»å¯¹å®šä½è„±ç¦»æ–‡æ¡£æµï¼Œä½†<strong>ç»å¯¹å®šä½å…ƒç´ å¸ˆå”¯ä¸€çš„å…ƒç´ åˆ™çˆ¶å…ƒç´ ä¼šå¤±å»é«˜åº¦</strong></p>
</li>
<li><p><code>transform</code>æœ‰å…¼å®¹é—®é¢˜</p>
</li>
<li><p>åŒæ°´å¹³å±…ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨<code>margin-topå®ç°</code></p>
</li>
</ul>
<h3 id="flex-align-items"><a href="#flex-align-items" class="headerlink" title="flex + align-items"></a>flex + align-items</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">    display: flex;</span></span><br><span class="line"><span class="undefined">    align-items: center;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>flex</code>æœ‰å…¼å®¹é—®é¢˜</li>
</ul>
<h3 id="top-margin-height-2"><a href="#top-margin-height-2" class="headerlink" title="top + margin(-height / 2)"></a>top + margin(-height / 2)</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span> Content goes here<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">  position: absolute;</span></span><br><span class="line"><span class="undefined">  top: 50%;</span></span><br><span class="line"><span class="undefined">  height: 240px;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">margin-top</span>: <span class="selector-tag">-120px</span>; <span class="comment">/* negative half of the height */</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>ç»å¯¹å®šä½ä¸”å›ºå®šé«˜åº¦</p>
</li>
<li><p>è‹¥contentå¤ªå¤šåˆ™ä¼šå‡ºç°æº¢å‡ºï¼Œ<code>overflow:auto</code>åˆ™ä¼šå‡ºç°æ»šåŠ¨æ¡</p>
</li>
<li><p>è™½ç„¶é€‚ç”¨æ‰€æœ‰æµè§ˆå™¨ï¼Œä½†æ˜¯å‡å¦‚æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œcontentåˆ™ä¼šæ¶ˆå¤±</p>
</li>
</ul>
<h3 id="height-50-margin-bottom-contentheight"><a href="#height-50-margin-bottom-contentheight" class="headerlink" title="height:50% + margin-bottom: -contentheight"></a>height:50% + margin-bottom: -contentheight</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"floater"</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"content"</span>&gt;</span>Content here<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-id">#floater</span> &#123;</span></span><br><span class="line"><span class="undefined">  float: left;</span></span><br><span class="line"><span class="undefined">  height: 50%;</span></span><br><span class="line"><span class="undefined">  margin-bottom: -120px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-id">#content</span> &#123;</span></span><br><span class="line"><span class="undefined">  clear: both;</span></span><br><span class="line"><span class="undefined">  height: 240px;</span></span><br><span class="line"><span class="undefined">  position: relative;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>é€‚ç”¨æ‰€æœ‰æµè§ˆå™¨</p>
</li>
<li><p>æ²¡æœ‰è¶³å¤Ÿç©ºé—´æ—¶(ä¾‹å¦‚ï¼šçª—å£ç¼©å°) content ä¸ä¼šè¢«æˆªæ–­ï¼Œæ»šåŠ¨æ¡å‡ºç°</p>
</li>
</ul>
<h3 id="margin-auto-top-amp-bottom"><a href="#margin-auto-top-amp-bottom" class="headerlink" title="margin:auto + top &amp; bottom"></a>margin:auto + top &amp; bottom</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"content"</span>&gt;</span> Content here<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-id">#content</span> &#123;</span></span><br><span class="line"><span class="undefined">  position: absolute;</span></span><br><span class="line"><span class="undefined">  top: 0;</span></span><br><span class="line"><span class="undefined">  bottom: 0;</span></span><br><span class="line"><span class="undefined">  left: 0;</span></span><br><span class="line"><span class="undefined">  right: 0;</span></span><br><span class="line"><span class="undefined">  margin: auto;</span></span><br><span class="line"><span class="undefined">  height: 240px;</span></span><br><span class="line"><span class="undefined">  width: 70%;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>åŒæ ·è‹¥ç©ºé—´å°ï¼Œåˆ™ content ä¼šæ¶ˆå¤±</p>
</li>
<li><p>å­˜åœ¨ IE ä¸å…¼å®¹çš„é—®é¢˜</p>
</li>
</ul>
<h3 id="line-height"><a href="#line-height" class="headerlink" title="line-height"></a>line-height</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"content"</span>&gt;</span> Content here<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-id">#content</span> &#123;</span></span><br><span class="line"><span class="undefined">  height: 100px;</span></span><br><span class="line"><span class="undefined">  line-height: 100px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>åªå¯¹æ–‡æœ¬æœ‰æ•ˆ</p>
</li>
<li><p>å¤šè¡Œæ—¶ï¼Œæ–­è¯æ¯”è¾ƒç³Ÿç³•</p>
</li>
</ul>
<h2 id="æ°´å¹³å‚ç›´å±…ä¸­"><a href="#æ°´å¹³å‚ç›´å±…ä¸­" class="headerlink" title="æ°´å¹³å‚ç›´å±…ä¸­"></a>æ°´å¹³å‚ç›´å±…ä¸­</h2><h3 id="absolute-transform-2"><a href="#absolute-transform-2" class="headerlink" title="absolute + transform"></a>absolute + transform</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">    position: relative;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.child</span> &#123;</span></span><br><span class="line"><span class="undefined">    position: absolute;</span></span><br><span class="line"><span class="undefined">    left: 50%;</span></span><br><span class="line"><span class="undefined">    top: 50%;</span></span><br><span class="line"><span class="undefined">    transform: translate(-50%, -50%);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>ç»å¯¹å®šä½è„±ç¦»æ–‡æ¡£æµ</p>
</li>
<li><p><code>transform</code>æœ‰å…¼å®¹é—®é¢˜</p>
</li>
</ul>
<h3 id="inline-block-text-align-table-cell-vertical-align"><a href="#inline-block-text-align-table-cell-vertical-align" class="headerlink" title="inline-block + text-align + table-cell + vertical-align"></a>inline-block + text-align + table-cell + vertical-align</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">    text-align: center;</span></span><br><span class="line"><span class="undefined">    display: table-cell;</span></span><br><span class="line"><span class="undefined">    vertical-align: middle;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.child</span> &#123;</span></span><br><span class="line"><span class="undefined">    display: inline-block;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å…¼å®¹å¥½</li>
</ul>
<h3 id="flex-justify-content-align-items"><a href="#flex-justify-content-align-items" class="headerlink" title="flex + justify-content + align-items"></a>flex + justify-content + align-items</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">    display: flex;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">justify-content</span>: <span class="selector-tag">center</span>; <span class="comment">/* æ°´å¹³å±…ä¸­ */</span></span></span><br><span class="line"><span class="css">    <span class="selector-tag">align-items</span>: <span class="selector-tag">center</span>; <span class="comment">/*å‚ç›´å±…ä¸­*/</span></span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>åªéœ€è¦è®¾ç½®çˆ¶èŠ‚ç‚¹</p>
</li>
<li><p><code>flex</code>æœ‰å…¼å®¹é—®é¢˜</p>
</li>
</ul>
<h2 id="ä¸€åˆ—å®šå®½ï¼Œä¸€åˆ—è‡ªé€‚åº”"><a href="#ä¸€åˆ—å®šå®½ï¼Œä¸€åˆ—è‡ªé€‚åº”" class="headerlink" title="ä¸€åˆ—å®šå®½ï¼Œä¸€åˆ—è‡ªé€‚åº”"></a>ä¸€åˆ—å®šå®½ï¼Œä¸€åˆ—è‡ªé€‚åº”</h2><h3 id="float-margin"><a href="#float-margin" class="headerlink" title="float + margin"></a>float + margin</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>left<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="undefined">  float: left;</span></span><br><span class="line"><span class="undefined">  width: 100px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="undefined">  margin-left: 100px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>IE 6 æœ‰3åƒç´ çš„BUGï¼Œè§£å†³<strong>å¯ä»¥åœ¨<code>.left</code>åŠ å…¥<code>margin-left:-3px</code></strong>ï¼Œå½“ç„¶ä¹Ÿæœ‰å…¶ä»–çš„è§£å†³æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>left<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right-fix"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="undefined">  float: left;</span></span><br><span class="line"><span class="undefined">  width: 100px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.right-fix</span> &#123;</span></span><br><span class="line"><span class="undefined">  float: right;</span></span><br><span class="line"><span class="undefined">  width: 100%;</span></span><br><span class="line"><span class="undefined">  margin-left: -100px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="undefined">  margin-left: 100px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>æ­¤æ–¹æ³•ä¸ä¼šå­˜åœ¨IE 6ä¸­3åƒç´ çš„é—®é¢˜ï¼Œä½†<code>.left</code>ä¸å¯é€‰æ‹©ï¼Œéœ€è¦è®¾ç½®<code>.left {position: relation}</code></strong>æ¥æé«˜å±‚çº§ã€‚</p>
<h3 id="float-overflow"><a href="#float-overflow" class="headerlink" title="float + overflow"></a>float + overflow</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>left<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="undefined">  float: left;</span></span><br><span class="line"><span class="undefined">  width: 100px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="undefined">  overflow: hidden;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>è®¾ç½®<code>overflow: hidden</code>ä¼šè§¦å‘BFCå—çº§æ ¼å¼ä¸Šä¸‹æ–‡ï¼Œå°±æ˜¯æ— è®ºåœ¨BFCé‡Œé¢åšä»€ä¹ˆæ“ä½œï¼Œå¤–é¢éƒ½ä¸ä¼šå—å½±å“ã€‚ä½†æ˜¯æ­¤æ–¹æ³•ä¸è¢«IE 6æ”¯æŒã€‚</strong></p>
<h3 id="table"><a href="#table" class="headerlink" title="table"></a>table</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"paren"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>left<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">  display: table;</span></span><br><span class="line"><span class="undefined">  width: 100%;</span></span><br><span class="line"><span class="undefined">  table-layout: fixed;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="undefined">  display: table-cell;</span></span><br><span class="line"><span class="undefined">  width: 100px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="undefined">  display: table-cell;</span></span><br><span class="line"><span class="css">  <span class="comment">/*å®½åº¦ä¸ºå‰©ä½™å®½åº¦*/</span></span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong><code>table</code> çš„æ˜¾ç¤ºç‰¹æ€§ä¸ºæ¯åˆ—çš„å•å…ƒæ ¼å®½åº¦å’Œä¸€å®šç­‰ä¸è¡¨æ ¼å®½åº¦ã€‚ <code>table-layout: fixed</code> å¯åŠ é€Ÿæ¸²æŸ“ï¼Œä¹Ÿæ˜¯è®¾å®šå¸ƒå±€ä¼˜å…ˆã€‚<code>table-cell</code> ä¸­ä¸å¯ä»¥è®¾ç½® <code>margin</code> ä½†æ˜¯å¯ä»¥é€šè¿‡ <code>padding</code> æ¥è®¾ç½®é—´è·</strong></p>
<h3 id="flex"><a href="#flex" class="headerlink" title="flex"></a>flex</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>left<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">  display: flex;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="undefined">  width: 100px;</span></span><br><span class="line"><span class="undefined">  margin-left: 20px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="undefined">  flex: 1;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å…¼å®¹é—®é¢˜</li>
</ul>
<h2 id="ç­‰åˆ†å¸ƒå±€"><a href="#ç­‰åˆ†å¸ƒå±€" class="headerlink" title="ç­‰åˆ†å¸ƒå±€"></a>ç­‰åˆ†å¸ƒå±€</h2><h3 id="float"><a href="#float" class="headerlink" title="float"></a>float</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>3<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>4<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">  margin-left: -20px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.column</span> &#123;</span></span><br><span class="line"><span class="undefined">  float: left;</span></span><br><span class="line"><span class="undefined">  width: 25%;</span></span><br><span class="line"><span class="undefined">  padding-left: 20px;</span></span><br><span class="line"><span class="undefined">  box-sizing: border-box;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å…¼å®¹IE 8 ä»¥ä¸Šç‰ˆæœ¬</li>
</ul>
<h3 id="flex-1"><a href="#flex-1" class="headerlink" title="flex"></a>flex</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>3<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>4<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">  display: flex;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.column</span> &#123;</span></span><br><span class="line"><span class="undefined">  flex: 1;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.column</span> + <span class="selector-class">.column</span> &#123; <span class="comment">/* ç›¸é‚»å…„å¼Ÿ */</span></span></span><br><span class="line"><span class="undefined">  margin-left: 20px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="table-1"><a href="#table-1" class="headerlink" title="table"></a>table</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent-fix"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span>&gt;</span>3<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span>&gt;</span>4<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.parent-fix</span>	&#123;</span></span><br><span class="line"><span class="undefined">	margin-left: -20px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">	display: table;</span></span><br><span class="line"><span class="undefined">	width: 100%;</span></span><br><span class="line"><span class="css">    <span class="comment">/*å¯ä»¥å¸ƒå±€ä¼˜å…ˆï¼Œä¹Ÿå¯ä»¥å•å…ƒæ ¼å®½åº¦å¹³åˆ†åœ¨æ²¡æœ‰è®¾ç½®çš„æƒ…å†µä¸‹*/</span></span></span><br><span class="line"><span class="undefined">	table-layout: fixed;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.column</span> &#123;</span></span><br><span class="line"><span class="undefined">	display: table-cell;</span></span><br><span class="line"><span class="undefined">	padding-left: 20px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="ç­‰é«˜å¸ƒå±€"><a href="#ç­‰é«˜å¸ƒå±€" class="headerlink" title="ç­‰é«˜å¸ƒå±€"></a>ç­‰é«˜å¸ƒå±€</h2><h3 id="table-2"><a href="#table-2" class="headerlink" title="table"></a>table</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>left<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">	display: table;</span></span><br><span class="line"><span class="undefined">	width: 100%;</span></span><br><span class="line"><span class="undefined">	table-layout: fixed;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="undefined">	display: table-cell;</span></span><br><span class="line"><span class="undefined">	width: 100px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="undefined">	display: table-cell;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>table</code> çš„ç‰¹æ€§ä¸ºæ¯åˆ—ç­‰å®½ï¼Œæ¯è¡Œç­‰é«˜å¯ä»¥ç”¨äºè§£å†³æ­¤éœ€æ±‚</li>
</ul>
<h3 id="flex-2"><a href="#flex-2" class="headerlink" title="flex"></a>flex</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>left<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">	display: flex;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="undefined">	width: 100px;</span></span><br><span class="line"><span class="undefined">	margin-left: 20px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="undefined">  flex: 1;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„è¿™é‡Œå®é™…ä¸Šä½¿ç”¨äº†<code>align-items: stretch</code>ï¼Œflex é»˜è®¤çš„ <code>align-items</code>çš„å€¼ä¸º <code>stretch</code> </strong></p>
<h3 id="float-1"><a href="#float-1" class="headerlink" title="float"></a>float</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>left<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>right<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="undefined">  overflow: hidden;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.left</span>,</span></span><br><span class="line"><span class="css"><span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="undefined">  padding-bottom: 9999px;</span></span><br><span class="line"><span class="undefined">  margin-bottom: -9999px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="undefined">  float: left;</span></span><br><span class="line"><span class="undefined">  width: 100px;</span></span><br><span class="line"><span class="undefined">  margin-right: 20px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="undefined">  overflow: hidden;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ­¤æ–¹æ³•åªæœ‰èƒŒæ™¯æ˜¾ç¤ºé«˜åº¦ç›¸ç­‰ï¼Œå·¦å³çœŸå®é«˜åº¦å…¶å®ä¸æƒ³ç­‰ï¼Œä½†å…¼å®¹æ€§è¾ƒå¥½ã€‚</li>
</ul>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<ul>
<li><a href="http://www.xingxin.me/posts/590058affd9e613545f2d1f3" target="_blank" rel="noopener">http://www.xingxin.me/posts/590058affd9e613545f2d1f3</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[cssçš„ä¸€äº›å°è®°]]></title>
      <url>https://lucius0.github.io/2017/03/19/archivers/css-notes/</url>
      <content type="html"><![CDATA[<h2 id="before-å’Œ-after"><a href="#before-å’Œ-after" class="headerlink" title=":before å’Œ :after"></a>:before å’Œ :after</h2><p>ä¼ªç±»<code>:before</code>å’Œ<code>:after</code>é»˜è®¤æ˜¯ä¸€ä¸ªè¡Œå†…å…ƒç´ ï¼Œæ‰€ä»¥è¿™ä¸ªå…ƒç´ è®¾ç½®<code>width/height</code>æ˜¯æ— æ•ˆçš„ï¼Œå°±åƒç»™<code>a</code>å…ƒç´ è®¾ç½®<code>width/height</code>ä¸€æ ·ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡è®¾ç½®<code>position:absolute;</code>ï¼Œå¯¹è¿™ä¸ªå…ƒç´ çš„<code>display</code>å±æ€§è®¡ç®—ä¸º<code>inline-block</code>å€¼ï¼Œä½†æ˜¯è®¾ç½®äº†<code>width/height</code>é’ˆå¯¹çš„æ˜¯<code>:before/:after</code>ç”Ÿæˆçš„åŒ¿åæ›¿æ¢å…ƒç´ ï¼Œè€Œä¸æ˜¯å…¶ä¸­çš„<code>content</code>ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// æ— æ•ˆ</span><br><span class="line">span:before &#123;</span><br><span class="line">    content: url(xxx.png);</span><br><span class="line">    width: 800px;</span><br><span class="line">    height: 600px;</span><br><span class="line">&#125;</span><br><span class="line">// å¯ä»¥</span><br><span class="line">span:before &#123;</span><br><span class="line">    content: '';</span><br><span class="line">    background-image:url(xxx.png);</span><br><span class="line">    background-size:800px 600px;</span><br><span class="line">    width: 800px;</span><br><span class="line">    height: 600px;</span><br><span class="line">    position: absolute; // è®¾ç½®å®šä½ç±»å‹</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="inline-block"><a href="#inline-block" class="headerlink" title="inline-block"></a>inline-block</h2><h3 id="å…ƒç´ é—´éš”"><a href="#å…ƒç´ é—´éš”" class="headerlink" title="å…ƒç´ é—´éš”"></a>å…ƒç´ é—´éš”</h3><p><code>inline-block</code>ä½¿å¾—å…ƒç´ æ°´å¹³æ’åˆ—ï¼Œä½†å¦‚æœä¸¤ä¸ª<code>inline-block</code>å…ƒç´ ä¹‹é—´å­˜åœ¨<strong>ç©ºæ ¼</strong>æˆ–è€…<strong>æ¢è¡Œ</strong>å°±ä¼šå‡ºç°å¥‡æ€ªçš„å…ƒç´ é—´éš”ï¼Œå³ä½¿ä½¿ç”¨äº†<code>{padding: 0; margin: 0}</code>ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#text p &#123; display: inline-block; padding: 10px; background-color: red; color: #fff;&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"text"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/css/css-27.png" alt=""></p>
<p>å¸¸è§çš„è§£å†³æ–¹æ³•ï¼š</p>
<p>1ã€å…ƒç´ ä¹‹é—´ä¸è¦å­˜åœ¨<strong>ç©ºæ ¼</strong>æˆ–è€…<strong>æ¢è¡Œç¬¦</strong>ï¼›</p>
<p>2ã€çˆ¶å®¹å™¨çš„<code>font-size:0</code>ã€‚</p>
<p>å»é™¤<code>inline-block</code>ä¹‹é—´çš„é—´éš”æœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒå¼ é‘«æ—­è€å¸ˆçš„<a href="http://www.zhangxinxu.com/wordpress/2012/04/inline-block-space-remove-%E5%8E%BB%E9%99%A4%E9%97%B4%E8%B7%9D/" target="_blank" rel="noopener">å»é™¤inline-blockå…ƒç´ é—´é—´è·çš„Nç§æ–¹æ³•</a></p>
<h3 id="å…ƒç´ å¯¹é½é—®é¢˜"><a href="#å…ƒç´ å¯¹é½é—®é¢˜" class="headerlink" title="å…ƒç´ å¯¹é½é—®é¢˜"></a>å…ƒç´ å¯¹é½é—®é¢˜</h3><p>ä¸¤<code>inline-block</code>å…ƒç´ ï¼Œä¸å­˜åœ¨æ–‡æœ¬çš„æƒ…å†µä¸‹</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#test p &#123;display: inline-block;&#125;</span><br><span class="line">.c1, .c2 &#123;width: 100px; height: 100px;&#125;</span><br><span class="line">.c1 &#123;border: 1px solid #f00;&#125;</span><br><span class="line">.c2 &#123;border: 1px solid #000;&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"test"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"c1"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"c2"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/css/css-28.png" alt=""></p>
<p>ä¸¤<code>inline-block</code>å…ƒç´ å­˜åœ¨æ–‡æœ¬çš„æƒ…å†µä¸‹</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#test p &#123;display: inline-block;&#125;</span><br><span class="line">.c1, .c2 &#123;width: 100px; height: 100px;&#125;</span><br><span class="line">.c1 &#123;border: 1px solid #f00;&#125;</span><br><span class="line">.c2 &#123;border: 1px solid #000;&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"test"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"c1"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"c2"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/css/css-29.png" alt=""></p>
<p>å¸¸è§çš„è§£å†³æ–¹æ³•ï¼š</p>
<p>ç»™å›¾ç‰‡æˆ–è€…èƒŒæ™¯è®¾ç½®<code>vertical-align: top</code>å³å¯ï¼Œæˆ–è€…ç»™æœ‰æ–‡æœ¬çš„å…ƒç´ è®¾ç½®<code>overflow:hidden</code></p>
<p>å‡ºç°è¿™ç§çš„åŸå› æ˜¯å› ä¸º<code>inline-block</code>çš„é»˜è®¤å±æ€§æ˜¯<code>vertical-align: baseline</code>ï¼Œå³ä»¥çˆ¶å…ƒç´ çš„åŸºçº¿å¯¹é½ï¼Œä½†å½“å‡ºç°æ–‡æœ¬çš„æ—¶å€™ï¼Œåˆ™ä¼šå½±å“äº†å¯¹é½çš„åŸºçº¿ã€‚</p>
<p>æ¥è‡ªå®˜æ–¹çš„ç­”æ¡ˆï¼š<a href="https://link.zhihu.com/?target=http%3A//www.w3.org/TR/CSS21/visudet.html%23leading" target="_blank" rel="noopener">â€œVisual formatting model detailsâ€</a></p>
<blockquote>
<p>The baseline of an â€˜inline-blockâ€™ is the baseline of its last line box in the normal flow, unless it has either no in-flow line boxes or if its â€˜overflowâ€™ property has a computed value other than â€˜visibleâ€™, in which case the baseline is the bottom margin edge.</p>
</blockquote>
<h2 id="ç›’æ¨¡å‹"><a href="#ç›’æ¨¡å‹" class="headerlink" title="ç›’æ¨¡å‹"></a>ç›’æ¨¡å‹</h2><p>é¡µé¢ä¸Šçš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å¯ä»¥çœ‹æˆä¸€ä¸ªç›’æ¨¡å‹ã€‚</p>
<p><img src="/images/css/css-30.png" alt=""></p>
<p>å¯ä»¥çŸ¥é“ç›’æ¨¡å‹ç”±å››éƒ¨åˆ†ç»„æˆ<code>content + padding + border + margin</code>ï¼Œå› æ­¤ä¸€ä¸ªå…ƒç´ çš„å®½åº¦åº”è¯¥æ˜¯ï¼š<code>æ€»å®½åº¦ = margin-left + border-left + padding-left + width + padding-right + border-right + margin-right</code>ã€‚</p>
<p>ä½†æ˜¯ä»¥ä¸Šæœ‰é—®é¢˜çš„æ˜¯ï¼Œåœ¨<strong>IE(ä½äºIE 9)</strong>çš„å®½åº¦ä¸ºï¼š<code>æ€»å®½åº¦ = width + margin-right + margin-left</code>ã€‚å› æ­¤å‡ºç°äº†<code>box-sizing: border-box</code>çš„å±æ€§ï¼Œå½“è®¾ç½®<code>box-sizing: border-box</code>å±æ€§æ—¶ï¼Œ<code>border</code> å’Œ <code>padding</code> å°±è¢«åŒ…å«åœ¨äº†å®½é«˜ä¹‹å†…ï¼Œå’Œ IE ä¹‹å‰çš„æ ‡å‡†æ˜¯ä¸€æ ·çš„ã€‚</p>
<h2 id="Chrome-å°äº12å·å­—ä½“"><a href="#Chrome-å°äº12å·å­—ä½“" class="headerlink" title="Chrome å°äº12å·å­—ä½“"></a>Chrome å°äº12å·å­—ä½“</h2><p>ç›¸å¯¹äºå…¶ä»–çš„æµè§ˆå™¨ï¼Œchromeçš„é»˜è®¤æœ€å°å­—ä½“åªèƒ½æ˜¯<code>12px</code>ï¼Œæ— è®ºä½ è®¾ç½®å†å°ä¹Ÿæ˜¯åªèƒ½æ˜¯<code>12px</code>ï¼Œé‚£å‡å¦‚æœ‰ä¸€ä¸ªéœ€æ±‚æ˜¯è¦ä½ å…¼å®¹å…¶ä»–å¹³å°ï¼ŒåŒ…æ‹¬chromeçš„å­—ä½“è¡¨ç°å°äº<code>12px</code>çš„å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨css3çš„ä¸€ä¸ªå±æ€§<code>transform: scale(n)</code>ã€‚</p>
<h2 id="text-overflow-ellipsis"><a href="#text-overflow-ellipsis" class="headerlink" title="text-overflow: ellipsis"></a>text-overflow: ellipsis</h2><p><strong>å¤šè¡Œæ–‡æœ¬</strong>åœ¨å½“å‰æ ‡å‡†æ˜¯ä¸æ”¯æŒ<code>text-overflow: ellipsis</code>ã€‚åœ¨è‰æ¡ˆä¸­æœ‰ä¸€ä¸ªä¸è§„èŒƒçš„å±æ€§<code>-webkit-line-clamp: &lt;number&gt;</code> <a href="http://developer.apple.com/safari/library/documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html#//apple_ref/doc/uid/TP30001266-UnsupportedProperties" target="_blank" rel="noopener">(unsupported WebKit property)</a>å€’æ˜¯å¯ä»¥æ”¯æŒè¿™ä¸€éœ€æ±‚ï¼Œä½†æ˜¯ç›®å‰ä¹Ÿåªæ˜¯åœ¨è‰æ¡ˆä¸­ã€‚<code>text-overflow: ellipsis</code>éœ€è¦<code>overflow: hidden</code>è·Ÿ<code>white-space: nowrap</code>çš„æ”¯æŒï¼Œåœ¨IE 6è¿˜éœ€è¦ç»™å…ƒç´ è®¾ç½®<strong>å®½åº¦</strong>ï¼Œè‡³äºå¤šè¡Œæ–‡æœ¬ï¼Œå¯ä»¥ç”¨<em>Jqueryæ’ä»¶</em>çš„<em>Jquery-dotdotdot</em>ï¼Œæˆ–è€…é€šè¿‡ä¼ªå…ƒç´ <code>:after</code>ä¹Ÿå¯ä»¥å¾ˆå·§å¦™çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>åœ¨æ­¤å¸–ä¸€ä¸‹å¼ è€å¸ˆçš„åˆ†æä»¥åŠä»–çš„æ–¹æ¡ˆï¼š<a href="http://www.zhangxinxu.com/wordpress/2009/09/%E5%85%B3%E4%BA%8E%E6%96%87%E5%AD%97%E5%86%85%E5%AE%B9%E6%BA%A2%E5%87%BA%E7%94%A8%E7%82%B9%E7%82%B9%E7%82%B9-%E7%9C%81%E7%95%A5%E5%8F%B7%E8%A1%A8%E7%A4%BA/" target="_blank" rel="noopener">å…³äºæ–‡å­—å†…å®¹æº¢å‡ºç”¨ç‚¹ç‚¹ç‚¹(â€¦)çœç•¥å·è¡¨ç¤º</a></p>
<h2 id="letter-spacing-æ— æ³•å±…ä¸­çš„é—®é¢˜"><a href="#letter-spacing-æ— æ³•å±…ä¸­çš„é—®é¢˜" class="headerlink" title="letter-spacing æ— æ³•å±…ä¸­çš„é—®é¢˜"></a>letter-spacing æ— æ³•å±…ä¸­çš„é—®é¢˜</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">letter-spacing</span>: 20<span class="selector-tag">px</span>;</span><br><span class="line"><span class="selector-tag">text-indent</span>: 20<span class="selector-tag">px</span>;</span><br><span class="line"><span class="selector-tag">text-align</span><span class="selector-pseudo">:center</span>;</span><br></pre></td></tr></table></figure>
<h2 id="blur"><a href="#blur" class="headerlink" title="blur"></a>blur</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">filter</span>: <span class="selector-tag">blur</span>(10<span class="selector-tag">px</span>);</span><br><span class="line"><span class="selector-tag">-webkit-filter</span>: <span class="selector-tag">blur</span>(10<span class="selector-tag">px</span>);</span><br><span class="line"><span class="selector-tag">-moz-filter</span>: <span class="selector-tag">blur</span>(10<span class="selector-tag">px</span>);</span><br><span class="line"><span class="selector-tag">-o-filter</span>: <span class="selector-tag">blur</span>(10<span class="selector-tag">px</span>);</span><br><span class="line"><span class="selector-tag">-ms-filter</span>: <span class="selector-tag">blur</span>(10<span class="selector-tag">px</span>);</span><br><span class="line">filter: progid:DXImageTransform.Microsoft.Blur(PixelRadius="4");</span><br></pre></td></tr></table></figure>
<h2 id="work-wrap-amp-amp-work-break"><a href="#work-wrap-amp-amp-work-break" class="headerlink" title="work-wrap &amp;&amp; work-break"></a>work-wrap &amp;&amp; work-break</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">    666 asdjkhaksdhksdhkjahskajhsdasdasdaaskashdkasdhkad 872934729347</span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">span &#123;</span><br><span class="line">    word-wrap: break-word;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/css/css-31.png" alt=""></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">    666 asdjkhaksdhksdhkjahskajhsdasdasdaaskashdkasdhkad 872934729347</span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">span &#123;</span><br><span class="line">    word-break: break-all;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/css/css-32.png" alt=""></p>
<p><code>word-wrap: break-word</code> ä¼šæŠŠè¿‡é•¿çš„å­—ç¬¦ä¸²æ¢è¡Œå†æŠ˜æ–­æº¢å‡ºéƒ¨åˆ†ï¼Œè€Œ<code>word-break: break-all</code> ä¼šæŠŠè¿‡é•¿çš„å­—ç¬¦ä¸²åœ¨è¯¥è¡Œå°±å°†æº¢å‡ºçš„æŠ˜æ–­ã€‚</p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä¸ƒä¸ªä½ å¯èƒ½ä¸äº†è§£çš„CSSå•ä½]]></title>
      <url>https://lucius0.github.io/2017/03/19/archivers/7-css-units-you-might-not-know-about/</url>
      <content type="html"><![CDATA[<p>æˆ‘ä»¬å¾ˆå®¹æ˜“æ— æ³•æ‘†è„±çš„ä½¿ç”¨æˆ‘ä»¬æ‰€ç†Ÿæ‚‰çš„CSSæŠ€æœ¯ï¼Œå½“æ–°çš„é—®é¢˜å‡ºç°ï¼Œè¿™æ ·ä¼šä½¿æˆ‘ä»¬å¤„äºä¸åˆ©çš„åœ°ä½ã€‚</p>
<p>éšç€Webç»§ç»­çš„å‘å±•ï¼Œå¯¹æ–°çš„è§£å†³æ–¹æ¡ˆçš„éœ€æ±‚ä¹Ÿä¼šç»§ç»­å¢å¤§ã€‚å› æ­¤ï¼Œä½œä¸ºç½‘é¡µè®¾è®¡å¸ˆå’Œå‰ç«¯å¼€å‘äººå‘˜ï¼Œæˆ‘ä»¬åˆ«æ— é€‰æ‹©ï¼Œåªæœ‰å»äº†è§£æˆ‘ä»¬çš„å·¥å…·é›†å¹¶ä¸”ç†Ÿæ‚‰å®ƒã€‚</p>
<p>è¿™æ„å‘³ç€æˆ‘ä»¬è¿˜è¦äº†è§£ä¸€äº›ç‰¹æ®Šçš„å·¥å…·-é‚£äº›ä¸ç»å¸¸ä½¿ç”¨çš„ï¼Œä½†æ˜¯å½“éœ€è¦å®ƒä»¬çš„æ—¶å€™ï¼Œå®ƒä»¬æ°æ°æ˜¯æœ€æ­£ç¡®çš„å·¥å…·ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘å°†è¦å‘ä½ ä»‹ç»ä¸€äº›ä½ ä»¥å‰å¯èƒ½ä¸çŸ¥é“çš„CSSå·¥å…·ã€‚è¿™äº›å·¥å…·éƒ½æ˜¯è®¡é‡å•ä½ï¼Œå°±åƒåƒç´ æˆ–è€…ç›¸å¯¹å•ä½,ä½†æ˜¯å¾ˆå¯èƒ½ä½ ä»æ¥æ²¡å¬è¯´è¿‡å®ƒä»¬ï¼è®©æˆ‘ä»¬ä¸€æ¢ç©¶ç«Ÿå§ã€‚</p>
<h2 id="rem"><a href="#rem" class="headerlink" title="rem"></a>rem</h2><p>æˆ‘ä»¬å°†ä»ä½ å·²ç»ç†Ÿæ‚‰çš„ä¸œè¥¿å¼€å§‹ã€‚<code>em</code>å•ä½è¢«å®šä¹‰ä¸ºå½“å‰å­—ä½“å¤§å°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨<code>body</code>å…ƒç´ ä¸Šè®¾ç½®ä¸€ä¸ªå­—ä½“å¤§å°ï¼Œé‚£ä¹ˆåœ¨<code>body</code>å…ƒç´ å†…çš„ä»»ä½•å­å…ƒç´ çš„<code>em</code>å€¼éƒ½ç­‰äºè¿™ä¸ªå­—ä½“å¤§å°ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"test"</span>&gt;</span>Test<span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">body &#123; font-size: 14px; &#125; </span><br><span class="line">div &#123; font-size: 1.2em; // calculated at 14px * 1.2, or 16.8px &#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è¯´è¿™ä¸ª<code>div</code>å°†æœ‰ä¸€ä¸ª<code>1.2em</code>çš„<code>font-size</code>ã€‚å®ƒæ˜¯æ‰€ç»§æ‰¿çš„å­—ä½“å¤§å°çš„<code>1.2</code>å€ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ä¸º<code>14px</code>ã€‚ç»“æœä¸º<code>16.8px</code>.</p>
<p>ä½†æ˜¯ï¼Œå½“ä½ åœ¨æ¯ä¸ªå…ƒç´ å†…éƒ½çº§è”<code>em</code>å®šä¹‰çš„å­—ä½“å¤§å°å°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿåœ¨ä¸‹é¢çš„ä»£ç ç‰‡æ®µä¸­æˆ‘ä»¬åº”ç”¨å’Œä¸Šé¢ä¸€æ¨¡ä¸€æ ·çš„CSS.æ¯ä¸ª<code>div</code>ä»å®ƒä»¬çš„çˆ¶èŠ‚ç‚¹ç»§æ‰¿å­—ä½“å¤§å°ï¼Œå¸¦ç»™æˆ‘ä»¬é€æ¸å¢åŠ çš„å­—ä½“å¤§å°ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span> </span><br><span class="line">        Test <span class="comment">&lt;!-- 14 * 1.2 = 16.8px --&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span> </span><br><span class="line">            Test <span class="comment">&lt;!-- 16.8 * 1.2 = 20.16px --&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span> </span><br><span class="line">                Test <span class="comment">&lt;!-- 20.16 * 1.2 = 24.192px --&gt;</span> </span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p data-height="300" data-theme-id="0" data-slug-hash="xbZQRQ" data-user="Envato Tuts" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/tutsplus/pen/xbZQRQ" target="_blank" rel="noopener">Custom Flexbox Alignment With Auto Margins</a> forked by Envato Tuts(<a href="http://codepen.io" target="_blank" rel="noopener">@Envato Tuts</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p>è™½ç„¶åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½éœ€è¦è¿™ä¸ªï¼Œä½†æ˜¯é€šå¸¸ä½ å¯èƒ½æƒ³åŸºäºä¸€ä¸ªå”¯ä¸€çš„åº¦é‡æ ‡å‡†æ¥æŒ‰æ¯”ä¾‹ç¼©æ”¾ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥ç”¨<code>rem</code>ã€‚<code>rem</code>ä¸­çš„â€<code>r</code>â€œä»£è¡¨â€<code>root</code>â€œï¼›è¿™ç­‰åŒäº<code>font-size</code>åŸºäºæ ¹å…ƒç´ è¿›è¡Œè®¾ç½®ï¼›åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ ¹å…ƒç´ ä¸º<code>html</code>å…ƒç´ ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">html &#123; font-size: 14px; &#125; </span><br><span class="line">div &#123; font-size: 1.2rem; &#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šä¸€ä¸ªç¤ºä¾‹ä¸­ä¸‰ä¸ªåµŒå¥—çš„<code>div</code>çš„å­—ä½“å¤§å°è®¡ç®—ç»“æœéƒ½ä¸º<code>16.8px</code>ã€‚</p>
<h3 id="å¯¹ç½‘æ ¼å¸ƒå±€çš„å¥½å¤„"><a href="#å¯¹ç½‘æ ¼å¸ƒå±€çš„å¥½å¤„" class="headerlink" title="å¯¹ç½‘æ ¼å¸ƒå±€çš„å¥½å¤„"></a>å¯¹ç½‘æ ¼å¸ƒå±€çš„å¥½å¤„</h3><p><code>rem</code>ä¸æ˜¯åªå¯¹å®šä¹‰å­—ä½“å¤§å°æœ‰ç”¨ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>rem</code>æŠŠæ•´ä¸ªç½‘æ ¼ç³»ç»Ÿæˆ–è€…UIæ ·å¼åº“åŸºäºHTMLæ ¹å…ƒç´ çš„å­—ä½“å¤§å°ä¸Š,ç„¶ååœ¨ç‰¹å®šçš„åœ°æ–¹ä½¿ç”¨<code>em</code>æ¯”ä¾‹ç¼©æ”¾ã€‚è¿™å°†å¸¦ç»™ä½ æ›´åŠ å¯é¢„æµ‹çš„å­—ä½“å¤§å°å’Œæ¯”ä¾‹ç¼©æ”¾ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.container &#123; </span><br><span class="line">    width: 70rem; // 70 * 14px = 980px </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»æ¦‚å¿µä¸Šè®²ï¼Œåƒè¿™æ ·ä¸€ä¸ªç­–ç•¥èƒŒåçš„æƒ³æ³•æ˜¯ä¸ºäº†å…è®¸ä½ çš„ç•Œé¢éšç€ä½ çš„å†…å®¹æŒ‰æ¯”ä¾‹ç¼©æ”¾ã€‚ç„¶è€Œï¼Œè¿™å¯èƒ½ä¸ä¸€å®šå¯¹æ¯ä¸ªæ¡ˆä¾‹éƒ½æœ‰æ„ä¹‰ã€‚</p>
<p>â€œ<a href="http://caniuse.com/#feat=rem" target="_blank" rel="noopener">rem(root em)å•ä½</a>â€œçš„å…¼å®¹æ€§åˆ—è¡¨ã€‚</p>
<h2 id="vhå’Œvw"><a href="#vhå’Œvw" class="headerlink" title="vhå’Œvw"></a>vhå’Œvw</h2><p>å“åº”å¼ç½‘é¡µè®¾è®¡æŠ€æœ¯å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºæ¯”ä¾‹è§„åˆ™ã€‚ç„¶è€Œï¼ŒCSSæ¯”ä¾‹ä¸æ€»æ˜¯æ¯ä¸ªé—®é¢˜çš„æœ€ä½³è§£å†³æ–¹æ¡ˆã€‚CSSå®½åº¦æ˜¯ç›¸å¯¹äºæœ€è¿‘çš„åŒ…å«çˆ¶å…ƒç´ ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨æ˜¾ç¤ºçª—å£çš„å®½åº¦æˆ–é«˜åº¦è€Œä¸æ˜¯çˆ¶å…ƒç´ çš„å®½åº¦å°†ä¼šæ€ä¹ˆæ ·ï¼Ÿè¿™æ­£æ˜¯<code>vh</code>å’Œ<code>vw</code>å•ä½æ‰€æä¾›çš„ã€‚</p>
<p><code>vh</code>ç­‰äºviewporté«˜åº¦çš„<code>1/100</code>.ä¾‹å¦‚ï¼Œå¦‚æœæµè§ˆå™¨çš„é«˜æ˜¯<code>900px</code>,<code>1vh</code>æ±‚å¾—çš„å€¼ä¸º<code>9px</code>ã€‚åŒç†ï¼Œå¦‚æœæ˜¾ç¤ºçª—å£å®½åº¦ä¸º<code>750px</code>,<code>1vw</code>æ±‚å¾—çš„å€¼ä¸º<code>7.5px</code>ã€‚</p>
<p>è¿™äº›è§„åˆ™è¡¨é¢ä¸Šçœ‹èµ·æ¥æœ‰æ— å°½çš„ç”¨é€”ã€‚ä¾‹å¦‚ï¼Œåšä¸€ä¸ªå æ»¡é«˜åº¦çš„æˆ–è€…æ¥è¿‘å æ»¡é«˜åº¦çš„å¹»ç¯ç‰‡ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªéå¸¸ç®€å•çš„æ–¹æ³•å®ç°ï¼Œåªè¦ç”¨ä¸€è¡ŒCSSï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.slide &#123;</span><br><span class="line">    height: 100vh;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è®¾æƒ³ä½ æƒ³è¦ä¸€ä¸ªå æ»¡å±å¹•å®½åº¦çš„æ ‡é¢˜ã€‚ä¸ºåšåˆ°è¿™ä¸€ç‚¹ï¼Œä½ å°†ä¼šç”¨<code>vw</code>æ¥è®¾ç½®ä¸€ä¸ªå­—ä½“å¤§å°ã€‚è¿™ä¸ªå¤§å°å°†ä¼šéšç€æµè§ˆå™¨çš„å®½åº¦æŒ‰æ¯”ä¾‹ç¼©æ”¾ã€‚</p>
<p data-height="300" data-theme-id="0" data-slug-hash="gbPQga" data-user="Envato Tuts" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/tutsplus/pen/gbPQga" target="_blank" rel="noopener">Custom Flexbox Alignment With Auto Margins</a> forked by Envato Tuts(<a href="http://codepen.io" target="_blank" rel="noopener">@Envato Tuts</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p><a href="http://caniuse.com/#feat=viewport-units" target="_blank" rel="noopener">è§†çª—å•ä½: vw, vh</a>çš„å…¼å®¹æ€§åˆ—è¡¨ã€‚</p>
<h2 id="vmin-å’Œ-vmax"><a href="#vmin-å’Œ-vmax" class="headerlink" title="vmin å’Œ vmax"></a>vmin å’Œ vmax</h2><p><code>vh</code>å’Œ<code>vm</code>æ€»æ˜¯ä¸è§†å£çš„é«˜åº¦å’Œå®½åº¦æœ‰å…³ï¼Œä¸ä¹‹ä¸åŒçš„ï¼Œ<code>vmin</code>å’Œ<code>vmax</code>æ˜¯ä¸è¿™æ¬¡å®½åº¦å’Œé«˜åº¦çš„æœ€å¤§å€¼æˆ–æœ€å°å€¼æœ‰å…³ï¼Œå–å†³äºå“ªä¸ªæ›´å¤§å’Œæ›´å°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæµè§ˆå™¨è®¾ç½®ä¸º<code>1100px</code>å®½ã€<code>700px</code>é«˜ï¼Œ<code>1vmin</code>ä¼šæ˜¯<code>7px</code>,<code>1vmax</code>ä¸º<code>11px</code>ã€‚ç„¶è€Œï¼Œå¦‚æœå®½åº¦è®¾ç½®ä¸º<code>800px</code>ï¼Œé«˜åº¦è®¾ç½®ä¸º<code>1080px</code>ï¼Œ<code>1vmin</code>å°†ä¼šç­‰äº<code>8px</code>è€Œ<code>1vmax</code>å°†ä¼šæ˜¯<code>10.8px</code>ã€‚</p>
<p>æ‰€ä»¥ä½ ä»€ä¹ˆæ—¶å€™å¯èƒ½ç”¨åˆ°è¿™äº›å€¼ï¼Ÿ</p>
<p>è®¾æƒ³ä½ éœ€è¦ä¸€ä¸ªæ€»æ˜¯åœ¨å±å¹•ä¸Šå¯è§çš„å…ƒç´ ã€‚ä½¿ç”¨é«˜åº¦å’Œå®½åº¦è®¾ç½®ä¸ºä½äº<code>100</code>çš„<code>vmin</code>å€¼å°†å¯ä»¥å®ç°è¿™ä¸ªæ•ˆæœã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ­£æ–¹å½¢çš„å…ƒç´ æ€»æ˜¯è‡³å°‘æ¥è§¦å±å¹•çš„ä¸¤æ¡è¾¹å¯èƒ½æ˜¯è¿™æ ·å®šä¹‰çš„ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.box &#123; </span><br><span class="line">    height: 100vmin; width: 100vmin; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/css/css-24.png" alt=""></p>
<p>å¦‚æœä½ éœ€è¦ä¸€ä¸ªæ€»æ˜¯è¦†ç›–å¯è§†çª—å£çš„æ­£æ–¹å½¢(ä¸€ç›´æ¥è§¦å±å¹•çš„å››æ¡è¾¹),ä½¿ç”¨ç›¸åŒçš„è§„åˆ™åªæ˜¯æŠŠå•ä½æ¢æˆ<code>vmax</code>ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.box &#123; </span><br><span class="line">    height: 100vmax; width: 100vmax; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/css/css-25.png" alt=""></p>
<p>è¿™äº›è§„åˆ™çš„ç»„åˆæä¾›äº†ä¸€ä¸ªéå¸¸çµæ´»çš„æ–¹å¼ï¼Œç”¨æ–°çš„ã€ä»¤äººå…´å¥‹çš„æ–¹å¼åˆ©ç”¨ä½ çš„å¯è§†çª—å£çš„å¤§å°ã€‚</p>
<p><a href="http://caniuse.com/#feat=viewport-units" target="_blank" rel="noopener">Viewport units: vmin, vmax</a> â€œå…¼å®¹åˆ—è¡¨ã€‚</p>
<h2 id="exå’Œch"><a href="#exå’Œch" class="headerlink" title="exå’Œch"></a>exå’Œch</h2><p><code>ex</code>å’Œ<code>ch</code>å•ä½ï¼Œä¸<code>em</code>å’Œ<code>rem</code>ç›¸ä¼¼ï¼Œä¾èµ–äºå½“å‰å­—ä½“å’Œå­—ä½“å¤§å°ã€‚ç„¶è€Œï¼Œä¸<code>em</code>å’Œ<code>rem</code>ä¸åŒçš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªå•ä½åªä¹Ÿä¾èµ–äº<code>font-family</code>ï¼Œå› ä¸ºå®ƒä»¬è¢«å®šä¸ºåŸºäºç‰¹æ®Šå­—ä½“çš„æ³•æ¡ˆã€‚</p>
<p><code>ch</code>å•ä½ï¼Œæˆ–è€…å­—ç¬¦å•ä½è¢«å®šä¹‰ä¸º0å­—ç¬¦çš„å®½åº¦çš„â€œå…ˆè¿›çš„å°ºå¯¸â€ã€‚åœ¨â€Eric Meyerâ€™sçš„åšå®¢â€ä¸­å¯ä»¥æ‰¾åˆ°ä¸€äº›éå¸¸æœ‰è¶£çš„è®¨è®ºå…³äºè¿™æ„å‘³ç€ä»€ä¹ˆï¼Œä½†æ˜¯åŸºæœ¬çš„æ¦‚å¿µæ˜¯ï¼Œç»™å®šä¸€ä¸ªç­‰å®½å­—ä½“çš„å­—ä½“ï¼Œä¸€ä¸ªNä¸ªå­—ç¬¦å•ä½å®½çš„ç›’å­ï¼Œæ¯”å¦‚<code>widthï¼š40ch;</code>,å¯ä»¥ä¸€ç›´å®¹çº³ä¸€ä¸ªæœ‰40ä¸ªå­—ç¬¦çš„åº”ç”¨é‚£ä¸ªç‰¹å®šå­—ä½“çš„å­—ç¬¦ä¸²ã€‚è™½ç„¶è¿™ä¸ªç‰¹æ®Šè§„åˆ™çš„ä¼ ç»Ÿç”¨é€”ä¸åˆ—å‡ºç›²æ–‡æœ‰å…³ï¼Œä½†æ˜¯è¿™é‡Œåˆ›é€ æ€§çš„å¯è¡Œæ€§ä¸€å®šä¼šè¶…è¶Šè¿™äº›ç®€å•çš„ç”¨é€”ã€‚</p>
<p><code>ex</code>å•ä½è¢«å®šä¹‰ä¸ºâ€å½“å‰å­—ä½“çš„x-heightæˆ–è€…ä¸€ä¸ª<code>em</code>çš„ä¸€åŠâ€ã€‚ç»™å®šçš„å­—ä½“çš„<code>x-height</code>æ˜¯æŒ‡é‚£ä¸ªå­—ä½“çš„å°å†™xçš„é«˜åº¦ã€‚é€šå¸¸ï¼Œè¿™æ˜¯è¿™ä¸ªå­—ä½“çš„ä¸­é—´çš„æ ‡å¿—ã€‚</p>
<p><img src="/images/css/css-26.png" alt=""></p>
<p>å¯¹äºè¿™ç§å•ä½æœ‰å¾ˆå¤šçš„ç”¨é€”ï¼Œå¤§å¤šæ•°æ˜¯ç”¨äºæ’ç‰ˆçš„å¾®è°ƒã€‚ä¾‹å¦‚ï¼Œ<code>sup</code>å…ƒç´ ,ä»£è¡¨ä¸Šæ ‡ï¼Œå¯ä»¥ç”¨ç›¸å¯¹å®šä½å’Œä¸€ä¸ª<code>1ex</code>çš„åº•éƒ¨å€¼åœ¨è¡Œå†…è¢«æ¨é«˜ã€‚ç±»ä¼¼åœ°ï¼Œä½ å¯ä»¥æ‹‰ä½ä¸€ä¸ªä¸‹æ ‡å…ƒç´ ã€‚æµè§ˆå™¨é»˜è®¤æ”¯æŒè¿™äº›åˆ©ç”¨ä¸Šæ ‡å’Œä¸‹æ ‡ç‰¹æ€§çš„<code>vertical-align</code>è§„åˆ™ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³è¦æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œä½ å¯ä»¥åƒè¿™æ ·æ›´æ˜ç¡®çš„å¤„ç†æ ·å¼ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sup &#123; </span><br><span class="line">    position: relative; bottom: 1ex; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">sub &#123; </span><br><span class="line">    position: relative; bottom: -1ex; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>ex</code>å•ä½åœ¨<a href="http://www.w3.org/TR/REC-CSS1/#length-units" target="_blank" rel="noopener">CSS1</a>ä¸­å·²ç»å­˜åœ¨ï¼Œä½†æ˜¯ä½ ä¸ä¼šæ‰¾åˆ°å¯¹<code>ch</code>å•ä½æœ‰åƒè¿™æ ·åšå®çš„æ”¯æŒã€‚å…·ä½“æ”¯æŒï¼Œåœ¨Eric Meyerâ€™s çš„åšå®¢ä¸­æŸ¥çœ‹<a href="http://www.quirksmode.org/css/units-values/" target="_blank" rel="noopener">CSSå•ä½å’Œå€¼</a>ã€‚</p>
<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>å¯†åˆ‡å…³æ³¨CSSçš„æŒç»­å‘å±•å’Œæ‰©å¼ æ˜¯éå¸¸é‡è¦çš„ï¼Œä¸€è¾¹åœ¨ä½ çš„å·¥å…·é›†é‡ŒçŸ¥é“æ‰€æœ‰çš„å·¥å…·ã€‚ä¹Ÿè®¸ä½ ä¼šé‡åˆ°ä¸€ä¸ªç‰¹æ®Šçš„é—®é¢˜éœ€è¦ä¸€ä¸ªæ„æƒ³ä¸åˆ°çš„è§£å†³æ–¹æ¡ˆï¼Œåˆ©ç”¨è¿™äº›æ›´éšè”½çš„è®¡é‡å•ä½ä¹‹ä¸€ã€‚èŠ±æ—¶é—´å»é˜…è¯»æ–°è§„èŒƒï¼Œè®°å½•æ¥è‡ªå¥½çš„èµ„æºçš„æ–°é—»èµ„è®¯ï¼</p>
<h2 id="æ‰©å±•é˜…è¯»"><a href="#æ‰©å±•é˜…è¯»" class="headerlink" title="æ‰©å±•é˜…è¯»"></a>æ‰©å±•é˜…è¯»</h2><ul>
<li><a href="https://webdesign.tutsplus.com/articles/taking-the-erm-out-of-ems--webdesign-12321" target="_blank" rel="noopener">Taking the â€œErm..â€ Out of Ems</a></li>
<li><a href="https://webdesign.tutsplus.com/articles/taking-ems-even-further--webdesign-12543" target="_blank" rel="noopener">Taking Ems Even Further</a></li>
<li><a href="http://caniuse.com/#feat=viewport-units" target="_blank" rel="noopener">Caniuse Viewport units</a></li>
<li><a href="http://www.w3cplus.com/css/css-font-sizing.html" target="_blank" rel="noopener">CSSçš„font-sizeå±æ€§</a></li>
<li><a href="http://www.w3cplus.com/css/r-i-p-rem-viva-css-reference-pixel.html" target="_blank" rel="noopener">Rem VS Px</a></li>
<li><a href="http://www.w3cplus.com/css/the-lengths-of-css.html" target="_blank" rel="noopener">CSSçš„é•¿åº¦å•ä½</a></li>
<li><a href="http://www.w3cplus.com/css3/define-font-size-with-css3-rem" target="_blank" rel="noopener">CSS3çš„REMè®¾ç½®å­—ä½“å¤§å°</a></li>
<li><a href="http://www.w3cplus.com/css/px-to-em" target="_blank" rel="noopener">CSSä¸­å¼ºå¤§çš„EM</a></li>
</ul>
<script src="http://codepen.io/assets/embed/ei.js"> </script>

<p>è½¬è‡ªï¼š<a href="https://www.w3cplus.com/css/7-css-units-you-might-not-know-about.html" target="_blank" rel="noopener">https://www.w3cplus.com/css/7-css-units-you-might-not-know-about.html</a></p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS - relative å’Œ absolute å°è®°]]></title>
      <url>https://lucius0.github.io/2017/03/02/archivers/relative-absolute-note/</url>
      <content type="html"><![CDATA[<p>æˆ‘åœ¨ä¹‹å‰ç¿»è¯‘è¿‡æœ‰å…³äºcsså®šä½çš„æ–‡ç«  <a href="/2016/10/30//archivers/5-things-you-should-know-about-css/" title="ã€Š5ä»¶ä½ éœ€è¦çŸ¥é“çš„csså®šä½ã€‹">ã€Š5ä»¶ä½ éœ€è¦çŸ¥é“çš„csså®šä½ã€‹</a>ã€‚é‚£ä¹ˆè¿™æ¬¡æ˜¯çœ‹äº†å¼ é‘«æ—­è€å¸ˆçš„<a href="http://www.zhangxinxu.com/wordpress/2010/12/css-%E7%9B%B8%E5%AF%B9%E7%BB%9D%E5%AF%B9%E5%AE%9A%E4%BD%8D%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89/" target="_blank" rel="noopener">ç›¸å¯¹å®šä½å’Œç»å¯¹å®šä½</a>ä¹‹åçš„å°è®°ï¼Œå·©å›ºä¸‹åŸºç¡€çŸ¥è¯†ã€‚</p>
<h2 id="absolute"><a href="#absolute" class="headerlink" title="absolute"></a>absolute</h2><h3 id="åŒ…è£¹æ€§"><a href="#åŒ…è£¹æ€§" class="headerlink" title="åŒ…è£¹æ€§"></a>åŒ…è£¹æ€§</h3><p><code>position: absolute</code>è·Ÿ<code>float: left</code>ä¸€æ ·å…·æœ‰åŒ…è£¹æ€§ï¼Œå³è®©å…ƒç´ <code>inline-block</code>åŒ–ï¼Œä¾‹å¦‚divæ ‡ç­¾é»˜è®¤å®½åº¦100%æ˜¾ç¤ºï¼Œä¸€æ—¦æœ‰äº†åŒ…è£¹æ€§ï¼Œå³100%é»˜è®¤å®½åº¦å°±ä¼šæˆäº†è‡ªé€‚åº”å†…éƒ¨å…ƒç´ çš„å®½åº¦ã€‚<a href="http://www.zhangxinxu.com/study/201012/position-absolute-inline-block.html" target="_blank" rel="noopener">absoluteçš„inline-blockåŒ–demo</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.div &#123; padding:20px; margin-bottom:10px; background-color:#f0f3f9; &#125;</span><br><span class="line">.abs &#123; position:absolute; &#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"div"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">data-src</span>=<span class="string">"http://image.zhangxinxu.com/image/study/s/s256/mm1.jpg"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>æ— absolute<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"div abs"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">data-src</span>=<span class="string">"http://image.zhangxinxu.com/image/study/s/s256/mm1.jpg"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>absoluteå<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>float ä¹Ÿæ˜¯ <code>inline-block</code>å…ƒç´ ï¼Œå¯ä»¥åˆ©ç”¨ float ä½¿å¾—ä¸€äº›å†…è”å…ƒç´ å¦‚ span æ”¯æŒ width å±æ€§ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä»¥ä¸‹ç›®çš„éƒ½æ˜¯ä¸€æ ·çš„ --&gt;</span></span><br><span class="line">span &#123; display:block; width:100px; &#125;</span><br><span class="line">span &#123; float:left; width:100px; &#125;</span><br><span class="line">span &#123; position:absolute; width:100px; &#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç ´åæ€§"><a href="#ç ´åæ€§" class="headerlink" title="ç ´åæ€§"></a>ç ´åæ€§</h3><p>float ä¼šä½¿<strong>é«˜åº¦</strong>å¤±æ•ˆï¼Œä¹‹æ‰€ä»¥<strong>å®½åº¦</strong>è¿˜åœ¨ï¼Œæ˜¯å› ä¸ºè¿˜åœ¨DOM treeï¼Œä½ç½®è¿˜æ˜¯ï¼›è€Œ absolute å› ä¸ºè„±ç¦»æ–‡æ¡£æµï¼Œæ‰€ä»¥å®½é«˜éƒ½å¤±æ•ˆã€‚<a href="http://www.zhangxinxu.com/study/201012/position-absolute-destroy.html" target="_blank" rel="noopener">absoluteçš„ç ´åæ€§demo</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.div &#123; padding:20px; margin:10px 0 0 10px; background-color:#f0f3f9; float:left; &#125;</span><br><span class="line">.abs &#123; position:absolute; &#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"div"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">data-src</span>=<span class="string">"http://image.zhangxinxu.com/image/study/s/s256/mm1.jpg"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>å›¾ç‰‡æ— absolute<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"div"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"abs"</span> <span class="attr">data-src</span>=<span class="string">"http://image.zhangxinxu.com/image/study/s/s256/mm1.jpg"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>å›¾ç‰‡absoluteå<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="å¸¸è§absoluteå¸ƒå±€çš„æ›¿ä»£å®ç°æ–¹æ¡ˆ"><a href="#å¸¸è§absoluteå¸ƒå±€çš„æ›¿ä»£å®ç°æ–¹æ¡ˆ" class="headerlink" title="å¸¸è§absoluteå¸ƒå±€çš„æ›¿ä»£å®ç°æ–¹æ¡ˆ"></a>å¸¸è§absoluteå¸ƒå±€çš„æ›¿ä»£å®ç°æ–¹æ¡ˆ</h3><p><strong>marginæ›¿æ¢</strong></p>
<p>margin å¯ä»¥ä»£æ›¿ absolute å¯¹å…¶å…ƒç´ å®šä½ï¼Œå¦‚Bç›¸å¯¹äºAå…ƒç´ å³ä¸‹è§’å®šä½ï¼Œå¸¸è§çš„å°±æ˜¯ç”¨Bå…ƒç´  absolute å®šä½å¹¶ä¸”ä½¿ç”¨ bottom è·Ÿ right å±æ€§å®šä½ã€‚è¿™æ ·ä¼šå­˜åœ¨é—®é¢˜ï¼Œä¸€æ˜¯å½“çˆ¶å®¹å™¨ä¸º static æ—¶å€™ï¼ŒBä¼šå®šä½é”™ä¹±ï¼ŒäºŒæ˜¯å½“çˆ¶å®¹å™¨çš„å®½åº¦æ”¹å˜ï¼Œé‚£ä¹ˆBçš„å®šä½ä¹Ÿéšä¹‹æ”¹å˜ã€‚è€Œåˆ©ç”¨ margin çš„åšæ³•æ˜¯æ€æ ·çš„å‘¢ï¼ŸAè·ŸBä¸åœ¨åŒä¸€ä¸ª inline-block é‡Œï¼Œå¯ä»¥è®©Aè¡¨ç°ä¸º block å±æ€§ï¼Œå¹¶ä¸”ä½¿Bè£¹ä¸Šä¸€ä¸ªè¡¨ç°ä¸º inline-block çš„å®¹å™¨ï¼Œè¿™æ ·Bå…ƒç´ å°±å¯ä»¥ä½¿ç”¨ margin æ¥çµæ´»å®šä½åˆ°å³ä¸‹è§’äº†ã€‚<a href="http://www.zhangxinxu.com/study/201012/position-absolute-replace-method-2.html" target="_blank" rel="noopener">absolute/marginå®šä½å¸ƒå±€å¯¹æ¯”demo</a></p>
<h3 id="absoluteæ­£ä¸šä¹‹å…ƒç´ éšè—"><a href="#absoluteæ­£ä¸šä¹‹å…ƒç´ éšè—" class="headerlink" title="absoluteæ­£ä¸šä¹‹å…ƒç´ éšè—"></a>absoluteæ­£ä¸šä¹‹å…ƒç´ éšè—</h3><p>é™¤äº†ä½¿ç”¨<code>display: none</code>å’Œ<code>display:block/inline</code>æ¥æ§åˆ¶DOMå…ƒç´ æ˜¾éšï¼Œè¿˜å¯ä»¥åˆ©ç”¨ absolute ï¼Œä¸”æœ‰ä¸‰ä¸ªå¥½å¤„ï¼š<strong>é¡µé¢å¯ç”¨æ€§ï¼Œå›æµä¸æ¸²æŸ“ï¼Œé…åˆJavaScriptçš„æ§åˆ¶ã€‚</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.hidden&#123;</span><br><span class="line">    position:absolute;</span><br><span class="line">    top:-9999em;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.hidden&#123;</span><br><span class="line">    position:absolute;</span><br><span class="line">    visibility:hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.hidden&#123;</span><br><span class="line">    position:absolute;</span><br><span class="line">    clip: rect(1px 1px 1px 1px); /* IE6, IE7 */</span><br><span class="line">    clip: rect(1px, 1px, 1px, 1px);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>1ã€å¯ç”¨æ€§éšè—ï¼š</strong>â€œé€‰é¡¹å¡å†…å®¹â€ï¼Œâ€œæ›´å¤šæ”¶èµ·å±•å¼€â€è¿™äº›ä¼šä¸åˆ©äºç›²äººè¿™ç±»éœ€è¦å€ŸåŠ©å±å¹•é˜…è¯»å™¨çš„ç”¨æˆ·ï¼Œä½†æ˜¯å¯ç”¨æ€§éšè—ä¹Ÿå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å“åº”é”®ç›˜ç„¦ç‚¹Tabåˆ‡æ¢çš„æ—¶å€™ï¼Œå‡å¦‚ä½ ç”¨çš„æ˜¯ absolute éšè—çš„æ—¶å€™ï¼Œæ˜¯å¯ä»¥è¢«å“åº”ç„¦ç‚¹çš„ã€‚</p>
<p><strong>2ã€å›æµä¸æ¸²æŸ“ï¼š</strong>ä½¿ç”¨<code>display:none</code>ä¼šé€ æˆé‡ç»˜è·Ÿå›æµï¼Œè¯¦ç»†å¯ä»¥çœ‹â€œ<a href="http://www.zhangxinxu.com/wordpress/?p=311" target="_blank" rel="noopener">æœ€å°åŒ–æµè§ˆå™¨ä¸­çš„å›æµ(reflow)</a>â€å’Œâ€œ<a href="http://www.zhangxinxu.com/wordpress/?p=600" target="_blank" rel="noopener">å›æµä¸é‡ç»˜ï¼šCSSæ€§èƒ½è®©JavaScriptå˜æ…¢ï¼Ÿ</a>â€</p>
<p><strong>3ã€é…åˆJavaScriptçš„æ§åˆ¶ï¼š</strong> éšè—å¯ä»¥çœ‹ä¸Šé¢çš„ï¼Œä½†æ˜¯æ˜¾ç¤ºæˆ‘ä»¬åªéœ€è¦<code>dom.style.position = &quot;static&quot;;</code>ï¼Œå°±æ— éœ€æ‹…å¿ƒåŸæœ¬æ ‡ç­¾çš„æ˜¯inlineæ°´å¹³è¿˜æ˜¯blockæ°´å¹³ã€‚</p>
<h3 id="absoluteä¸ç­‰é«˜å¸ƒå±€"><a href="#absoluteä¸ç­‰é«˜å¸ƒå±€" class="headerlink" title="absoluteä¸ç­‰é«˜å¸ƒå±€"></a>absoluteä¸ç­‰é«˜å¸ƒå±€</h3><p><a href="http://www.zhangxinxu.com/wordpress/?p=694" target="_blank" rel="noopener">çº¯CSSå®ç°ä¾§è¾¹æ /åˆ†æ é«˜åº¦è‡ªåŠ¨ç›¸ç­‰</a> ä¸ <a href="http://www.zhangxinxu.com/wordpress/?p=1187" target="_blank" rel="noopener">æˆ‘æ‰€çŸ¥é“çš„å‡ ç§display:table-cellçš„åº”ç”¨</a> å‡å¯ä»¥å®ç°ç­‰é«˜å¸ƒå±€ã€‚</p>
<p>ç°åœ¨æ˜¯åˆ©ç”¨ absolute æ¥å®ç°ç­‰é«˜å¸ƒå±€ï¼Œåº”ç”¨äº†<code>position: absolute</code>å…ƒç´ æ— å®½åº¦æ— é«˜åº¦ã€‚<a href="http://www.zhangxinxu.com/study/201103/absolute-equal-height-layout.html" target="_blank" rel="noopener">ç»å¯¹å®šä½ä¸ç­‰é«˜å¸ƒå±€demo</a></p>
<p>æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.equal_height&#123;width:100%; height:999em; position:absolute; left:0; top:0;&#125;</span><br></pre></td></tr></table></figure>
<p>åŒæ—¶ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ol>
<li><p>é«˜åº¦999emçš„ç»å¯¹å®šä½å±‚ä½äºä¾§æ å®¹å™¨å†…ï¼Œä¾§æ <code>position</code>ä¸º<code>relative</code></p>
</li>
<li><p>è¯¥æ å®é™…å…ƒç´ å†…å®¹ç”¨ä¸€ä¸ªä¸absoluteç»å¯¹å®šä½å±‚ä¸ºå…„å¼Ÿå…³ç³»çš„æ ‡ç­¾å±‚åŒ…è£¹ï¼Œ<code>position</code>ä¸º<code>relative</code>ï¼Œ<code>z-index</code>å€¼1æˆ–å…¶ä»–</p>
</li>
<li><p>å·¦å³æ çš„çˆ¶æ ‡ç­¾éœ€è®¾ç½®<code>overflow:hidden</code>ï¼ŒåŒæ—¶ä¸ºäº†å…¼å®¹IE6/7ï¼Œéœ€è®¾ç½®<code>position</code>ä¸º<code>relative</code></p>
</li>
</ol>
<p><img src="/images/css/css-23.png" alt=""></p>
<p><strong>åŸç†ï¼š</strong>ç”±äºç»å¯¹å®šä½å…ƒç´ æ— é«˜åº¦çš„ç‰¹æ€§æ— å®½åº¦çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ªé€ ä¸€ä¸ªé«˜åº¦è¶³å¤Ÿé«˜çš„ç»å¯¹å®šä½å±‚ï¼ˆè®¾ç½®èƒŒæ™¯è‰²ï¼Œè¾¹æ¡†ç­‰å±æ€§ï¼‰ï¼ŒåŒæ—¶è®¾ç½®çˆ¶æ ‡ç­¾æº¢å‡ºéšè—ï¼Œé‚£ä¹ˆå…¶å¤šå‡ºæ¥çš„é«˜åº¦å°±ä¸ä¼šæ˜¾ç¤ºäº†ï¼Œä¹Ÿå°±å®ç°äº†çœ‹ä¸Šå»çš„ç­‰é«˜å¸ƒå±€æ•ˆæœäº†ã€‚</p>
<h2 id="relative"><a href="#relative" class="headerlink" title="relative"></a>relative</h2><p>1ã€å®šä½</p>
<p>relative ä¸ absolute ä¸åŒçš„æ˜¯ï¼Œrelative ç›¸å¯¹äºè‡ªèº«ä½ç§»ï¼Œè€Œ absolute æ˜¯ç›¸å¯¹äºå®¹å™¨ä½ç§»ï¼Œå¼ è€å¸ˆå½¢è±¡çš„ç§°ä¸ºâ€œå¹»å½±ä½ç§»â€œï¼Œä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿå› ä¸º relative æ˜¯ä¸ä¼šè„±ç¦»æ–‡æ¡£æµçš„ï¼Œå³å°±ç®—ä½ ç¦»å¼€äº†è‡ªå·±æœ¬æ¥çš„ä½ç½®ï¼Œé‚£ä¸ªä½ç½®è¿˜åœ¨ï¼Œè¿˜æ˜¯å±äºä½ çš„ï¼Œåªæ˜¯ä½ çš„â€å¹»å½±â€œç¦»å¼€äº†åŸæ¥çš„ä½ç½®ï¼Œè¡¨ç°ä¹Ÿå°±å˜äº†ã€‚<a href="http://www.zhangxinxu.com/study/201108/css-relative-skill-move.html" target="_blank" rel="noopener">relativeå±æ€§å¹»å½±ç¬ç§»æŠ€èƒ½demo</a></p>
<p>2ã€z-index</p>
<p>relative è·Ÿ absolute ä¸€æ ·æ‹¥æœ‰ <code>z-index</code> å±æ€§</p>
<p>3ã€é™åˆ¶ absolute</p>
<p>å½“ absolute çš„çˆ¶å®¹å™¨çš„å®šä½æ˜¯ relative æ—¶ï¼Œabsolute å…ƒç´ ä¹Ÿå°±åªèƒ½åœ¨ relative é™åˆ¶ä¸‹ç§»åŠ¨äº†ï¼Œå³ absolute çš„<code>top\left</code>åˆ™æ˜¯ç›¸å¯¹äº relative ç§»åŠ¨çš„ã€‚</p>
<h3 id="relative-æœ€å°åŒ–å½±å“"><a href="#relative-æœ€å°åŒ–å½±å“" class="headerlink" title="relative æœ€å°åŒ–å½±å“"></a>relative æœ€å°åŒ–å½±å“</h3><p><a href="http://www.zhangxinxu.com/study/201108/css-relative-mini-effect-rule-unfollow.html" target="_blank" rel="noopener">æœªéµå¾ªæœ€å°åŒ–å½±å“åŸåˆ™å®ç°demo</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.test &#123;width:25em; margin:2em auto;&#125;</span><br><span class="line">.box &#123; padding:2em; border:1px solid #beceeb; border-radius:2px; background-color:#f0f3f9; position:relative; &#125;</span><br><span class="line">.ok &#123; color:green; font-size:6em; position:absolute; right:-11px; bottom:-.5em; &#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"test"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">        CSS relativeç›¸å¯¹å®šä½çš„æœ€å°åŒ–å½±å“åŸåˆ™</span><br><span class="line">        <span class="tag">&lt;<span class="name">strong</span> <span class="attr">class</span>=<span class="string">"ok"</span>&gt;</span>âˆš<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a href="http://www.zhangxinxu.com/study/201108/css-relative-mini-effect-rule.html" target="_blank" rel="noopener">éµå¾ªæœ€å°åŒ–å½±å“åŸåˆ™å®ç°demo</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.test &#123;width:25em; margin:2em auto;&#125;</span><br><span class="line">.box &#123; padding:2em; border:1px solid #beceeb; border-radius:2px; background-color:#f0f3f9; &#125;</span><br><span class="line">.rel &#123; position:relative; &#125;</span><br><span class="line">.ok &#123; color:green; font-size:6em; position:absolute; right:-10px; top:-1em; &#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"test"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span>CSS relativeç›¸å¯¹å®šä½çš„æœ€å°åŒ–å½±å“åŸåˆ™<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"rel"</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span> <span class="attr">class</span>=<span class="string">"ok"</span>&gt;</span>âˆš<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><code>absolute+margin</code>ï¼ˆå·¦ä¸Šè§’å…ƒç´ å®šä½ï¼Œä½œç”¨äºå½“å‰å…ƒç´ ï¼‰ã€<code>float+relative</code>ï¼ˆå³ä¸Šè§’å…ƒç´ å®šä½ï¼Œä½œç”¨äºå½“å‰å…ƒç´ ï¼‰å’Œ<code>relative+absolute</code>ï¼ˆå³ä¸‹è§’å…ƒç´ å®šä½ï¼Œç›´æ¥çˆ¶æ ‡ç­¾+å½“å‰å®šä½å…ƒç´ ï¼‰ã€‚è€Œç›®å‰webå±Šå¤§è‚†ä½¿ç”¨çš„å¤–å±‚divå±‚è®¾ç½®relativeå±æ€§ï¼Œé‡Œé¢ä¸€äº›absoluteå…ƒç´ å®šä½çš„æ–¹æ³•æ˜¯ä¸æ¨èçš„ã€‚</p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vue - ç”Ÿå‘½å‘¨æœŸå’Œé’©å­]]></title>
      <url>https://lucius0.github.io/2017/02/27/archivers/vue-life-cycle-and-hook/</url>
      <content type="html"><![CDATA[<p>ç”Ÿå‘½å‘¨æœŸçš„ç¤ºä¾‹å›¾ï¼Œå¯ä»¥å‚è€ƒ <a href="/2017/01/08//archivers/vue-beginning/" title="ã€ŠVue.js åˆä½“éªŒã€‹">ã€ŠVue.js åˆä½“éªŒã€‹</a> ä¸­çš„<strong>ç”Ÿå‘½å‘¨æœŸ</strong>ã€‚</p>
<p>ç»“åˆä¸Šé¢ç»™çš„ç”Ÿå‘½å‘¨æœŸç¤ºä¾‹å›¾ï¼Œæˆ‘ä»¬å¤§è‡´æ¸…æ¥šVueä»åˆ›å»ºåˆ°é”€æ¯çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ©ç”¨ä»£ç è®²è§£ä¸‹å…·ä½“æ¯ä¸ªé’©å­çš„å®é™…ä½œç”¨ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">"refHook"</span> &gt;</span>this is refHook<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">    data: &#123;</span></span><br><span class="line"><span class="javascript">        message : <span class="string">"this is data message"</span></span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">     beforeCreate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;   beforeCreate'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el); <span class="comment">//undefined</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data); <span class="comment">//undefined </span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message);  <span class="comment">//undefined </span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs); <span class="comment">//å·²è¢«åˆå§‹åŒ–</span></span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;   created'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el); <span class="comment">//undefined</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data); <span class="comment">//å·²è¢«åˆå§‹åŒ– </span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message);  <span class="comment">//å·²è¢«åˆå§‹åŒ– </span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs); <span class="comment">//å·²è¢«åˆå§‹åŒ–</span></span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      beforeMount: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;   beforeMount'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el); <span class="comment">//å·²è¢«åˆå§‹åŒ–</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data); <span class="comment">//å·²è¢«åˆå§‹åŒ– </span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message);  <span class="comment">//å·²è¢«åˆå§‹åŒ– </span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs); <span class="comment">//å·²è¢«åˆå§‹åŒ–</span></span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      mounted: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;   mounted'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el); <span class="comment">//å·²è¢«åˆå§‹åŒ–</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data); <span class="comment">//å·²è¢«åˆå§‹åŒ– </span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message);  <span class="comment">//å·²è¢«åˆå§‹åŒ– </span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs); <span class="comment">//å·²è¢«åˆå§‹åŒ–</span></span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      beforeUpdate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;   beforeUpdate'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el); </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data); </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message);  </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs); </span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      updated: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;   updated'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el); </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data);  </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message);  </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs); </span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      beforeDestroy: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;   beforeDestroy'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el); </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data);  </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message);   </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs); </span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      destroyed: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;   destroyed'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el); </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data);  </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message);   </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs);</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">  &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸‹å›¾æˆ‘ä»¬çœ‹åˆ°ä»åˆ›å»ºåˆ°æŒ‚è½½çš„æ•´ä¸ªæµç¨‹ï¼Œç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œåœ¨<code>beforeMount</code>æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>el</code>è¿˜æ˜¯<code>[[ message ]]</code>(<em>ps: è¿™é‡Œçš„ [ æŒ‡çš„æ˜¯èŠ±æ‹¬å¼§ï¼Œå› ä¸ºhexoä¼šæŠŠèŠ±æ‹¬å¼§ç»™è§†ä¸ºå…³é”®å­—ç¬¦</em>)ï¼Œè¿™é‡Œå°±æ˜¯è¿ç”¨åˆ°äº†<strong>visual dom</strong>çš„åŸç†ï¼Œç›´åˆ°<code>mounted</code>æ‰æŠŠæ•°æ®æ¸²æŸ“è¿›å»ã€‚</p>
<p><img src="/images/vue/vue-15.png" alt=""></p>
<p><strong>å°ç»“ï¼š</strong></p>
<ol>
<li><p><code>beforecreated</code>ï¼šel å’Œ data è¿˜æœªåˆå§‹åŒ–ï¼Œ<del>ä½†æ˜¯refså·²ç»åˆå§‹åŒ–å®Œæˆäº†</del>ï¼Œrefsä¹Ÿæ˜¯åªæ˜¯æ‹¿åˆ°å¯¹è±¡ï¼Œå±æ€§æ–¹æ³•è¿˜æ²¡æ¸²æŸ“å®Œæ¯•([Vue warn]: Error in beforecreated hook)ã€‚</p>
</li>
<li><p><code>created</code>ï¼šå®Œæˆäº† data æ•°æ®çš„åˆå§‹åŒ–ï¼Œelæ²¡æœ‰</p>
</li>
<li><p><code>beforeMount</code>ï¼šå®Œæˆäº† el å’Œ data åˆå§‹åŒ– </p>
</li>
<li><p><code>mounted</code>ï¼šå®ŒæˆæŒ‚è½½ï¼Œrefsçš„ç»„ä»¶å±æ€§æ–¹æ³•æ¸²æŸ“å®Œæˆ</p>
</li>
</ol>
<p>åœ¨æ§åˆ¶å°è¾“å…¥<code>app.message = &#39;hello vue&#39;</code>ï¼Œä¼šçœ‹åˆ°vueè§¦å‘<code>beforeUpdate</code>ä»¥åŠ<code>updated</code>ã€‚</p>
<p><img src="/images/vue/vue-16.png" alt=""></p>
<p>è‡³äºé”€æ¯ï¼Œ<code>app.$destroy()</code>ï¼Œä¼šè§¦å‘<code>beforeDestroy</code>å’Œ<code>destroyed</code>ï¼Œä½†æ˜¯é”€æ¯ä¹‹åï¼Œæˆ‘ä»¬é‡æ–°ä¿®æ”¹<code>app.message = &#39;hello&#39;</code>æ˜¯ä¸ä¼šå†ç”Ÿæ•ˆçš„äº†ï¼Œä¹Ÿå°±æ˜¯åŸå…ˆçš„domä¾æ—§å­˜åœ¨ï¼Œä½†æ˜¯å·²ç»æ— æ³•ä½¿ç”¨vueæ¥æ§åˆ¶domå…ƒç´ çš„å˜åŒ–äº†ã€‚</p>
<p>é‚£ä¹ˆç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿæˆ‘ä»¬åŒæ ·ä¹Ÿæ¥åšä¸€ä¸‹ç®€å•çš„æ¨¡æ‹Ÿã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">child-com</span> <span class="attr">:child-msg</span>=<span class="string">"childMsg"</span>&gt;</span><span class="tag">&lt;/<span class="name">child-com</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">Vue.component(<span class="string">'childCom'</span>, &#123;</span></span><br><span class="line"><span class="xml">  template: "<span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;childMsg&#125;&#125; - &#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span>",</span></span><br><span class="line"><span class="javascript">  props: [<span class="string">'childMsg'</span>],</span></span><br><span class="line"><span class="undefined">  data () &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">      message: <span class="string">"this is child data message"</span></span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="javascript">  beforeCreate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  child beforeCreate'</span>);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message); </span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"props  : "</span> + <span class="keyword">this</span>.childMsg, <span class="keyword">this</span>.childMsg);</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="javascript">  created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  child created'</span>);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message); </span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"props  : "</span> + <span class="keyword">this</span>.childMsg, <span class="keyword">this</span>.childMsg);</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="javascript">  beforeMount: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  child beforeMount'</span>);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message); </span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"props  : "</span> + <span class="keyword">this</span>.childMsg, <span class="keyword">this</span>.childMsg);</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="javascript">  mounted: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  child mounted'</span>);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message); </span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"props  : "</span> + <span class="keyword">this</span>.childMsg, <span class="keyword">this</span>.childMsg);</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="javascript">  beforeUpdate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  child beforeUpdate'</span>);</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="javascript">  updated: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  child updated'</span>);</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="javascript">  beforeDestroy: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  child beforeDestroy'</span>);</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="javascript">  destroyed: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  child destroyed'</span>);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">    data: &#123;</span></span><br><span class="line"><span class="javascript">        message : <span class="string">"this is data message"</span>,</span></span><br><span class="line"><span class="javascript">        childMsg: <span class="string">"this is childMsg"</span></span></span><br><span class="line"><span class="undefined">    &#125;,</span></span><br><span class="line"><span class="javascript">     beforeCreate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  parent beforeCreate'</span>);</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  parent created'</span>);</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      beforeMount: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  parent beforeMount'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message); </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs);</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      mounted: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  parent mounted'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el, <span class="keyword">this</span>.$el);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data, <span class="keyword">this</span>.$data);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message, <span class="keyword">this</span>.message); </span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"refs   : "</span> + <span class="keyword">this</span>.$refs, <span class="keyword">this</span>.$refs);</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      beforeUpdate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  parent beforeUpdate'</span>);</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      updated: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  parent updated'</span>);</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      beforeDestroy: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  parent beforeDestroy'</span>);</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      destroyed: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.group(<span class="string">'=========================================&gt;&gt;&gt;&gt;&gt;&gt;  parent destroyed'</span>);</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">  &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>props</code>çš„æ•°æ®æ˜¯è·Ÿ<code>data</code>çš„å‡ºç°å‘¨æœŸæ˜¯ä¸€æ ·çš„ï¼Œç»„ä»¶æ˜¯åœ¨çˆ¶å®¹å™¨æ‰§è¡Œ<code>beforeMount</code>æ—¶åˆå§‹åŒ–çš„ï¼Œåœ¨<code>beforeCreate</code>æ“ä½œ<code>props</code>æ•°æ®åˆ™ä¼šæŠ¥é”™ï¼Œå› ä¸ºé‚£ä¸ªæ—¶å€™è¿˜æ²¡æŒ‚è½½åˆ°appå®ä¾‹åŒ–å¯¹è±¡ä¸Šã€‚è¿˜æœ‰æ³¨æ„ä¸€ä¸‹<code>parent beforeMount</code>ï¼Œè¿™ä¸ªè·Ÿä¹‹å‰è¯´çš„è™šæ‹Ÿdomçš„åŸç†ä¸€æ ·ï¼Œå…ˆå å‘ï¼Œç„¶åå†æŒ‚è½½ã€‚</p>
<p><img src="/images/vue/vue-17.png" alt=""></p>
<p>åœ¨<code>created</code>æ—¶ï¼Œç»„ä»¶çš„<code>props</code>æ•°æ®å‡ºæ¥äº†ï¼Œæ³¨æ„ç»„ä»¶çš„<code>el</code>åœ¨<code>beforeMount</code>æ—¶ï¼Œæ˜¯ä¸ä¼šåƒçˆ¶å®¹å™¨é‚£æ ·å…ˆå å‘çš„ï¼Œè€Œæ˜¯ç­‰åˆ°<code>mounted</code>ä¹‹åæ‰æŠŠæ•°æ®æ¸²æŸ“ä¸Šå»ï¼Œä¹‹åè¿”å›çˆ¶å®¹å™¨çš„<code>mounted</code>æ–¹æ³•ï¼Œæ‰ä¼šæŠŠç»„ä»¶æ•°æ®éƒ½æ¸²æŸ“åˆ°domä¸Šé¢å»ã€‚</p>
<p><img src="/images/vue/vue-18.png" alt=""></p>
<p><strong>æ€»ç»“ï¼š</strong></p>
<blockquote>
<p>beforecreate : ä¸¾ä¸ªæ —å­ï¼šå¯ä»¥åœ¨è¿™åŠ ä¸ªloadingäº‹ä»¶<br>created ï¼šåœ¨è¿™ç»“æŸloadingï¼Œè¿˜åšä¸€äº›åˆå§‹åŒ–ï¼Œå®ç°å‡½æ•°è‡ªæ‰§è¡Œ<br>mounted ï¼š åœ¨è¿™å‘èµ·åç«¯è¯·æ±‚ï¼Œæ‹¿å›æ•°æ®ï¼Œé…åˆè·¯ç”±é’©å­åšä¸€äº›äº‹æƒ…<br>beforeDestoryï¼š ä½ ç¡®è®¤åˆ é™¤XXå—ï¼Ÿ<br>destoryed ï¼šå½“å‰ç»„ä»¶å·²è¢«åˆ é™¤ï¼Œæ¸…ç©ºç›¸å…³å†…å®¹</p>
</blockquote>
<p>å‚è€ƒèµ„æ–™ï¼š<a href="http://www.cnblogs.com/gagag/p/6246493.html" target="_blank" rel="noopener">http://www.cnblogs.com/gagag/p/6246493.html</a></p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> vue </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vue - props]]></title>
      <url>https://lucius0.github.io/2017/02/24/archivers/vue-props/</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Vue 2.xç›¸æ¯”è¾ƒVue 1.xè€Œè¨€ï¼Œå‡çº§å˜åŒ–é™¤äº†å®ç°äº†Virtual-Domä»¥å¤–ï¼Œç»™ä½¿ç”¨è€…æœ€å¤§ä¸é€‚å°±æ˜¯ç§»é™¤çš„ç»„ä»¶çš„<code>props</code>çš„åŒå‘ç»‘å®šåŠŸèƒ½ã€‚ä»¥å¾€åœ¨Vue1.xä¸­åˆ©ç”¨<code>props</code>çš„<code>twoWay</code>å’Œ<code>.sync</code>ç»‘å®šä¿®é¥°ç¬¦å°±å¯ä»¥å®ç°<code>props</code>çš„åŒå‘ç»‘å®šåŠŸèƒ½ï¼Œä½†æ˜¯åœ¨Vue2ä¸­å½»åº•åºŸå¼ƒäº†æ­¤åŠŸèƒ½ï¼Œå¦‚æœéœ€è¦åŒå‘ç»‘å®šéœ€è¦è‡ªå·±æ¥å®ç°ã€‚</p>
<h2 id="Vue2çš„ç»„ä»¶propsé€šä¿¡æ–¹å¼"><a href="#Vue2çš„ç»„ä»¶propsé€šä¿¡æ–¹å¼" class="headerlink" title="Vue2çš„ç»„ä»¶propsé€šä¿¡æ–¹å¼"></a>Vue2çš„ç»„ä»¶propsé€šä¿¡æ–¹å¼</h2><p>åœ¨Vue2ä¸­ç»„ä»¶çš„propsçš„æ•°æ®æµåŠ¨æ”¹ä¸ºäº†åªèƒ½å•å‘æµåŠ¨ï¼Œå³åªèƒ½ç”±ç»„ä»¶å¤–ï¼ˆè°ƒç”¨ç»„ä»¶æ–¹ï¼‰é€šè¿‡ç»„ä»¶çš„DOMå±æ€§<code>attribute</code>ä¼ é€’<code>props</code>ç»™ç»„ä»¶å†…ï¼Œç»„ä»¶å†…åªèƒ½è¢«åŠ¨æ¥æ”¶ç»„ä»¶å¤–ä¼ é€’è¿‡æ¥çš„æ•°æ®ï¼Œå¹¶ä¸”åœ¨ç»„ä»¶å†…ï¼Œä¸èƒ½ä¿®æ”¹ç”±å¤–å±‚ä¼ æ¥çš„<code>props</code>æ•°æ®ã€‚</p>
<p><img src="/images/vue/vue-12.jpg" alt=""></p>
<p>å…³äºè¿™ä¸€ç‚¹çš„ä¿®æ”¹å®˜æ–¹ç»™çš„è§£é‡Šï¼š</p>
<blockquote>
<p>prop æ˜¯å•å‘ç»‘å®šçš„ï¼šå½“çˆ¶ç»„ä»¶çš„å±æ€§å˜åŒ–æ—¶ï¼Œå°†ä¼ å¯¼ç»™å­ç»„ä»¶ï¼Œä½†æ˜¯ä¸ä¼šåè¿‡æ¥ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢å­ç»„ä»¶æ— æ„ä¿®æ”¹äº†çˆ¶ç»„ä»¶çš„çŠ¶æ€â€”â€”è¿™ä¼šè®©åº”ç”¨çš„æ•°æ®æµéš¾ä»¥ç†è§£ã€‚</p>
</blockquote>
<p>è™½ç„¶åºŸå¼ƒäº†propsçš„åŒå‘ç»‘å®šå¯¹äºæ•´ä¸ªé¡¹ç›®æ•´ä½“è€Œè¨€æ˜¯æœ‰åˆ©ä¸”æ­£ç¡®çš„ï¼Œä½†æ˜¯åœ¨æŸäº›æ—¶å€™æˆ‘ä»¬ç¡®å®éœ€è¦ä»ç»„ä»¶å†…éƒ¨ä¿®æ”¹propsçš„éœ€æ±‚</p>
<h2 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><p>å‡è®¾æˆ‘è¦åšä¸€ä¸ªiOSé£æ ¼çš„å¼€å…³æŒ‰é’®ï¼Œéœ€æ±‚å°±åªæœ‰ä¸¤ä¸ªï¼š</p>
<ol>
<li><p>ç‚¹å‡»æŒ‰é’®å®ç° å¼€/å…³ çŠ¶æ€åˆ‡æ¢</p>
</li>
<li><p>ä¸ç‚¹å‡»æŒ‰é’®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¤–éƒ¨ä¿®æ”¹æ•°æ®åˆ‡æ¢å¼€å…³çŠ¶æ€ï¼Œæ¯”å¦‚çº§è”è”åŠ¨å¼€å…³ã€‚</p>
</li>
</ol>
<p><img src="/images/vue/vue-13.jpg" alt=""></p>
<p>ä»£ç å¤§è‡´æ˜¯ç±»ä¼¼è¿™æ ·çš„ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--å¼€å…³ç»„ä»¶--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">switchbtn</span> <span class="attr">:result</span>=<span class="string">"result"</span>&gt;</span><span class="tag">&lt;/<span class="name">switchbtn</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--å¤–éƒ¨æ§åˆ¶--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"change"</span> @<span class="attr">click</span>=<span class="string">"change"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¼€å…³ç»„ä»¶ä»£ç </span></span><br><span class="line">Vue.component(<span class="string">"switchbtn"</span>,&#123;</span><br><span class="line">    template:<span class="string">"&lt;div @click='change'&gt;&#123;&#123;result?'å¼€':'å…³'&#125;&#125;&lt;/div&gt;"</span>,</span><br><span class="line">    props:[<span class="string">"result"</span>],</span><br><span class="line">    methods:&#123;</span><br><span class="line">        change()&#123;</span><br><span class="line">            <span class="keyword">this</span>.result=!<span class="keyword">this</span>.result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨ç»„ä»¶</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">"#app"</span>,</span><br><span class="line">    data:&#123;</span><br><span class="line">        result:<span class="literal">true</span><span class="comment">//å¼€å…³çŠ¶æ€æ•°æ®</span></span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line">        change()&#123;</span><br><span class="line">            <span class="keyword">this</span>.result=!<span class="keyword">this</span>.result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯åœ¨vue2.0ä¸­ä¸Šé¢çš„ä»£ç åœ¨ç‚¹å‡»å¼€å…³æ—¶ä¼šæŠ¥é”™ï¼š</p>
<blockquote>
<p>[Vue warn]: Avoid mutating a prop directly since the value will be overwritten whenever the parent component re-renders. Instead, use a data or computed property based on the propâ€™s value. Prop being mutated: â€œresultâ€ (found in component )</p>
</blockquote>
<p>ç»„ä»¶å†…ä¸èƒ½ä¿®æ”¹propsçš„å€¼ï¼ŒåŒæ—¶ä¿®æ”¹çš„å€¼ä¹Ÿä¸ä¼šåŒæ­¥åˆ°ç»„ä»¶å¤–å±‚ï¼Œå³è°ƒç”¨ç»„ä»¶æ–¹ä¸çŸ¥é“ç»„ä»¶å†…éƒ¨å½“å‰çš„çŠ¶æ€æ˜¯ä»€ä¹ˆ</p>
<h2 id="å®ç°ç»„ä»¶å±æ€§çš„åŒå‘ç»‘å®šæ–¹å¼"><a href="#å®ç°ç»„ä»¶å±æ€§çš„åŒå‘ç»‘å®šæ–¹å¼" class="headerlink" title="å®ç°ç»„ä»¶å±æ€§çš„åŒå‘ç»‘å®šæ–¹å¼"></a>å®ç°ç»„ä»¶å±æ€§çš„åŒå‘ç»‘å®šæ–¹å¼</h2><h3 id="åœ¨ç»„ä»¶å†…çš„dataå¯¹è±¡ä¸­åˆ›å»ºä¸€ä¸ªpropså±æ€§çš„å‰¯æœ¬"><a href="#åœ¨ç»„ä»¶å†…çš„dataå¯¹è±¡ä¸­åˆ›å»ºä¸€ä¸ªpropså±æ€§çš„å‰¯æœ¬" class="headerlink" title="åœ¨ç»„ä»¶å†…çš„dataå¯¹è±¡ä¸­åˆ›å»ºä¸€ä¸ªpropså±æ€§çš„å‰¯æœ¬"></a>åœ¨ç»„ä»¶å†…çš„dataå¯¹è±¡ä¸­åˆ›å»ºä¸€ä¸ªpropså±æ€§çš„å‰¯æœ¬</h3><p>å› ä¸º<code>result</code>ä¸å¯å†™ï¼Œæ‰€ä»¥éœ€è¦åœ¨dataä¸­åˆ›å»ºä¸€ä¸ªå‰¯æœ¬<code>myResult</code>å˜é‡ï¼Œåˆå§‹å€¼ä¸ºpropså±æ€§<code>result</code>çš„å€¼ï¼ŒåŒæ—¶åœ¨ç»„ä»¶å†…æ‰€æœ‰éœ€è¦è°ƒç”¨propsçš„åœ°æ–¹è°ƒç”¨è¿™ä¸ªdataå¯¹è±¡<code>myResult</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">"switchbtn"</span>, &#123;</span><br><span class="line">    template: <span class="string">"&lt;div @click='change'&gt;&#123;&#123;myResult?'å¼€':'å…³'&#125;&#125;&lt;/div&gt;"</span>,</span><br><span class="line">    props: [<span class="string">"result"</span>],</span><br><span class="line">    data: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            myResult: <span class="keyword">this</span>.result<span class="comment">//dataä¸­æ–°å¢å­—æ®µ</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    ......</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºé’ˆå¯¹propså±æ€§çš„watchæ¥åŒæ­¥ç»„ä»¶å¤–å¯¹propsçš„ä¿®æ”¹"><a href="#åˆ›å»ºé’ˆå¯¹propså±æ€§çš„watchæ¥åŒæ­¥ç»„ä»¶å¤–å¯¹propsçš„ä¿®æ”¹" class="headerlink" title="åˆ›å»ºé’ˆå¯¹propså±æ€§çš„watchæ¥åŒæ­¥ç»„ä»¶å¤–å¯¹propsçš„ä¿®æ”¹"></a>åˆ›å»ºé’ˆå¯¹propså±æ€§çš„watchæ¥åŒæ­¥ç»„ä»¶å¤–å¯¹propsçš„ä¿®æ”¹</h3><p>æ­¤æ—¶åœ¨ç»„ä»¶å¤–ï¼ˆçˆ¶ç»„ä»¶ï¼‰ä¿®æ”¹äº†ç»„ä»¶çš„propsï¼Œä¼šåŒæ­¥åˆ°ç»„ä»¶å†…å¯¹åº”çš„propsä¸Šï¼Œä½†æ˜¯ä¸ä¼šåŒæ­¥åˆ°ä½ åˆšåˆšåœ¨dataå¯¹è±¡ä¸­åˆ›å»ºçš„é‚£ä¸ªå‰¯æœ¬ä¸Šï¼Œæ‰€ä»¥éœ€è¦å†åˆ›å»ºä¸€ä¸ªé’ˆå¯¹propså±æ€§<code>result</code>çš„watchï¼ˆç›‘å¬ï¼‰ï¼Œå½“propsä¿®æ”¹åå¯¹åº”dataä¸­çš„å‰¯æœ¬<code>myResult</code>ä¹Ÿè¦åŒæ­¥æ•°æ®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">"switchbtn"</span>, &#123;</span><br><span class="line">    template: <span class="string">"&lt;div @click='change'&gt;&#123;&#123;myResult?'å¼€':'å…³'&#125;&#125;&lt;/div&gt;"</span>,</span><br><span class="line">    props: [<span class="string">"result"</span>],</span><br><span class="line">    data: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            myResult: <span class="keyword">this</span>.result</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">        result(val) &#123;</span><br><span class="line">            <span class="keyword">this</span>.myResult = val;<span class="comment">//æ–°å¢resultçš„watchï¼Œç›‘å¬å˜æ›´å¹¶åŒæ­¥åˆ°myResultä¸Š</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    ......</span><br></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºé’ˆå¯¹propså‰¯æœ¬çš„watchï¼Œé€šçŸ¥åˆ°ç»„ä»¶å¤–"><a href="#åˆ›å»ºé’ˆå¯¹propså‰¯æœ¬çš„watchï¼Œé€šçŸ¥åˆ°ç»„ä»¶å¤–" class="headerlink" title="åˆ›å»ºé’ˆå¯¹propså‰¯æœ¬çš„watchï¼Œé€šçŸ¥åˆ°ç»„ä»¶å¤–"></a>åˆ›å»ºé’ˆå¯¹propså‰¯æœ¬çš„watchï¼Œé€šçŸ¥åˆ°ç»„ä»¶å¤–</h3><p>æ­¤æ—¶åœ¨ç»„ä»¶å†…ä¿®æ”¹äº†propsçš„å‰¯æœ¬<code>myResult</code>ï¼Œç»„ä»¶å¤–ä¸çŸ¥é“ç»„ä»¶å†…çš„propsçŠ¶æ€ï¼Œæ‰€ä»¥éœ€è¦å†åˆ›å»ºä¸€ä¸ªé’ˆå¯¹propså‰¯æœ¬<code>myResult</code>ï¼Œå³å¯¹åº”dataå±æ€§çš„watchã€‚<br>åœ¨ç»„ä»¶å†…å‘å¤–å±‚ï¼ˆçˆ¶ç»„ä»¶ï¼‰å‘é€é€šçŸ¥ï¼Œé€šçŸ¥ç»„ä»¶å†…å±æ€§å˜æ›´ï¼Œç„¶åç”±å¤–å±‚ï¼ˆçˆ¶ç»„ä»¶ï¼‰è‡ªå·±æ¥å˜æ›´ä»–çš„æ•°æ®</p>
<p><strong>æœ€ç»ˆå…¨éƒ¨ä»£ç ï¼š</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">switchbtn</span> <span class="attr">:result</span>=<span class="string">"result"</span> @<span class="attr">on-result-change</span>=<span class="string">"onResultChange"</span>&gt;</span><span class="tag">&lt;/<span class="name">switchbtn</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"change"</span> @<span class="attr">click</span>=<span class="string">"change"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">"switchbtn"</span>, &#123;</span><br><span class="line">    template: <span class="string">"&lt;div @click='change'&gt;&#123;&#123;myResult?'å¼€':'å…³'&#125;&#125;&lt;/div&gt;"</span>,</span><br><span class="line">    props: [<span class="string">"result"</span>],</span><br><span class="line">    data: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            myResult: <span class="keyword">this</span>.result<span class="comment">//â‘ åˆ›å»ºpropså±æ€§resultçš„å‰¯æœ¬--myResult</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">        result(val) &#123;</span><br><span class="line">            <span class="keyword">this</span>.myResult = val;<span class="comment">//â‘¡ç›‘å¬å¤–éƒ¨å¯¹propså±æ€§resultçš„å˜æ›´ï¼Œå¹¶åŒæ­¥åˆ°ç»„ä»¶å†…çš„dataå±æ€§myResultä¸­</span></span><br><span class="line">        &#125;,</span><br><span class="line">        myResult(val)&#123;</span><br><span class="line">            <span class="comment">//xxcanghai å°å°æ²§æµ· åšå®¢å›­</span></span><br><span class="line">            <span class="keyword">this</span>.$emit(<span class="string">"on-result-change"</span>,val);<span class="comment">//â‘¢ç»„ä»¶å†…å¯¹myResultå˜æ›´åå‘å¤–éƒ¨å‘é€äº‹ä»¶é€šçŸ¥</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        change() &#123;</span><br><span class="line">            <span class="keyword">this</span>.myResult = !<span class="keyword">this</span>.myResult;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">"#app"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        result: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        change() &#123;</span><br><span class="line">            <span class="keyword">this</span>.result = !<span class="keyword">this</span>.result;</span><br><span class="line">        &#125;,</span><br><span class="line">        onResultChange(val)&#123;</span><br><span class="line">            <span class="keyword">this</span>.result=val;<span class="comment">//â‘£å¤–å±‚è°ƒç”¨ç»„ä»¶æ–¹æ³¨å†Œå˜æ›´æ–¹æ³•ï¼Œå°†ç»„ä»¶å†…çš„æ•°æ®å˜æ›´ï¼ŒåŒæ­¥åˆ°ç»„ä»¶å¤–çš„æ•°æ®çŠ¶æ€ä¸­</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>è‡³æ­¤ï¼Œå®ç°äº†ç»„ä»¶å†…æ•°æ®ä¸ç»„ä»¶å¤–çš„æ•°æ®çš„<strong>åŒå‘ç»‘å®š</strong>ï¼Œç»„ä»¶å†…å¤–æ•°æ®çš„åŒæ­¥ã€‚æœ€åå½’ç»“ä¸ºä¸€å¥è¯å°±æ˜¯ï¼šç»„ä»¶å†…éƒ¨è‡ªå·±å˜äº†å‘Šè¯‰å¤–éƒ¨ï¼Œå¤–éƒ¨å†³å®šè¦ä¸è¦å˜ã€‚</p>
<p><img src="/images/vue/vue-14.jpg" alt=""></p>
<h3 id="ä»€ä¹ˆæ ·çš„propsé€‚åˆåšåŒå‘ç»‘å®šï¼Ÿ"><a href="#ä»€ä¹ˆæ ·çš„propsé€‚åˆåšåŒå‘ç»‘å®šï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ ·çš„propsé€‚åˆåšåŒå‘ç»‘å®šï¼Ÿ"></a>ä»€ä¹ˆæ ·çš„propsé€‚åˆåšåŒå‘ç»‘å®šï¼Ÿ</h3><p>é¦–å…ˆè¦å£°æ˜çš„æ˜¯åŒå‘ç»‘å®šçš„propsè‚¯å®šæ˜¯ä¸åˆ©äºç»„ä»¶é—´çš„æ•°æ®çŠ¶æ€ç®¡ç†ï¼Œå°¤å…¶æ˜¯åœ¨å¤æ‚çš„ä¸šåŠ¡ä¸­æ›´æ˜¯å¦‚æ­¤ï¼Œæ‰€ä»¥è¦å°½å¯èƒ½çš„å°‘ç”¨åŒå‘ç»‘å®šï¼Œè¿‡äºå¤æ‚çš„æ•°æ®å¤„ç†å»ºè®®ä½¿ç”¨Vuex ï¼ˆ<a href="http://vuex.vuejs.org/zh-cn/intro.html" target="_blank" rel="noopener">http://vuex.vuejs.org/zh-cn/intro.html</a>ï¼‰</p>
<p>ä½†æ˜¯åœ¨æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨è¿‡ç¨‹ä¸­åˆç¡®å®æœ‰propsåŒå‘ç»‘å®šçš„éœ€æ±‚ï¼Œä¸ªäººè®¤ä¸ºåªæœ‰åœ¨æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶å†ä½¿ç”¨åŒå‘ç»‘å®šçš„propsã€‚</p>
<ol>
<li><p>ç»„ä»¶å†…éƒ¨éœ€è¦ä¿®æ”¹propsã€‚</p>
</li>
<li><p>ç»„ä»¶éœ€è¦å¯ä»¥ç”±å¤–éƒ¨åœ¨è¿è¡Œæ—¶åŠ¨æ€æ§åˆ¶ï¼Œè€Œéå•çº¯åˆå§‹åŒ–ã€‚</p>
</li>
<li><p>ç»„ä»¶å¤–éƒ¨éœ€è¦è¯»å–ç»„ä»¶å†…çš„çŠ¶æ€æ¥è¿›è¡Œå¤„ç†</p>
</li>
</ol>
<p>æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„æœ‰æ¯”å¦‚æœ¬ä¾‹ä¸­çš„switchå¼€å…³ç»„ä»¶ï¼Œéœ€è¦å¤–éƒ¨æ§åˆ¶å¼€å…³çŠ¶æ€ï¼›å†æ¯”å¦‚Tabå¤šæ ‡ç­¾é¡µç»„ä»¶çš„activeIndexå±æ€§ï¼Œéœ€è¦å¯ä»¥ç”±å¤–éƒ¨æ§åˆ¶æ ‡ç­¾é¡µå½“å‰æ‰“å¼€å“ªä¸€é¡µç­‰ç­‰ã€‚</p>
<h2 id="è‡ªåŠ¨åŒ–çš„propsåŒå‘ç»‘å®šå¤„ç†"><a href="#è‡ªåŠ¨åŒ–çš„propsåŒå‘ç»‘å®šå¤„ç†" class="headerlink" title="è‡ªåŠ¨åŒ–çš„propsåŒå‘ç»‘å®šå¤„ç†"></a>è‡ªåŠ¨åŒ–çš„propsåŒå‘ç»‘å®šå¤„ç†</h2><h3 id="Vueçš„mixinç»„ä»¶â€”â€”propsync"><a href="#Vueçš„mixinç»„ä»¶â€”â€”propsync" class="headerlink" title="Vueçš„mixinç»„ä»¶â€”â€”propsync"></a>Vueçš„mixinç»„ä»¶â€”â€”propsync</h3><p>é€šè¿‡ä¸Šä¾‹ä¹Ÿå¯ä»¥çœ‹å‡ºåœ¨Vue2.0ä¸­å®ç°propsçš„åŒå‘ç»‘å®šå¾ˆéº»çƒ¦ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªpropséœ€è¦åšåŒå‘ç»‘å®šä¸Šé¢çš„ä»£ç å°±è¦å®ç°ä¸¤éï¼Œä»£ç æå…¶å†—ä½™ã€‚æ‰€ä»¥æˆ‘å†™äº†ä¸€ä¸ªmixinæ¥è‡ªåŠ¨åŒ–å¤„ç†propsçš„åŒå‘ç»‘å®šçš„éœ€æ±‚â€”â€”<code>propsync</code>ã€‚</p>
<h3 id="ä¸»è¦åŠŸèƒ½"><a href="#ä¸»è¦åŠŸèƒ½" class="headerlink" title="ä¸»è¦åŠŸèƒ½"></a>ä¸»è¦åŠŸèƒ½</h3><ol>
<li><p>å®ç°äº†åœ¨ç»„ä»¶å†…è‡ªåŠ¨åˆ›å»ºæ‰€æœ‰propå¯¹åº”çš„dataå±æ€§ï¼Œæ–¹ä¾¿ç»„ä»¶å†…ä¿®æ”¹propä½¿ç”¨ã€‚è§£å†³äº†vue2.0ä¸­ä¸å…è®¸ç»„ä»¶å†…ç›´æ¥ä¿®æ”¹propçš„è®¾è®¡ã€‚</p>
</li>
<li><p>å®ç°äº†ç»„ä»¶å¤–ä¿®æ”¹ç»„ä»¶propï¼Œç»„ä»¶å†…è‡ªåŠ¨åŒæ­¥ä¿®æ”¹åˆ°dataå±æ€§ã€‚</p>
</li>
<li><p>å®ç°äº†ç»„ä»¶å†…ä¿®æ”¹äº†dataå±æ€§ï¼ˆç”±propåˆ›å»ºçš„ï¼‰ï¼Œè‡ªåŠ¨å‘ç»„ä»¶å¤–å‘å‡ºäº‹ä»¶é€šçŸ¥æœ‰å†…éƒ¨propä¿®æ”¹ã€‚ç”±ç»„ä»¶å¤–å†³å®šæ˜¯å¦è¦å°†ä¿®æ”¹åŒæ­¥åˆ°ç»„ä»¶å¤–</p>
</li>
</ol>
<h3 id="propsyncçš„ä½¿ç”¨æ–¹æ³•"><a href="#propsyncçš„ä½¿ç”¨æ–¹æ³•" class="headerlink" title="propsyncçš„ä½¿ç”¨æ–¹æ³•"></a>propsyncçš„ä½¿ç”¨æ–¹æ³•</h3><h4 id="ç¼–å†™ç»„ä»¶"><a href="#ç¼–å†™ç»„ä»¶" class="headerlink" title="ç¼–å†™ç»„ä»¶"></a>ç¼–å†™ç»„ä»¶</h4><ol>
<li><p>å¯¹äºç¼–å†™ç»„ä»¶æ—¶ï¼Œå¦‚æœéœ€è¦propsåŒå‘ç»‘å®šï¼Œåˆ™ç›´æ¥å¼•å…¥mixinï¼Œå¹¶åœ¨é…ç½®ä¸­å£°æ˜mixinå³å¯ï¼š <code>mixins: [propsync]</code></p>
</li>
<li><p>æ­¤mixinä¼šæ ¹æ®propçš„åç§°ç”Ÿæˆå¯¹åº”çš„dataå±æ€§åï¼Œé»˜è®¤ä¸ºåœ¨propå±æ€§åå‰é¢å¢åŠ â€p_â€ï¼Œå³è‹¥propä¸­æœ‰å­—æ®µåä¸º<code>active</code>ï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆåä¸º<code>p_active</code>çš„dataå­—æ®µï¼ˆpropsåˆ°dataçš„åç§°å˜æ›´æ–¹æ³•å¯è‡ªè¡Œä¿®æ”¹ï¼Œè¯¦è§propsyncæºç å¼€å¤´é…ç½®ï¼‰</p>
</li>
<li><p>propsyncé»˜è®¤ä¼šå°†æ‰€æœ‰propsåˆ›å»ºåŒå‘ç»‘å®šï¼Œå¯é€šè¿‡<code>propsync:false</code>æ¥å£°æ˜æ­¤propsä¸éœ€è¦åˆ›å»ºåŒå‘ç»‘å®šã€‚</p>
</li>
</ol>
<p>ä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> propsync <span class="keyword">from</span> <span class="string">'./mixins/propsync'</span>;<span class="comment">//å¼•å…¥mixinæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">"tab"</span>,</span><br><span class="line">  mixins: [propsync],<span class="comment">//å£°æ˜ä½¿ç”¨propsyncçš„mixin (https://cn.vuejs.org/v2/api/#mixins)</span></span><br><span class="line">  props: &#123;</span><br><span class="line">    active: &#123;</span><br><span class="line">      type: [<span class="built_in">String</span>, <span class="built_in">Number</span>],<span class="comment">//ä¼šè¢«propsyncè‡ªåŠ¨å®ç°åŒå‘ç»‘å®šï¼Œåœ¨dataä¸­åˆ›å»ºp_activeå˜é‡</span></span><br><span class="line">    &#125;,</span><br><span class="line">    width: &#123;</span><br><span class="line">      type: [<span class="built_in">Number</span>, <span class="built_in">String</span>],</span><br><span class="line">      propsync:<span class="literal">false</span><span class="comment">//ä¸ä¼šè¢«propsyncå®ç°åŒå‘ç»‘å®š</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    setActive(page, index, e) &#123;</span><br><span class="line">      <span class="keyword">this</span>.p_active = index;<span class="comment">//å¯ä»¥ç›´æ¥ä½¿ç”¨this.p_active</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="è°ƒç”¨ç»„ä»¶"><a href="#è°ƒç”¨ç»„ä»¶" class="headerlink" title="è°ƒç”¨ç»„ä»¶"></a>è°ƒç”¨ç»„ä»¶</h4><p>å¼•å…¥propsyncåï¼Œä¼šåœ¨å†…éƒ¨åŒå‘ç»‘å®šçš„dataå˜æ›´åè§¦å‘ä¸€ä¸ª<code>onPropsChange</code>äº‹ä»¶ã€‚é‚åœ¨è°ƒç”¨ç»„ä»¶å¤„ï¼Œå¢åŠ ä¸€ä¸ªäº‹ä»¶ç›‘å¬ onPropsChangeï¼ˆå¯ä¿®æ”¹ï¼‰ï¼Œå½“ç»„ä»¶å†…ä¿®æ”¹äº†propsæ—¶<code>propsync</code>ä¼šè§¦å‘æ­¤äº‹ä»¶ï¼Œè¿”å›å‚ä¸ä¾æ¬¡ä¸ºï¼š<strong>ä¿®æ”¹propåç§°ï¼Œä¿®æ”¹åå€¼ï¼Œä¿®æ”¹å‰å€¼</strong>ã€‚å¯ä»¥ç”±å½“å‰ç»„ä»¶è°ƒç”¨æ–¹ï¼ˆçˆ¶ç»„ä»¶ï¼‰æ¥å†³å®šæ˜¯å¦è¦å°†ç»„ä»¶å†…çš„å˜æ›´åŒæ­¥åˆ°è°ƒç”¨æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;tab :active=<span class="string">"active"</span> @onPropsChange=<span class="string">"change"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">tab</span>&gt;</span></span></span><br><span class="line">  </span><br><span class="line">......ç•¥</span><br><span class="line">&#123;</span><br><span class="line">  data:&#123;</span><br><span class="line">   active:<span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  methods:&#123;</span><br><span class="line">   change:<span class="function"><span class="keyword">function</span>(<span class="params">propName,newVal,oldVal</span>)</span>&#123;</span><br><span class="line">     <span class="keyword">this</span>[propName]=newVal;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">"ç»„ä»¶tabçš„"</span> +propName+ <span class="string">"å±æ€§å˜æ›´ä¸º"</span> +newVal);</span><br><span class="line">   &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Vueçš„mixinç»„ä»¶propsyncå·²ç»æ‰˜ç®¡è‡³Githubï¼š<a href="https://github.com/xxcanghai/cnblogsFiles/blob/master/vue-mixins/propsync.js" target="_blank" rel="noopener">https://github.com/xxcanghai/cnblogsFiles/blob/master/vue-mixins/propsync.js</a></p>
<p>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.cnblogs.com/xxcanghai/p/6124699.html" target="_blank" rel="noopener">http://www.cnblogs.com/xxcanghai/p/6124699.html</a></p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> vue </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[git diff]]></title>
      <url>https://lucius0.github.io/2017/02/23/archivers/git-diff/</url>
      <content type="html"><![CDATA[<h2 id="changeå´æœªstage"><a href="#changeå´æœªstage" class="headerlink" title="changeå´æœªstage"></a>changeå´æœªstage</h2><p>å¸¸è§çš„ä¸€ç§åšæ³•å°±æ˜¯ä½¿ç”¨<code>git diff</code>æ¥æŸ¥çœ‹å·¥ä½œç›®å½•è¿˜æœªstageçš„æ–‡ä»¶å·®å¼‚ã€‚</p>
<p><strong>å®éªŒæ–¹æ³•ï¼š</strong></p>
<ol>
<li><p>ä¿®æ”¹ä¸€ä¸‹simplegit.rbï¼Œæ·»åŠ ä¸€ä¸ªæ–¹æ³•</p>
</li>
<li><p>ç„¶ååœ¨READMEæ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªä½œè€…</p>
</li>
<li><p>ç„¶åæˆ‘ä»¬ç”¨<code>git add</code>å‘½ä»¤æŠŠREADMEæ–‡ä»¶è½½å…¥(stage)</p>
</li>
<li><p>è¿è¡Œ<code>git status</code>ä¼šæ˜¾ç¤ºREADMEè½½å…¥äº†ï¼Œè€Œsimplegit.rbåªæ˜¯ä¿®æ”¹äº†è¿˜æœªè½½å…¥</p>
</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ vim lib/simplegit.rb</span><br><span class="line">$ vim README</span><br><span class="line">$ git add README</span><br><span class="line">$ git status</span><br><span class="line"># On branch master</span><br><span class="line"># Changes to be committed:</span><br><span class="line">#   (use "git reset HEAD &lt;file&gt;..." to unstage)</span><br><span class="line">#</span><br><span class="line"># modified:   README</span><br><span class="line">#</span><br><span class="line"># Changed but not updated:</span><br><span class="line">#   (use "git add &lt;file&gt;..." to update what will be committed)</span><br><span class="line">#   (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span><br><span class="line">#</span><br><span class="line"># modified:   lib/simplegit.rb</span><br><span class="line">#</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆï¼Œæˆ‘ç°åœ¨æƒ³æŸ¥çœ‹ä¸€ä¸‹å¯¹simplegit.rbæ–‡ä»¶ç©¶ç«Ÿåšäº†ä»€ä¹ˆæ”¹åŠ¨ï¼Ÿåœ¨æˆ‘è½½å…¥ä¹‹å‰æ€ä¹ˆæŸ¥çœ‹è¿™äº›æ”¹åŠ¨çš„å†…å®¹å‘¢ï¼Ÿç­”æ¡ˆæ˜¯åªéœ€è¿è¡Œä¸å¸¦ä»»ä½•å‚æ•°çš„<code>git diff</code>å‘½ä»¤å³å¯ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ git diff</span><br><span class="line">diff --git a/lib/simplegit.rb b/lib/simplegit.rb</span><br><span class="line">index dd5ecc4.<span class="number">.8</span>ac6604 <span class="number">100644</span></span><br><span class="line">--- a/lib/simplegit.rb</span><br><span class="line">+++ b/lib/simplegit.rb</span><br><span class="line">@@ <span class="number">-25</span>,<span class="number">6</span> +<span class="number">25</span>,<span class="number">10</span> @@ <span class="class"><span class="keyword">class</span> <span class="title">SimpleGit</span></span></span><br><span class="line">     command("git log -n 25 #&#123;treeish&#125;")</span><br><span class="line">   end</span><br><span class="line">+  def log_single(branch = <span class="string">'master'</span>)</span><br><span class="line">+    command(<span class="string">"git log --pretty=oneline #&#123;branch&#125;"</span>)</span><br><span class="line">+  end</span><br><span class="line">+</span><br><span class="line">   def blame(path)</span><br><span class="line">     command(<span class="string">"git blame #&#123;path&#125;"</span>)</span><br><span class="line">   end</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å¯ä»¥çœ‹åˆ°æˆ‘æ·»åŠ åˆ°æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œç°åœ¨æˆ‘å¯ä»¥å†³å®šæ˜¯ä¸æ˜¯è¦å°†å…¶è½½å…¥äº†ã€‚æ³¨æ„ï¼ŒREADMEæ–‡ä»¶çš„ä¿®æ”¹å¹¶æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<h2 id="stageä½†æœªcommit"><a href="#stageä½†æœªcommit" class="headerlink" title="stageä½†æœªcommit"></a>stageä½†æœªcommit</h2><p>ä¸ºäº†æŸ¥çœ‹è½½å…¥ï¼ˆstagedï¼‰è€Œå¹¶æœªæäº¤ï¼ˆnot committedï¼‰çš„å†…å®¹å·®å¼‚ï¼Œå¯ä»¥ä½¿ç”¨<code>git diff --stage</code>å‘½ä»¤ï¼ˆåœ¨git 1.6ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨<code>--cached</code>ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git diff --staged</span><br><span class="line">diff --git a/README b/README</span><br><span class="line">index c526f88.<span class="number">.879</span>f0d4 <span class="number">100644</span></span><br><span class="line">--- a/README</span><br><span class="line">+++ b/README</span><br><span class="line">@@ <span class="number">-8</span>,<span class="number">3</span> +<span class="number">8</span>,<span class="number">4</span> @@ It is an example <span class="keyword">for</span> the Git Peepcode book that I<span class="string">'m currently writin</span></span><br><span class="line"><span class="string"> Author : Scott Chacon (schacon@gmail.com)</span></span><br><span class="line"><span class="string">          Orange Peel Chacon (opchacon@gmail.com)</span></span><br><span class="line"><span class="string">          Magnus O. Chacon (mchacon@gmail.com)</span></span><br><span class="line"><span class="string">+         Josephine Chacon (jo.chacon@gmail.com)</span></span><br></pre></td></tr></table></figure>
<p>é€‚åº”æƒ…å½¢ï¼šåœ¨è¿è¡Œ<code>git commitï¼ˆä¸å¸¦&#39;-a&#39;ï¼‰</code>ä¹‹å‰ï¼ŒæŸ¥çœ‹æ‰€æœ‰è½½å…¥è€Œæœªæäº¤çš„å˜æ›´å†…å®¹ã€‚</p>
<h2 id="æœ€åä¸€æ¬¡æäº¤ä¹‹åçš„æ‰€æœ‰å˜æ›´"><a href="#æœ€åä¸€æ¬¡æäº¤ä¹‹åçš„æ‰€æœ‰å˜æ›´" class="headerlink" title="æœ€åä¸€æ¬¡æäº¤ä¹‹åçš„æ‰€æœ‰å˜æ›´"></a>æœ€åä¸€æ¬¡æäº¤ä¹‹åçš„æ‰€æœ‰å˜æ›´</h2><p>ç°åœ¨ï¼Œå¦‚æœä½ æƒ³æŸ¥çœ‹æœ€åä¸€æ¬¡æäº¤ä¹‹åå·¥ä½œç›®å½•ä¸­æ–‡ä»¶çš„å˜æ›´ï¼Œä½ å¯ä»¥åœ¨<code>git diff</code>ä¹‹ååŠ ä¸€ä¸ªHEADæ¥è¿›è¡Œæ¯”å¯¹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ git diff HEAD</span><br><span class="line">diff --git a/README b/README</span><br><span class="line">index c526f88.<span class="number">.879</span>f0d4 <span class="number">100644</span></span><br><span class="line">--- a/README</span><br><span class="line">+++ b/README</span><br><span class="line">@@ <span class="number">-8</span>,<span class="number">3</span> +<span class="number">8</span>,<span class="number">4</span> @@ It is an example <span class="keyword">for</span> the Git Peepcode book that I<span class="string">'m currently writin</span></span><br><span class="line"><span class="string"> Author : Scott Chacon (schacon@gmail.com)</span></span><br><span class="line"><span class="string">          Orange Peel Chacon (opchacon@gmail.com)</span></span><br><span class="line"><span class="string">          Magnus O. Chacon (mchacon@gmail.com)</span></span><br><span class="line"><span class="string">+         Josephine Chacon (jo.chacon@gmail.com)</span></span><br><span class="line"><span class="string">diff --git a/lib/simplegit.rb b/lib/simplegit.rb</span></span><br><span class="line"><span class="string">index dd5ecc4..8ac6604 100644</span></span><br><span class="line"><span class="string">--- a/lib/simplegit.rb</span></span><br><span class="line"><span class="string">+++ b/lib/simplegit.rb</span></span><br><span class="line"><span class="string">@@ -25,6 +25,10 @@ class SimpleGit</span></span><br><span class="line"><span class="string">     command("git log -n 25 #&#123;treeish&#125;")</span></span><br><span class="line"><span class="string">   end</span></span><br><span class="line"><span class="string">+  def log_single(branch = '</span>master<span class="string">')</span></span><br><span class="line"><span class="string">+    command("git log --pretty=oneline #&#123;branch&#125;")</span></span><br><span class="line"><span class="string">+  end</span></span><br><span class="line"><span class="string">+</span></span><br><span class="line"><span class="string">   def blame(path)</span></span><br><span class="line"><span class="string">     command("git blame #&#123;path&#125;")</span></span><br><span class="line"><span class="string">   end</span></span><br></pre></td></tr></table></figure>
<p>é€‚ç”¨æƒ…å½¢ï¼šåœ¨è¿è¡Œ<code>git commit -a</code>ä¹‹å‰ã€‚æ˜¾ç¤ºæ‰€æœ‰è½½å…¥çš„å’Œæœªè½½å…¥çš„å˜æ›´ã€‚</p>
<h2 id="ä»ä¸€ä¸ªç‰¹å®šç‚¹å¼€å§‹æ–‡ä»¶çš„ä¿®æ”¹æƒ…å†µ"><a href="#ä»ä¸€ä¸ªç‰¹å®šç‚¹å¼€å§‹æ–‡ä»¶çš„ä¿®æ”¹æƒ…å†µ" class="headerlink" title="ä»ä¸€ä¸ªç‰¹å®šç‚¹å¼€å§‹æ–‡ä»¶çš„ä¿®æ”¹æƒ…å†µ"></a>ä»ä¸€ä¸ªç‰¹å®šç‚¹å¼€å§‹æ–‡ä»¶çš„ä¿®æ”¹æƒ…å†µ</h2><p>è¿™ä¹Ÿæ˜¯æœ€å¸¸è§çš„ä¸€ä¸ªé—®é¢˜ã€‚è­¬å¦‚ï¼Œå¦‚ä½•æŸ¥çœ‹åˆ›å»ºv1.6è¿™ä¸ªæ ‡ç­¾ä¹‹åREADMEæ–‡ä»¶æ‰€å‘ç”Ÿçš„ä¿®æ”¹å‘¢ï¼Œå¯ä»¥è¿™æ ·ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ git diff v1<span class="number">.6</span><span class="number">.0</span> -- README </span><br><span class="line">diff --git a/README b/README</span><br><span class="line">index <span class="number">548142</span>c.<span class="number">.5</span>fa41b7 <span class="number">100644</span></span><br><span class="line">--- a/README</span><br><span class="line">+++ b/README</span><br><span class="line">@@ <span class="number">-24</span>,<span class="number">7</span> +<span class="number">24</span>,<span class="number">7</span> @@ It was originally written by Linus Torvalds <span class="keyword">with</span> help <span class="keyword">of</span> a group o</span><br><span class="line"> hackers around the net. It is currently maintained by Junio C Hamano.</span><br><span class="line"> Please read the file INSTALL <span class="keyword">for</span> installation instructions.</span><br><span class="line">-See Documentation/tutorial.txt to get started, then see</span><br><span class="line">+See Documentation/gittutorial.txt to get started, then see</span><br><span class="line"> Documentation/everyday.txt <span class="keyword">for</span> a useful minimum set <span class="keyword">of</span> commands,</span><br><span class="line"> and <span class="string">"man git-commandname"</span> <span class="keyword">for</span> documentation <span class="keyword">of</span> each command.</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢å°±æ˜¾ç¤ºå‡ºäº†å·¥ä½œç›®å½•ä¸­READMEæ–‡ä»¶çš„ç‰ˆæœ¬å·®å¼‚â€“å¦‚æœä½ åšäº†æœ¬åœ°ä¿®æ”¹ï¼Œè½½å…¥æˆ–æœªè½½å…¥ï¼Œéƒ½ä¼šåœ¨è¿™æ¬¡æ¯”å¯¹ä¸­æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<h2 id="ä¸¤æ¬¡æäº¤çš„å·®å¼‚æ¯”å¯¹"><a href="#ä¸¤æ¬¡æäº¤çš„å·®å¼‚æ¯”å¯¹" class="headerlink" title="ä¸¤æ¬¡æäº¤çš„å·®å¼‚æ¯”å¯¹"></a>ä¸¤æ¬¡æäº¤çš„å·®å¼‚æ¯”å¯¹</h2><p>å¦‚æœä½ æƒ³å¯¹ä¸¤æ¬¡å¿«ç…§åšå·®å¼‚æ¯”å¯¹ï¼Œä¹Ÿå³é¡¹ç›®çš„ä¸¤ä¸ªç‰ˆæœ¬ä¹‹é—´æ¯”å¯¹â€“ç›´æ¥åœ¨<code>git diff</code>åè·Ÿä¸Šè¦æ¯”å¯¹çš„ä¸¤ä¸ªç‰ˆæœ¬å·å³å¯ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git diff v1<span class="number">.0</span> v1<span class="number">.1</span></span><br></pre></td></tr></table></figure>
<p>diffå‘½ä»¤åŠ è¿™æ ·çš„å‚æ•°ï¼Œæ˜¾ç¤ºæŸäº›ç»Ÿè®¡æ•°ï¼Œä¸‹é¢æ˜¯æ˜¾ç¤ºv1.6.1.1å’Œv1.6.1.2ä¸¤ä¸ªç‰ˆæœ¬ä¹‹é—´å·®å¼‚çš„ç»Ÿè®¡æ•°å­—ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ git diff v1<span class="number">.6</span><span class="number">.1</span><span class="number">.1</span> v1<span class="number">.6</span><span class="number">.1</span><span class="number">.2</span> --stat</span><br><span class="line"> Documentation/RelNotes<span class="number">-1.6</span><span class="number">.1</span><span class="number">.2</span>.txt |   <span class="number">39</span> +++++++++++++</span><br><span class="line"> Documentation/config.txt           |    <span class="number">4</span> +-</span><br><span class="line"> Documentation/git-ls-tree.txt      |    <span class="number">8</span> +++-</span><br><span class="line"> GIT-VERSION-GEN                    |    <span class="number">2</span> +-</span><br><span class="line"> RelNotes                           |    <span class="number">2</span> +-</span><br><span class="line"> builtin-commit.c                   |    <span class="number">6</span> ++</span><br><span class="line"> builtin-gc.c                       |    <span class="number">8</span> ++-</span><br><span class="line"> builtin-grep.c                     |   <span class="number">15</span> +++++-</span><br><span class="line"> builtin-log.c                      |   <span class="number">28</span> +++++++++-</span><br><span class="line"> builtin-ls-tree.c                  |    <span class="number">7</span> ++-</span><br><span class="line"> builtin-send-pack.c                |   <span class="number">43</span> +++++++--------</span><br><span class="line"> diffcore-rename.c                  |    <span class="number">9</span> +++-</span><br><span class="line"> git-sh-setup.sh                    |    <span class="number">2</span> +-</span><br><span class="line"> sha1_file.c                        |    <span class="number">3</span> +-</span><br><span class="line"> sha1_name.c                        |    <span class="number">2</span> +-</span><br><span class="line"> t/t2300-cd-to-toplevel.sh          |    <span class="number">4</span> +-</span><br><span class="line"> t/t4014-format-patch.sh            |   <span class="number">52</span> +++++++++++++++++-</span><br><span class="line"> t/t5519-push-alternates.sh         |  <span class="number">106</span> ++++++++++++++++++++++++++++++++++++</span><br><span class="line"> t/t7002-grep.sh                    |    <span class="number">7</span> +++</span><br><span class="line"> test-path-utils.c                  |    <span class="number">2</span> +-</span><br><span class="line"> <span class="number">20</span> files changed, <span class="number">306</span> insertions(+), <span class="number">43</span> deletions(-)</span><br></pre></td></tr></table></figure>
<p>è¿˜å¯ä»¥æ·±å…¥æŸ¥çœ‹æŸä¸ªå…·ä½“æ–‡ä»¶çš„å˜æ›´æ¯”å¯¹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ git diff v1<span class="number">.6</span><span class="number">.1</span><span class="number">.1</span> v1<span class="number">.6</span><span class="number">.1</span><span class="number">.2</span> -- sha1_file.c</span><br><span class="line">diff --git a/sha1_file.c b/sha1_file.c</span><br><span class="line">index <span class="number">52</span>d1ead..ce5ea12 <span class="number">100644</span></span><br><span class="line">--- a/sha1_file.c</span><br><span class="line">+++ b/sha1_file.c</span><br><span class="line">@@ <span class="number">-2337</span>,<span class="number">7</span> +<span class="number">2337</span>,<span class="number">8</span> @@ <span class="keyword">static</span> int create_tmpfile(char *buffer, size_t bufsiz, <span class="keyword">const</span> c</span><br><span class="line"> <span class="keyword">static</span> int write_loose_object(<span class="keyword">const</span> unsigned char *sha1, char *hdr, int hdrlen,</span><br><span class="line">                              <span class="keyword">void</span> *buf, unsigned long len, time_t mtime)</span><br><span class="line"> &#123;</span><br><span class="line">-       int fd, size, ret;</span><br><span class="line">+       int fd, ret;</span><br><span class="line">+       size_t size;</span><br><span class="line">        unsigned char *compressed;</span><br><span class="line">        z_stream stream;</span><br><span class="line">        char *filename;</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œä¹‹åä¼šæ˜¾ç¤ºsha1_file.cæ–‡ä»¶åœ¨v1.6.1.1å’Œv1.6.1.2ä¸¤ä¸ªç‰ˆæœ¬ä¹‹é—´çš„æ¯”å¯¹ç»“æœã€‚</p>
<h2 id="åœ¨åˆå¹¶æŸåˆ†æ”¯å‰æŸ¥çœ‹å˜æ›´å†…å®¹"><a href="#åœ¨åˆå¹¶æŸåˆ†æ”¯å‰æŸ¥çœ‹å˜æ›´å†…å®¹" class="headerlink" title="åœ¨åˆå¹¶æŸåˆ†æ”¯å‰æŸ¥çœ‹å˜æ›´å†…å®¹"></a>åœ¨åˆå¹¶æŸåˆ†æ”¯å‰æŸ¥çœ‹å˜æ›´å†…å®¹</h2><p>è¿™æ˜¯ä¸ªæ¯”è¾ƒå¥‡æ€ªçš„é—®é¢˜ï¼Œå› ä¸ºå¦‚æœä½ å¼€å§‹æ˜¯å·¥ä½œåœ¨ä¸€ä¸ªä¸»åˆ†æ”¯ä¸Šï¼Œè€Œåç”Ÿæˆäº†ä¸¤ä¸ªåˆ†æ”¯ï¼Œå¦‚æœç›´æ¥å¯¹æ¯”å¿«ç…§çš„è¯ï¼Œç»“æœåªä¼šæ˜¾ç¤ºä»ä¸€ä¸ªçŠ¶æ€åˆ°å¦ä¸€ä¸ªçŠ¶æ€çš„å·®å¼‚æ¯”å¯¹ç»“æœã€‚<br>ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ª<code>dev</code>çš„åˆ†æ”¯ï¼Œè¿›å…¥è¿™ä¸ªåˆ†æ”¯ç»™<code>lib/simplegit.rb</code>æ·»åŠ äº†ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åå›åˆ°äº†<code>master</code>åˆ†æ”¯ï¼Œåˆ é™¤äº†READMEæ–‡ä»¶çš„ä¸€è¡Œï¼Œç„¶åè¿è¡Œï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git diff master dev</span><br></pre></td></tr></table></figure>
<p>ç»“æœä¼šæ˜¾ç¤ºä½ ç»™æŸä¸ªæ–‡ä»¶ä¸­æ·»åŠ äº†æ–¹æ³•ï¼Œè¿˜å¾€READMEæ–‡ä»¶æ·»åŠ äº†ä¸€è¡Œå†…å®¹ã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿå› ä¸ºå¯¹<code>dev</code>åˆ†æ”¯æ¥è¯´ï¼ŒREADMEæ–‡ä»¶è¿˜æ˜¯åŸæ ·ï¼Œè€Œåœ¨â€™masterâ€™ä¸Šï¼Œä½ å·²ç»åˆ æ‰äº†ä¸€è¡Œï¼Œè¿™æ ·ç›´æ¥å¯¹ä¸¤ä¸ªå¿«ç…§è¿›è¡Œå¯¹æ¯”å°±å¥½ä¼¼â€™devâ€™åˆ†æ”¯æ·»åŠ äº†ä¸€è¡Œè¿›å»ä¸€æ ·ã€‚ä½ æƒ³æŸ¥çœ‹çš„å®é™…ä¸Šæ˜¯åœ¨åˆ›å»ºdevåˆ†æ”¯ä¹‹ååœ¨è¿™æ¡åˆ†æ”¯ä¸Šçš„å·®å¼‚å¯¹æ¯”ï¼Œæ‰€ä»¥åº”è¯¥æ‰§è¡Œè¿™æ ·çš„å‘½ä»¤ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git diff master...dev</span><br></pre></td></tr></table></figure>
<p>è¿™å°±ä¸ä¼šæ‹¿masteråˆ†æ”¯ä¸Šæœ€åä¸€ä¸ªå¿«ç…§å’Œdevåˆ†æ”¯ä¸Šæœ€åä¸€ä¸ªå¿«ç…§è¿›è¡Œæ¯”å¯¹â€“è€Œæ˜¯ç”¨devä¸masteræ‰€äº¤çš„é‚£ä¸ªåˆ†æ­§ç‚¹å’Œç°åœ¨çš„devåˆ†æ”¯ä¸Šæœ€åä¸€ä¸ªå¿«ç…§è¿›è¡Œæ¯”å¯¹ã€‚åœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™æ ·æ¯”å¯¹çš„ç»“æœæ˜¯æ˜¾ç¤ºå¯¹é‚£ä¸ªæ–‡ä»¶æ·»åŠ äº†ä¸€ä¸ªå‡½æ•°ã€‚å¦‚æœä½ ç›®å‰æ­£å¤„åœ¨masteråˆ†æ”¯ä¸Šï¼Œä½ å¯ä»¥è¿è¡Œï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git diff ...dev</span><br></pre></td></tr></table></figure>
<p>è·Ÿä¸Šé¢çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³æŸ¥çœ‹å°†è¦åˆå¹¶çš„æŸä¸ªåˆ†æ”¯ä¼šæœ‰ä»€ä¹ˆæ ·çš„å˜åŒ–ï¼Œå¯ä»¥æ‰§è¡Œï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git diff ...(branch)</span><br></pre></td></tr></table></figure>
<p>å°†branchæ›¿æ¢ä¸ºä½ æƒ³è¦åˆå¹¶çš„åˆ†æ”¯åå³å¯ã€‚</p>
]]></content>
      
        <categories>
            
            <category> tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vue.js 2.0 æºç å­¦ä¹ ]]></title>
      <url>https://lucius0.github.io/2017/01/20/archivers/code-review-for-vue/</url>
      <content type="html"><![CDATA[<h2 id="Vue2-0-ä»‹ç»"><a href="#Vue2-0-ä»‹ç»" class="headerlink" title="Vue2.0 ä»‹ç»"></a>Vue2.0 ä»‹ç»</h2><p>1.0ç‰ˆæœ¬æ­£å¼å‘å¸ƒåï¼Œå°±åœ¨ä¸šåŠ¡ä¸­å¼€å§‹ä½¿ç”¨ï¼Œå°†åŸå…ˆjQueryçš„åŠŸèƒ½é€æ­¥çš„è¿›è¡Œè¿ç§»ã€‚16å¹´10æœˆ1æ—¥ï¼ŒVue2.0ç‰ˆæœ¬æ­£å¼å‘å¸ƒäº†ï¼Œå…¶ä¸­æ ¸å¿ƒä»£ç éƒ½è¿›è¡Œäº†é‡å†™ï¼Œäºæ˜¯å°±ä¸“é—¨èŠ±æ—¶é—´ï¼Œå¯¹Vue2.0çš„æºç è¿›è¡Œäº†å­¦ä¹ ã€‚æœ¬ç¯‡æ–‡ç« å°±æ˜¯2.0æºç å­¦ä¹ çš„æ€»ç»“ã€‚</p>
<p>å…ˆå¯¹Vue2.0çš„æ–°ç‰¹æ€§åšä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼š</p>
<ul>
<li><p><strong>å¤§å° &amp; æ€§èƒ½</strong>ï¼šVue2.0çš„çº¿ä¸ŠåŒ…gzipååªæœ‰12kbï¼Œè€Œ1.0éœ€è¦22kbï¼Œreactéœ€è¦44kbã€‚è€Œä¸”Vue2.0çš„æ€§èƒ½åœ¨reactç­‰å‡ ä¸ªæ¡†æ¶ä¸­ï¼Œæ€§èƒ½æ˜¯æœ€å¿«çš„ã€‚</p>
</li>
<li><p><strong>VDOM</strong>ï¼šå®ç°äº†virtual domï¼Œå¹¶ä¸”å°†é™æ€å­æ ‘è¿›è¡Œäº†æå–ï¼Œå‡å°‘ç•Œé¢é‡ç»˜æ—¶çš„å¯¹æ¯”ã€‚ä¸1.0å¯¹æ¯”æ€§èƒ½æœ‰æ˜æ˜¾æå‡ã€‚</p>
</li>
<li><p><strong>Server Render</strong>ï¼š2.0è¿˜å¯¹Server Renderåšäº†æ”¯æŒã€‚</p>
</li>
</ul>
<p>Vueçš„æœ€æ–°æºç å¯ä»¥å»<a href="https://github.com/vuejs/vue" target="_blank" rel="noopener">https://github.com/vuejs/vue</a>è·å¾—ã€‚æœ¬æ–‡è®²çš„æ˜¯2.0.3ç‰ˆæœ¬ï¼Œ2.0.3å¯ä»¥å»<a href="https://github.com/vuejs/vue/tree/v2.0.3" target="_blank" rel="noopener">https://github.com/vuejs/vue/tree/v2.0.3</a>è¿™é‡Œè·å¾—ã€‚</p>
<p>ä¸‹é¢å¼€å§‹è¿›å…¥æ­£é¢˜ï¼Œé¦–å…ˆä»ç”Ÿå‘½å‘¨æœŸå¼€å§‹ã€‚</p>
<h2 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h2><p><img src="/images/vue/vue-07.png" alt=""></p>
<p>ä¸Šå›¾å°±æ˜¯å®˜æ–¹ç»™å‡ºçš„Vue 2.0çš„ç”Ÿå‘½å‘¨æœŸå›¾ï¼Œå…¶ä¸­åŒ…å«äº†Vueå¯¹è±¡ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹ä¸­çš„å‡ ä¸ªæ ¸å¿ƒæ­¥éª¤ã€‚äº†è§£è¿™å‡ ä¸ªè¿‡ç¨‹ï¼Œå¯ä»¥å¾ˆå¥½å¸®åŠ©æˆ‘ä»¬ç†è§£Vueçš„åˆ›å»ºä¸é”€æ¯è¿‡ç¨‹ã€‚ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œç”Ÿå‘½å‘¨æœŸåˆ†ä¸º4ä¸ªå‘¨æœŸï¼š</p>
<ul>
<li><p><strong>create</strong>ï¼š<code>new Vue</code>æ—¶ï¼Œä¼šå…ˆè¿›è¡Œcreateï¼Œåˆ›å»ºå‡ºVueå¯¹è±¡ã€‚</p>
</li>
<li><p><strong>mount</strong>ï¼šæ ¹æ®<code>elï¼Œtemplateï¼Œrender</code>æ–¹æ³•ç­‰å±æ€§ï¼Œä¼šç”ŸæˆDOMï¼Œå¹¶æ·»åŠ åˆ°å¯¹åº”ä½ç½®ã€‚</p>
</li>
<li><p><strong>update</strong>ï¼šå½“æ•°æ®å‘ç”Ÿå˜åŒ–åï¼Œä¼šé‡æ–°æ¸²æŸ“DOMï¼Œå¹¶è¿›è¡Œæ›¿æ¢ã€‚</p>
</li>
<li><p><strong>destroy</strong>ï¼šé”€æ¯æ—¶è§¦å‘ã€‚</p>
</li>
</ul>
<p>é‚£ä¹ˆè¿™4ä¸ªè¿‡ç¨‹åœ¨æºç ä¸­æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿæˆ‘ä»¬ä»<code>new Vue</code>ä¸­å¼€å§‹ã€‚</p>
<h2 id="new-Vue"><a href="#new-Vue" class="headerlink" title="new Vue"></a>new Vue</h2><p>ä¸ºäº†æ›´å¥½çš„ç†è§£newçš„è¿‡ç¨‹ï¼Œæˆ‘æ•´ç†äº†ä¸€ä¸ªåºåˆ—å›¾ï¼š</p>
<p><img src="/images/vue/vue-08.jpg" alt=""></p>
<p>new Vueçš„è¿‡ç¨‹ä¸»è¦æ¶‰åŠåˆ°ä¸‰ä¸ªå¯¹è±¡ï¼š<code>vmã€compilerã€watcher</code>ã€‚å…¶ä¸­ï¼Œ<code>vm</code>è¡¨ç¤º<code>Vue</code>çš„å…·ä½“å¯¹è±¡ï¼›<code>compiler</code>è´Ÿè´£å°†<code>template</code>è§£æä¸º<code>AST render</code>æ–¹æ³•ï¼›<code>watcher</code>ç”¨äºè§‚å¯Ÿæ•°æ®å˜åŒ–ï¼Œä»¥å®ç°æ•°æ®å˜åŒ–åè¿›è¡Œ<code>re-render</code>ã€‚</p>
<p>ä¸‹é¢æ¥åˆ†æä¸‹å…·ä½“è¿‡ç¨‹å’Œä»£ç ï¼š</p>
<p>é¦–å…ˆï¼Œè¿è¡Œ<code>new Vue()</code>çš„æ—¶å€™ï¼Œä¼šè¿›å…¥ä»£ç <code>src/core/instance/index.js</code>çš„Vueæ„é€ å‡½æ•°ä¸­ï¼Œå¹¶æ‰§è¡Œ<code>this._init()</code>æ–¹æ³•ã€‚åœ¨<code>_init</code>ä¸­ï¼Œä¼šå¯¹å„ä¸ªåŠŸèƒ½è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶æ‰§è¡Œ<code>beforeCreate</code>å’Œ<code>created</code>ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">initLifecycle(vm)</span><br><span class="line">initEvents(vm)</span><br><span class="line">callHook(vm, <span class="string">'beforeCreate'</span>)</span><br><span class="line">initState(vm)</span><br><span class="line">callHook(vm, <span class="string">'created'</span>)</span><br><span class="line">initRender(vm)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™ä¸ªè¿‡ç¨‹æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼š<code>beforeCreate</code>å’Œ<code>create</code>ä¹‹é—´åªæœ‰<code>initState</code>ï¼Œå’Œå®˜æ–¹ç»™å‡ºçš„ç”Ÿå‘½å‘¨æœŸå¹¶ä¸å®Œå…¨ä¸€æ ·ã€‚è¿™é‡Œçš„<code>initState</code>æ˜¯ç”¨äºåˆå§‹åŒ–<code>dataï¼Œprops</code>ç­‰çš„ç›‘å¬çš„ã€‚</p>
</blockquote>
<p>åœ¨<code>init</code>çš„æœ€åï¼Œä¼šè¿è¡Œ<code>initRender</code>æ–¹æ³•ã€‚åœ¨è¯¥æ–¹æ³•ä¸­ï¼Œä¼šè¿è¡Œ<code>vm.$mount</code>æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (vm.$options.el) &#123;</span><br><span class="line">  vm.$mount(vm.$options.el)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™é‡Œçš„<code>vm.$mount</code>å¯ä»¥åœ¨ä¸šåŠ¡ä»£ç ä¸­è°ƒç”¨ï¼Œè¿™æ ·ï¼Œ<code>new</code> è¿‡ç¨‹å’Œ <code>mount</code> è¿‡ç¨‹å°±å¯ä»¥æ ¹æ®ä¸šåŠ¡æƒ…å†µè¿›è¡Œåˆ†ç¦»ã€‚</p>
</blockquote>
<p>è¿™é‡Œçš„<code>$mount</code>åœ¨<code>src/entries/web-runtime-with-compiler.js</code>ä¸­ï¼Œä¸»è¦é€»è¾‘æ˜¯æ ¹æ®<code>elï¼Œtemplateï¼Œrender</code>ä¸‰ä¸ªå±æ€§æ¥è·å¾—<code>AST render</code>æ–¹æ³•ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!options.render) &#123;   <span class="comment">// å¦‚æœæœ‰renderæ–¹æ³•ï¼Œç›´æ¥è¿è¡Œmount</span></span><br><span class="line">  <span class="keyword">let</span> template = options.template</span><br><span class="line">  <span class="keyword">if</span> (template) &#123;  <span class="comment">// å¦‚æœæœ‰templateï¼Œ è·å–templateå‚æ•°å¯¹äºçš„HTMLä½œä¸ºæ¨¡æ¿</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> template === <span class="string">'string'</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (template.charAt(<span class="number">0</span>) === <span class="string">'#'</span>) &#123;</span><br><span class="line">        template = idToTemplate(template)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (template.nodeType) &#123;</span><br><span class="line">      template = template.innerHTML</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">        warn(<span class="string">'invalid template option:'</span> + template, <span class="keyword">this</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (el) &#123;  <span class="comment">// å¦‚æœæ²¡æœ‰template, ä¸”å­˜åœ¨elï¼Œåˆ™è·å–elçš„outerHTMLä½œä¸ºæ¨¡æ¿</span></span><br><span class="line">    template = getOuterHTML(el)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (template) &#123; <span class="comment">// å¦‚æœè·å–åˆ°äº†æ¨¡æ¿ï¼Œåˆ™å°†æ¨¡æ¿è½¬åŒ–ä¸ºrenderæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">const</span> &#123; render, staticRenderFns &#125; = compileToFunctions(template, &#123;</span><br><span class="line">      warn,</span><br><span class="line">      shouldDecodeNewlines,</span><br><span class="line">      delimiters: options.delimiters</span><br><span class="line">    &#125;, <span class="keyword">this</span>)</span><br><span class="line">    options.render = render</span><br><span class="line">    options.staticRenderFns = staticRenderFns</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> mount.call(<span class="keyword">this</span>, el, hydrating)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™ä¸ªè¿‡ç¨‹æœ‰ä¸‰ç‚¹éœ€è¦æ³¨æ„ï¼š<br>1ã€compileæ—¶ï¼Œå°†æœ€å¤§çš„é™æ€å­æ ‘æå–å‡ºæ¥ä½œä¸ºå•ç‹¬çš„ASTæ¸²æŸ“æ–¹æ³•ï¼Œä»¥æå‡åé¢vNodeå¯¹æ¯”æ—¶çš„æ€§èƒ½ã€‚æ‰€ä»¥ï¼Œå½“å­˜åœ¨å¤šä¸ªè¿ç»­çš„é™æ€æ ‡ç­¾æ—¶ï¼Œå¯ä»¥åœ¨å¤–è¾¹æ·»åŠ ä¸€ä¸ªé™æ€çˆ¶èŠ‚ç‚¹ï¼Œè¿™æ ·ï¼ŒstaticRenderFnsæ•°ç›®å¯ä»¥å‡å°‘ï¼Œä»è€Œæå‡æ€§èƒ½ã€‚<br>2ã€Vue2.0 ä¸­çš„æ¨¡æ¿æœ‰ä¸‰ç§å¼•ç”¨æ–¹æ³•ï¼šelï¼Œtemplateï¼Œrender(JSX)ã€‚å…¶ä¸­ä¼˜å…ˆçº§æ˜¯render &gt; template &gt; elã€‚<br>3ã€elï¼Œtemplateä¸¤ç§å†™æ³•ï¼Œæœ€åéƒ½ä¼šé€šè¿‡compilerè½¬åŒ–ä¸ºrender(JSX)æ¥è¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç›´æ¥å†™æˆrender(JSX)çš„æ€§èƒ½æ˜¯æœ€ä½³çš„ã€‚å½“ç„¶ï¼Œå¦‚æœä½¿ç”¨äº†æ„å»ºå·¥å…·ï¼Œæœ€ç»ˆç”Ÿæˆçš„åŒ…å°±æ˜¯ä½¿ç”¨çš„render(JSX)ã€‚è¿™æ ·å­ï¼Œåœ¨æºç ä¸Šå°±å¯ä»¥ä¸ç”¨è¿‡å¤šè€ƒè™‘è¿™ä¸€å—çš„æ€§èƒ½äº†ï¼Œç›´æ¥ç”¨å¯ç»´æŠ¤æ€§æœ€å¥½çš„æ–¹å¼å°±è¡Œã€‚</p>
</blockquote>
<p>å°†æ¨¡æ¿è½¬åŒ–ä¸ºrenderï¼Œç”¨åˆ°äº†<code>compileToFunction</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æœ€åä¼šé€šè¿‡<code>src/compiler/index.js</code>æ–‡ä»¶ä¸­çš„<code>compile</code>æ–¹æ³•ï¼Œå°†æ¨¡æ¿è½¬åŒ–ä¸ºASTè¯­æ³•ç»“æ„çš„renderæ–¹æ³•ï¼Œå¹¶å¯¹é™æ€å­æ ‘è¿›è¡Œåˆ†ç¦»ã€‚</p>
<p>å®Œæˆ<code>render</code>æ–¹æ³•çš„ç”Ÿæˆåï¼Œä¼šè¿›å…¥<code>_mount(src/core/instance/lifecycle.js)</code>ä¸­è¿›è¡ŒDOMæ›´æ–°ã€‚è¯¥æ–¹æ³•çš„æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vm._watcher = <span class="keyword">new</span> Watcher(vm, () =&gt; &#123;</span><br><span class="line">  vm._update(vm._render(), hydrating)</span><br><span class="line">&#125;, noop)</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆä¼šnewä¸€ä¸ªwatcherå¯¹è±¡ï¼Œåœ¨watcherå¯¹è±¡åˆ›å»ºåï¼Œä¼šè¿è¡Œä¼ å…¥çš„æ–¹æ³•<code>vm._update(vm._render(), hydrating)</code> (watcherçš„é€»è¾‘åœ¨ä¸‹é¢çš„watcherå°èŠ‚ä¸­ç»†è®²)ã€‚å…¶ä¸­çš„<code>vm._render()</code>ä¸»è¦ä½œç”¨å°±æ˜¯è¿è¡Œå‰é¢çš„compileç”Ÿæˆçš„renderæ–¹æ³•ï¼Œå¹¶è¿”å›ä¸€ä¸ªvNodeå¯¹è±¡ã€‚è¿™é‡Œçš„vNodeå°±æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„DOMèŠ‚ç‚¹ã€‚</p>
<p>æ‹¿åˆ°vNodeåï¼Œä¼ å…¥ <code>vm._update()</code> æ–¹æ³•ï¼Œè¿›è¡ŒDOMæ›´æ–°ã€‚</p>
<h2 id="VDOM"><a href="#VDOM" class="headerlink" title="VDOM"></a>VDOM</h2><p>ä¸Šé¢å·²ç»è®²å®Œäº†<code>new Vue</code>è¿‡ç¨‹ä¸­çš„ä¸»è¦æ­¥éª¤ï¼Œå…¶ä¸­æ¶‰åŠåˆ°templateå¦‚ä½•è½¬åŒ–ä¸ºDOMçš„è¿‡ç¨‹ï¼Œè¿™é‡Œå•ç‹¬æ‹¿å‡ºæ¥è®²ä¸‹ã€‚å…ˆä¸Šåºåˆ—å›¾ï¼š</p>
<p><img src="/images/vue/vue-09.jpg" alt=""></p>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œä»templateåˆ°DOMï¼Œæœ‰ä¸‰ä¸ªè¿‡ç¨‹ï¼š</p>
<ul>
<li><p><strong>template -&gt; AST render</strong> (compilerè§£ætemplate)</p>
</li>
<li><p><strong>AST render -&gt; vNode</strong> (renderæ–¹æ³•è¿è¡Œ)</p>
</li>
<li><p><strong>vNode -&gt; DOM</strong> (vdom.patch)</p>
</li>
</ul>
<p>é¦–å…ˆtemplateåœ¨compilerä¸­è§£æä¸ºAST renderæ–¹æ³•çš„è¿‡ç¨‹ã€‚ä¸Šä¸€èŠ‚ä¸­æœ‰è¯´åˆ°ï¼Œ<code>initState</code>åï¼Œä¼šè°ƒç”¨<code>src/entries/web-runtime-with-compiler.js</code>ä¸­çš„<code>Vue.prototype.$mount</code>æ–¹æ³•ã€‚åœ¨<code>$mount</code>ä¸­ï¼Œä¼šè·å–templateï¼Œç„¶åè°ƒç”¨<code>src/platforms/web/compiler/index.js</code>çš„<code>compilerToFunction</code>æ–¹æ³•ã€‚åœ¨è¯¥æ–¹æ³•ä¸­ï¼Œä¼šè¿è¡Œcompileå°†templateè§£æä¸ºå¤šä¸ªrenderæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯AST renderã€‚è¿™é‡Œçš„compileåœ¨æ–‡ä»¶<code>src/compiler/index.js</code>ä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ast = parse(template.trim(), options)   <span class="comment">// è§£ætemplateä¸ºAST</span></span><br><span class="line">optimize(ast, options)  <span class="comment">// æå–static tree</span></span><br><span class="line"><span class="keyword">const</span> code = generate(ast, options)  <span class="comment">// ç”Ÿæˆrender æ–¹æ³•</span></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  ast,</span><br><span class="line">  render: code.render,</span><br><span class="line">  staticRenderFns: code.staticRenderFns</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºï¼Œcompileæ–¹æ³•å°±æ˜¯å°†templateä»¥ASTçš„æ–¹å¼è¿›è¡Œè§£æï¼Œå¹¶è½¬åŒ–ä¸ºrenderæ–¹æ³•è¿›è¡Œè¿”å›ã€‚</p>
<p>å†çœ‹ç¬¬äºŒä¸ªè¿‡ç¨‹ï¼ŒAST render -&gt; vNodeã€‚è¿™ä¸ªè¿‡ç¨‹å¾ˆç®€å•ï¼Œå°±æ˜¯å°†AST renderæ–¹æ³•è¿›è¡Œè¿è¡Œï¼Œè·å¾—è¿”å›çš„vNodeå¯¹è±¡ã€‚</p>
<p>æœ€åä¸€æ­¥ï¼ŒvNode -&gt; DOMã€‚è¯¥è¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨vNodeçš„å¯¹æ¯”ä»¥åŠDOMçš„æ·»åŠ ä¿®æ”¹æ“ä½œã€‚åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæœ‰è®²åˆ°<code>vm._update()</code>æ–¹æ³•ä¸­å¯¹DOMè¿›è¡Œæ›´æ–°ã€‚<code>_update</code>çš„ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/core/instance/lifecycle.js</span></span><br><span class="line"><span class="keyword">if</span> (!prevVnode) &#123;</span><br><span class="line">  <span class="comment">// Vue.prototype.__patch__ is injected in entry points</span></span><br><span class="line">  <span class="comment">// based on the rendering backend used.</span></span><br><span class="line">  vm.$el = vm.__patch__(vm.$el, vnode, hydrating)  <span class="comment">// é¦–æ¬¡æ·»åŠ </span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  vm.$el = vm.__patch__(prevVnode, vnode)  <span class="comment">// æ•°æ®å˜åŒ–åè§¦å‘çš„DOMæ›´æ–°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ— è®ºæ˜¯é¦–æ¬¡æ·»åŠ è¿˜æ˜¯åæœŸçš„updateï¼Œéƒ½æ˜¯é€šè¿‡<code>__patch__</code>æ¥æ›´æ–°çš„ã€‚è¿™é‡Œçš„<code>__patch__</code>æ ¸å¿ƒæ­¥éª¤æ˜¯åœ¨<code>src/core/vdom/patch.js</code>ä¸­çš„patchæ–¹æ³•è¿›è¡Œå®ç°ï¼Œæºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">patch</span> (<span class="params">oldVnode, vnode, hydrating, removeOnly</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!oldVnode) &#123;</span><br><span class="line">      ...</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      ...</span><br><span class="line">      <span class="keyword">if</span> (!isRealElement &amp;&amp; sameVnode(oldVnode, vnode)) &#123;</span><br><span class="line">        patchVnode(oldVnode, vnode, insertedVnodeQueue, removeOnly)  <span class="comment">// diffå¹¶æ›´æ–°DOMã€‚</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        elm = oldVnode.elm</span><br><span class="line">        parent = nodeOps.parentNode(elm)</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">if</span> (parent !== <span class="literal">null</span>) &#123;</span><br><span class="line">          nodeOps.insertBefore(parent, vnode.elm, nodeOps.nextSibling(elm))  <span class="comment">// æ·»åŠ elementåˆ°DOMã€‚</span></span><br><span class="line">          removeVnodes(parent, [oldVnode], <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆæ·»åŠ å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡<code>insertBefore</code>å°†è½¬æ¢å¥½çš„elementæ·»åŠ åˆ°DOMä¸­ã€‚å¦‚æœupdateï¼Œåˆ™ä¼šè°ƒåŠ¨<code>patchVNode()</code>ã€‚æœ€åæ¥çœ‹ä¸‹<code>patchVNode</code>çš„ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">patchVnode</span> (<span class="params">oldVnode, vnode, insertedVnodeQueue, removeOnly</span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">const</span> elm = vnode.elm = oldVnode.elm</span><br><span class="line">  <span class="keyword">const</span> oldCh = oldVnode.children</span><br><span class="line">  <span class="keyword">const</span> ch = vnode.children</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">if</span> (isUndef(vnode.text)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isDef(oldCh) &amp;&amp; isDef(ch)) &#123;  <span class="comment">// å½“éƒ½å­˜åœ¨æ—¶ï¼Œæ›´æ–°Children</span></span><br><span class="line">      <span class="keyword">if</span> (oldCh !== ch) updateChildren(elm, oldCh, ch, insertedVnodeQueue, removeOnly)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDef(ch)) &#123;  <span class="comment">// åªå­˜åœ¨æ–°èŠ‚ç‚¹æ—¶ï¼Œå³æ·»åŠ èŠ‚ç‚¹</span></span><br><span class="line">      <span class="keyword">if</span> (isDef(oldVnode.text)) nodeOps.setTextContent(elm, <span class="string">''</span>)</span><br><span class="line">      addVnodes(elm, <span class="literal">null</span>, ch, <span class="number">0</span>, ch.length - <span class="number">1</span>, insertedVnodeQueue)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDef(oldCh)) &#123;  <span class="comment">// åªå­˜åœ¨è€èŠ‚ç‚¹æ—¶ï¼Œå³åˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line">      removeVnodes(elm, oldCh, <span class="number">0</span>, oldCh.length - <span class="number">1</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDef(oldVnode.text)) &#123;  <span class="comment">// åˆ é™¤äº†textContent</span></span><br><span class="line">      nodeOps.setTextContent(elm, <span class="string">''</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (oldVnode.text !== vnode.text) &#123; <span class="comment">// ä¿®æ”¹äº†textContent</span></span><br><span class="line">    nodeOps.setTextContent(elm, vnode.text)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­æœ‰è°ƒç”¨äº†<code>updateChildren</code>æ¥æ›´æ–°å­èŠ‚ç‚¹ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateChildren</span> (<span class="params">parentElm, oldCh, newCh, insertedVnodeQueue, removeOnly</span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">while</span> (oldStartIdx &lt;= oldEndIdx &amp;&amp; newStartIdx &lt;= newEndIdx) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isUndef(oldStartVnode)) &#123;</span><br><span class="line">      oldStartVnode = oldCh[++oldStartIdx] <span class="comment">// Vnode has been moved left</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isUndef(oldEndVnode)) &#123;</span><br><span class="line">      oldEndVnode = oldCh[--oldEndIdx]</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldStartVnode, newStartVnode)) &#123;</span><br><span class="line">      patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue)</span><br><span class="line">      oldStartVnode = oldCh[++oldStartIdx]</span><br><span class="line">      newStartVnode = newCh[++newStartIdx]</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldEndVnode, newEndVnode)) &#123;</span><br><span class="line">      patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue)</span><br><span class="line">      oldEndVnode = oldCh[--oldEndIdx]</span><br><span class="line">      newEndVnode = newCh[--newEndIdx]</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldStartVnode, newEndVnode)) &#123; <span class="comment">// Vnode moved right</span></span><br><span class="line">      patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue)</span><br><span class="line">      canMove &amp;&amp; nodeOps.insertBefore(parentElm, oldStartVnode.elm, nodeOps.nextSibling(oldEndVnode.elm))</span><br><span class="line">      oldStartVnode = oldCh[++oldStartIdx]</span><br><span class="line">      newEndVnode = newCh[--newEndIdx]</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldEndVnode, newStartVnode)) &#123; <span class="comment">// Vnode moved left</span></span><br><span class="line">      patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue)</span><br><span class="line">      canMove &amp;&amp; nodeOps.insertBefore(parentElm, oldEndVnode.elm, oldStartVnode.elm)</span><br><span class="line">      oldEndVnode = oldCh[--oldEndIdx]</span><br><span class="line">      newStartVnode = newCh[++newStartIdx]</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      ...</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°<code>updateChildren</code>ä¸­ï¼Œåˆé€šè¿‡<code>patchVnode</code>æ¥æ›´æ–°å½“å‰èŠ‚ç‚¹ã€‚æ¢³ç†ä¸€ä¸‹ï¼Œ<code>patch</code>é€šè¿‡<code>patchVnode</code>æ¥æ›´æ–°æ ¹èŠ‚ç‚¹ï¼Œç„¶åé€šè¿‡<code>updateChildren</code>æ¥æ›´æ–°å­èŠ‚ç‚¹ï¼Œå…·ä½“å­èŠ‚ç‚¹ï¼Œåˆé€šè¿‡<code>patchVnode</code>æ¥æ›´æ–°ï¼Œé€šè¿‡ä¸€ä¸ªç±»ä¼¼äºé€’å½’çš„æ–¹å¼é€ä¸ªèŠ‚ç‚¹çš„å®Œæˆå¯¹æ¯”å’Œæ›´æ–°ã€‚</p>
<blockquote>
<p>Vue 2.0ä¸­å¦‚ä½•å»å®ç°VDOMçš„æ€è·¯æ˜¯å¦æ¸…æ™°ï¼Œé€šè¿‡4å±‚ç»“æ„ï¼Œå¾ˆå¥½çš„å®ç°äº†å¯ç»´æŠ¤æ€§ï¼Œä¹Ÿä¸ºå®ç°server renderï¼Œweexç­‰åŠŸèƒ½æä¾›äº†å¯èƒ½ã€‚æ‹¿server renderä¸¾ä¾‹ï¼Œåªéœ€è¦å°†æœ€å<code>vNode -&gt; DOM</code> æ”¹æˆ <code>vNode -&gt; String</code> æˆ– <code>vNode -&gt; Stream</code>ï¼Œå°±å¯ä»¥å®ç°server renderã€‚å‰©ä¸‹çš„compilerå’ŒVueæ ¸å¿ƒé€»è¾‘éƒ½ä¸éœ€è¦æ”¹ã€‚</p>
</blockquote>
<h2 id="Watcher"><a href="#Watcher" class="headerlink" title="Watcher"></a>Watcher</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“MVVMæ¡†æ¶çš„ç‰¹å¾å°±æ˜¯å½“æ•°æ®å‘ç”Ÿå˜åŒ–åï¼Œä¼šè‡ªåŠ¨æ›´æ–°å¯¹åº”çš„DOMèŠ‚ç‚¹ã€‚ä½¿ç”¨MVVMä¹‹åï¼Œä¸šåŠ¡ä»£ç ä¸­å°±å¯ä»¥å®Œæˆä¸å†™DOMæ“ä½œä»£ç ï¼Œä¸ä»…å¯ä»¥å°†ä¸šåŠ¡ä»£ç èšç„¦åœ¨ä¸šåŠ¡é€»è¾‘ä¸Šï¼Œè¿˜å¯ä»¥æä¾›ä¸šåŠ¡çš„å¯ç»´æŠ¤æ€§å’Œå¯æµ‹è¯•æ€§ã€‚é‚£ä¹ˆVue2.0ä¸­æ˜¯æ€ä¹ˆå®ç°å¯¹æ•°æ®å˜åŒ–çš„ç›‘å¬å‘¢ï¼Ÿç…§ä¾‹ï¼Œå…ˆçœ‹åºåˆ—å›¾ï¼š</p>
<p><img src="/images/vue/vue-10.jpg" alt=""></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ•´ä¸ªWatcherçš„è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªè¿‡ç¨‹ã€‚</p>
<ul>
<li><p>å¯¹stateè®¾ç½®setter/getter</p>
</li>
<li><p>å¯¹vmè®¾ç½®å¥½watcherï¼Œæ·»åŠ å¥½stateè§¦å‘setteræ—¶çš„æ’åºæ–¹æ³•</p>
</li>
<li><p>stateå˜åŒ–è§¦å‘æ‰§è¡Œ</p>
</li>
</ul>
<p>åœ¨å‰é¢æœ‰è¯´è¿‡ï¼Œåœ¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°<code>beforeCreate</code>å’Œ<code>created</code>ç›´æ¥ï¼Œä¼šè¿è¡Œæ–¹æ³•<code>initState()</code>ã€‚åœ¨<code>initState</code>ä¸­ï¼Œä¼šå¯¹propsï¼Œdataï¼Œcomputedç­‰å±æ€§æ·»åŠ <code>setter/getter</code>ã€‚æ‹¿dataä¸¾ä¾‹ï¼Œè®¾ç½®<code>setter/getter</code>çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initData</span> (<span class="params">vm: Component</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> data = vm.$options.data</span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">// proxy data on instance</span></span><br><span class="line">  <span class="keyword">const</span> keys = <span class="built_in">Object</span>.keys(data)</span><br><span class="line">  <span class="keyword">let</span> i = keys.length</span><br><span class="line">  <span class="keyword">while</span> (i--) &#123;</span><br><span class="line">    ...</span><br><span class="line">    proxy(vm, keys[i])   <span class="comment">// è®¾ç½®vm._dataä¸ºä»£ç†</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// observe data</span></span><br><span class="line">  observe(data)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡è°ƒç”¨<code>observe</code>æ–¹æ³•ï¼Œä¼šå¯¹dataæ·»åŠ å¥½è§‚å¯Ÿè€…ï¼Œæ ¸å¿ƒä»£ç ä¸ºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(obj, key, &#123;</span><br><span class="line">  enumerable: <span class="literal">true</span>,</span><br><span class="line">  configurable: <span class="literal">true</span>,</span><br><span class="line">  get: <span class="function"><span class="keyword">function</span> <span class="title">reactiveGetter</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> value = getter ? getter.call(obj) : val</span><br><span class="line">    <span class="keyword">if</span> (Dep.target) &#123;</span><br><span class="line">      dep.depend()  <span class="comment">// å¤„ç†å¥½ä¾èµ–watcher</span></span><br><span class="line">      ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">  &#125;,</span><br><span class="line">  set: <span class="function"><span class="keyword">function</span> <span class="title">reactiveSetter</span> (<span class="params">newVal</span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    childOb = observe(newVal)  <span class="comment">// å¯¹æ–°æ•°æ®é‡æ–°observe</span></span><br><span class="line">    dep.notify()  <span class="comment">// é€šçŸ¥åˆ°depè¿›è¡Œæ•°æ®æ›´æ–°</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ—¶å€™ï¼Œå¯¹dataçš„ç›‘å¬å·²ç»å®Œæˆã€‚å¯ä»¥çœ‹åˆ°ï¼Œå½“dataå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè¿è¡Œdep.notify()ã€‚åœ¨notifyæ–¹æ³•ä¸­ï¼Œä¼šå»è¿è¡Œwatcherçš„updateæ–¹æ³•ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">update () &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.lazy) &#123;</span><br><span class="line">    <span class="keyword">this</span>.dirty = <span class="literal">true</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.sync) &#123;</span><br><span class="line">    <span class="keyword">this</span>.run()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    queueWatcher(<span class="keyword">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">run () &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.active) &#123;</span><br><span class="line">    <span class="keyword">const</span> value = <span class="keyword">this</span>.get()</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>update</code> æ–¹æ³•ä¸­ï¼Œ<code>queueWatcher</code> æ–¹æ³•çš„ç›®çš„æ˜¯é€šè¿‡ <code>nextTicker</code> æ¥æ‰§è¡Œ <code>run</code> æ–¹æ³•ï¼Œå±äºæ”¯çº¿é€»è¾‘ï¼Œå°±ä¸åˆ†æäº†ï¼Œè¿™é‡Œç›´æ¥çœ‹ <code>run</code> çš„å®ç°ã€‚<code>run</code> æ–¹æ³•å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯ç®€å•çš„è°ƒç”¨ <code>get</code> æ–¹æ³•ï¼Œè€Œ <code>get</code> æ–¹æ³•ä¼šé€šè¿‡æ‰§è¡Œ <code>this.getter()</code> æ¥æ›´æ–°DOMã€‚</p>
<p>é‚£ä¹ˆ<code>this.getter</code>æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæœ¬æ–‡æœ€å¼€å§‹åˆ†æ<code>new Vue</code>è¿‡ç¨‹æ—¶ï¼Œæœ‰è®²åˆ°è¿è¡Œ<code>_mount</code>æ–¹æ³•æ—¶ï¼Œä¼šè¿è¡Œå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vm._watcher = <span class="keyword">new</span> Watcher(vm, () =&gt; &#123;</span><br><span class="line">  vm._update(vm._render(), hydrating)</span><br><span class="line">&#125;, noop)</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆ<code>this.getter</code>å°±æ˜¯è¿™é‡ŒWatcheræ–¹æ³•çš„ç¬¬äºŒå‚æ•°ã€‚æ¥çœ‹ä¸‹<code>new Watcher</code>çš„ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Watcher</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span> (</span><br><span class="line">    vm: Component,</span><br><span class="line">    expOrFn: string | Function,</span><br><span class="line">    cb: Function,</span><br><span class="line">    options?: Object = &#123;&#125;</span><br><span class="line">  ) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> expOrFn === <span class="string">'function'</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.getter = expOrFn</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.getter = parsePath(expOrFn)</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">this</span>.value = <span class="keyword">this</span>.lazy</span><br><span class="line">      ? <span class="literal">undefined</span></span><br><span class="line">      : <span class="keyword">this</span>.get()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºï¼Œåœ¨new Vueè¿‡ç¨‹ä¸­ï¼ŒWatcherä¼šåœ¨æ„é€ å®Œæˆåä¸»åŠ¨è°ƒç”¨this.get()æ¥è§¦å‘this.getter()æ–¹æ³•çš„è¿è¡Œï¼Œä»¥è¾¾åˆ°æ›´æ–°DOMèŠ‚ç‚¹ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼šé¦–å…ˆ_initæ—¶ï¼Œä¼šå¯¹Dataè®¾ç½®å¥½setteræ–¹æ³•ï¼Œsetteræ–¹æ³•ä¸­ä¼šè°ƒç”¨dep.notify()ï¼Œä»¥ä¾¿æ•°æ®å˜åŒ–æ—¶é€šçŸ¥DOMè¿›è¡Œæ›´æ–°ã€‚ç„¶ånew Watcheræ—¶ï¼Œä¼šæ›´æ–°DOMçš„æ–¹æ³•è¿›è¡Œè®¾ç½®ï¼Œä¹Ÿå°±æ˜¯Watcher.getteræ–¹æ³•ã€‚æœ€åï¼Œå½“Dataå‘ç”Ÿå˜åŒ–æ—¶å€™ï¼Œdep.notify()è¿è¡Œï¼Œè¿è¡Œåˆ°watcher.getter()æ—¶ï¼Œå°±ä¼šå»è¿è¡Œrenderå’Œupdateé€»è¾‘ï¼Œæœ€ç»ˆè¾¾åˆ°DOMæ›´æ–°çš„ç›®çš„ã€‚</p>
<h2 id="æ€»ç»“å’Œæ”¶è·"><a href="#æ€»ç»“å’Œæ”¶è·" class="headerlink" title="æ€»ç»“å’Œæ”¶è·"></a>æ€»ç»“å’Œæ”¶è·</h2><p>åˆšå¼€å§‹è§‰å¾—çœ‹æºç ï¼Œæ˜¯å› ä¸ºå¸Œæœ›èƒ½äº†è§£ä¸‹Vue 2.0çš„å®ç°ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½å¾—åˆ°ä¸€äº›ä»æ–‡æ¡£ä¸­æ— æ³•çŸ¥é“çš„ç»†èŠ‚ï¼Œç”¨äºæå‡è¿è¡Œæ•ˆç‡ã€‚æŠŠä¸»è¦æµç¨‹ç†æ¸…æ¥šåï¼Œçš„ç¡®äº†è§£åˆ°ä¸€äº›ï¼Œè¿™é‡Œåšä¸ªæ•´ç†ï¼š</p>
<ul>
<li><p>elå±æ€§ä¼ å…¥çš„å¦‚æœä¸æ˜¯elementï¼Œæœ€åä¼šé€šè¿‡<code>document.querySelector</code>æ¥è·å–çš„ï¼Œè¿™ä¸ªæ¥å£æ€§èƒ½è¾ƒå·®ï¼Œæ‰€ä»¥ï¼Œelä¼ å…¥ä¸€ä¸ªelementæ€§èƒ½ä¼šæ›´å¥½ã€‚</p>
</li>
<li><p><code>$mount</code>æ–¹æ³•ä¸­å¯¹htmlï¼Œbodyæ ‡ç­¾åšäº†è¿‡æ»¤ï¼Œè¿™ä¸¤ä¸ªä¸èƒ½ç”¨æ¥ä½œä¸ºæ¸²æŸ“çš„æ ¹èŠ‚ç‚¹ã€‚</p>
</li>
<li><p>æ¯ä¸€ä¸ªç»„ä»¶éƒ½ä¼šä»<code>_init</code>å¼€å§‹é‡æ–°è¿è¡Œï¼Œæ‰€ä»¥ï¼Œå½“å­˜åœ¨ä¸€ä¸ªé•¿åˆ—è¡¨æ—¶ï¼Œå°†å­èŠ‚ç‚¹ä½œä¸ºä¸€ä¸ªç»„ä»¶ï¼Œæ€§èƒ½ä¼šè¾ƒå·®ã€‚</p>
</li>
<li><p><code>*.vue</code>æ–‡ä»¶ä¼šåœ¨æ„å»ºæ—¶è½¬åŒ–ä¸ºrenderæ–¹æ³•ï¼Œè€Œrenderæ–¹æ³•çš„æ€§èƒ½æ¯”æŒ‡å®štemplateæ›´å¥½ã€‚æ‰€ä»¥ï¼Œæºç ä½¿ç”¨<code>*.vue</code>çš„æ–¹å¼ï¼Œæ€§èƒ½ä¼šæ›´å¥½ã€‚</p>
</li>
<li><p>å¦‚æœéœ€è¦è‡ªå®šä¹‰<code>delimiters</code>ï¼Œæ¯ä¸€ä¸ªç»„ä»¶éƒ½éœ€è¦å•ç‹¬æŒ‡å®šã€‚</p>
</li>
<li><p>å¦‚æœæ˜¯<code>*.vue</code>æ–‡ä»¶ï¼Œåˆ¶å®š<code>delimiters</code>æ˜¯å¤±æ•ˆçš„ï¼Œå› ä¸º<code>vue-loader</code>å¯¹<code>*.vue</code>æ–‡ä»¶è¿›è¡Œè§£ææ—¶ï¼Œå¹¶æ²¡æœ‰å°†<code>delimiters</code>ä¼ é€’åˆ°<code>compiler.compile()</code>ä¸­ã€‚</p>
</li>
</ul>
<p>è½¬è‡ªï¼š<a href="https://segmentfault.com/a/1190000007484936" target="_blank" rel="noopener">https://segmentfault.com/a/1190000007484936</a></p>
<h2 id="ç»“æ„å›¾"><a href="#ç»“æ„å›¾" class="headerlink" title="ç»“æ„å›¾"></a>ç»“æ„å›¾</h2><p>ä¸‹é¢æ˜¯å–è‡ª<a href="http://jiongks.name/blog/a-big-map-to-intro-vue-next/" target="_blank" rel="noopener">é€šè¿‡ä¸€å¼ å›¾èµ°è¿› Vue 2.0</a>çš„Vue2.0çš„ç»“æ„å›¾</p>
<p><img src="/images/vue/vue-11.jpg" alt=""></p>
<hr>
<p><strong>å‚è€ƒèµ„æ–™</strong></p>
<p><a href="http://www.cnblogs.com/dh-dh/p/5606596.html" target="_blank" rel="noopener">è¯¦è§£vueçš„æ•°æ®bindingåŸç†</a></p>
<p><a href="https://github.com/banama/aboutVue/blob/master/vue-event.md" target="_blank" rel="noopener">Vueçš„äº‹ä»¶è§£è¯»</a></p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> vue </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vue.js ç»„ä»¶]]></title>
      <url>https://lucius0.github.io/2017/01/10/archivers/vue-component/</url>
      <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>ç»„ä»¶ï¼ˆComponentï¼‰æ˜¯ Vue.js æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ã€‚ç»„ä»¶å¯ä»¥æ‰©å±• HTML å…ƒç´ ï¼Œå°è£…å¯é‡ç”¨çš„ä»£ç ã€‚åœ¨è¾ƒé«˜å±‚é¢ä¸Šï¼Œç»„ä»¶æ˜¯è‡ªå®šä¹‰å…ƒç´ ï¼Œ Vue.js çš„ç¼–è¯‘å™¨ä¸ºå®ƒæ·»åŠ ç‰¹æ®ŠåŠŸèƒ½ã€‚åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œç»„ä»¶ä¹Ÿå¯ä»¥æ˜¯åŸç”Ÿ HTML å…ƒç´ çš„å½¢å¼ï¼Œä»¥ is ç‰¹æ€§æ‰©å±•ã€‚</p>
<p><img src="/images/vue/vue-02.png" alt=""></p>
<h2 id="æ³¨å†Œ"><a href="#æ³¨å†Œ" class="headerlink" title="æ³¨å†Œ"></a>æ³¨å†Œ</h2><h3 id="å…¨å±€æ³¨å†Œ"><a href="#å…¨å±€æ³¨å†Œ" class="headerlink" title="å…¨å±€æ³¨å†Œ"></a>å…¨å±€æ³¨å†Œ</h3><p><code>Vue.component(tagName, options)</code></p>
<p>å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºç»„ä»¶æ„é€ å™¨</span></span><br><span class="line"><span class="keyword">var</span> myComponent = Vue.extend(&#123;</span><br><span class="line">	template: <span class="string">'#template'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œç»„ä»¶</span></span><br><span class="line">Vue.component(<span class="string">'my-component'</span>, myComponent)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨Vueå®ä¾‹ä½œç”¨èŒƒå›´å†…ä½¿ç”¨ç»„ä»¶</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="å±€éƒ¨æ³¨å†Œ"><a href="#å±€éƒ¨æ³¨å†Œ" class="headerlink" title="å±€éƒ¨æ³¨å†Œ"></a>å±€éƒ¨æ³¨å†Œ</h3><p>é€šè¿‡ä½¿ç”¨ç»„ä»¶å®ä¾‹é€‰é¡¹æ³¨å†Œï¼Œå¯ä»¥ä½¿ç»„ä»¶<strong>ä»…åœ¨å¦ä¸€ä¸ªå®ä¾‹/ç»„ä»¶çš„ä½œç”¨åŸŸ</strong>ä¸­å¯ç”¨ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Child = &#123;</span><br><span class="line">  template: <span class="string">'&lt;div&gt;A custom component!&lt;/div&gt;'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  components: &#123;</span><br><span class="line">    <span class="comment">// &lt;my-component&gt; å°†åªåœ¨çˆ¶æ¨¡æ¿å¯ç”¨</span></span><br><span class="line">    <span class="string">'my-component'</span>: Child</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="data"><a href="#data" class="headerlink" title="data"></a>data</h2><p>ç»„ä»¶çš„<code>data</code>å¿…é¡»æ˜¯<strong>å‡½æ•°</strong>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = &#123; <span class="attr">a</span> : <span class="number">1</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// wrong </span></span><br><span class="line"><span class="keyword">var</span> c1 = Vue.extend(&#123;</span><br><span class="line">	data: data</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// right</span></span><br><span class="line"><span class="keyword">var</span> c2 = Vue.extend(&#123;</span><br><span class="line">	data () &#123;</span><br><span class="line">		<span class="keyword">return</span> &#123; <span class="attr">a</span> : <span class="number">1</span>&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="ååŒå·¥ä½œ"><a href="#ååŒå·¥ä½œ" class="headerlink" title="ååŒå·¥ä½œ"></a>ååŒå·¥ä½œ</h2><p>åœ¨ Vue.js ä¸­ï¼Œçˆ¶å­ç»„ä»¶çš„å…³ç³»å¯ä»¥æ€»ç»“ä¸º props down, events up ã€‚çˆ¶ç»„ä»¶é€šè¿‡ props å‘ä¸‹ä¼ é€’æ•°æ®ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶é€šè¿‡ events ç»™çˆ¶ç»„ä»¶å‘é€æ¶ˆæ¯ã€‚</p>
<h3 id="props"><a href="#props" class="headerlink" title="props"></a>props</h3><p>ç»„ä»¶å®ä¾‹çš„ä½œç”¨åŸŸæ˜¯<strong>å­¤ç«‹</strong>çš„ï¼Œ<code>props</code>æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”±çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶ï¼Œåä¹‹åˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">'child'</span>, &#123;</span><br><span class="line">  <span class="comment">// å£°æ˜ props</span></span><br><span class="line">  props: [<span class="string">'message'</span>],</span><br><span class="line">  <span class="comment">// å°±åƒ data ä¸€æ ·ï¼Œprop å¯ä»¥ç”¨åœ¨æ¨¡æ¿å†…</span></span><br><span class="line">  <span class="comment">// åŒæ ·ä¹Ÿå¯ä»¥åœ¨ vm å®ä¾‹ä¸­åƒ â€œthis.messageâ€ è¿™æ ·ä½¿ç”¨</span></span><br><span class="line">  template: <span class="string">'&lt;span&gt;&#123;&#123; message &#125;&#125;&lt;/span&gt;'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;child message=<span class="string">"hello!"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">child</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>ç»“æœ</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„ï¼š</strong></p>
<p>1ã€htmlä¸åŒºåˆ†å¤§å°å†™ï¼Œ<code>prop</code>ä¼šä» camelCaseè½¬ä¸º kebab-case</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">'child'</span>, &#123;</span><br><span class="line">  <span class="comment">// camelCase in JavaScript</span></span><br><span class="line">  props: [<span class="string">'myMessage'</span>],</span><br><span class="line">  template: <span class="string">'&lt;span&gt;&#123;&#123; myMessage &#125;&#125;&lt;/span&gt;'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ===&gt;&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!-- kebab-<span class="keyword">case</span> <span class="keyword">in</span> HTML --&gt;</span><br><span class="line">&lt;child my-message=<span class="string">"hello!"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">child</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>2ã€åŠ¨æ€prop</p>
<p>å¯ä»¥ç”¨<code>v-bind</code>åŠ¨æ€ç»‘å®špropsçš„å€¼åˆ°çˆ¶ç»„ä»¶çš„æ•°æ®ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;input v-model=<span class="string">"parentMsg"</span>&gt;</span><br><span class="line">  &lt;br&gt;</span><br><span class="line">  &lt;child v-bind:my-message=<span class="string">"parentMsg"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">child</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
<p>3ã€å­—é¢é‡vsåŠ¨æ€è¯­æ³•</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- ä¼ é€’äº†ä¸€ä¸ªå­—ç¬¦ä¸²<span class="string">"1"</span> --&gt;</span><br><span class="line">&lt;comp some-prop=<span class="string">"1"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">comp</span>&gt;</span></span></span><br><span class="line">&lt;!-- ä¼ é€’å®é™…çš„æ•°å­— --&gt;</span><br><span class="line">&lt;comp v-bind:some-prop=<span class="string">"1"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">comp</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>4ã€æ”¹å˜ç»„ä»¶propå€¼</p>
<p>å®šä¹‰ä¸€ä¸ªå±€éƒ¨ data å±æ€§ï¼Œå¹¶å°† prop çš„åˆå§‹å€¼ä½œä¸ºå±€éƒ¨æ•°æ®çš„åˆå§‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">props: [<span class="string">'initialCounter'</span>],</span><br><span class="line">data: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">counter</span>: <span class="keyword">this</span>.initialCounter &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>prop ä½œä¸ºéœ€è¦è¢«è½¬å˜çš„åŸå§‹å€¼ä¼ å…¥ï¼Œå®šä¹‰ä¸€ä¸ª computed å±æ€§ï¼Œæ­¤å±æ€§ä» prop çš„å€¼è®¡ç®—å¾—å‡º</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">props: [<span class="string">'size'</span>],</span><br><span class="line">computed: &#123;</span><br><span class="line">  normalizedSize: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.size.trim().toLowerCase()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5ã€prop æ£€æµ‹</p>
<p>prop å¯ä»¥æ·»åŠ æ£€æµ‹æœºåˆ¶ï¼Œç›®å‰ type æœ‰<code>String</code>ã€<code>Number</code>ã€<code>Boolean</code>ã€<code>Function</code>ã€<code>Object</code>ã€<code>Array</code>ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ç±»å‹ï¼Œä½¿ç”¨<code>instanceof</code>æ£€æµ‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">'example'</span>, &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    <span class="comment">// åŸºç¡€ç±»å‹æ£€æµ‹ ï¼ˆ`null` æ„æ€æ˜¯ä»»ä½•ç±»å‹éƒ½å¯ä»¥ï¼‰</span></span><br><span class="line">    propA: <span class="built_in">Number</span>,</span><br><span class="line">    <span class="comment">// å¤šç§ç±»å‹</span></span><br><span class="line">    propB: [<span class="built_in">String</span>, <span class="built_in">Number</span>],</span><br><span class="line">    <span class="comment">// å¿…ä¼ ä¸”æ˜¯å­—ç¬¦ä¸²</span></span><br><span class="line">    propC: &#123;</span><br><span class="line">      type: <span class="built_in">String</span>,</span><br><span class="line">      required: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// æ•°å­—ï¼Œæœ‰é»˜è®¤å€¼</span></span><br><span class="line">    propD: &#123;</span><br><span class="line">      type: <span class="built_in">Number</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="number">100</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// æ•°ç»„ï¼å¯¹è±¡çš„é»˜è®¤å€¼åº”å½“ç”±ä¸€ä¸ªå·¥å‚å‡½æ•°è¿”å›</span></span><br><span class="line">    propE: &#123;</span><br><span class="line">      type: <span class="built_in">Object</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">message</span>: <span class="string">'hello'</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// è‡ªå®šä¹‰éªŒè¯å‡½æ•°</span></span><br><span class="line">    propF: &#123;</span><br><span class="line">      validator: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value &gt; <span class="number">10</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="è‡ªå®šä¹‰äº‹ä»¶"><a href="#è‡ªå®šä¹‰äº‹ä»¶" class="headerlink" title="è‡ªå®šä¹‰äº‹ä»¶"></a>è‡ªå®šä¹‰äº‹ä»¶</h3><p><code>$on(eventName)</code>ç›‘å¬äº‹ä»¶</p>
<p><code>$emit(eventName)</code>è§¦å‘äº‹ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"counter-event-example"</span>&gt;</span><br><span class="line">  &lt;p&gt;&#123;&#123; total &#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">  &lt;!-- ç›‘å¬äº‹ä»¶ï¼šincrementï¼Œç›‘å¬å‡½æ•°ï¼šincrementTotal --&gt;</span></span><br><span class="line"><span class="regexp">  &lt;button-counter v-on:increment="incrementTotal"&gt;&lt;/</span>button-counter&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Vue.component('button-counter', &#123;</span></span><br><span class="line"><span class="regexp">  template: '&lt;button v-on:click="increment"&gt;&#123;&#123; counter &#125;&#125;&lt;/</span>button&gt;<span class="string">',</span></span><br><span class="line"><span class="string">  data: function () &#123;</span></span><br><span class="line"><span class="string">    return &#123;</span></span><br><span class="line"><span class="string">      counter: 0</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  methods: &#123;</span></span><br><span class="line"><span class="string">    increment: function () &#123;</span></span><br><span class="line"><span class="string">      this.counter += 1</span></span><br><span class="line"><span class="string">      this.$emit('</span>increment<span class="string">') // æŠ›å‡ºäº‹ä»¶</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string">new Vue(&#123;</span></span><br><span class="line">  el: '#counter-event-example',</span><br><span class="line">  data: &#123;</span><br><span class="line">    total: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    incrementTotal: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.total += <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>è‹¥æƒ³ç»‘å®š<strong>åŸç”Ÿäº‹ä»¶</strong>ï¼Œå¯ä»¥ç”¨<code>.native</code>ä¿®é¥°<code>v-on</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-component v-on:click.native=<span class="string">"doTheThing"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h3 id="slot-å†…å®¹åˆ†å‘"><a href="#slot-å†…å®¹åˆ†å‘" class="headerlink" title="slot(å†…å®¹åˆ†å‘)"></a>slot(å†…å®¹åˆ†å‘)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;app&gt;</span><br><span class="line">  &lt;app-header&gt;<span class="xml"><span class="tag">&lt;/<span class="name">app-header</span>&gt;</span></span></span><br><span class="line">  &lt;app-footer&gt;&lt;/app-footer&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">app</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>1ã€<code>&lt;app&gt;</code> ç»„ä»¶ä¸çŸ¥é“å®ƒçš„æŒ‚è½½ç‚¹ä¼šæœ‰ä»€ä¹ˆå†…å®¹ã€‚æŒ‚è½½ç‚¹çš„å†…å®¹æ˜¯ç”±<code>&lt;app&gt;</code>çš„çˆ¶ç»„ä»¶å†³å®šçš„ã€‚</p>
<p>2ã€<code>&lt;app&gt;</code> ç»„ä»¶å¾ˆå¯èƒ½æœ‰å®ƒè‡ªå·±çš„æ¨¡ç‰ˆã€‚</p>
<p><strong>ç¼–è¯‘ä½œç”¨åŸŸ</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;child-component&gt;</span><br><span class="line">  &#123;&#123; message &#125;&#125; <span class="comment">// message çš„æ•°æ®æ˜¯ç»‘å®šåœ¨çˆ¶ç»„ä»¶è€Œéå­ç»„ä»¶</span></span><br><span class="line">&lt;<span class="regexp">/child-component&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;!-- æ— æ•ˆ --&gt;</span></span><br><span class="line"><span class="regexp">&lt;child-component v-show="someChildProperty"&gt;&lt;/</span>child-component&gt;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¾‹å­å‡ºç°æ— æ•ˆçš„åŸå› æ˜¯ï¼šå‡å®š <code>someChildProperty</code> æ˜¯å­ç»„ä»¶çš„å±æ€§ï¼Œä¸Šä¾‹ä¸ä¼šå¦‚é¢„æœŸé‚£æ ·å·¥ä½œã€‚çˆ¶ç»„ä»¶æ¨¡æ¿ä¸åº”è¯¥çŸ¥é“å­ç»„ä»¶çš„çŠ¶æ€ã€‚</p>
<p>å¦‚æœè¦ç»‘å®šå­ç»„ä»¶å†…çš„æŒ‡ä»¤åˆ°ä¸€ä¸ªç»„ä»¶çš„æ ¹èŠ‚ç‚¹ï¼Œåº”å½“åœ¨å®ƒçš„æ¨¡æ¿å†…è¿™ä¹ˆåšï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">'child-component'</span>, &#123;</span><br><span class="line">  <span class="comment">// æœ‰æ•ˆï¼Œå› ä¸ºæ˜¯åœ¨æ­£ç¡®çš„ä½œç”¨åŸŸå†…</span></span><br><span class="line">  template: <span class="string">'&lt;div v-show="someChildProperty"&gt;Child&lt;/div&gt;'</span>,</span><br><span class="line">  data: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      someChildProperty: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>slotç®€å•æ¥è¯´å°±åœ¨åŒ…è£…åœ¨å­ç»„ä»¶é‡Œçš„å…¶ä»–å…ƒç´ ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç»„ä»¶æ¨¡æ¿ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"header"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"footer"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- çˆ¶ç»„ä»¶æ¨¡æ¿ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app-layout</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">slot</span>=<span class="string">"header"</span>&gt;</span>è¿™é‡Œå¯èƒ½æ˜¯ä¸€ä¸ªé¡µé¢æ ‡é¢˜<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸»è¦å†…å®¹çš„ä¸€ä¸ªæ®µè½ã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>å¦ä¸€ä¸ªä¸»è¦æ®µè½ã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">slot</span>=<span class="string">"footer"</span>&gt;</span>è¿™é‡Œæœ‰ä¸€äº›è”ç³»ä¿¡æ¯<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">app-layout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ¸²æŸ“ç»“æœä¸ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>è¿™é‡Œå¯èƒ½æ˜¯ä¸€ä¸ªé¡µé¢æ ‡é¢˜<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸»è¦å†…å®¹çš„ä¸€ä¸ªæ®µè½ã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>å¦ä¸€ä¸ªä¸»è¦æ®µè½ã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>è¿™é‡Œæœ‰ä¸€äº›è”ç³»ä¿¡æ¯<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>åŠ¨æ€ç»„ä»¶</strong></p>
<p>ä½¿ç”¨ä¿ç•™çš„ <code>&lt;component&gt;</code> å…ƒç´ ï¼ŒåŠ¨æ€åœ°ç»‘å®šåˆ°å®ƒçš„ <code>is</code> ç‰¹æ€§ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#example'</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    currentView: <span class="string">'home'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    home: &#123; <span class="comment">/* ... */</span> &#125;,</span><br><span class="line">    posts: &#123; <span class="comment">/* ... */</span> &#125;,</span><br><span class="line">    archive: &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;component v-bind:is=<span class="string">"currentView"</span>&gt;</span><br><span class="line">  &lt;!-- ç»„ä»¶åœ¨ vm.currentview å˜åŒ–æ—¶æ”¹å˜ï¼ --&gt;</span><br><span class="line">&lt;<span class="regexp">/component&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>keep-alive</strong></p>
<p>åˆ‡æ¢å‡ºå»çš„ç»„ä»¶ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥ä¿ç•™å®ƒçš„çŠ¶æ€æˆ–é¿å…é‡æ–°æ¸²æŸ“ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;keep-alive&gt;</span><br><span class="line">  &lt;component :is=<span class="string">"currentView"</span>&gt;</span><br><span class="line">    &lt;!-- éæ´»åŠ¨ç»„ä»¶å°†è¢«ç¼“å­˜ï¼ --&gt;</span><br><span class="line">  &lt;<span class="regexp">/component&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>keep-alive&gt;</span><br></pre></td></tr></table></figure>
<p>å­¦ä¹ å‚è€ƒæ–‡ç« (v1.0)ï¼š</p>
<ul>
<li><p><a href="http://www.cnblogs.com/keepfool/p/5625583.html" target="_blank" rel="noopener">http://www.cnblogs.com/keepfool/p/5625583.html</a></p>
</li>
<li><p><a href="http://www.cnblogs.com/keepfool/p/5637834.html" target="_blank" rel="noopener">http://www.cnblogs.com/keepfool/p/5637834.html</a></p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> vue </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vue.js åˆä½“éªŒ]]></title>
      <url>https://lucius0.github.io/2017/01/08/archivers/vue-beginning/</url>
      <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Vue.js ä¸»è¦æ˜¯åˆ©ç”¨åˆ°ECMAScript 5çš„ç‰¹æ€§ï¼Œå› æ­¤IE 8ä»¥ä¸‹çš„æµè§ˆå™¨éƒ½ä¸æ”¯æŒï¼Œå¯ä»¥é€šè¿‡<a href="http://caniuse.com/#feat=es5" target="_blank" rel="noopener">caniuse</a>æ¥æŸ¥çœ‹æµè§ˆå™¨çš„æ”¯æŒæƒ…å†µã€‚</p>
<p><a href="http://doc.vue-js.com/v2/guide/index.html" target="_blank" rel="noopener">å®˜æ–¹</a>çš„ä»‹ç»æ˜¯ï¼š</p>
<p>Vue.jsï¼ˆè¯»éŸ³ /vjuË/, ç±»ä¼¼äº viewï¼‰ æ˜¯ä¸€å¥—æ„å»ºç”¨æˆ·ç•Œé¢çš„ æ¸è¿›å¼æ¡†æ¶ã€‚ä¸å…¶ä»–é‡é‡çº§æ¡†æ¶ä¸åŒçš„æ˜¯ï¼ŒVue é‡‡ç”¨è‡ªåº•å‘ä¸Šå¢é‡å¼€å‘çš„è®¾è®¡ã€‚Vue çš„æ ¸å¿ƒåº“åªå…³æ³¨è§†å›¾å±‚ï¼Œå¹¶ä¸”éå¸¸å®¹æ˜“å­¦ä¹ ï¼Œéå¸¸å®¹æ˜“ä¸å…¶å®ƒåº“æˆ–å·²æœ‰é¡¹ç›®æ•´åˆã€‚å¦ä¸€æ–¹é¢ï¼ŒVue å®Œå…¨æœ‰èƒ½åŠ›é©±åŠ¨é‡‡ç”¨<a href="http://doc.vue-js.com/v2/guide/single-file-components.html" target="_blank" rel="noopener">å•æ–‡ä»¶ç»„ä»¶</a>å’Œ<a href="http://github.com/vuejs/awesome-vue#libraries--plugins" target="_blank" rel="noopener">Vueç”Ÿæ€ç³»ç»Ÿæ”¯æŒçš„åº“</a>å¼€å‘çš„å¤æ‚å•é¡µåº”ç”¨ã€‚</p>
<p>Vue.js çš„ç›®æ ‡æ˜¯é€šè¿‡å°½å¯èƒ½ç®€å•çš„ API å®ç°å“åº”çš„æ•°æ®ç»‘å®šå’Œç»„åˆçš„è§†å›¾ç»„ä»¶ã€‚</p>
<p>å¦‚æœä½ æ˜¯æœ‰ç»éªŒçš„å‰ç«¯å¼€å‘è€…ï¼Œæƒ³çŸ¥é“ Vue.js ä¸å…¶å®ƒåº“/æ¡†æ¶çš„åŒºåˆ«ï¼ŒæŸ¥çœ‹<a href="http://doc.vue-js.com/v2/guide/comparison.html" target="_blank" rel="noopener">å¯¹æ¯”å…¶å®ƒæ¡†æ¶</a>ã€‚</p>
<p><img src="/images/vue/vue-01.jpeg" alt=""></p>
<p>å…¶ä¸­<code>view</code>å¯¹åº”å¦‚ä¸‹ç±»ä¼¼domä»£ç </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>model</code>åˆ™ä¸ºPOJOï¼Œ</p>
<p><code>var data = {msg: &#39;hello&#39;}</code></p>
<p>æ‰€ä»¥vue.jså……å½“çš„å°±æ˜¯vmï¼Œæ•°æ®å±‚ä»¥åŠè§†è§‰å±‚çš„æ¡¥æ¢</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">	el: <span class="string">'#app'</span>,</span><br><span class="line">	data: &#123;</span><br><span class="line">		msg: data.msg</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>ç»„ä»¶ç³»ç»Ÿ</strong></p>
<p><img src="/images/vue/vue-02.png" alt=""></p>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="ç›´æ¥å¼•å…¥"><a href="#ç›´æ¥å¼•å…¥" class="headerlink" title="ç›´æ¥å¼•å…¥"></a>ç›´æ¥å¼•å…¥</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dir</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">dir</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"scripts/vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">	el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">&#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="é€šè¿‡vue-cli"><a href="#é€šè¿‡vue-cli" class="headerlink" title="é€šè¿‡vue-cli"></a>é€šè¿‡vue-cli</h3><p>å…¨å±€å®‰è£…vue-cliå°±å¯ä»¥äº†</p>
<p><code>npm install --global vue-cli</code></p>
<p>è¯¦ç»†çš„å¯ä»¥<a href="http://doc.vue-js.com/v2/guide/installation.html" target="_blank" rel="noopener">æŸ¥çœ‹</a></p>
<h2 id="åŸºæœ¬å±æ€§åŠå…¶æ–¹æ³•"><a href="#åŸºæœ¬å±æ€§åŠå…¶æ–¹æ³•" class="headerlink" title="åŸºæœ¬å±æ€§åŠå…¶æ–¹æ³•"></a>åŸºæœ¬å±æ€§åŠå…¶æ–¹æ³•</h2><p>å¯ä»¥æŸ¥çœ‹<a href="http://doc.vue-js.com/v2/api/" target="_blank" rel="noopener">å®˜ç½‘çš„API</a>ï¼Œv1.0 è·Ÿ v2.0 æœ‰åŒºåˆ«ã€‚å»ºè®®å¥½å¥½ç ”ç©¶ä¸€ä¸‹ï¼Œåœ¨è¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚</p>
<p>é‚£ä¹ˆçˆ¶èŠ‚ç‚¹ï¼Œæˆ–è€…è¯´æ˜¯æ ¹ç»“ç‚¹çš„ç»“æ„æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">	el: <span class="string">'#app'</span>,</span><br><span class="line">	components: &#123;</span><br><span class="line">		<span class="string">'header-component'</span>: headerComponent,</span><br><span class="line">		<span class="string">'body-component'</span>: bodyComponent,</span><br><span class="line">		<span class="string">'footer-component'</span>: footerComponent</span><br><span class="line">	&#125;,</span><br><span class="line">	data: &#123;</span><br><span class="line">		...</span><br><span class="line">	&#125;,</span><br><span class="line">	methods: &#123;</span><br><span class="line">		...</span><br><span class="line">	&#125;,</span><br><span class="line">	beforeCreate () &#123;&#125;,</span><br><span class="line">	created () &#123;&#125;,</span><br><span class="line">	beforeMount () &#123;&#125;,</span><br><span class="line">	...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ç»„ä»¶çš„ç»„ç»‡ç»“æ„</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> component = Vue.extend(&#123;</span><br><span class="line">	template: <span class="string">'#component'</span>,</span><br><span class="line">	components: &#123;</span><br><span class="line">		<span class="string">'child-header-component'</span>: childHeaderComponent</span><br><span class="line">	&#125;,</span><br><span class="line">	props: &#123;&#125;,</span><br><span class="line">	events: &#123;&#125;,</span><br><span class="line">	methods: &#123;&#125;,</span><br><span class="line">	...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h2><p><img src="/images/vue/vue-03.png" alt=""></p>
<p>vueæ˜¯é€šè¿‡æ•°æ®åŠ«æŒçš„æ–¹å¼æ¥åšæ•°æ®ç»‘å®šçš„ï¼Œå…¶æ ¸å¿ƒæ–¹æ³•å°±æ˜¯é€šè¿‡<code>Object.defineProperty()</code>æ¥å®ç°å¯¹å±æ€§çš„åŠ«æŒã€‚å‰é¢æœ‰æåˆ°è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸èƒ½æ”¯æŒIE 8ä»¥ä¸‹çš„ç‰ˆæœ¬ã€‚è¦å®ç°mvvmï¼Œéœ€è¦å®ç°ä»¥ä¸‹çš„æ¡ä»¶ï¼š</p>
<ol>
<li><p>å®ç°ä¸€ä¸ªæ•°æ®ç›‘å¬å™¨Observerï¼Œèƒ½å¤Ÿå¯¹æ•°æ®å¯¹è±¡çš„æ‰€æœ‰å±æ€§è¿›è¡Œç›‘å¬ï¼Œå¦‚æœ‰å˜åŠ¨æ ¹æ®æ–°è€å€¼çš„å¯¹æ¯”è¿›è¡Œæ›´æ–°ï¼›</p>
</li>
<li><p>å®ç°ä¸€ä¸ªæŒ‡ä»¤è§£æå™¨Compileï¼Œå¯¹å…ƒç´ èŠ‚ç‚¹çš„æŒ‡ä»¤è¿›è¡Œéå†å¹¶ä¸”è§£æï¼Œæ ¹æ®æŒ‡ä»¤æ¥æ›¿æ¢æ•°æ®ï¼Œå¹¶ä¸”æ›´æ–°å‡½æ•°ï¼›</p>
</li>
<li><p>å®ç°ä¸€ä¸ªwatcherï¼Œä½œä¸ºObserverä»¥åŠCompileçš„æ¡¥æ¢ï¼Œèƒ½å¤Ÿè®¢é˜…å¹¶ä¸”æ¥æ”¶å±æ€§å˜åŠ¨çš„é€šçŸ¥ï¼Œæ‰§è¡ŒæŒ‡ä»¤ç»‘å®šç›¸å¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œä»è€Œåˆ·æ–°è§†å›¾ï¼›</p>
</li>
<li><p>å®ç°mvvmå…¥å£ï¼Œç»„ç»‡ä¸Šé¢çš„ä¸‰ä¸ªæ¨¡å—ã€‚</p>
</li>
</ol>
<p><img src="/images/vue/vue-04.jpeg" alt=""></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;</span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  data: data</span><br><span class="line">&#125;)</span><br><span class="line">vm.a === data.a <span class="comment">// -&gt; true</span></span><br><span class="line"><span class="comment">// è®¾ç½®å±æ€§ä¹Ÿä¼šå½±å“åˆ°åŸå§‹æ•°æ®</span></span><br><span class="line">vm.a = <span class="number">2</span></span><br><span class="line">data.a <span class="comment">// -&gt; 2</span></span><br><span class="line"><span class="comment">// ... åä¹‹äº¦ç„¶</span></span><br><span class="line">data.a = <span class="number">3</span></span><br><span class="line">vm.a <span class="comment">// -&gt; 3</span></span><br></pre></td></tr></table></figure>
<h2 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h2><p>ä»¥ä¸‹æ˜¯ v2.0 çš„ç”Ÿå‘½å‘¨æœŸå›¾</p>
<p><img src="/images/vue/vue-05.png" alt=""></p>
<p>è€Œè¿™æ˜¯ v1.0 çš„ç”Ÿå‘½å‘¨æœŸå›¾</p>
<p><img src="/images/vue/vue-06.png" alt=""></p>
<p>æ‰€ä»¥è¯´v1.0è·Ÿv2.0è¿˜æ˜¯æœ‰å¾ˆå¤§çš„å·®åˆ«çš„ã€‚</p>
<table>
<thead>
<tr>
<th>v1.0</th>
<th>v2.0</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>init</td>
<td>beforeCreate</td>
<td>ç»„ä»¶å®ä¾‹åˆšè¢«åˆ›å»ºï¼Œç»„ä»¶å±æ€§è®¡ç®—ä¹‹å‰ï¼Œå¦‚ data å±æ€§ç­‰</td>
</tr>
<tr>
<td>created</td>
<td>created</td>
<td>ç»„ä»¶å®ä¾‹åˆ›å»ºå®Œæˆï¼Œå±æ€§å·²ç»‘å®šï¼Œä½† DOM è¿˜æœªç”Ÿæˆï¼Œ<code>$el</code> å±æ€§è¿˜ä¸å­˜åœ¨</td>
</tr>
<tr>
<td>beforeCompile</td>
<td>beforeMount</td>
<td>æ¨¡æ¿ç¼–è¯‘/æŒ‚è½½ä¹‹å‰</td>
</tr>
<tr>
<td>compiled</td>
<td>mounted</td>
<td>æ¿ç¼–è¯‘/æŒ‚è½½ä¹‹å</td>
</tr>
<tr>
<td>ready</td>
<td>mounted</td>
<td>æ¨¡æ¿ç¼–è¯‘/æŒ‚è½½ä¹‹åï¼ˆä¸ä¿è¯ç»„ä»¶å·²åœ¨ document ä¸­ï¼‰</td>
</tr>
<tr>
<td>-</td>
<td>beforeUpdate</td>
<td>ç»„ä»¶æ›´æ–°ä¹‹å‰</td>
</tr>
<tr>
<td>-</td>
<td>updated</td>
<td>ç»„ä»¶æ›´æ–°ä¹‹å</td>
</tr>
<tr>
<td>-</td>
<td>activated</td>
<td>for <code>keep-alive</code>ï¼Œç»„ä»¶è¢«æ¿€æ´»æ—¶è°ƒç”¨</td>
</tr>
<tr>
<td>-</td>
<td>deactivated</td>
<td>for <code>keep-alive</code>ï¼Œç»„ä»¶è¢«ç§»é™¤æ—¶è°ƒç”¨</td>
</tr>
<tr>
<td>attached</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>detached</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>beforeDestory</td>
<td>beforeDestory</td>
<td>ç»„ä»¶é”€æ¯å‰è°ƒç”¨</td>
</tr>
<tr>
<td>destoryed</td>
<td>destoryed</td>
<td>ç»„ä»¶é”€æ¯åè°ƒç”¨</td>
</tr>
</tbody>
</table>
<h2 id="æ•°æ®ç»‘å®š"><a href="#æ•°æ®ç»‘å®š" class="headerlink" title="æ•°æ®ç»‘å®š"></a>æ•°æ®ç»‘å®š</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">æ™®é€šæ–‡æœ¬ï¼š<span class="string">`&#123;&#123; &#125;&#125;`</span></span><br><span class="line"></span><br><span class="line">çº¯htmlï¼š<span class="string">`&lt;div v-html="rawHtml"&gt;&lt;/div&gt;`</span></span><br><span class="line"></span><br><span class="line">*Mustache*ä¸èƒ½ç”¨äºhtmlå±æ€§ï¼Œåº”ä½¿ç”¨<span class="string">`v-bind`</span>æŒ‡ä»¤</span><br><span class="line"></span><br><span class="line"><span class="string">`&lt;div v-bind:id="dynamicId"&gt;&lt;/div&gt;`</span></span><br><span class="line"></span><br><span class="line">javascriptè¡¨è¾¾å¼</span><br><span class="line"></span><br><span class="line"><span class="string">`&#123;&#123; number + 1 &#125;&#125;`</span></span><br><span class="line"></span><br><span class="line"><span class="string">`&#123;&#123; ok ? 'YES' : 'NO' &#125;&#125;`</span></span><br><span class="line"></span><br><span class="line"><span class="string">`&#123;&#123; message.split('').reverse().join('') &#125;&#125;`</span></span><br><span class="line"></span><br><span class="line"><span class="string">`&lt;div v-bind:id="'list-' + id"&gt;&lt;/div&gt;`</span></span><br><span class="line"></span><br><span class="line">**æ³¨æ„ï¼š** Vueæ¯ä¸ªç»‘å®šåªèƒ½åŒ…å«**å•ä¸ªè¡¨è¾¾å¼**ï¼Œå¦‚ä»¥ä¸‹çš„åˆ™ä¸ä¼šç”Ÿæ•ˆã€‚</span><br><span class="line"></span><br><span class="line">&lt;!-- è¿™æ˜¯è¯­å¥ï¼Œä¸æ˜¯è¡¨è¾¾å¼ --&gt;</span><br><span class="line">&#123;&#123; <span class="keyword">var</span> a = <span class="number">1</span> &#125;&#125;</span><br><span class="line">&lt;!-- æµæ§åˆ¶ä¹Ÿä¸ä¼šç”Ÿæ•ˆï¼Œè¯·ä½¿ç”¨ä¸‰å…ƒè¡¨è¾¾å¼ --&gt;</span><br><span class="line">&#123;&#123; <span class="keyword">if</span> (ok) &#123; <span class="keyword">return</span> message &#125; &#125;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æŒ‡ä»¤"><a href="#æŒ‡ä»¤" class="headerlink" title="æŒ‡ä»¤"></a>æŒ‡ä»¤</h2><ul>
<li><p>v-textï¼šæ›´æ–°å…ƒç´ çš„ <code>textContent</code>ã€‚å¦‚æœè¦æ›´æ–°éƒ¨åˆ†çš„ <code>textContent</code> ï¼Œéœ€è¦ä½¿ç”¨  {{ Mustache }}  æ’å€¼ã€‚</p>
</li>
<li><p>v-htmlï¼šæ›´æ–°å…ƒç´ çš„ <code>innerHTML</code> ã€‚æ³¨æ„ï¼š<strong>å†…å®¹æŒ‰æ™®é€š HTML æ’å…¥ - ä¸ä¼šä½œä¸º Vue æ¨¡æ¿è¿›è¡Œç¼–è¯‘ã€‚</strong></p>
</li>
<li><p>v-showï¼šæ ¹æ®è¡¨è¾¾å¼ä¹‹çœŸå‡å€¼ï¼Œåˆ‡æ¢å…ƒç´ çš„ <code>display</code> CSS å±æ€§ã€‚å½“æ¡ä»¶å˜åŒ–æ—¶è¯¥æŒ‡ä»¤è§¦å‘è¿‡æ¸¡æ•ˆæœã€‚</p>
</li>
<li><p>v-ifï¼šæ ¹æ®è¡¨è¾¾å¼çš„å€¼çš„çœŸå‡æ¡ä»¶æ¸²æŸ“å…ƒç´ ã€‚åœ¨åˆ‡æ¢æ—¶å…ƒç´ åŠå®ƒçš„æ•°æ®ç»‘å®š / ç»„ä»¶è¢«é”€æ¯å¹¶é‡å»ºã€‚å¦‚æœå…ƒç´ æ˜¯ <code>&lt;template&gt;</code> ï¼Œå°†æå‡ºå®ƒçš„å†…å®¹ä½œä¸ºæ¡ä»¶å—ã€‚å½“æ¡ä»¶å˜åŒ–æ—¶è¯¥æŒ‡ä»¤è§¦å‘è¿‡æ¸¡æ•ˆæœã€‚</p>
</li>
<li><p>v-elseã€v-else-ifï¼šå‰ä¸€å…„å¼Ÿå…ƒç´ å¿…é¡»æœ‰ <code>v-if</code> æˆ– <code>v-else-if</code>ã€‚</p>
</li>
<li><p>v-forï¼šåŸºäºæºæ•°æ®å¤šæ¬¡æ¸²æŸ“å…ƒç´ æˆ–æ¨¡æ¿å—ã€‚æ­¤æŒ‡ä»¤ä¹‹å€¼ï¼Œå¿…é¡»ä½¿ç”¨ç‰¹å®šè¯­æ³• <code>alias in expression</code>ï¼Œå¦‚<code>item in items</code>æˆ–<code>(item, index) in items</code>ï¼ŒåŒjsçš„éå†ï¼Œä¸å±€é™äºéå†æ•°æ®ç»“æ„ï¼Œè¿˜å¯ä»¥éå†å¯¹è±¡å±æ€§ï¼Œå½“éå†å¯¹è±¡æ—¶ï¼Œå¯ä»¥<code>(value, key, index) in object</code>ã€‚</p>
</li>
<li><p>v-onï¼šç»‘å®šäº‹ä»¶ç›‘å¬å™¨ã€‚äº‹ä»¶ç±»å‹ç”±å‚æ•°æŒ‡å®šã€‚</p>
<p><strong>ä¿®é¥°ç¬¦ï¼š</strong></p>
<ul>
<li><p>.stop - è°ƒç”¨<code>event.stopPropagation()</code>ï¼Œé˜»æ­¢å•å‡»äº‹ä»¶å†’æ³¡ã€‚</p>
</li>
<li><p>.prevent - è°ƒç”¨ <code>event.preventDefault()</code>ï¼Œæäº¤äº‹ä»¶ä¸å†é‡è½½é¡µé¢ã€‚</p>
</li>
<li><p>.capture - æ·»åŠ äº‹ä»¶ä¾¦å¬å™¨æ—¶ä½¿ç”¨ capture æ¨¡å¼ï¼Œå³æ•è·æ¨¡å¼ã€‚</p>
</li>
<li><p>.self - åªå½“äº‹ä»¶æ˜¯ä»ä¾¦å¬å™¨ç»‘å®šçš„å…ƒç´ æœ¬èº«è§¦å‘æ—¶æ‰è§¦å‘å›è°ƒã€‚</p>
</li>
<li><p>{keyCode | keyAlias} - åªå½“äº‹ä»¶æ˜¯ä»ä¾¦å¬å™¨ç»‘å®šçš„å…ƒç´ æœ¬èº«è§¦å‘æ—¶æ‰è§¦å‘å›è°ƒã€‚</p>
</li>
<li><p>.native - ç›‘å¬ç»„ä»¶æ ¹å…ƒç´ çš„åŸç”Ÿäº‹ä»¶ã€‚</p>
</li>
<li><p>.keyup[.enter | .tab | .delete | .esc | .space | .up | .down | .left | .right] - æ— éœ€è§£é‡Š</p>
</li>
</ul>
<p><strong>ç”¨æ³•ï¼š</strong></p>
<p>ç”¨åœ¨æ™®é€šå…ƒç´ ä¸Šæ—¶ï¼Œåªèƒ½ç›‘å¬ åŸç”Ÿ DOM äº‹ä»¶ã€‚ç”¨åœ¨è‡ªå®šä¹‰å…ƒç´ ç»„ä»¶ä¸Šæ—¶ï¼Œä¹Ÿå¯ä»¥ç›‘å¬å­ç»„ä»¶è§¦å‘çš„è‡ªå®šä¹‰äº‹ä»¶ã€‚åœ¨ç›‘å¬åŸç”Ÿ DOM äº‹ä»¶æ—¶ï¼Œæ–¹æ³•ä»¥äº‹ä»¶ä¸ºå”¯ä¸€çš„å‚æ•°ã€‚å¦‚æœä½¿ç”¨å†…è”è¯­å¥ï¼Œè¯­å¥å¯ä»¥è®¿é—®ä¸€ä¸ª <code>$event</code> å±æ€§ï¼š <code>v-on:click=&quot;handle(&#39;ok&#39;, $event)&quot;</code>ã€‚</p>
</li>
<li><p>v-bindï¼šåŠ¨æ€åœ°ç»‘å®šä¸€ä¸ªæˆ–å¤šä¸ªç‰¹æ€§ï¼Œæˆ–ä¸€ä¸ªç»„ä»¶ prop åˆ°è¡¨è¾¾å¼ã€‚åœ¨ç»‘å®š <code>class</code> æˆ– <code>style</code> ç‰¹æ€§æ—¶ï¼Œæ”¯æŒå…¶å®ƒç±»å‹çš„å€¼ï¼Œå¦‚æ•°ç»„æˆ–å¯¹è±¡ã€‚</p>
<p><strong>å‚è€ƒï¼š</strong><a href="https://cn.vuejs.org/v2/guide/class-and-style.html" target="_blank" rel="noopener">Class ä¸ Style ç»‘å®š</a>å’Œ<a href="https://cn.vuejs.org/v2/guide/components.html#Props" target="_blank" rel="noopener">ç»„ä»¶ - ç»„ä»¶ Props</a></p>
</li>
<li><p>v-modelï¼šåœ¨è¡¨å•æ§ä»¶æˆ–è€…ç»„ä»¶ä¸Šåˆ›å»ºåŒå‘ç»‘å®šã€‚</p>
<p><strong>ä¿®é¥°ç¬¦ï¼š</strong></p>
<ul>
<li><p><code>.lazy</code> - å–ä»£ <code>input</code> ç›‘å¬ <code>change</code> äº‹ä»¶</p>
</li>
<li><p><code>.number</code> - è¾“å…¥å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—</p>
</li>
<li><p><code>.trim</code> - è¾“å…¥é¦–å°¾ç©ºæ ¼è¿‡æ»¤</p>
</li>
</ul>
<p><strong>é™åˆ¶ï¼š</strong></p>
<ul>
<li><p><code>&lt;input&gt;</code></p>
</li>
<li><p><code>&lt;select&gt;</code></p>
</li>
<li><p><code>&lt;textarea&gt;</code></p>
</li>
<li><p>components</p>
</li>
</ul>
</li>
<li><p>v-preï¼šè·³è¿‡è¿™ä¸ªå…ƒç´ å’Œå®ƒçš„å­å…ƒç´ çš„ç¼–è¯‘è¿‡ç¨‹ã€‚å¯ä»¥ç”¨æ¥æ˜¾ç¤ºåŸå§‹ Mustache æ ‡ç­¾ã€‚è·³è¿‡å¤§é‡æ²¡æœ‰æŒ‡ä»¤çš„èŠ‚ç‚¹ä¼šåŠ å¿«ç¼–è¯‘ã€‚</p>
</li>
<li><p>v-cloakï¼šä¸ªæŒ‡ä»¤ä¿æŒåœ¨å…ƒç´ ä¸Šç›´åˆ°å…³è”å®ä¾‹ç»“æŸç¼–è¯‘ã€‚å’Œ CSS è§„åˆ™å¦‚ <code>[v-cloak] { display: none }</code> ä¸€èµ·ç”¨æ—¶ï¼Œè¿™ä¸ªæŒ‡ä»¤å¯ä»¥éšè—æœªç¼–è¯‘çš„ Mustache æ ‡ç­¾ç›´åˆ°å®ä¾‹å‡†å¤‡å®Œæ¯•ã€‚</p>
<p><strong>ç”¨æ³•ï¼š</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[v-cloak] &#123;</span><br><span class="line">  display: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;div v-cloak&gt;</span><br><span class="line">  &#123;&#123; message &#125;&#125;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ ä¸ä¼šæ˜¾ç¤ºï¼Œç›´åˆ°ç¼–è¯‘ç»“æŸã€‚</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>v-onceï¼šåªæ¸²æŸ“å…ƒç´ å’Œç»„ä»¶ä¸€æ¬¡ã€‚éšåçš„é‡æ–°æ¸²æŸ“,å…ƒç´ /ç»„ä»¶åŠå…¶æ‰€æœ‰çš„å­èŠ‚ç‚¹å°†è¢«è§†ä¸ºé™æ€å†…å®¹å¹¶è·³è¿‡ã€‚è¿™å¯ä»¥ç”¨äºä¼˜åŒ–æ›´æ–°æ€§èƒ½ã€‚</li>
</ul>
<h2 id="è®¡ç®—å±æ€§"><a href="#è®¡ç®—å±æ€§" class="headerlink" title="è®¡ç®—å±æ€§"></a>è®¡ç®—å±æ€§</h2><p>è™½ç„¶å¯ä»¥é€šè¿‡ {{ }}  å¯ä»¥ç»‘å®šæ•°æ®ï¼Œä½†æ˜¯å¤ªé‡çš„é€»è¾‘ä¼šä½¿å¾—æ¨¡æ¿è¿‡é‡éš¾ä»¥ç»´æŠ¤ï¼Œå› æ­¤<code>computed</code>è¿è¥è€Œç”Ÿã€‚</p>
<p>å®˜æ–¹demo</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"example"</span>&gt;</span><br><span class="line">  &lt;p&gt;Original message: <span class="string">"&#123;&#123; message &#125;&#125;"</span>&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">  &lt;p&gt;Computed reversed message: "&#123;&#123; reversedMessage &#125;&#125;"&lt;/</span>p&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">var vm = new Vue(&#123;</span></span><br><span class="line"><span class="regexp">  el: '#example',</span></span><br><span class="line"><span class="regexp">  data: &#123;</span></span><br><span class="line"><span class="regexp">    message: 'Hello'</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  computed: &#123;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ a computed getter</span></span><br><span class="line"><span class="regexp">    reversedMessage: function () &#123;</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/ `this` points to the vm instance</span></span><br><span class="line"><span class="regexp">      return this.message.split('').reverse().join('')</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ åªè¦ message ä¸å‘ç”Ÿå˜åŒ–ï¼Œå¤šæ¬¡è®¿é—® reversedMessage è®¡ç®—å±æ€§ä¼šç«‹å³è¿”å›ä¹‹å‰çš„è®¡ç®—ç»“æœï¼Œè€Œä¸å¿…å†æ¬¡æ‰§è¡Œå‡½æ•°</span></span><br></pre></td></tr></table></figure>
<p>1ã€computed VS methodsï¼š<code>computed</code>åŸºäºä¾èµ–ç¼“å­˜ï¼Œè€Œ<code>methods</code>åˆ™ä¼šæ¯æ¬¡æ‰§è¡Œå‡½æ•°ï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ<code>computed</code>åªè¦ç›¸å…³ä¾èµ–ä¸å‘ç”Ÿæ”¹å˜ï¼Œåˆ™ä¸ä¼šé‡æ–°å–å€¼ï¼Œè€Œ<code>methods</code>åˆ™æ— è®ºæ˜¯å¦ä¾èµ–ä¼šæ”¹å˜ï¼Œéƒ½ä¼šé‡æ–°è°ƒç”¨å‡½æ•°è®¡ç®—ä¸€æ¬¡ã€‚<em>å½“æ•°æ®é‡å¤§æ—¶ï¼Œå¯ä»¥è€ƒè™‘æœ‰<code>computed</code>ï¼Œè€Œå½“ä½ ä¸æƒ³è¦æœ‰ç¼“å­˜åˆ™å¯ä»¥ç”¨<code>methods</code></em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—å±æ€§å°†ä¸ä¼šæ›´æ–°ï¼Œå› ä¸º Date.now() ä¸æ˜¯å“åº”å¼ä¾èµ–</span></span><br><span class="line">computed: &#123;</span><br><span class="line">  now: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Date</span>.now()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€computed VS $watchï¼š<code>$watch</code>æ˜¯è§‚å¯ŸVueå®ä¾‹ä¸Šæ•°æ®å˜åŠ¨ï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ<code>$watch</code>å¯ä»¥ç›‘å¬åˆ°å…¶å˜åŒ–å¹¶ä½œå‡ºç›¸å¯¹åº”çš„é€»è¾‘å¤„ç†ã€‚<code>$watch</code>è·Ÿ<code>computed</code>ä½¿ç”¨åœºæ™¯åªèƒ½è§†æƒ…å†µè€Œå®šã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"demo"</span>&gt;&#123;&#123; fullName &#125;&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ $watch</span></span><br><span class="line"><span class="regexp">var vm = new Vue(&#123;</span></span><br><span class="line"><span class="regexp">  el: '#demo',</span></span><br><span class="line"><span class="regexp">  data: &#123;</span></span><br><span class="line"><span class="regexp">    firstName: 'Foo',</span></span><br><span class="line"><span class="regexp">    lastName: 'Bar',</span></span><br><span class="line"><span class="regexp">    fullName: 'Foo Bar'</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  watch: &#123;</span></span><br><span class="line"><span class="regexp">    firstName: function (val) &#123;</span></span><br><span class="line"><span class="regexp">      this.fullName = val + ' ' + this.lastName</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    lastName: function (val) &#123;</span></span><br><span class="line"><span class="regexp">      this.fullName = this.firstName + ' ' + val</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ computed</span></span><br><span class="line"><span class="regexp">var vm = new Vue(&#123;</span></span><br><span class="line"><span class="regexp">  el: '#demo',</span></span><br><span class="line"><span class="regexp">  data: &#123;</span></span><br><span class="line"><span class="regexp">    firstName: 'Foo',</span></span><br><span class="line"><span class="regexp">    lastName: 'Bar'</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  computed: &#123;</span></span><br><span class="line"><span class="regexp">    fullName: function () &#123;</span></span><br><span class="line"><span class="regexp">      return this.firstName + ' ' + this.lastName</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>
<p><code>computed</code> ç›¸æ¯” <code>$watch</code> ç®€å•å¤šã€‚</p>
<p>3ã€è®¡ç®—å±æ€§é»˜è®¤æƒ…å†µä¸‹åªæœ‰<code>getter</code>ï¼Œå¹¶æ²¡æœ‰<code>setter</code>ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  fullName: &#123;</span><br><span class="line">    <span class="comment">// getter</span></span><br><span class="line">    get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.firstName + <span class="string">' '</span> + <span class="keyword">this</span>.lastName</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// setter</span></span><br><span class="line">    set: <span class="function"><span class="keyword">function</span> (<span class="params">newValue</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> names = newValue.split(<span class="string">' '</span>)</span><br><span class="line">      <span class="keyword">this</span>.firstName = names[<span class="number">0</span>]</span><br><span class="line">      <span class="keyword">this</span>.lastName = names[names.length - <span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Class-ä¸-Style-ç»‘å®š"><a href="#Class-ä¸-Style-ç»‘å®š" class="headerlink" title="Class ä¸ Style ç»‘å®š"></a>Class ä¸ Style ç»‘å®š</h2><p>classï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">"&#123; active: isActive &#125;"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">======================================================================</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"static"</span></span><br><span class="line">     v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">"&#123; active: isActive, 'text-danger': hasError &#125;"</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">data: &#123;</span></span><br><span class="line"><span class="regexp">  isActive: true,</span></span><br><span class="line"><span class="regexp">  hasError: false</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">======================================================================</span></span><br><span class="line"><span class="regexp">&lt;div v-bind:class="classObject"&gt;&lt;/</span>div&gt;</span><br><span class="line">data: &#123;</span><br><span class="line">  classObject: &#123;</span><br><span class="line">    active: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">'text-danger'</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">======================================================================</span><br><span class="line">&lt;div v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">"[activeClass, errorClass]"</span>&gt;</span><br><span class="line">data: &#123;</span><br><span class="line">  activeClass: <span class="string">'active'</span>,</span><br><span class="line">  errorClass: <span class="string">'text-danger'</span></span><br><span class="line">&#125;</span><br><span class="line">======================================================================</span><br><span class="line">&lt;div v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">"[isActive ? activeClass : '', errorClass]"</span>&gt;</span><br><span class="line">&lt;div v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">"[&#123; active: isActive &#125;, errorClass]"</span>&gt;</span><br></pre></td></tr></table></figure>
<p>styleï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-bind:style=<span class="string">"&#123; color: activeColor, fontSize: fontSize + 'px' &#125;"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">data: &#123;</span><br><span class="line">  activeColor: <span class="string">'red'</span>,</span><br><span class="line">  fontSize: <span class="number">30</span></span><br><span class="line">&#125;</span><br><span class="line">======================================================================</span><br><span class="line">&lt;div v-bind:style=<span class="string">"styleObject"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">data: &#123;</span><br><span class="line">  styleObject: &#123;</span><br><span class="line">    color: <span class="string">'red'</span>,</span><br><span class="line">    fontSize: <span class="string">'13px'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">======================================================================</span><br><span class="line">&lt;div v-bind:style=<span class="string">"[baseStyles, overridingStyles]"</span>&gt;</span><br></pre></td></tr></table></figure>
<h2 id="åˆ—è¡¨æ¸²æŸ“"><a href="#åˆ—è¡¨æ¸²æŸ“" class="headerlink" title="åˆ—è¡¨æ¸²æŸ“"></a>åˆ—è¡¨æ¸²æŸ“</h2><h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><p>ç›¸å…³å†…å®¹å¯ä»¥æŸ¥çœ‹æŒ‡ä»¤ä¸­çš„<code>v-for</code>ï¼Œè¿™é‡Œåªè®²è¿°<code>key</code>ï¼Œv2.0çš„<code>key</code>è·Ÿv1.0çš„<code>track-by</code>å­˜åœ¨çš„æ„ä¹‰ä¸€æ ·ï¼Œéƒ½æ˜¯ç»™æ¯ä¸€é¡¹ä¸€ä¸ªå”¯ä¸€æ ‡å¿—ç¬¦ï¼Œè¿™é‡Œéœ€è¦åˆ©ç”¨åˆ°<code>v-bind</code>å°†<code>key</code>ç»‘å®šèµ·æ¥ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">"item in items"</span> <span class="attr">:key</span>=<span class="string">"item.id"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- å†…å®¹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong>ç”±äºjsçš„é™åˆ¶ï¼Œ Vue ä¸èƒ½æ£€æµ‹ä»¥ä¸‹å˜åŠ¨çš„æ•°ç»„ï¼š</p>
<p>1ã€å½“ä½ åˆ©ç”¨ç´¢å¼•ç›´æ¥è®¾ç½®ä¸€ä¸ªé¡¹æ—¶ï¼Œä¾‹å¦‚ï¼š <code>vm.items[indexOfItem] = newValue</code></p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Vue.set</span></span><br><span class="line">Vue.set(example1.items, indexOfItem, newValue)</span><br><span class="line"><span class="comment">// æˆ–</span></span><br><span class="line"><span class="comment">// Array.prototype.splice`</span></span><br><span class="line">example1.items.splice(indexOfItem, <span class="number">1</span>, newValue)</span><br></pre></td></tr></table></figure>
<p>2ã€å½“ä½ ä¿®æ”¹æ•°ç»„çš„é•¿åº¦æ—¶ï¼Œä¾‹å¦‚ï¼š <code>vm.items.length = newLength</code></p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">example1.items.splice(newLength)</span><br></pre></td></tr></table></figure>
<h3 id="è¿‡æ»¤-æ’åº"><a href="#è¿‡æ»¤-æ’åº" class="headerlink" title="è¿‡æ»¤|æ’åº"></a>è¿‡æ»¤|æ’åº</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;li v-<span class="keyword">for</span>=<span class="string">"n in evenNumbers"</span>&gt;&#123;&#123; n &#125;&#125;&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">data: &#123;</span></span><br><span class="line"><span class="regexp">  numbers: [ 1, 2, 3, 4, 5 ]</span></span><br><span class="line"><span class="regexp">&#125;,</span></span><br><span class="line"><span class="regexp">computed: &#123;</span></span><br><span class="line"><span class="regexp">  evenNumbers: function () &#123;</span></span><br><span class="line"><span class="regexp">    return this.numbers.filter(function (number) &#123;</span></span><br><span class="line"><span class="regexp">      return number % 2 === 0</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">======================================================================</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;li v-for="n in even(numbers)"&gt;&#123;&#123; n &#125;&#125;&lt;/</span>li&gt;</span><br><span class="line">data: &#123;</span><br><span class="line">  numbers: [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> ]</span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">  even: <span class="function"><span class="keyword">function</span> (<span class="params">numbers</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> numbers.filter(<span class="function"><span class="keyword">function</span> (<span class="params">number</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> number % <span class="number">2</span> === <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="äº‹ä»¶ç›‘å¬å™¨"><a href="#äº‹ä»¶ç›‘å¬å™¨" class="headerlink" title="äº‹ä»¶ç›‘å¬å™¨"></a>äº‹ä»¶ç›‘å¬å™¨</h2><p>å¯ä»¥æŸ¥çœ‹<em>æŒ‡ä»¤</em>ä¸­çš„<code>.keyup</code>ï¼Œé™¤äº†ä¸Šé¢å®˜æ–¹ç»™çš„ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰<code>keycode</code>ï¼Œå¦‚<code>Vue.config.keyCodes.f1 = 112</code>ã€‚</p>
<p>å…¶ä¸­åœ¨v2.1.0ç‰ˆæœ¬ä¸­æ–°å¢äº†ä»¥ä¸‹çš„ç‰¹æ€§ï¼š</p>
<p>å¯ä»¥ç”¨å¦‚ä¸‹ä¿®é¥°ç¬¦å¼€å¯é¼ æ ‡æˆ–é”®ç›˜äº‹ä»¶ç›‘å¬ï¼Œä½¿åœ¨æŒ‰é”®æŒ‰ä¸‹æ—¶å‘ç”Ÿå“åº”ã€‚</p>
<ul>
<li><p><code>.ctrl</code></p>
</li>
<li><p><code>.alt</code></p>
</li>
<li><p><code>.shift</code></p>
</li>
<li><p><code>.meta</code></p>
</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Alt + C --&gt;</span><br><span class="line">&lt;input @keyup.alt<span class="number">.67</span>=<span class="string">"clear"</span>&gt;</span><br><span class="line">&lt;!-- Ctrl + Click --&gt;</span><br><span class="line">&lt;div @click.ctrl=<span class="string">"doSomething"</span>&gt;Do something&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ol>
<li><p>ä»<code>v-on</code>æ–¹ä¾¿å®šä½æ–¹æ³•ï¼›</p>
</li>
<li><p>æ— é¡»å†jsç»‘å®šäº‹ä»¶ï¼Œviewmodelåªæ˜¯å¤„ç†çº¯ç²¹çš„é€»è¾‘ï¼›</p>
</li>
<li><p>viewModelè¢«é”€æ¯ï¼Œäº‹ä»¶ä¹Ÿä¼šéšä¹‹è¢«æ¸…ç†</p>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> vue </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç”¨shadowsocksåŠ é€Ÿgit clone]]></title>
      <url>https://lucius0.github.io/2017/01/07/archivers/shadowsocks-and-git/</url>
      <content type="html"><![CDATA[<p>åœ¨ä¸­å›½ï¼Œæœ‰æ—¶å€™å°±ç®—ç¿»å¢™ï¼Œåœ¨ä½¿ç”¨gitä¸Šè¿˜æ˜¯å­˜åœ¨é€Ÿåº¦å¾ˆæ…¢ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨shadowsocksçš„sock5ä»£ç†ï¼Œä¸ºæˆ‘ä»¬çš„gitæ“ä½œåŠ é€Ÿã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.proxy &apos;socks5://127.0.0.1:1080&apos; </span><br><span class="line">git config --global https.proxy &apos;socks5://127.0.0.1:1080&apos;</span><br></pre></td></tr></table></figure>
<p>shadowsocksçš„é»˜è®¤ç«¯å£å°±æ˜¯1080ï¼Œä¸Šé¢çš„è®¾ç½®åªæ˜¯å¼€å¯äº†<code>https</code>åè®®çš„ä»£ç†ï¼Œgitåè®®å¼€å¯ä»£ç†å¯ä»¥æŸ¥çœ‹<a href="http://segmentfault.com/q/1010000000118837" target="_blank" rel="noopener">è¿™é‡Œ</a></p>
]]></content>
      
        <categories>
            
            <category> tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[git cloneæ—¶é‡åˆ°could not read from remote repository]]></title>
      <url>https://lucius0.github.io/2017/01/07/archivers/could-not-read-from-remote-repository/</url>
      <content type="html"><![CDATA[<p>git clone æ—¶é‡åˆ°å¦‚ä¸‹çš„é”™è¯¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git clone git@github.com:xxxxx/xxx</span><br><span class="line">Cloning into &apos;xxx&apos;...</span><br><span class="line">The authenticity of host &apos;github.com (192.30.252.128)&apos; can&apos;t be established.</span><br><span class="line">RSA key fingerprint is 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48.</span><br><span class="line">Are you sure you want to continue connecting (yes/no)? </span><br><span class="line">**Host key verification failed.**</span><br><span class="line">fatal: Could not read from remote repository.</span><br><span class="line"></span><br><span class="line">Please make sure you have the correct access rights</span><br><span class="line">and the repository exists.</span><br></pre></td></tr></table></figure>
<h2 id="é—®é¢˜åŸå› "><a href="#é—®é¢˜åŸå› " class="headerlink" title="é—®é¢˜åŸå› "></a>é—®é¢˜åŸå› </h2><p>ç¼ºå°‘ known_hosts æ–‡ä»¶, è€Œä¸”å¿…é¡»ç”Ÿæˆ github.com çš„ipæ‰§è¡Œå†…å®¹.</p>
<p>åªè¦æ‰§è¡Œå‘½ä»¤<code>ssh git@github.com</code>ï¼Œè¿™æ ·åœ¨.sshç›®å½•å°±æœ‰ä¸‰ä¸ªæ–‡ä»¶äº†ï¼Œå³<code>id_rsa</code>ï¼Œ<code>id_rsa.pub</code>ï¼Œ<code>known_hosts</code></p>
]]></content>
      
        <categories>
            
            <category> tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[git pullæ—¶é‡åˆ°error: cannot lock refçš„é”™è¯¯]]></title>
      <url>https://lucius0.github.io/2017/01/06/archivers/error-cannot-lock-ref/</url>
      <content type="html"><![CDATA[<blockquote>
<p>git pull æ—¶é‡åˆ° <strong>error: cannot lock ref â€˜xxxâ€™: â€˜xxxâ€™ exists; cannot create â€˜xxxâ€™</strong>ï¼Œä¼šå¯¼è‡´pullå¤±è´¥ã€‚</p>
</blockquote>
<h2 id="é—®é¢˜åŸå› "><a href="#é—®é¢˜åŸå› " class="headerlink" title="é—®é¢˜åŸå› "></a>é—®é¢˜åŸå› </h2><p>gitå·¥ç¨‹çš„.git/refsç›®å½•ä¸‹è·Ÿè¸ªçš„æŸäº›gitåˆ†æ”¯ï¼Œåœ¨pullæ—¶å€™å‘ç°ä¸è¿œç¨‹ä»“åº“å¯¹åº”çš„åˆ†æ”¯refsä¸åŒï¼Œå› æ­¤å¯¼è‡´ git pull å¤±è´¥</p>
<p><strong>ä¸¾ä¸ªä¾‹å­ï¼š</strong></p>
<ol>
<li><p>AåŒäº‹<code>$ git push -force</code>äº†testè¿™ä¸ªåˆ†æ”¯ï¼Œå¯¼è‡´è¿œç¨‹ä»“åº“çš„åˆ†æ”¯è¢«è¦†ç›–ï¼Œè€Œä½ æœ¬åœ°çš„refsåˆ™ä¼šä¸è¿œç¨‹ä»“åº“çš„åˆ†æ”¯ä¸ä¸€è‡´ï¼Œäº§ç”Ÿé—®é¢˜ï¼›</p>
</li>
<li><p>gitåˆ†æ”¯æ˜¯ä¸åŒºåˆ†å¤§å°å†™ï¼Œæœ‰äººåˆ é™¤äº†è¿œç¨‹ä»“åº“çš„åˆ†æ”¯åˆé‡æ–°åˆ›å»ºä¸€ä¸ªåŒæ ·åå­—çš„åˆ†æ”¯åŒæ ·ä¹Ÿä¼šäº§ç”Ÿé—®é¢˜ã€‚</p>
</li>
</ol>
<h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><p>è¦ä¹ˆå¼ºè¡Œgit pullï¼Œè¦ä¹ˆåˆ é™¤å‡ºç°é—®é¢˜çš„refsæ–‡ä»¶å¤¹ï¼Œå†git pull(æ¨è)</p>
<ol>
<li><p>åˆ é™¤æœ‰é—®é¢˜çš„refsï¼Œå¯ä»¥ç›´æ¥åœ¨.git/refsä¸‹é¢æ ¹æ®é”™è¯¯æç¤ºåˆ é™¤ç›¸å¯¹åº”çš„refsæ–‡ä»¶ï¼Œå¦‚â€™refs/remotes/origin/testParent/testâ€™ï¼Œä½ ä¹Ÿå¯ä»¥åˆ é™¤refsæ•´ä¸ªæ–‡ä»¶å¤¹ã€‚</p>
</li>
<li><p>ä½¿ç”¨gitå‘½ä»¤<code>$ git update-ref -d refs/remotes/origin/testParent/test</code></p>
</li>
<li><p>å¼ºåˆ¶æ‰§è¡Œpullï¼Œ<code>$ git pull -p</code></p>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Flexboxä¸z-index]]></title>
      <url>https://lucius0.github.io/2016/11/13/archivers/flexbox-and-z-index/</url>
      <content type="html"><![CDATA[<p>åŸæ–‡é“¾æ¥ï¼š <a href="https://www.sitepoint.com/quick-tip-how-z-index-and-auto-margins-work-in-flexbox/" target="_blank" rel="noopener">https://www.sitepoint.com/quick-tip-how-z-index-and-auto-margins-work-in-flexbox/</a></p>
<p><a href="https://www.w3.org/TR/css-flexbox-1/" target="_blank" rel="noopener">Flexbox</a> æ˜¯è§£å†³ä¾‹å¦‚å›ºå®šé¡µè„šå’Œç­‰é«˜åˆ—ç­‰çš„æ™®é€šå¸ƒå±€çš„ä¸€ç§æœ‰æ•ˆçš„è§£å†³æ–¹æ³•ã€‚æŠ›å¼€è¿™äº›ï¼Œå®ƒè¿˜æä¾›äº†ä¸€äº›ä¸å¤ªæµè¡Œçš„æœ‰ç”¨ç‰¹æ€§ã€‚è®©æˆ‘ä»¬æ¥ä¸€ä¸€æ¢ç´¢å®ƒä»¬ã€‚</p>
<h2 id="Flexbox-å’Œ-z-index"><a href="#Flexbox-å’Œ-z-index" class="headerlink" title="Flexbox å’Œ z-index"></a>Flexbox å’Œ z-index</h2><p>æ­£å¦‚ä½ å·²ç»çŸ¥é“çš„é‚£æ ·ï¼Œ<code>z-index</code>å±æ€§åªèƒ½åœ¨å®šä½çš„å…ƒç´ æœ‰æ•ˆã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å…ƒç´ éƒ½æ‹¥æœ‰<code>position: static</code>å¹¶ä¸”æ— æ³•å®šä½ã€‚é™¤é<code>position</code>å±æ€§çš„å€¼è¢«è®¾ç½®ä¸º<code>relative</code>ï¼Œ<code>absolute</code>ï¼Œ<code>fixed</code>ï¼Œæˆ–è€…<code>sticky</code>ã€‚</p>
<p>ç„¶è€Œï¼Œä¸€ä¸ªæ²¡æœ‰å®šä½æ€§è´¨çš„å…ƒç´ ï¼Œä¾‹å¦‚flexé¡¹ç›®åŒæ ·ä¹Ÿå¯ä»¥æ¥æ”¶<code>z-index</code>å±æ€§ã€‚æœ‰å…³ä¿¡æ¯ï¼Œåœ¨<a href="https://drafts.csswg.org/css-flexbox-1/#painting" target="_blank" rel="noopener">CSSå¼¹æ€§ç›’å­å¸ƒå±€è§„èŒƒ</a>æœ‰ä»‹ç»ã€‚</p>
<blockquote>
<p>Flexé¡¹ç›®åœ¨æ¸²æŸ“æ—¶å¦‚åŒå†…è”å—çŠ¶å…ƒç´ ä¸€æ ·ï¼Œé™¤äº†å‘½ä»¤ä¿®æ”¹æ–‡æ¡£æµé¡ºåºæ˜¯ç”¨æ¥æ›¿æ¢æœªä¿®æ”¹æ–‡æ¡£æµé¡ºåºï¼Œ<code>z-index</code>å’Œè‡ªåŠ¨è¾¹è·åœ¨åˆ›å»ºå±‚å ä¸Šä¸‹æ–‡è¡¨ç°æ˜¯ä¸ä¸€æ ·çš„ï¼Œå³ä½¿å€¼ä¸ºstaticã€‚</p>
</blockquote>
<p>ä¸ºäº†ç†è§£è¿™äº›è¡Œä¸ºï¼Œè®©æˆ‘ä»¬è·Ÿéšç€ä»¥ä¸‹çš„ä¾‹å­æ¥æ€è€ƒå§ï¼š</p>
<p data-height="499" data-theme-id="0" data-slug-hash="JKYEgj" data-user="SitePoint" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/SitePoint/pen/JKYEgj" target="_blank" rel="noopener">Flexbox and z-index</a> forked by SitePoint(<a href="http://codepen.io" target="_blank" rel="noopener">@SitePoint</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p>è¿™é‡Œæˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªå…ƒç´ ï¼š<code>.font</code>å…ƒç´ å’Œ<code>.back</code>å…ƒç´ ã€‚<code>.font</code>å…ƒç´ æœ‰ä¸€å†…å®¹å€¼ä¸ºâ€˜1â€™çš„å­å…ƒç´ ï¼Œå¹¶ä¸”<code>.font</code>å…ƒç´ ä¸ºç»å¯¹å®šä½å…ƒç´ ã€‚ç‰¹åˆ«åœ°ï¼Œå®ƒæ‹¥æœ‰<code>position:fixed</code>å±æ€§å¹¶ä¸”è¦†ç›–äº†æ•´ä¸ªè§†å›¾ã€‚</p>
<p>è‡³äº<code>.back</code>å…ƒç´ æ˜¯ä¸€ä¸ªflexå®¹å™¨ï¼Œå®ƒåŒ…å«äº†ä¸¤ä¸ªå­å…ƒç´ -ä¸€ä¸ªå†…å®¹ä¸º2å’Œä¸€ä¸ªä¸º3çš„å­å…ƒç´ ã€‚åŸºäºæˆ‘ä»¬åœ¨ä¸Šé¢è®¨è®ºçš„ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹flexé¡¹ç›®è®¾ç½®<code>z-index</code>å±æ€§ï¼Œå³ä½¿å®ƒä»¬ä¸æ˜¯å®šä½å…ƒç´ (å³å®ƒä»¬æœ‰<code>position:static</code>)</p>
<p>æ³¨æ„åˆ°å½“æˆ‘ä»¬é€šè¿‡ç‚¹å‡»ä¸Šé¢ä¾‹å­çš„æŒ‰é’®ç»™flexé¡¹ç›®æ·»åŠ <code>z-index:2</code>ï¼Œå®ƒä»¬ä¼šè¢«å®šä½åˆ°<code>.front</code>å…ƒç´ çš„ä¸Šé¢ã€‚</p>
<h2 id="Flexboxå’Œè‡ªåŠ¨è¾¹è·"><a href="#Flexboxå’Œè‡ªåŠ¨è¾¹è·" class="headerlink" title="Flexboxå’Œè‡ªåŠ¨è¾¹è·"></a>Flexboxå’Œè‡ªåŠ¨è¾¹è·</h2><p>é€šè¿‡ç»™flexé¡¹ç›®è®¾ç½®è‡ªåŠ¨è¾¹è·ï¼Œæˆ‘ä»¬å¯ä»¥è§£å†³ç›¸åŒçš„UIæ ·å¼ã€‚ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬å…ˆå‡è±¡æˆ‘ä»¬è¦æ„é€ è¿™ç§ç±»å‹çš„é¡µå¤´å¸ƒå±€ã€‚</p>
<p><img src="/images/css/css-18.png" alt=""></p>
<p>ä¸ºäº†æ„é€ è¿™ç§æ ·å¼çš„é¡µå¤´ï¼Œæˆ‘ä»¬ä½¿ç”¨Flexboxï¼Œæ²¡æœ‰æµ®åŠ¨ï¼Œæ²¡æœ‰å›ºå®šå®½è¯¸å¦‚æ­¤ç±»çš„å±æ€§ã€‚</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">nav</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"logo"</span>&gt;</span>LOGO<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"menu"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>About<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>Projects<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>Contact<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"social"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>Facebook<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>Twitter<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>CSS:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">header</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">nav</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">90%</span>;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">1200px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.menu</span> &#123;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ï¼Œ<code>nav</code>å…ƒç´ æ˜¯flexå®¹å™¨ï¼Œè€Œlogoï¼Œä¸»èœå•ï¼Œç¤¾äº¤èœå•åˆ™æ˜¯flexé¡¹ç›®ã€‚æ­£å¦‚ä½ åœ¨ä¸Šä¸€ä¸ªä»£ç ç»“æœçœ‹åˆ°çš„ï¼Œå‰ä¸¤ä¸ªflexé¡¹ç›®æ˜¯æ²¿ç€ä¸»è½´æ’åˆ—åœ¨flexå®¹å™¨çš„å·¦è¾¹ã€‚ç›¸åçš„ï¼Œç¤¾äº¤èœå•åˆ™æ˜¯æ²¿ç€ä¸»è½´æ’åˆ—åœ¨çˆ¶å®¹å™¨çš„å³è¾¹ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§å¯ä»¥å®ç°æ’åˆ—æ–¹å¼çš„å°±æ˜¯ç»™ä¸»èœå•æ·»åŠ <code>margin-right: auto</code>ã€‚åªè¦ä¸€è¡Œä»£ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡è½½ç¤¾äº¤èœå•çš„æ’åˆ—æ–¹å¼å¹¶æŠŠå®ƒå§‹ç»ˆæ’åˆ—åœ¨å®¹å™¨çš„å³è¾¹ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨<code>align-self</code>å±æ€§å»è¦†ç›–flexé¡¹ç›®äº¤å‰è½´çš„é»˜è®¤æ’åˆ—æ–¹å¼ã€‚</p>
<p>é™¤äº†è‡ªåŠ¨è¾¹è·ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æœ‰ç¬¬äºŒç§æ–¹æ³•å»è®¾è®¡æˆ‘ä»¬çš„å¸ƒå±€ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ç§»é™¤ä¸»èœå•çš„<code>margin-right</code>å±æ€§ï¼Œç„¶åæˆ‘ä»¬å¯¹å…¶æ·»åŠ <code>flex-grow</code>å±æ€§ã€‚</p>
<p>å°½ç®¡ç»“æœçœ‹èµ·æ¥ä¸¤è€…æ— å¼‚ï¼Œä½†å´æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¸åŒç‚¹ã€‚åœ¨ç¬¬ä¸€ä¸ªè§£å†³æ–¹æ³•é‡Œé¢ï¼Œèœå•æœ‰å®ƒè®¡ç®—å¥½çš„åˆå§‹å®½åº¦ã€‚æ‰€ä»¥ä¸¾ä¸ªä¾‹å­ï¼Œå½“è§†å›¾çš„å®½åº¦ä¸º1100pxï¼Œèœå•çš„å®½åº¦çœ‹èµ·æ¥åˆ™æ˜¯ä¸‹é¢è¿™æ ·çš„ã€‚</p>
<p><img src="/images/css/css-19.png" alt=""></p>
<p>å¦ä¸€æ–¹é¢ï¼Œå¯¹äºç¬¬äºŒç§è§£å†³æ–¹æ¡ˆï¼Œèœå•çš„å®½åº¦å€¼ä¼šæ›´å¤§ï¼Œå› ä¸ºæˆ‘ä»¬æŒ‡å®šäº†<code>flex-grow: 1</code>ï¼Œè¿™æ˜¯å½“æˆ‘ä»¬è§†å›¾å®½åº¦ä¸º1100pxæ—¶ç›¸å¯¹åº”çš„å®½åº¦ã€‚</p>
<p><img src="/images/css/css-20.png" alt=""></p>
<p>ä»¥ä¸‹æ˜¯ä¾‹å­ï¼š</p>
<p data-height="499" data-theme-id="0" data-slug-hash="ezpgqx" data-user="SitePoint" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/SitePoint/pen/ezpgqx" target="_blank" rel="noopener">Custom Flexbox Alignment With Auto Margins</a> forked by SitePoint(<a href="http://codepen.io" target="_blank" rel="noopener">@SitePoint</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p>ç°åœ¨è®©æˆ‘ä»¬æ¥å‡è®¾ä¸€ä¸‹æˆ‘ä»¬æƒ³è¦ä¿®æ”¹çš„é¡µå¤´å¸ƒå±€ï¼Œæ–°çš„è®¾è®¡å¸ƒå±€æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="/images/css/css-21.png" alt=""></p>
<p>HTMLéƒ¨åˆ†çš„ä»£ç ä¿æŒä¸å˜ï¼Œæˆ‘ä»¬åªæ˜¯å¯¹CSSåšç¨å¾®ä¿®æ”¹ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nav</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">180px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.menu</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ï¼Œæ³¨æ„ä¸‹ç¤¾äº¤èœå•æ’åˆ—åœ¨çˆ¶å…ƒç´ çš„åº•éƒ¨ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ç»™ä¸»èœå•æ·»åŠ äº†<code>margin-bottom: auto</code>ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬åŒæ ·è¿˜å¯ä»¥ä½¿ç”¨<code>flex-grow: 1</code>ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•ä¼šå¢åŠ menuçš„é«˜åº¦ã€‚</p>
<p>åŒæ ·æ¥çœ‹ä¸€ä¸‹codepençš„ç¤ºä¾‹ä»£ç ï¼š</p>
<p data-height="499" data-theme-id="0" data-slug-hash="GqpWKW" data-user="SitePoint" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/SitePoint/pen/GqpWKW" target="_blank" rel="noopener">Custom Flexbox Alignment With flex-grow:1</a> forked by SitePoint(<a href="http://codepen.io" target="_blank" rel="noopener">@SitePoint</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p>æœ‰ä¸€ä»¶äº‹æˆ‘ä»¬éœ€è¦ç•™æ„çš„æ˜¯æˆ‘ä»¬åœ¨æ‰€æœ‰çš„ä¾‹å­éƒ½å®šä¹‰äº†<code>justify-content</code>å±æ€§ï¼Œæˆ‘ä»¬åœ¨è§†è§‰ä¸Šçœ‹ä¸å‡ºæœ‰ä»»ä½•çš„å·®å¼‚ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬å¯¹flexé¡¹ç›®ä½¿ç”¨äº†<code>auto margin</code>ã€‚åªæœ‰å½“æˆ‘ä»¬ç§»é™¤äº†è‡ªåŠ¨è¾¹è·(auto margin)ä¹‹åï¼Œ<code>justify-content</code>æ‰ä¼šç”Ÿæ•ˆã€‚æ ¹æ®ä»¥ä¸‹çš„è§„èŒƒ</p>
<blockquote>
<p>If free space is distributed to auto margins, the alignment properties will have no effect in that dimension because the margins will have stolen all the free space left over after flexing.</p>
<p>å‡å¦‚æŠŠå‰©ä½™çš„ç©ºé—´éƒ½åˆ†é…ç»™è‡ªåŠ¨è¾¹è·ï¼Œé‚£ä¹ˆå¯¹å…¶å±æ€§å°†ä¼šå¤±æ•ˆã€‚è¿™æ˜¯å› ä¸ºå‡å¦‚æ˜¯flexå¸ƒå±€ä¹‹åï¼Œmarginä¼šå æ®æ‰€å‰©ä½™çš„ç©ºé—´ã€‚</p>
</blockquote>
<p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬æ¥å¯¹é¡µå¤´åšå‡ºæ–°çš„æ”¹é€ ã€‚</p>
<p>æ¯«æ— ç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®<code>justify-content: space-between</code>æ¥å¾ˆç®€å•çš„å®ç°è¿™æ ·çš„æ•ˆæœã€‚ä½†æ˜¯å†æä¸€æ¬¡ï¼Œæˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®è‡ªåŠ¨è¾¹è·æ¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚æˆ‘ä»¬åªè¦ç»™ä¸»èœå•è®¾ç½®<code>margin: 0 auto</code>ã€‚</p>
<p>Codepen æ¡ˆä¾‹ï¼š</p>
<p data-height="499" data-theme-id="0" data-slug-hash="beVqax" data-user="SitePoint" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/SitePoint/pen/beVqax" target="_blank" rel="noopener">Custom Flexbox Alignment With Auto Margins</a> forked by SitePoint(<a href="http://codepen.io" target="_blank" rel="noopener">@SitePoint</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>åœ¨è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸¤ç§é²œä¸ºäººçŸ¥å…³äºFlexboxçš„å°æŠ€å·§ã€‚åœ¨ç»“æŸä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ¥æ¦‚æ‹¬ä¸€ä¸‹ï¼š</p>
<ul>
<li><p>æˆ‘ä»¬å¯ä»¥å¯¹flexé¡¹ç›®è®¾ç½®<code>z-index</code>ï¼Œå³ä½¿ä»–ä»¬çš„å®šä½ä¸º<code>static</code>ï¼Œ<code>position: static</code>ã€‚</p>
</li>
<li><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªåŠ¨è¾¹è·æ¥å®ç°ä¸»è½´ä¸Šçš„flexé¡¹ç›®çš„è‡ªå®šä¹‰æ’åˆ—ã€‚</p>
</li>
</ul>
<p>å‡å¦‚ä½ è¿˜åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨äº†å…¶ä»–çš„æŠ€å·§ï¼Œæ¬¢è¿åœ¨ä¸‹é¢ç•™è¨€ã€‚</p>
<script src="http://codepen.io/assets/embed/ei.js"> </script>]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æ·±å…¥æµ…å‡ºFlexbox]]></title>
      <url>https://lucius0.github.io/2016/11/09/archivers/dive-into-flexbox/</url>
      <content type="html"><![CDATA[<p>å…ˆç»™å¤§å®¶ä»‹ç»ä¸€ä¸ªå¯ä»¥è¾¹å­¦è¾¹ç©çš„Flexboxç½‘ç«™ã€‚</p>
<ul>
<li><p><a href="http://flexboxfroggy.com/#zh-cn" target="_blank" rel="noopener">FLEXBOX FROGGY</a></p>
</li>
<li><p><a href="http://www.css88.com/tool/flexboxfroggy/#zh-cn" target="_blank" rel="noopener">é•œåƒç½‘é¡µ</a></p>
</li>
</ul>
<p>Flexible boxes layoutæ˜¯W3Cä¸ºäº†æ›´å¥½çš„åœ¨ç½‘é¡µä¸­æ’ç‰ˆå’Œå¸ƒå±€è€Œè®¾è®¡å‡ºæ¥çš„ä¸€ä¸ªæ¨¡å—ã€‚å®ƒç”¨æ¥å¯ä»¥å¤„ç†æ›´åŠ å¤æ‚çš„å¸ƒå±€ã€‚å®ƒæœ¬è´¨æ˜¯ç›’æ¨¡å‹çš„å»¶ä¼¸ï¼Œå®ƒå¯ä»¥è¿›ä¸€æ­¥å»è§„èŒƒå®¹å™¨ä¸­å­å…ƒç´ ç›’æ¨¡å‹ä¹‹é—´çš„ç›¸å¯¹å…³ç³»ã€‚</p>
<h2 id="åŸºç¡€çŸ¥è¯†ç‚¹"><a href="#åŸºç¡€çŸ¥è¯†ç‚¹" class="headerlink" title="åŸºç¡€çŸ¥è¯†ç‚¹"></a>åŸºç¡€çŸ¥è¯†ç‚¹</h2><p><img src="/images/css/css-09.png" alt=""></p>
<p>Flexible boxesç›’å­æŒ‰ç…§å®½å’Œé«˜åˆ†å‡ºäº†<code>main axis</code>(ä¸»è½´)å’Œ<code>cross axis</code>(å’Œä¸»è½´äº¤å‰çš„è½´)ï¼Œç›’å­çš„ä¸Šè¾¹ç§°ä¸º<code>cross start</code>,ä¸‹è¾¹ç§°ä¸º<code>cross end</code>,å·¦è¾¹ç§°ä¸º<code>main start</code>,å³è¾¹ç§°ä¸º<code>main end</code>ã€‚</p>
<h2 id="Flexible-boxeså¯ä»¥è§£å†³ä»€ä¹ˆé—®é¢˜"><a href="#Flexible-boxeså¯ä»¥è§£å†³ä»€ä¹ˆé—®é¢˜" class="headerlink" title="Flexible boxeså¯ä»¥è§£å†³ä»€ä¹ˆé—®é¢˜"></a>Flexible boxeså¯ä»¥è§£å†³ä»€ä¹ˆé—®é¢˜</h2><p><strong>å®Œå…¨å±…ä¸­</strong></p>
<p>åœ¨å‰ç«¯ä¸­å®ç°å±…ä¸­æ˜¯ä¸€ä»¶å¾ˆå¤´ç–¼çš„äº‹æƒ…ï¼Œå°¤å…¶æ˜¯å®ç°å‚ç›´å±…ä¸­ï¼Œä¹‹å‰ç¿»è¯‘äº†ä¸€ç¯‡<a href="/2016/10/28//archivers/seven_ways_of_centering_with_css/" title="å®ç°ç½®ä¸­çš„ä¸ƒç§æ–¹æ³•">å®ç°ç½®ä¸­çš„ä¸ƒç§æ–¹æ³•</a>ï¼Œå…¶ä¸­æåˆ°ä¸€ç§æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨<code>transform</code>ï¼Œéœ€è¦5è¡Œä»£ç å¯ä»¥å®ç°å®Œå…¨ç½®ä¸­ã€‚</p>
<p>ä¸‹é¢çœ‹ä¸€ä¸‹<code>Flexible boxes</code>å®ç°ç½®ä¸­:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-container</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>:flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Flexible boxesåªè¦3è¡Œä»£ç å°±å¯ä»¥å®ç°ç½®ä¸­ã€‚</p>
<p><strong>ç­‰é«˜çš„å¡ç‰‡å¼å¸ƒå±€</strong></p>
<p>åœ¨æ²¡æœ‰ç”¨Flexible boxesä¹‹å‰å¾ˆå¤šå¡ç‰‡è®¾è®¡çš„ç½‘ç«™éƒ½æœ‰è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œç”±äºå¡ç‰‡é‡Œé¢çš„å†…å®¹å¤šå°‘ä¸åŒï¼Œè€Œäº§ç”Ÿçš„ä¸ç­‰é«˜é—®é¢˜ã€‚</p>
<p>Flexible boxesç®€å•çš„å®ç°ç­‰é«˜åˆ—ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-container</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>:flex;</span><br><span class="line">  <span class="attribute">align-items</span>: stretch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Flexible-boxesèƒ½ç”¨åœ¨å“ªé‡Œ"><a href="#Flexible-boxesèƒ½ç”¨åœ¨å“ªé‡Œ" class="headerlink" title="Flexible boxesèƒ½ç”¨åœ¨å“ªé‡Œ"></a>Flexible boxesèƒ½ç”¨åœ¨å“ªé‡Œ</h2><p><strong>å…¼å®¹æ€§</strong></p>
<p><img src="/images/css/css-10.png" alt=""></p>
<p>å¯ä»¥çœ‹å‡ºFlexible boxesä»æå‡ºåˆ°ç°åœ¨ä¹Ÿå·²ç»æœ‰äº†8ä¸ªè‰æ¡ˆã€‚Flexible boxesæ›´æ–°äº†ä¸‰ç§å†™æ³•ã€‚</p>
<p><img src="/images/css/css-11.png" alt=""></p>
<p>caniuseä¸Šå„ä¸ªæµè§ˆå™¨æ”¯æŒçš„æƒ…å†µ</p>
<p><img src="/images/css/css-12.jpg" alt=""></p>
<p>ç¨å¾®æ•´ç†ä¸€ä¸‹(è¿™é‡Œå€Ÿç”¨gitcafeçš„JaychSuçš„å›¾ç”¨ä¸€ä¸‹)</p>
<p>ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒæœ€æ–°çš„é‚£ä¸ªç‰ˆæœ¬,åªæœ‰<code>IE10</code>æ”¯æŒä¸­é—´é‚£ä¸ªç‰ˆæœ¬ã€‚</p>
<p><strong>ä½¿ç”¨CSSé¢„å¤„ç†å™¨å®šä¹‰çš„@mixinè§£å†³Flexible boxesç‰ˆæœ¬å…¼å®¹</strong></p>
<p>åœ¨githubä¸Šæœ‰å¤§ç¥æŠŠFlexible boxesä¸‰ä¸ªç‰ˆæœ¬ææˆä¸€ä¸ªSassçš„<code>@mixin</code>,è¿™æ ·å¯ä»¥åœ¨éœ€è¦çš„åœ°æ–¹ç›´æ¥<code>@include</code>è¿›æ¥å°±å¯ä»¥è½»æ¾è§£å†³ä¸‰ä¸ªç‰ˆæœ¬çš„å…¼å®¹é—®é¢˜ã€‚</p>
<p><a href="https://github.com/mastastealth/sass-flex-mixin" target="_blank" rel="noopener">sasså…³äºFlexible boxesçš„mixinçš„githubé¡¹ç›®åœ°å€</a></p>
<h2 id="Flexible-boxeså®ç°çš„åŸç†é€»è¾‘"><a href="#Flexible-boxeså®ç°çš„åŸç†é€»è¾‘" class="headerlink" title="Flexible boxeså®ç°çš„åŸç†é€»è¾‘"></a>Flexible boxeså®ç°çš„åŸç†é€»è¾‘</h2><p><strong>displayï¼ˆå®šä¹‰å®¹å™¨é‡Œé¢ä¸ºflexæ–‡æ¡£æµï¼‰</strong></p>
<ul>
<li><p><code>dislpay:flex</code>ä½¿çˆ¶å®¹å™¨è¡¨ç°ä¸ºå—ç›’å­</p>
</li>
<li><p><code>display:inline-flex</code>ä½¿å®¹å™¨è¡¨ç°ä¸ºè¡Œç›’å­</p>
</li>
</ul>
<p><strong>flex</strong></p>
<p>flexæ˜¯<code>flex-grow,flex-shrink,flex-basis</code>çš„ç¼©å†™å½¢å¼ã€‚é»˜è®¤å€¼æ˜¯<code>0 1 auto</code>ã€‚</p>
<p><strong>flex-basis</strong></p>
<p>flex-basis:flex-basiså¯ä»¥ç†è§£ä¸ºæˆ‘ä»¬ç»™å­å…ƒç´ è®¾ç½®çš„å®½åº¦ã€‚é»˜è®¤å€¼æ˜¯auto,å®½åº¦è®¾ç½®ä¸ºautoæ—¶ï¼Œç›’å­çš„å®½åº¦å–å†³ä½ ä»¬å…ƒç´ çš„å®½åº¦ã€‚</p>
<p><img src="/images/css/css-13.png" alt=""></p>
<p><strong>flex-growå’Œflex-shrink</strong></p>
<p>growå’Œshrinkæ˜¯ä¸€å¯¹åŒèƒèƒï¼Œgrowè¡¨ç¤ºä¼¸å¼ å› å­ï¼Œshrinkè¡¨ç¤ºæ˜¯æ”¶ç¼©å› å­ã€‚</p>
<p>growåœ¨flexå®¹å™¨ä¸‹çš„å­å…ƒç´ çš„å®½åº¦å’Œæ¯”å®¹å™¨å’Œå°çš„æ—¶å€™èµ·ä½œç”¨ã€‚ growå®šä¹‰äº†å­å…ƒç´ çš„å®½åº¦å¢é•¿å› å­ï¼Œå®¹å™¨ä¸­é™¤å»å­å…ƒç´ ä¹‹å’Œå‰©ä¸‹çš„å®½åº¦ä¼šæŒ‰ç…§å„ä¸ªå­å…ƒç´ çš„gorwå€¼è¿›è¡Œå¹³åˆ†åŠ å¤§å„ä¸ªå­å…ƒç´ ä¸Šã€‚</p>
<p><strong>å…¬å¼ï¼š</strong></p>
<p>è®¡ç®—å®¹å™¨è¿˜å‰©ç©ºé—´</p>
<p><code>available_space(å®¹å™¨è¿˜å‰©çš„ç©ºé—´ï¼‰=container_size(å®¹å™¨å®½åº¦)-flex_item_total(å­å…ƒç´ å®½åº¦ä¹‹å’Œ)</code></p>
<p>è®¡ç®—å¢é•¿å•ä½</p>
<p><code>grow_unit(å¢é•¿å•ä½)=available_space/flex_grow_total(å­å…ƒç´ å¢é•¿å› å­ä¹‹å’Œ)</code></p>
<p>å¾—åˆ°å­å…ƒç´ çš„å®½åº¦</p>
<p><code>flex-item-width(å­å…ƒç´ è®¡ç®—å¾—åˆ°çš„å®½åº¦)=flex-basis+grow-unit*flex-grow</code></p>
<p><img src="/images/css/css-14.png" alt=""></p>
<p>ä¸Šé¢ä¾‹å­çš„è®¡ç®—</p>
<p><code>container-size=480px;
flex-item-total=100*3=300px;
flex-grow-total=3+2+1=6;
available_space=480-300=180px;
grow_unit=180/6=30px;</code></p>
<p>å­å…ƒç´ 1çš„å®½åº¦ä¸ºï¼š</p>
<p><code>flex_item_width1=100+3*30=190px;</code></p>
<p>å­å…ƒç´ 2çš„å®½åº¦ä¸ºï¼š</p>
<p><code>flex_item_width1=100+2*30=160px;</code></p>
<p>å­å…ƒç´ 3çš„å®½åº¦ä¸ºï¼š</p>
<p><code>flex_item_width1=100+30=130px;</code></p>
<p data-height="499" data-theme-id="0" data-slug-hash="pvQZoy" data-user="luxiaojijan" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/luxiaojijan/pen/pvQZoy" target="_blank" rel="noopener">Timer</a> forked by luxiaojijan (<a href="http://codepen.io" target="_blank" rel="noopener">@luxiaojijan</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p>shrinkåˆ™æ˜¯åœ¨å®½åº¦å’Œæ¯”å®¹å™¨å®½åº¦å¤§æ—¶å€™ï¼Œæ‰æœ‰ç”¨ã€‚æŒ‰ç…§shrinkçš„å€¼å‡å»ç›¸åº”å¤§å°å¾—åˆ°å­å…ƒç´ çš„å€¼ã€‚</p>
<p><strong>å…¬å¼ï¼š</strong></p>
<p>overflow_space(æº¢å‡ºçš„å®½åº¦)</p>
<p><strong>è®¡ç®—æº¢å‡ºçš„å®½åº¦</strong></p>
<p><code>overflow-space=flex-item-total(å­å…ƒç´ basiså®½åº¦ä¹‹å’Œ)-container_width(å®¹å™¨å®½åº¦)</code></p>
<p><strong>å¾—åˆ°è®¡ç®—çš„å­å…ƒç´ çš„å®½åº¦</strong></p>
<p><code>item-basis:å­å…ƒç´ è®¾ç½®çš„flex-basisï¼›
item-shrink:å­å…ƒç´ çš„flex-shrinkï¼›
item-shrink-sum:æ‰€æœ‰å­å…ƒç´ flex_shrinkçš„å’Œã€‚     
flex_item_width(è®¡ç®—çš„å­å…ƒç´ çš„å®½åº¦)=item-basis 
--(overflow-space*(item-shrink/item-shrink-sum))</code></p>
<p><img src="/images/css/css-15.png" alt=""></p>
<p><code>container-width=480px; item-shrinkåˆ†åˆ«ä¸º3ï¼Œ2ï¼Œ1.item-basis=200px;  overflow-space=120px;</code></p>
<p>åˆ™ï¼š</p>
<p><code>flex_item1_width=200-(120*(3/6))=140px;
flex_item2_width=200-(120*(2/6))=160px; 
flex_item3_width=200-(120*(1/6))=180px;</code></p>
<p data-height="499" data-theme-id="0" data-slug-hash="GgPOJw" data-user="luxiaojijan" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/luxiaojijan/pen/GgPOJw" target="_blank" rel="noopener">Timer</a> forked by luxiaojijan (<a href="http://codepen.io" target="_blank" rel="noopener">@luxiaojijan</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p><strong>align-content</strong></p>
<p>å¯¹å•è¡Œå’Œå•åˆ—ä¸èµ·ä½œç”¨ï¼Œå¤šè¡Œæ—¶æ‰æœ‰æ•ˆï¼Œéœ€è®¾ç½®<code>flex-direction:row;flex-wrap:wrap;</code>æˆ–è€…<code>flex-flow:row-wrap</code>,å¯¹<code>flex container</code>ä¸­çš„è¡Œè¿›è¡Œå¸ƒå±€æ’ç‰ˆã€‚</p>
<ul>
<li><p><code>flex-start</code>:è¡Œå¡«å……åˆ°å®¹å™¨çš„å¼€å§‹ã€‚</p>
</li>
<li><p><code>flex-bottom</code>:è¡Œå¡«å……åˆ°å®¹å™¨çš„ç»“æŸã€‚</p>
</li>
<li><p><code>center</code>:è¡Œå±…ä¸­åˆ†å¸ƒã€‚</p>
</li>
<li><p><code>space-between</code>:è¡Œå¹³å‡åˆ†å¸ƒï¼Œç¬¬ä¸€è¡Œåœ¨å®¹å™¨å¼€å§‹ï¼Œæœ€åä¸€è¡Œåœ¨å®¹å™¨ç»“æŸã€‚</p>
</li>
<li><p><code>space-around</code>:è¡Œå¹³å‡åˆ†å¸ƒï¼Œä½†è¡Œä¸è¡Œä¹‹é—´æœ‰ç©ºéš™ã€‚</p>
</li>
</ul>
<p><strong>å®ä¾‹æ•ˆæœ</strong></p>
<p data-height="499" data-theme-id="0" data-slug-hash="wBRebG" data-user="luxiaojijan" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/luxiaojijan/pen/wBRebG" target="_blank" rel="noopener">Timer</a> forked by luxiaojijan (<a href="http://codepen.io" target="_blank" rel="noopener">@luxiaojijan</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p><strong>align-items</strong></p>
<p>ç”¨äºå½“å‰è¡Œä¸­çš„å­å…ƒç´ è¿›è¡Œå¯¹é½å¸ƒå±€ã€‚</p>
<ul>
<li><p><code>flex-start</code>: å­å…ƒç´ çš„ä¸Šè¾¹ç¼˜å¯¹é½åˆ°è¡Œçš„ä¸Šè¾¹ç¼˜ã€‚</p>
</li>
<li><p><code>flex-end</code>: å­å…ƒç´ çš„ä¸Šè¾¹ç¼˜å¯¹é½åˆ°è¡Œçš„ä¸‹è¾¹ç¼˜ã€‚</p>
</li>
<li><p><code>center</code>: ä»¥ä¸­è½´çº¿å±…ä¸­ã€‚</p>
</li>
<li><p><code>baseline</code>: å­å…ƒç´ çš„åŸºçº¿å¯¹é½ã€‚</p>
</li>
<li><p><code>stretch</code>:å­å…ƒç´ æ‹‰ä¼¸è‡³å……æ»¡å®¹å™¨ã€‚</p>
</li>
</ul>
<p data-height="499" data-theme-id="0" data-slug-hash="ZYVJeR" data-user="luxiaojijan" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/luxiaojijan/pen/ZYVJeR" target="_blank" rel="noopener">Timer</a> forked by luxiaojijan (<a href="http://codepen.io" target="_blank" rel="noopener">@luxiaojijan</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p><strong>align-self</strong></p>
<p>åº”ç”¨åœ¨å­å…ƒç´ ä¸Šï¼Œå¯ä»¥è¦†ç›–<code>align-item</code>æ¥è·å¾—ç‰¹æ®Šçš„å…ƒç´ å¯¹é½ã€‚</p>
<ul>
<li><p><code>flex-start</code>: å­å…ƒç´ çš„ä¸Šè¾¹ç¼˜å¯¹é½åˆ°è¡Œçš„ä¸Šè¾¹ç¼˜ã€‚</p>
</li>
<li><p><code>flex-end</code>: å­å…ƒç´ çš„ä¸Šè¾¹ç¼˜å¯¹é½åˆ°è¡Œçš„ä¸‹è¾¹ç¼˜ã€‚</p>
</li>
<li><p><code>center</code>: ä»¥ä¸­è½´çº¿å±…ä¸­ã€‚</p>
</li>
<li><p><code>baseline</code>: å­å…ƒç´ çš„åŸºçº¿å¯¹é½ã€‚</p>
</li>
<li><p><code>stretch</code>:å­å…ƒç´ æ‹‰ä¼¸è‡³å……æ»¡å®¹å™¨ã€‚</p>
</li>
</ul>
<p><strong>å®ä¾‹æ•ˆæœ</strong></p>
<p data-height="499" data-theme-id="0" data-slug-hash="gbZxRM" data-user="luxiaojijan" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/luxiaojijan/pen/gbZxRM" target="_blank" rel="noopener">Timer</a> forked by luxiaojijan (<a href="http://codepen.io" target="_blank" rel="noopener">@luxiaojijan</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p>ä¸€ä¸ªåˆ©ç”¨<code>align-self</code>æ¥æ”¹å˜é»˜è®¤<code>align-items</code>æ’ç‰ˆçš„ä¾‹å­</p>
<p data-height="499" data-theme-id="0" data-slug-hash="MYZvoX" data-user="luxiaojijan" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/luxiaojijan/pen/MYZvoX" target="_blank" rel="noopener">Timer</a> forked by luxiaojijan (<a href="http://codepen.io" target="_blank" rel="noopener">@luxiaojijan</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p><strong>justify-content</strong></p>
<ul>
<li><p><code>flex-start</code>: å­å…ƒç´ é å®¹å™¨çš„å·¦è¾¹çº¿å¯¹é½</p>
</li>
<li><p><code>flex-end</code>: å­å…ƒç´ é å®¹å™¨çš„å³è¾¹çº¿å¯¹é½</p>
</li>
<li><p><code>center</code>: ä»¥ä¸­è½´çº¿å±…ä¸­ã€‚</p>
</li>
<li><p><code>space-between</code>: å­å…ƒç´ è¢«å¹³å‡åˆ†å¸ƒ,ç¬¬ä¸€å­å…ƒç´ åœ¨å®¹å™¨æœ€å·¦è¾¹ï¼Œæœ€åä¸€ä¸ªå­å…ƒç´ åœ¨æœ€å³è¾¹</p>
</li>
<li><p><code>space-around</code>:å­å…ƒç´ å¹³å‡åˆ†å¸ƒï¼Œä½†å­å…ƒç´ ä¸å­å…ƒç´ ä¹‹é—´æœ‰ç©ºéš™</p>
</li>
</ul>
<p><strong>å®ä¾‹æ•ˆæœ</strong></p>
<p data-height="499" data-theme-id="0" data-slug-hash="KwbRJe" data-user="luxiaojijan" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/luxiaojijan/pen/KwbRJe" target="_blank" rel="noopener">Timer</a> forked by luxiaojijan (<a href="http://codepen.io" target="_blank" rel="noopener">@luxiaojijan</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p><strong>order</strong></p>
<p>ç”¨æ¥æ”¹å˜å­å…ƒç´ ä¹‹é—´çš„æ’åˆ—å¾ªåºï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œå€¼è¶Šå°ï¼Œè¶Šå¾€å‰æ’ã€‚</p>
<p><img src="/images/css/css-16.png" alt=""></p>
<h2 id="Flexible-boxesè§£å†³çš„ä¸€äº›é—®é¢˜ã€‚"><a href="#Flexible-boxesè§£å†³çš„ä¸€äº›é—®é¢˜ã€‚" class="headerlink" title="Flexible boxesè§£å†³çš„ä¸€äº›é—®é¢˜ã€‚"></a>Flexible boxesè§£å†³çš„ä¸€äº›é—®é¢˜ã€‚</h2><p><strong>ä¼˜é›…çš„å®ç°å“åº”å¼å¸ƒå±€ã€‚</strong></p>
<p><img src="/images/css/css-17.gif" alt=""></p>
<p data-height="499" data-theme-id="0" data-slug-hash="EaGrOy" data-user="luxiaojijan" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/luxiaojijan/pen/EaGrOy" target="_blank" rel="noopener">Timer</a> forked by luxiaojijan (<a href="http://codepen.io" target="_blank" rel="noopener">@luxiaojijan</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p><strong>æœ€ç®€æ´çš„å®ç°åª’ä½“å¯¹è±¡æ•ˆæœã€‚ï¼ˆä¸éœ€è¦æµ®åŠ¨å’Œåˆ›å»ºBFCå“¦ï¼ï¼‰</strong></p>
<p data-height="499" data-theme-id="0" data-slug-hash="ZYVwVY" data-user="luxiaojijan" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/luxiaojijan/pen/ZYVwVY" target="_blank" rel="noopener">Timer</a> forked by luxiaojijan (<a href="http://codepen.io" target="_blank" rel="noopener">@luxiaojijan</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<h2 id="å…³äºFlexible-boxesçš„ä¸€äº›æ–‡ç« "><a href="#å…³äºFlexible-boxesçš„ä¸€äº›æ–‡ç« " class="headerlink" title="å…³äºFlexible boxesçš„ä¸€äº›æ–‡ç« "></a>å…³äºFlexible boxesçš„ä¸€äº›æ–‡ç« </h2><ul>
<li><a href="http://philipwalton.github.io/solved-by-Flexible boxes/" target="_blank" rel="noopener">Solved by Flexible boxes</a></li>
<li><a href="https://css-tricks.com/snippets/css/a-guide-to-Flexible boxes/" target="_blank" rel="noopener">A Complete Guide to Flexible boxes</a></li>
<li><a href="http://chriswrightdesign.com/experiments/Flexible boxes-adventures/" target="_blank" rel="noopener">Flexible boxes adventures</a></li>
</ul>
<script src="http://codepen.io/assets/embed/ei.js"> </script>

<p>å‡ºå¤„æ¥è‡ªï¼š<a href="http://www.w3cplus.com/css3/flexboxgeng-jia-you-ya-de-webbu-ju.html" target="_blank" rel="noopener">Flexible boxesæ›´åŠ ä¼˜é›…çš„Webå¸ƒå±€</a></p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptçš„æ¨¡å—ç®€å²]]></title>
      <url>https://lucius0.github.io/2016/11/02/archivers/brief-history-of-js-modules/</url>
      <content type="html"><![CDATA[<p><a href="https://medium.com/@sungyeol.choi/javascript-module-module-loader-module-bundler-es6-module-confused-yet-6343510e7bde#.j3e1w7v9r" target="_blank" rel="noopener">åŸæ–‡</a></p>
<p>ä½ æ˜¯å¦åˆšå…¥é—¨JavaScriptå¹¶ä¸”ç»å¸¸è¢«æ¨¡å—ã€æ¨¡å—åŠ è½½å™¨å’Œæ¨¡å—æ‰“åŒ…å™¨æ··æ·†ï¼Ÿæˆ–è€…ä½ å·²ç»å†™è¿‡ä¸€æ®µæ—¶é—´çš„JavaScriptäº†ï¼Œä½†æ˜¯è¿˜æ˜¯æ— æ³•æŒæ¡æ¨¡å—çš„ä¸“ä¸šç”¨è¯­ï¼Ÿä½ å¯èƒ½å¬è¿‡çš„ä¸“ä¸šç”¨è¯­ä¾‹å¦‚æœ‰<strong>CommonJSï¼ŒAMDï¼ŒBrowserifyï¼ŒSystemJSï¼ŒWebpackï¼ŒJSPM</strong>ç­‰ç­‰ã€‚ä½†æ˜¯å°±æ˜¯ä¸çŸ¥é“æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦å®ƒä»¬ã€‚</p>
<p>æˆ‘å°†ä¼šå°½æˆ‘æ‰€èƒ½çš„å»è§£é‡Šå®ƒä»¬æ˜¯ä»€ä¹ˆï¼Œèƒ½è§£å†³ä»€ä¹ˆæ ·çš„é—®é¢˜ï¼Œä»¥åŠæ˜¯æ€ä¹ˆæ ·å»è§£å†³é—®é¢˜çš„ã€‚</p>
<h2 id="ç¤ºä¾‹ç¨‹åº"><a href="#ç¤ºä¾‹ç¨‹åº" class="headerlink" title="ç¤ºä¾‹ç¨‹åº"></a>ç¤ºä¾‹ç¨‹åº</h2><p><img src="/images/javascript/js-01.png" alt=""></p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä¼šç”¨ä¸€ä¸ªç®€å•çš„ç½‘é¡µåº”ç”¨ç¨‹åºå»æ¼”ç¤ºå…³äºæ¨¡å—çš„æ¦‚å¿µã€‚åœ¨æµè§ˆå™¨ä¸Šè¯¥ç¨‹åºå±•ç¤ºäº†æ•°ç»„çš„å’Œã€‚å®ƒç”±4ä¸ªå‡½æ•°è·Ÿä¸€ä¸ª<em>index.html</em>ç»„æˆã€‚</p>
<p><img src="/images/javascript/js-02.jpeg" alt=""></p>
<p>mainå‡½æ•°è®¡ç®—æ•°ç»„çš„å’Œå¹¶æŠŠç­”æ¡ˆåœ¨<code>span#answer</code>å±•ç¤ºã€‚sumå‡½æ•°ä¾èµ–ä¸¤ä¸ªå‡½æ•°ï¼š<code>add</code>è·Ÿ<code>reduce</code>ã€‚<code>add</code>å‡½æ•°çš„ä½œç”¨é¡¾åæ€ä¹‰ï¼›å³ä¸¤æ•°å­—ç›¸åŠ ã€‚<code>reduce</code>å‡½æ•°ä¼šéå†æ•°ç»„å¹¶ä¸”è°ƒç”¨<code>iteratee</code>å›è°ƒå‡½æ•°ã€‚</p>
<p>èŠ±ç‚¹æ—¶é—´ç†è§£ä¸€ä¸‹ä»¥ä¸‹çš„ä»£ç ã€‚æˆ‘ä¼šåœ¨è¿™ç¯‡æ–‡ç« åå¤çš„ä½¿ç”¨åŒæ ·çš„å‡½æ•°ã€‚</p>
<p>0-index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>JS Modules<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">	The Answer is</span><br><span class="line">	<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"answer"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>1-main.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> values = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> ];</span><br><span class="line"><span class="keyword">var</span> answer = sum(values)</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"answer"</span>).innerHTML = answer;</span><br></pre></td></tr></table></figure>
<p>2-sum.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> reduce(arr, add);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3-add.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4-reduce.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reduce</span>(<span class="params">arr, iteratee</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> index = <span class="number">0</span>,</span><br><span class="line">    length = arr.length,</span><br><span class="line">    memo = arr[index];</span><br><span class="line">  <span class="keyword">for</span>(index += <span class="number">1</span>; index &lt; length; index += <span class="number">1</span>)&#123;</span><br><span class="line">    memo = iteratee(memo, arr[index])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> memo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹å¦‚ä½•å°†è¿™äº›ç¢ç‰‡åŒ–çš„ä»£ç æ‹¼æ¥åœ¨ä¸€èµ·åˆ›å»ºä¸€ä¸ªåº”ç”¨ã€‚</p>
<h2 id="å†…åµŒè„šæœ¬"><a href="#å†…åµŒè„šæœ¬" class="headerlink" title="å†…åµŒè„šæœ¬"></a>å†…åµŒè„šæœ¬</h2><p>å†…åµŒè„šæœ¬å°±æ˜¯å½“ä½ åœ¨<code>&lt;script&gt;&lt;/script&gt;</code>æ ‡ç­¾æ·»åŠ <code>JavaScript</code>ä»£ç ã€‚æˆ‘ç›¸ä¿¡å¤§å¤šæ•°çš„JavaScriptå¼€å‘è€…åœ¨ä»–ä»¬çš„äººç”Ÿä¸­è‡³å°‘æœ‰è¿‡ä¸€æ¬¡è¿™æ ·å­åšè¿‡ã€‚</p>
<p>è¿™æ˜¯ä¸€ç§å¾ˆå¥½çš„å¼€å§‹æ–¹å¼ã€‚ä¸éœ€è¦æ‹…å¿ƒå¤–éƒ¨è„šæœ¬æˆ–è€…ä¾èµ–å…³ç³»ã€‚ä½†åŒæ ·ä¹Ÿå¸¦æ¥äº†ä¸å¯ç»´æŠ¤çš„ä»£ç ã€‚åŸå› å¦‚ä¸‹ï¼š</p>
<ul>
<li><p><strong>ç¼ºä¹ä»£ç å¯é‡ç”¨æ€§ï¼š</strong>å‡å¦‚æˆ‘ä»¬éœ€è¦æ·»åŠ å¦ä¸€ä¸ªé¡µé¢å’Œéœ€è¦åœ¨æœ¬é¡µçš„ä¸€äº›å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åªèƒ½å¤åˆ¶è·Ÿé»è´´æˆ‘ä»¬æ‰€éœ€è¦çš„ä»£ç ã€‚</p>
</li>
<li><p><strong>ç¼ºä¹ä¾èµ–è§£æï¼š</strong>ä½ å¾—ä¿è¯åœ¨<code>main</code>å‡½æ•°ä¹‹å‰å°±å­˜åœ¨<code>add,reduce,sum</code>å‡½æ•°è„šæœ¬ã€‚</p>
</li>
<li><p><strong>å…¨å±€å˜é‡åæ±¡æŸ“ï¼š</strong>æ‰€æœ‰çš„å˜é‡è·Ÿå‡½æ•°éƒ½æ˜¯å‚¨å­˜åœ¨å…¨å±€å˜é‡ä½œç”¨åŸŸé‡Œé¢ã€‚</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JS Modules<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">      The Answer is</span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"answer"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> a + b;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">reduce</span>(<span class="params">arr, iteratee</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> index = <span class="number">0</span>,</span></span><br><span class="line"><span class="undefined">          length = arr.length,</span></span><br><span class="line"><span class="undefined">          memo = arr[index];</span></span><br><span class="line"><span class="javascript">        <span class="keyword">for</span>(index += <span class="number">1</span>; index &lt; length; index += <span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="undefined">          memo = iteratee(memo, arr[index])</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> memo;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">arr</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> reduce(arr, add);</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="javascript">      <span class="comment">/* Main Function */</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> values = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> ];</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> answer = sum(values)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">document</span>.getElementById(<span class="string">"answer"</span>).innerHTML = answer;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="å¼•å…¥å¤–éƒ¨è„šæœ¬æ ‡ç­¾"><a href="#å¼•å…¥å¤–éƒ¨è„šæœ¬æ ‡ç­¾" class="headerlink" title="å¼•å…¥å¤–éƒ¨è„šæœ¬æ ‡ç­¾"></a>å¼•å…¥å¤–éƒ¨è„šæœ¬æ ‡ç­¾</h2><p>è¿™æ˜¯ä»åµŒå…¥è„šæœ¬çš„ä¸€ç§è‡ªç„¶çš„è¿‡åº¦ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†ä¸€å¤§å—JavaScriptä»£ç åˆ’åˆ†æˆå‡ å°å—çš„è„šæœ¬æ–‡ä»¶å¹¶é€šè¿‡<code>&lt;script src=&#39;...&#39;&gt;&lt;/script&gt;</code>æ ‡ç­¾æ¥åŠ è½½ã€‚</p>
<p>é€šè¿‡åˆ†ç¦»çš„æ–‡ä»¶æˆ‘ä»¬å¯ä»¥å®ç°ä»£ç çš„å¤ç”¨ã€‚æˆ‘ä»¬ä¹Ÿä¸å†éœ€è¦åœ¨ä¸åŒçš„é¡µé¢å¤åˆ¶è·Ÿé»è´´ä»£ç ã€‚æˆ‘ä»¬åªè¦ç®€å•åœ°é€šè¿‡<code>&lt;script&gt;&lt;/script&gt;</code>æ ‡ç­¾å¼•å…¥æ–‡ä»¶ã€‚è¿™ç§æ–¹æ³•è™½ç„¶æ¯”è¾ƒå¥½ï¼Œä½†æ˜¯è¿˜æ˜¯å­˜åœ¨åŒæ ·çš„å‡ ç§é—®é¢˜ï¼š</p>
<ul>
<li><p><strong>ç¼ºä¹ä¾èµ–è§£æï¼š</strong>æ–‡ä»¶çš„æ’åºå¾ˆé‡è¦ã€‚ä½ éœ€è¦åœ¨<em>main.js</em>ä¹‹å‰å¼•å…¥äº†<em>add.js, reduce.js, add.js</em>ã€‚</p>
</li>
<li><p><strong>å…¨å±€å˜é‡æ±¡æŸ“ï¼š</strong>æ‰€æœ‰çš„å‡½æ•°è·Ÿå˜é‡ä¾æ—§æš´éœ²åœ¨å…¨å±€ä½œç”¨åŸŸèŒƒå›´å†…ã€‚</p>
</li>
</ul>
<p>0-index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JS Modules<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">      The Answer is</span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"answer"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./add.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./reduce.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./sum.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>1-add.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//add.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2-reduce.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//reduce.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reduce</span>(<span class="params">arr, iteratee</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> index = <span class="number">0</span>,</span><br><span class="line">    length = arr.length,</span><br><span class="line">    memo = arr[index];</span><br><span class="line"></span><br><span class="line">  index += <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(; index &lt; length; index += <span class="number">1</span>)&#123;</span><br><span class="line">    memo = iteratee(memo, arr[index])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> memo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3-sum.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sum.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> reduce(arr, add);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4-main.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">var</span> values = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> ];</span><br><span class="line"><span class="keyword">var</span> answer = sum(values)</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"answer"</span>).innerHTML = answer;</span><br></pre></td></tr></table></figure>
<h2 id="æ¨¡å—å¯¹è±¡ä»¥åŠIIFE"><a href="#æ¨¡å—å¯¹è±¡ä»¥åŠIIFE" class="headerlink" title="æ¨¡å—å¯¹è±¡ä»¥åŠIIFE"></a>æ¨¡å—å¯¹è±¡ä»¥åŠIIFE</h2><p>é€šè¿‡ä½¿ç”¨æ¨¡å—å¯¹è±¡å’Œ<a href="https://en.wikipedia.org/wiki/Immediately-invoked_function_expression" target="_blank" rel="noopener">ç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼IIFE</a>ï¼Œæˆ‘ä»¬å¯ä»¥å‡å°‘å…¨å±€ä½œç”¨åŸŸæ±¡æŸ“ã€‚åœ¨è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬ä»…ä»…æš´éœ²äº†ä¸€ä¸ªå¯¹è±¡åœ¨å…¨å±€ä½œç”¨åŸŸã€‚è¯¥å¯¹è±¡åŒ…å«äº†æ‰€æœ‰çš„æˆ‘ä»¬æ‰€éœ€è¦çš„å‡½æ•°è·Ÿå€¼åœ¨æˆ‘ä»¬çš„åº”ç”¨é‡Œé¢ã€‚åœ¨è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åªæš´éœ²äº†<code>myApp</code>å¯¹è±¡ç»™å…¨å±€ä½œç”¨åŸŸã€‚æ‰€æœ‰çš„å‡½æ•°å°†ä¼šåœ¨<code>myApp</code>å¯¹è±¡æ‰€æ”¯æŒã€‚</p>
<p>01-my-app.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myApp = &#123;&#125;;</span><br></pre></td></tr></table></figure>
<p>02-add.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  myApp.add = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>03-reduce.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  myApp.reduce = <span class="function"><span class="keyword">function</span>(<span class="params">arr, iteratee</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>,</span><br><span class="line">      length = arr.length,</span><br><span class="line">      memo = arr[index];</span><br><span class="line">  </span><br><span class="line">    index += <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; index &lt; length; index += <span class="number">1</span>)&#123;</span><br><span class="line">      memo = iteratee(memo, arr[index])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> memo;</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>04-sum.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  myApp.sum = <span class="function"><span class="keyword">function</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> myApp.reduce(arr, myUtil.add);</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>05-main.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">app</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> values = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> ];</span><br><span class="line">  <span class="keyword">var</span> answer = app.sum(values)</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"answer"</span>).innerHTML = answer;</span><br><span class="line">&#125;)(myApp);</span><br></pre></td></tr></table></figure>
<p>06-index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JS Modules<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">      The Answer is</span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"answer"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./my-app.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./add.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./reduce.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./sum.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ä¸€ç‚¹ä»¥ä¸Šçš„æ–‡ä»¶é™¤äº†<em>myApp.js</em>ç°åœ¨éƒ½åŒ…è£…æˆIIFEæ ¼å¼ã€‚</p>
<p><code>(function(){ /*... your code goes here ...*/ })();</code></p>
<p>é€šè¿‡å°†æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½åŒ…è£…æˆIIFEï¼Œæ‰€æœ‰çš„æœ¬åœ°å˜é‡éƒ½åœ¨å‡½æ•°ä½œç”¨åŸŸé‡Œé¢ã€‚å› æ­¤ä¸ä¼šå¯¹å…¨å±€é€ æˆæ±¡æŸ“ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡é™„åŠ <code>add, reduce, sum</code>åˆ°<code>myApp</code>å¯¹è±¡æ¥æš´éœ²å®ƒä»¬ã€‚æˆ‘ä»¬åªè¦å¼•ç”¨<code>myApp</code>å¯¹è±¡å°±èƒ½è°ƒç”¨è¿™äº›æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">myApp.add(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">myApp.sum([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]);</span><br><span class="line">myApp.reduce(add, value);</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å¾€IIFEä¼ é€’<code>myApp</code>å…¨å±€å¯¹è±¡ä½œä¸ºå®ƒçš„å‚æ•°ï¼Œå°±åƒ<code>main.js</code>æ–‡ä»¶æ‰€ç¤ºã€‚é€šè¿‡ç»™IIFEä¼ é€’å‚æ•°å¯¹è±¡ï¼Œå¹¶å¯ä»¥ä¸ºè¯¥å¯¹è±¡è®¾ç½®ä¸ºçŸ­åˆ«åã€‚è¿™æ ·æˆ‘ä»¬çš„ä»£ç å°±ä¼šç¨å¾®ç®€çŸ­ä¸€ç‚¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// obj is new veryLongNameOfGlobalObject</span></span><br><span class="line">&#125;)(veryLongNameOfGloablObject);</span><br></pre></td></tr></table></figure>
<p>è¿™ç›¸å¯¹äºä¸Šä¸€ä¸ªä¾‹å­æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ”¹è¿›ã€‚å¹¶ä¸”å¤§éƒ¨åˆ†çš„jsåº“éƒ½æ˜¯é‡‡ç”¨è¿™æ ·çš„æ¨¡å¼ï¼ŒåŒ…æ‹¬jqã€‚Jqæš´éœ²ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œ$ï¼Œè¿™æ ·æ‰€æœ‰çš„å‡½æ•°éƒ½åœ¨<code>$</code>çš„å¯¹è±¡é‡Œé¢ã€‚</p>
<p>æ˜¯çš„ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå®Œç¾çš„è§£å†³æ–¹æ¡ˆã€‚è¿™ä¸ªæ–¹æ³•æ‚£æœ‰è·Ÿä¸Šä¸€ä¸ªæ¡ˆä¾‹åŒæ ·çš„é—®é¢˜ã€‚</p>
<ul>
<li><p><strong>ç¼ºä¹ä¾èµ–è§£æï¼š</strong>æ–‡ä»¶çš„æ’åºå¾ˆé‡è¦ã€‚ä½ éœ€è¦åœ¨<em>main.js</em>ä¹‹å‰å¼•å…¥äº†<em>add.js, reduce.js, add.js</em>ã€‚</p>
</li>
<li><p><strong>å…¨å±€å˜é‡æ±¡æŸ“ï¼š</strong>å…¨å±€å˜é‡çš„æ•°é‡ç°åœ¨æ˜¯1ï¼Œè€Œä¸æ˜¯0ã€‚</p>
</li>
</ul>
<h2 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h2><p>åœ¨2009å¹´ï¼Œå‡ºç°å…³äºè¦æŠŠJavaScriptå¸¦åˆ°æœåŠ¡ç«¯çš„è¯é¢˜ã€‚äºæ˜¯ï¼ŒServerJsè¯ç”Ÿäº†ã€‚åæ¥ServerJsæ”¹åä¸ºCommonJSã€‚</p>
<p>CommonJSä¸æ˜¯ä¸€ä¸ªJavaScriptåº“ï¼Œè€Œæ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–ç»„ç»‡ã€‚å®ƒå°±è·ŸECMAæˆ–è€…W3Cä¸€æ ·ã€‚ECMAåˆ¶å®šäº†JavaScriptè¯­è¨€çš„è§„èŒƒã€‚W3Cåˆ¶å®šäº†JavaScriptç½‘é¡µAPIï¼Œä¾‹å¦‚DOMæˆ–è€…DOMäº‹ä»¶ã€‚CommonJSçš„ç›®æ ‡æ˜¯ä¸ºç½‘é¡µæœåŠ¡å™¨ï¼Œæ¡Œé¢ç¨‹åºï¼Œå‘½ä»¤è¡Œåº”ç”¨ç¨‹åºåˆ¶å®šä¸€å¥—é€šç”¨çš„APIã€‚</p>
<p>CommonJSåŒæ ·ä¸ºæ¨¡å—åˆ¶å®šAPIã€‚åœ¨æœåŠ¡ç«¯åº”ç”¨ç¨‹åºæ˜¯æ²¡æœ‰HTMLé¡µé¢ï¼Œä¹Ÿæ²¡æœ‰<code>&lt;script&gt;</code>æ ‡ç­¾ï¼Œå› æ­¤ä¸ºæ¨¡å—åˆ¶å®šä¸€å¥—æ¸…æ™°çš„APIå°±æ˜¾å¾—ååˆ†æœ‰æ„ä¹‰äº†ã€‚æ¨¡å—éœ€è¦æš´éœ²(<strong>export</strong>)ç»™å…¶ä»–æ¨¡å—ä½¿ç”¨ï¼Œå¹¶ä¸”è¿˜æ˜¯å¯è®¿é—®æ€§çš„(<strong>import</strong>)ã€‚å®ƒçš„æ¨¡å—è¾“å‡ºè¯­æ³•å°±åƒä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç å®šä¹‰å’Œè¾“å‡ºäº†ä¸€ä¸ªæ¨¡å—ï¼Œå¹¶ä¸”ä¿å­˜åœ¨<code>add.js</code>æ–‡ä»¶é‡Œé¢ã€‚</p>
<p>ä¸ºäº†ä½¿ç”¨å’Œå¼•å…¥<code>add</code>æ¨¡å—ï¼Œä½ éœ€è¦å°†æ–‡ä»¶åæˆ–è€…æ¨¡å—åä¼ å‚ç»™<code>require</code>å‡½æ•°ã€‚ä¸‹é¢å°±æ˜¯å¦‚ä½•å¼•å…¥æ¨¡å—çš„è¯­æ³•æè¿°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> add = <span class="built_in">require</span>(â€˜./addâ€™);</span><br></pre></td></tr></table></figure>
<p>å‡å¦‚ä½ æœ‰å†™è¿‡NodeJSï¼Œè¿™ç§è¯­æ³•ä¼šçœ‹èµ·æ¥ååˆ†çš„ç†Ÿæ‚‰ã€‚è¿™æ˜¯å› ä¸ºNodeJSå®ç°äº†CommonJSé£æ ¼çš„æ¨¡å—APIã€‚</p>
<h2 id="Asynchronous-Module-Definition-AMD"><a href="#Asynchronous-Module-Definition-AMD" class="headerlink" title="Asynchronous Module Definition(AMD)"></a>Asynchronous Module Definition(AMD)</h2><p>CommonJSå¸¦æ¥çš„é—®é¢˜å°±æ˜¯æ¨¡å—çš„å®šä¹‰æ˜¯åŒæ­¥çš„ã€‚å½“ä½ è°ƒç”¨<code>â€˜var add=require(â€˜addâ€™);</code>ï¼Œç³»ç»Ÿä¼šæš‚åœç›´åˆ°æ¨¡å—å‡†å¤‡å¥½äº†ã€‚æ„æ€å°±æ˜¯è¿™è¡Œä»£ç ä¼šä½¿æµè§ˆå™¨å‘ç”Ÿé˜»å¡ç›´åˆ°æ‰€æœ‰çš„æ¨¡å—éƒ½åŠ è½½å®Œæ¯•ã€‚å› æ­¤è¿™ä¹Ÿä¸æ˜¯åœ¨æµè§ˆå™¨ç«¯å®šä¹‰æ¨¡å—åº”ç”¨çš„æœ€ä½³æ–¹æ³•ã€‚</p>
<p>ä¸ºäº†å°†æœåŠ¡ç«¯çš„è¯­æ³•è½¬ç§»åˆ°å®¢æˆ·ç«¯çš„è¯­æ³•ï¼ŒCommonJSæå‡ºäº†å‡ ç§æ¨¡å—æ ¼å¼ï¼Œâ€Module/Transferâ€ã€‚å…¶ä¸­ä¸€ä¸ªææ¡ˆå°±æ˜¯ï¼Œâ€Module/Transfer/Câ€ï¼Œåæ¥å°±æˆäº†<a href="https://github.com/amdjs/amdjs-api/blob/master/AMD.md" target="_blank" rel="noopener">AMD</a>ã€‚</p>
<p>AMDçš„æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define([â€˜addâ€™, â€˜reduceâ€™], <span class="function"><span class="keyword">function</span>(<span class="params">add, reduce</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;...&#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„<code>define</code>è¿™ä¸ªå‡½æ•°(æˆ–è€…è¯´å…³é”®å­—)ç”¨ä¾èµ–åˆ—è¡¨å’Œå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚å‚æ•°é‡Œçš„å›è°ƒå‡½æ•°è·Ÿä¾èµ–åˆ—è¡¨çš„é¡ºåºä¸€ä¸€å¯¹åº”ã€‚è¿™è·Ÿæ¨¡å—å¯¼å…¥æ— å·®åˆ«ï¼Œå¹¶ä¸”å›è°ƒå‡½æ•°è¿”å›çš„å€¼å°±æ˜¯è¾“å‡º(<code>export</code>)çš„å€¼ã€‚</p>
<p>CommonJSå’ŒAMDåŒæ—¶è§£å†³äº†æ¨¡å—æ¨¡å¼å¸¦æ¥çš„ä¸¤ä¸ªé—ç•™é—®é¢˜ï¼š<strong>ä¾èµ–è§£æ</strong>å’Œ<strong>å…¨å±€ä½œç”¨åŸŸæ±¡æŸ“</strong>ï¼šæˆ‘ä»¬åªéœ€è¦å…³å¿ƒæ¯ä¸ªæ¨¡å—æˆ–è€…æ¯ä¸ªæ–‡ä»¶çš„ä¾èµ–å…³ç³»ï¼Œå’Œæ˜¯å¦å­˜åœ¨å…¨å±€ä½œç”¨åŸŸæ±¡æŸ“é—®é¢˜ã€‚ã€‚</p>
<h2 id="RequireJS"><a href="#RequireJS" class="headerlink" title="RequireJS"></a>RequireJS</h2><p>AMDå¯ä»¥å¸®æˆ‘ä»¬è§£å†³æµè§ˆå™¨åº”ç”¨ç¨‹åºä¸­çš„è„šæœ¬æ ‡ç­¾è·Ÿå…¨å±€æ±¡æŸ“çš„é—®é¢˜ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ä½¿ç”¨å®ƒå‘¢ï¼ŸRequireJSå‡ºç°äº†ã€‚RequireJSæ˜¯Javascriptçš„<strong>æ¨¡å—åŠ è½½å™¨</strong>ã€‚å®ƒçš„ä½œç”¨å°±æ˜¯å¸®åŠ©æˆ‘ä»¬å¼‚æ­¥åŠ è½½æˆ‘ä»¬æ‰€éœ€çš„æ¨¡å—ã€‚</p>
<p>ä»Šæ™šå®ƒçš„åå­—å¸¦æœ‰<code>require</code>ï¼Œä½†æ˜¯å®ƒçš„ç›®æ ‡å¹¶ä¸æ˜¯æ”¯æŒCommonJSçš„<code>require</code>è¯­æ³•ã€‚æœ‰äº†RequireJSï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™AMDé£æ ¼çš„æ¨¡å—ã€‚ã€‚</p>
<p>åœ¨ä½ å¼€å§‹å†™ç¨‹åºä¹‹å‰ï¼Œä½ éœ€è¦åˆ°<a href="http://requirejs.org/docs/start.html" target="_blank" rel="noopener">RequireJS website</a>ä¸‹è½½<em>require.js</em>æ–‡ä»¶ã€‚å¦‚ä¸‹å°±æ˜¯ç”¨RequireJSé£æ ¼ç¼–å†™çš„ä¾‹å­ã€‚</p>
<p>0-index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JS Modules<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">      The Answer is</span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"answer"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">data-main</span>=<span class="string">"main"</span> <span class="attr">src</span>=<span class="string">"require.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>1-main.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line">define([<span class="string">'sum'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">sum</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> values = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> ];</span><br><span class="line">  <span class="keyword">var</span> answer = sum(values)</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"answer"</span>).innerHTML = answer;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>2-sum.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add.js</span></span><br><span class="line">define([], <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> add;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>3-add.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add.js</span></span><br><span class="line">define([], <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> add;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>4-reduce.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// reduce.js</span></span><br><span class="line">define([], <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> reduce = <span class="function"><span class="keyword">function</span>(<span class="params">arr, iteratee</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>,</span><br><span class="line">      length = arr.length,</span><br><span class="line">      memo = arr[index];</span><br><span class="line"></span><br><span class="line">    index += <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; index &lt; length; index += <span class="number">1</span>)&#123;</span><br><span class="line">      memo = iteratee(memo, arr[index])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> memo;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> reduce;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åœ¨index.htmlæ–‡ä»¶åªæœ‰ä¸€ä¸ªè„šæœ¬æ ‡ç­¾</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">data-main</span>=<span class="string">â€mainâ€</span> <span class="attr">src</span>=<span class="string">â€require.jsâ€</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¯¥é¡µé¢åŠ è½½äº†<code>require.js</code>ï¼Œå¹¶ä¸”<code>data-main=&#39;main&#39;</code>å±æ€§é€šçŸ¥RequireJsåœ¨è¿™ä¸ªé¡µé¢å“ªé‡Œæ˜¯å¼€å§‹èŠ‚ç‚¹ã€‚é€šå¸¸é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå‡å®šæ‰€æœ‰çš„æ–‡ä»¶éƒ½æœ‰<em>â€˜.jsâ€™</em>æ‰©å±•åï¼Œå› æ­¤å¯ä»¥å¿½ç•¥<em>â€˜.jsâ€™</em>åç¼€åçš„æ–‡ä»¶ã€‚ä½†å½“RequireJSåŠ è½½å®Œ<em>main.js</em>ä¹‹åï¼Œå®ƒä¼šåŠ è½½è¯¥æ–‡ä»¶çš„ä¾èµ–ï¼Œä»¥åŠä¾èµ–çš„ä¾èµ–ï¼Œç­‰ç­‰ã€‚æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·å±•ç¤ºäº†æ‰€æœ‰æ–‡ä»¶çš„åŠ è½½é¡ºåºã€‚</p>
<p><img src="/images/css/css-08.png" alt=""></p>
<p>æµè§ˆå™¨åŠ è½½<code>index.html</code>ä»¥åŠåŠ è½½å®ƒçš„<code>require.js</code>ã€‚å‰©ä¸‹çš„æ–‡ä»¶å’Œä¾èµ–ç”±<code>require.js</code>æ¥è´Ÿè´£åŠ è½½ã€‚</p>
<p>RequireJSå’ŒAMDè§£å†³äº†æˆ‘ä»¬ä¹‹å‰çš„æ‰€æœ‰é—®é¢˜ã€‚ç„¶è€Œï¼Œå®ƒä¹Ÿå¸¦æ¥äº†å…¶ä»–ä¸€äº›ä¸æ˜¯å¾ˆä¸¥é‡çš„é—®é¢˜ã€‚</p>
<ul>
<li><p>AMDè¯­æ³•å¤ªè¿‡äºå¤æ‚ã€‚å› ä¸ºæ‰€æœ‰éƒ½åŒ…è£…åœ¨<code>define</code>å‡½æ•°é‡Œé¢ï¼Œæ‰€ä»¥ä¼šåœ¨æˆ‘ä»¬çš„ä»£ç äº§ç”Ÿä¸€äº›é¢å¤–çš„ç¼©è¿›ã€‚å‡å¦‚æ˜¯æ¯”è¾ƒå°çš„æ–‡ä»¶ï¼Œè¿™ä¹Ÿæ²¡ä»€ä¹ˆå¤§é—®é¢˜ï¼Œä½†å‡å¦‚æ˜¯æ¯”è¾ƒåºå¤§çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå®ƒå°†æ˜¯ä¸€ç§ç²¾ç¥æŠ˜ç£¨ã€‚</p>
</li>
<li><p>æ•°ç»„é‡Œçš„ä¾èµ–åˆ—è¡¨å¿…é¡»ä¸å‡½æ•°çš„å‚æ•°åˆ—è¡¨ç›¸åŒ¹é…ã€‚å‡å¦‚æœ‰å¤§é‡çš„ä¾èµ–ï¼Œé‚£ä¹ˆè¦ç†æ¸…ä¾èµ–é¡ºåºä¹Ÿæ˜¯æ¯”è¾ƒå›°éš¾çš„ä¸€ä»¶äº‹æƒ…ã€‚å¦‚æœæ¨¡å—æœ‰å‡ ä¸ªä¸ªä¾èµ–ï¼Œåæ¥åˆè¦ä»ä¸­åˆ é™¤ä¸€ä¸ªï¼Œé‚£ä¹ˆä¹…å¾ˆéš¾æ‰¾åˆ°åŒ¹é…çš„æ¨¡å—å’Œå‚æ•°ã€‚</p>
</li>
<li><p>ä¼´éšç€ç°ä»£æµè§ˆå™¨(HTTP 1.1)ï¼ŒåŠ è½½å¾ˆå¤šå°æ–‡ä»¶ä¹Ÿä¼šé™ä½æ€§èƒ½ã€‚</p>
</li>
</ul>
<h2 id="Browserify"><a href="#Browserify" class="headerlink" title="Browserify"></a>Browserify</h2><p>ç”±äºè¿™äº›åŸå› ï¼Œä¸€äº›äººæƒ³è¦ç”¨CommonJSè¯­æ³•æ¥ä»£æ›¿ã€‚ä½†æ˜¯CommonJSè¯­æ³•ä¸»è¦æ˜¯é’ˆå¯¹æœåŠ¡å™¨ä»¥åŠåŒæ­¥çš„ï¼Œå¯¹å§ï¼Ÿé‚£ä¹ˆBrowserifyçš„å‡ºç°å°±æ˜¯è¦æ¥è§£å†³è¿™äº›é—®é¢˜çš„ã€‚æœ‰äº†Browserifyï¼Œä½ å°±å¯ä»¥åœ¨æµè§ˆå™¨åº”ç”¨ç¨‹åºä½¿ç”¨CommonJSã€‚Browserifyæ˜¯ä¸€ä¸ª<strong>æ¨¡å—åŠ è½½å™¨</strong>ã€‚Browserifyéå†ä½ ä»£ç çš„ä¾èµ–æ ‘ï¼Œå¹¶ä¸”å°†å®ƒä»¬æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ã€‚</p>
<p>ä¸åƒRequireJSï¼ŒBrowserifyæ›´åƒæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ã€‚ä½ éœ€è¦ä½¿ç”¨NodeJSå’ŒNPMæ¥å®‰è£…å®ƒã€‚åªè¦ä½ åœ¨ä½ çš„ç³»ç»Ÿå®‰è£…äº†nodeJSï¼Œé‚£ä¹ˆè¾“å…¥ä»¥ä¸‹å‘½ä»¤è¡Œã€‚</p>
<p><code>npm install -g browserify</code></p>
<p>è®©æˆ‘ä»¬æ¥çœ‹ä¸‹ç”¨CommonJSè¯­æ³•çš„ä¾‹å­ç¨‹åºã€‚</p>
<p>0-index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JS Modules<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">      The Answer is</span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"answer"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>1-main.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.js</span></span><br><span class="line"><span class="keyword">var</span> sum = <span class="built_in">require</span>(<span class="string">'./sum'</span>);</span><br><span class="line"><span class="keyword">var</span> values = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> ];</span><br><span class="line"><span class="keyword">var</span> answer = sum(values)</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"answer"</span>).innerHTML = answer;</span><br></pre></td></tr></table></figure>
<p>2-sum.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sum.js</span></span><br><span class="line"><span class="keyword">var</span> reduce = <span class="built_in">require</span>(<span class="string">'./reduce'</span>);</span><br><span class="line"><span class="keyword">var</span> add = <span class="built_in">require</span>(<span class="string">'./add'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> reduce(arr, add);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>3-add.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//add.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>4-reduce.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//reduce.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">reduce</span>(<span class="params">arr, iteratee</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> index = <span class="number">0</span>,</span><br><span class="line">    length = arr.length,</span><br><span class="line">    memo = arr[index];</span><br><span class="line"></span><br><span class="line">  index += <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(; index &lt; length; index += <span class="number">1</span>)&#123;</span><br><span class="line">    memo = iteratee(memo, arr[index])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> memo;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°åœ¨<code>index.html</code>æ–‡ä»¶ä¸­ï¼ŒåŠ è½½äº†è„šæœ¬æ–‡ä»¶<code>bundle.js</code>ã€‚é‚£ä¹ˆ<code>bundle.js</code>æ–‡ä»¶åœ¨å“ªé‡Œå‘¢ï¼Ÿåªè¦ä½ æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤è¡Œï¼ŒBrowserifyä¼šä¸ºæˆ‘ä»¬ç”Ÿæˆè¯¥æ–‡ä»¶ã€‚</p>
<p><code>$ brwoserify main.js -o bundle.js</code></p>
<p>Browserifyä¼šè§£æ<code>main.js</code>é‡Œçš„<code>require</code>å‡½æ•°è°ƒç”¨å’Œéå†é¡¹ç›®é‡Œé¢çš„ä¾èµ–æ ‘ã€‚ç„¶åå°†ä»–ä»¬éƒ½æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ã€‚</p>
<p>å¦‚ä¸‹å°±æ˜¯<code>bundle</code>æ–‡ä»¶çš„ç›¸å…³ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">e</span>(<span class="params">t,n,r</span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">s</span>(<span class="params">o,u</span>)</span>&#123;<span class="keyword">if</span>(!n[o])&#123;<span class="keyword">if</span>(!t[o])&#123;<span class="keyword">var</span> a=<span class="keyword">typeof</span> <span class="built_in">require</span>==<span class="string">"function"</span>&amp;&amp;<span class="built_in">require</span>;<span class="keyword">if</span>(!u&amp;&amp;a)<span class="keyword">return</span> a(o,!<span class="number">0</span>);<span class="keyword">if</span>(i)<span class="keyword">return</span> i(o,!<span class="number">0</span>);<span class="keyword">var</span> f=<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Cannot find module '"</span>+o+<span class="string">"'"</span>);<span class="keyword">throw</span> f.code=<span class="string">"MODULE_NOT_FOUND"</span>,f&#125;<span class="keyword">var</span> l=n[o]=&#123;<span class="attr">exports</span>:&#123;&#125;&#125;;t[o][<span class="number">0</span>].call(l.exports,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">var</span> n=t[o][<span class="number">1</span>][e];<span class="keyword">return</span> s(n?n:e)&#125;,l,l.exports,e,t,n,r)&#125;<span class="keyword">return</span> n[o].exports&#125;<span class="keyword">var</span> i=<span class="keyword">typeof</span> <span class="built_in">require</span>==<span class="string">"function"</span>&amp;&amp;<span class="built_in">require</span>;<span class="keyword">for</span>(<span class="keyword">var</span> o=<span class="number">0</span>;o&lt;r.length;o++)s(r[o]);<span class="keyword">return</span> s&#125;)(&#123;<span class="number">1</span>:[<span class="function"><span class="keyword">function</span>(<span class="params">require,module,exports</span>)</span>&#123;</span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#125;,&#123;&#125;],<span class="number">2</span>:[<span class="function"><span class="keyword">function</span>(<span class="params">require,module,exports</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> sum = <span class="built_in">require</span>(<span class="string">'./sum'</span>);</span><br><span class="line"><span class="keyword">var</span> values = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> ];</span><br><span class="line"><span class="keyword">var</span> answer = sum(values)</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"answer"</span>).innerHTML = answer;</span><br><span class="line"></span><br><span class="line">&#125;,&#123;<span class="string">"./sum"</span>:<span class="number">4</span>&#125;],<span class="number">3</span>:[<span class="function"><span class="keyword">function</span>(<span class="params">require,module,exports</span>)</span>&#123;</span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">reduce</span>(<span class="params">arr, iteratee</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> index = <span class="number">0</span>,</span><br><span class="line">    length = arr.length,</span><br><span class="line">    memo = arr[index];</span><br><span class="line"></span><br><span class="line">  index += <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(; index &lt; length; index += <span class="number">1</span>)&#123;</span><br><span class="line">    memo = iteratee(memo, arr[index])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> memo;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#125;,&#123;&#125;],<span class="number">4</span>:[<span class="function"><span class="keyword">function</span>(<span class="params">require,module,exports</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> reduce = <span class="built_in">require</span>(<span class="string">'./reduce'</span>);</span><br><span class="line"><span class="keyword">var</span> add = <span class="built_in">require</span>(<span class="string">'./add'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> reduce(arr, add);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#125;,&#123;<span class="string">"./add"</span>:<span class="number">1</span>,<span class="string">"./reduce"</span>:<span class="number">3</span>&#125;]&#125;,&#123;&#125;,[<span class="number">2</span>]);</span><br></pre></td></tr></table></figure>
<p>ä½ æ— éœ€æ¯ä¸€è¡Œçš„å»ç†è§£è¿™ä¸ªæ‰“åŒ…æ–‡ä»¶çš„æ„æ€ã€‚ä½ åªè¦æ³¨æ„ä¸€ç‚¹çš„æ˜¯ï¼Œæ‰€æœ‰ç†Ÿæ‚‰çš„ä»£ç ï¼Œä¸»æ–‡ä»¶ï¼Œä»¥åŠæ‰€æœ‰çš„ä¾èµ–éƒ½åœ¨è¿™æ–‡ä»¶é‡Œé¢ã€‚</p>
<h2 id="UMD-â€”-åªä¼šè®©ä½ æ„Ÿåˆ°æ›´åŠ çš„å›°æƒ‘"><a href="#UMD-â€”-åªä¼šè®©ä½ æ„Ÿåˆ°æ›´åŠ çš„å›°æƒ‘" class="headerlink" title="UMDâ€Šâ€”â€Šåªä¼šè®©ä½ æ„Ÿåˆ°æ›´åŠ çš„å›°æƒ‘"></a>UMDâ€Šâ€”â€Šåªä¼šè®©ä½ æ„Ÿåˆ°æ›´åŠ çš„å›°æƒ‘</h2><p>ç°åœ¨æˆ‘ä»¬å·²ç»å­¦ä¼šäº†<em>å…¨å±€å¯¹è±¡</em>ï¼Œ<em>CommonJS</em>å’Œ<em>AMD</em>é£æ ¼çš„æ¨¡å—ã€‚å¹¶ä¸”æœ‰å¾ˆå¤šåº“å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¦ä¸ç”¨CommonJSï¼Œè¦ä¸AMDã€‚ä½†æ˜¯å‡å¦‚æˆ‘ä»¬æ­£åœ¨å†™ä¸€ä¸ªæ¨¡å—ï¼Œå¹¶æƒ³éƒ¨ç½²åˆ°äº’è”ç½‘ä¸Šå»æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬è¯¥ç”¨é‚£ç§é£æ ¼çš„æ¨¡å—ã€‚</p>
<p>ç”¨ä¸‰ç§ä¸åŒçš„æ¨¡å—éƒ½æ˜¯å¯ä»¥çš„ï¼Œå¦‚å…¨å±€æ¨¡å—å¯¹è±¡ï¼ŒCommonJSå’ŒAMDéƒ½æ˜¯æœ€ç»ˆé€‰æ‹©æ¥çš„ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸å¾—ä¸ç»´æŠ¤è¿™ä¸‰ç§ç±»å‹çš„æ–‡ä»¶ï¼Œå¹¶ä¸”ç”¨æˆ·ä¸å¾—ä¸ä»–ä»¬æ‰€ä¸‹è½½çš„æ˜¯å“ªç§æ¨¡å—ç±»å‹ã€‚</p>
<p>é€šç”¨æ¨¡å—å®šä¹‰(UMD)å°±æ˜¯æ¥å¤„ç†è¿™ä¸ªç‰¹æ®Šçš„é—®é¢˜çš„ã€‚åœ¨æœ¬è´¨ä¸Šï¼ŒUMDå°±æ˜¯ç”¨ä¸€å¥—<code>if/else</code>æ¥åˆ¤æ–­ç›®å‰çš„è¿è¡Œç¯å¢ƒæ”¯æŒå“ªç§æ¨¡å—ç±»å‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sum.umd.js</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">root, factory</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> define === <span class="string">'function'</span> &amp;&amp; define.amd) &#123;</span><br><span class="line">        <span class="comment">// AMD</span></span><br><span class="line">        define([<span class="string">'add'</span>, <span class="string">'reduce'</span>], factory);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> exports === <span class="string">'object'</span>) &#123;</span><br><span class="line">        <span class="comment">// Node, CommonJS-like</span></span><br><span class="line">        <span class="built_in">module</span>.exports = factory(<span class="built_in">require</span>(<span class="string">'add'</span>), <span class="built_in">require</span>(<span class="string">'reduce'</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Browser globals (root is window)</span></span><br><span class="line">        root.sum = factory(root.add, root.reduce);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span> (<span class="params">add, reduce</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//  private methods</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//    exposed public methods</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> reduce(arr, add);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<h2 id="ES6æ¨¡å—è¯­æ³•"><a href="#ES6æ¨¡å—è¯­æ³•" class="headerlink" title="ES6æ¨¡å—è¯­æ³•"></a>ES6æ¨¡å—è¯­æ³•</h2><p>Javascriptå…¨å±€æ¨¡å—å˜é‡ï¼ŒCommonJSï¼ŒAMDå’ŒUMDï¼Œè¿™é‡Œæœ‰å¤ªå¤šé€‰æ‹©äº†ã€‚ç°åœ¨ä½ å¯èƒ½ä¼šé—®ï¼Œæˆ‘ä¸‹ä¸€ä¸ªé¡¹ç›®åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ¨¡å—é£æ ¼ï¼Ÿç­”æ¡ˆæ˜¯ä¸€ä¸ªä¹Ÿä¸ç”¨ã€‚</p>
<p>Javascriptè¯­è¨€æ²¡æœ‰å†…ç½®çš„æ¨¡å—ç³»ç»Ÿã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æœ‰å¤ªå¤šä¸åŒçš„æ–¹å¼å»å¯¼å…¥å¯¼å‡ºæ¨¡å—äº†ã€‚ä½†æ˜¯æœ€è¿‘ä»¥æ¥è¿™äº›æ”¹å˜äº†ã€‚ä¼´éšç€ES6çš„åˆ°æ¥ï¼Œæ¨¡å—æ˜¯Javascriptå…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚æ‰€ä»¥é—®é¢˜çš„ç­”æ¡ˆæ˜¯ä½ å‡å¦‚æƒ³è¦ä½ ä¸‹ä¸€ä¸ªé¡¹ç›®å‰å«ä¸è¿‡æ—¶çš„è¯ï¼ŒES6æ¨¡å—è¯­æ³•æ˜¯ä½ æœ€å¥½çš„é€‰æ‹©ã€‚</p>
<p>ES6é€šè¿‡<code>import</code>å’Œ<code>export</code>å…³é”®å­—æ¥å¯¼å…¥å¯¼å‡ºæ¨¡å—ã€‚ä¸‹é¢æ˜¯å…³äºä½¿ç”¨ES6æ¨¡å—è¯­æ³•çš„ä¾‹å­ã€‚</p>
<p>01-main.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> sum <span class="keyword">from</span> <span class="string">"./sum"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> values = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> ];</span><br><span class="line"><span class="keyword">var</span> answer = sum(values);</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"answer"</span>).innerHTML = answer;</span><br></pre></td></tr></table></figure>
<p>02-sum.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// sum.js</span></span><br><span class="line"><span class="keyword">import</span> add <span class="keyword">from</span> <span class="string">'./add'</span>;</span><br><span class="line"><span class="keyword">import</span> reduce <span class="keyword">from</span> <span class="string">'./reduce'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> reduce(arr, add);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>03-add.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>04-reduce.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//reduce.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">reduce</span>(<span class="params">arr, iteratee</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> index = <span class="number">0</span>,</span><br><span class="line">  length = arr.length,</span><br><span class="line">  memo = arr[index];</span><br><span class="line"></span><br><span class="line">  index += <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(; index &lt; length; index += <span class="number">1</span>)&#123;</span><br><span class="line">    memo = iteratee(memo, arr[index]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> memo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…³äºES6æ¨¡å—æœ‰å¾ˆå¤šçŸ­è¯­ï¼šES6æ¨¡å—è¯­æ³•ç›¸å½“ç®€æ´ã€‚ES6æ¨¡å—å°†ä¼šå¼•é¢†Javascriptæœªæ¥çš„ä¸–ç•Œã€‚ä½†æ˜¯ä¸å¹¸çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæµè§ˆå™¨å¯¹è¿™ç§æ–°è¯­æ³•è¿˜æ²¡å‡†å¤‡å¥½(å¹¶æœªå…¨é¢æ”¯æŒ)ã€‚åœ¨å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œåªæœ‰Chromeæµè§ˆå™¨æ”¯æŒ<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" target="_blank" rel="noopener">import</a>è¯­å¥ã€‚å³ä½¿å½“å¤§éƒ¨åˆ†çš„æµè§ˆæ”¯æŒ<code>import</code>å’Œ<code>export</code>ï¼Œå‡å¦‚ä½ çš„åº”ç”¨ç¨‹åºéœ€è¦åœ¨ä½ç‰ˆæœ¬çš„æµè§ˆå™¨è¿è¡Œï¼Œé‚£æˆ‘ä»¬åŒæ ·ä¹Ÿä¼šè¿è¡Œå‡ºé”™ã€‚</p>
<p>å¹¸è¿çš„æ˜¯ï¼Œç°åœ¨æœ‰å¾ˆå¤šå·¥å…·å¯ä»¥ç”¨ï¼Œè¿™äº›å·¥å…·å…è®¸æˆ‘ä»¬ä½¿ç”¨ES6æ¨¡å—è¯­æ³•ã€‚</p>
<h2 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h2><p>Webpackæ˜¯ä¸€ä¸ª<strong>æ¨¡å—æ‰“åŒ…å™¨</strong>ï¼Œå°±è·ŸBrowserifyä¸€æ ·ï¼Œå®ƒä¼šéå†ä¾èµ–æ ‘å¹¶ä¸”å°†å®ƒæ‰“åŒ…æˆä¸€ä¸ªè‡³å¤šä¸ªæ–‡ä»¶ã€‚å‡å¦‚çœŸçš„è·ŸBrowserifyä¸€æ ·ï¼Œé‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆè¿˜éœ€è¦å¦ä¸€ä¸ªæ¨¡å—æ‰“åŒ…å™¨ï¼ŸWebpackå¯ä»¥ç®¡ç†CommonJSï¼ŒAMDå’ŒES6æ¨¡å—ã€‚å¹¶ä¸”Webpackå¸¦æ¥äº†æ›´çµæ´»æ›´é…·çš„ç‰¹æ€§ï¼š</p>
<ul>
<li><p><strong>ä»£ç åˆ†ç¦»ï¼š</strong>å½“ä½ æœ‰å¤šä¸ªappåŒæ—¶å…±äº«åŒä¸€äº›æ¨¡å—ï¼ŒWebpackå¯ä»¥å°†ä½ çš„ä»£ç æ‰“åŒ…æˆä¸¤ä¸ªæˆ–è€…å¤šä¸ªæ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œå½“ä½ æœ‰ä¸¤ä¸ªappï¼Œapp1è·Ÿapp2ï¼Œä¸¤è€…å…±ç”¨å¤šä¸ªæ¨¡å—ã€‚ä½¿ç”¨Browserifyï¼Œä½ ä¼šå¾—åˆ°<code>app1.js</code>å’Œ<code>app2.js</code>ï¼Œå¹¶ä¸”ä¸¤è€…éƒ½åŒæ—¶æ‹¥æœ‰æ‰€ä¾èµ–çš„æ¨¡å—ã€‚ä½†æ˜¯å‡å¦‚ä½¿ç”¨Webpackï¼Œä½ å¯ä»¥åˆ›å»º<code>app1.js</code>ï¼Œ<code>app2.js</code>ï¼Œå’Œ<code>share-lib.js</code>ã€‚æ˜¯çš„ï¼Œä½ å¿…é¡»åœ¨htmlé¡µé¢åŠ è½½è¿™2ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯ç”±äºå“ˆå¸Œæ–‡ä»¶åï¼Œæµè§ˆå™¨ç¼“å­˜ä»¥åŠCDNçš„åŸå› ï¼Œå®ƒå¯ä»¥å‡å°‘åˆå§‹åŒ–çš„åŠ è½½æ—¶é—´ã€‚</p>
</li>
<li><p><strong>åŠ è½½ï¼š</strong>é€šè¿‡è‡ªå®šä¹‰åŠ è½½ï¼Œä½ å¯ä»¥åœ¨åŠ è½½ä»»ä½•æ–‡ä»¶åˆ°ä½ çš„èµ„æºå»ã€‚ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨<code>require</code>è¯­æ³•åŠ è½½ä¸å•å•æ˜¯Javascriptæ–‡ä»¶ï¼Œè¿˜æœ‰cssï¼ŒCoffeeScriptï¼ŒSassï¼ŒLessï¼ŒHTMLæ¨¡æ¿ï¼Œå›¾ç‰‡ç­‰ç­‰ã€‚</p>
</li>
<li><p><strong>æ’ä»¶ï¼š</strong>Webpackæ’ä»¶å¯ä»¥åœ¨ä½ æ‰“åŒ…å†™å…¥åˆ°æ–‡ä»¶ä¹‹å‰å¯¹æ‰“åŒ…è¿›è¡Œæ“ä½œï¼Œæœ‰å¾ˆå¤šç¤¾åŒºéƒ½åœ¨åˆ›å»ºWebpackæ’ä»¶ã€‚ä¾‹å¦‚ï¼Œç»™æ‰“åŒ…ä»£ç æ·»åŠ æ³¨é‡Šï¼Œæ·»åŠ source mapï¼Œå°†æ‰“åŒ…æ–‡ä»¶åˆ†ç¦»æˆä¼—å¤šå°æ–‡ä»¶ç­‰ç­‰ã€‚</p>
</li>
</ul>
<p><em>WebpackDevServer</em>æ˜¯ä¸€ä¸ªæ£€æµ‹åˆ°å½“ä½ çš„ä»£ç å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨æ‰“åŒ…ä½ çš„æºä»£ç ä»¥åŠè‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨çš„å¼€å‘æœåŠ¡å™¨ã€‚é€šè¿‡ä»£ç çš„åŠæ—¶åé¦ˆï¼Œä»è€Œå¯ä»¥åŠ é€Ÿå¼€å‘è¿›åº¦ã€‚</p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦‚ä½•é€šè¿‡Webpackæ¥æ‰“åŒ…æˆ‘ä»¬çš„æ¡ˆä¾‹ç¨‹åºçš„ã€‚Webpackéœ€è¦ä¸€ç‚¹å¼•å¯¼ä»¥åŠé…ç½®ã€‚</p>
<p>æ—¢ç„¶Webpackæ˜¯JavaScriptå‘½ä»¤è¡Œå·¥å…·ï¼Œä½ å°±éœ€è¦å®‰è£…å¥½nodejså’Œnpmã€‚è£…å¥½npmä¹‹åï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¡Œåˆå§‹åŒ–é¡¹ç›®ï¼š</p>
<p><code>$ mkdir project; cd project
$ npm init -y
$ npm install -D webpack webpack-dev-server</code></p>
<p>ä½ éœ€è¦ç»™Webpackæ·»åŠ é…ç½®æ–‡ä»¶ã€‚åœ¨ä½ çš„é…ç½®æ–‡ä»¶ä¸­æœ€å°‘éœ€è¦<code>entry</code>è·Ÿ<code>output</code>ä¸¤ä¸ªå­—æ®µã€‚ä¿å­˜ä»¥ä¸‹å†…å®¹åˆ°<code>webpack.config.js</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">   entry: â€˜./app/main.jsâ€™,</span><br><span class="line">   output: &#123;</span><br><span class="line">       filename: â€˜bundle.jsâ€™</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€<code>package.json</code>å¹¶æ·»åŠ ä»¥ä¸‹<code>script</code>å†…å®¹ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">    "start": "webpack-dev-server -progress -colors",</span><br><span class="line">    "build": "webpack"</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æ·»åŠ æ‰€æœ‰ä½ çš„JavaScriptæ¨¡å—åˆ°<em>project/app</em>ç›®å½•å’Œæ·»åŠ <em>index.html</em>åˆ°<em>project</em>ç›®å½•ä¸‹ã€‚</p>
<p>01-index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JS Modules<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">      The Answer is</span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"answer"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>02-webpack.config.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./app/main.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: <span class="string">'./dist'</span>,</span><br><span class="line">    filename: <span class="string">'bundle.js'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>03-package.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"jsmodules"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"main.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"start"</span>: <span class="string">"webpack-dev-server --progress --colors"</span>,</span><br><span class="line">    <span class="attr">"build"</span>: <span class="string">"webpack"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"keywords"</span>: [],</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="attr">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"webpack"</span>: <span class="string">"^1.12.14"</span>,</span><br><span class="line">    <span class="attr">"webpack-dev-server"</span>: <span class="string">"^1.14.1"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>04-app-add.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/add.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>05-app-reduce.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/sum.js</span></span><br><span class="line"><span class="comment">// app/reduce.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">reduce</span>(<span class="params">arr, iteratee</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> index = <span class="number">0</span>,</span><br><span class="line">    length = arr.length,</span><br><span class="line">    memo = arr[index];</span><br><span class="line"></span><br><span class="line">  index += <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(; index &lt; length; index += <span class="number">1</span>)&#123;</span><br><span class="line">    memo = iteratee(memo, arr[index])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> memo;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>06-app-sum.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/sum.js</span></span><br><span class="line">define([<span class="string">'./reduce'</span>, <span class="string">'./add'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">reduce, add</span>)</span>&#123;</span><br><span class="line">  sum =  <span class="function"><span class="keyword">function</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> reduce(arr, add);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>07-app-main.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/main.js</span></span><br><span class="line"><span class="keyword">var</span> sum = <span class="built_in">require</span>(<span class="string">'./sum'</span>);</span><br><span class="line"><span class="keyword">var</span> values = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> ];</span><br><span class="line"><span class="keyword">var</span> answer = sum(values)</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"answer"</span>).innerHTML = answer;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ä¸€ä¸‹<code>add.js</code>å’Œ<code>reduce.js</code>ç¼–å†™é£æ ¼æ˜¯CommonJSé£æ ¼ï¼Œè€Œ<code>sum.js</code>åˆ™æ˜¯ç”¨AMDé£æ ¼ã€‚Webpackï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯å¯ä»¥ç®¡ç†CommonJSå’ŒAMDçš„ã€‚å‡å¦‚ä½ çš„æºç æœ‰ç”¨åˆ°ES6æ¨¡å—ç¼–ç é£æ ¼ï¼Œé‚£ä¹ˆä½ å°±ä¸å¾—ä¸å®‰è£…å’Œé…ç½®<em>â€œbabel loaderâ€</em>ã€‚</p>
<p>ä¸€æ—¦ä½ å·²ç»å®‰è£…å¥½æ‰€æœ‰æ–‡ä»¶ï¼Œä½ å¯ä»¥æ‰§è¡Œä¸‹é¢å‘½ä»¤è¡Œæ¥è¿è¡Œä½ çš„ç¨‹åºã€‚</p>
<p><code>$ npm start</code></p>
<p>éšåæ‰“å¼€ç½‘ç«™è¾“å…¥ç½‘å€ï¼š<code>http://localhost:8080/webpack-dev-server/</code></p>
<p>æ­¤æ—¶ï¼Œä½ å¯ä»¥æ‰“å¼€ä½ å–œçˆ±çš„ç¼–è¯‘å™¨å’Œè¾“å…¥ä½ çš„ä»£ç ã€‚å¾…ä½ ä¿å­˜ä¹‹åï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨åˆ·æ–°å’Œå±•ç¤ºä½ ä»£ç æ”¹åŠ¨ä¹‹åçš„ç»“æœã€‚</p>
<p>æœ‰ä¸€ä»¶äº‹ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†ï¼Œå°±æ˜¯ä½ å·²ç»æ‰¾ä¸åˆ°<em>â€˜dist/bundle.jsâ€™</em>æ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸ºWepback Dev Serverä¼šåˆ›å»ºæ‰“åŒ…æ–‡ä»¶ï¼Œå¹¶ä¸”æ²¡æœ‰å°†æ­¤å†™å…¥æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œè€Œæ˜¯ä¿å­˜åœ¨å†…å­˜é‡Œã€‚</p>
<p>ä¸ºäº†å¯ä»¥éƒ¨ç½²ï¼Œä½ å¯èƒ½æƒ³è¦åˆ›å»ºä¸€ä¸ªæ‰“åŒ…æ–‡ä»¶ã€‚ä½ å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤è¡Œåˆ›å»º<em>bundle.js</em>æ–‡ä»¶ã€‚</p>
<p><code>$ npm run build</code></p>
<p>å‡å¦‚ä½ æœ‰å…´è¶£æƒ³äº†è§£æ›´å¤šå…³äºWebpackçš„çŸ¥è¯†ï¼Œä½ å¯ä»¥è®¿é—®<a href="https://webpack.github.io/docs/" target="_blank" rel="noopener">Webpack</a>ã€‚</p>
<h2 id="Rollup-2015-05"><a href="#Rollup-2015-05" class="headerlink" title="Rollup (2015-05)"></a>Rollup (2015-05)</h2><p>ä½ æ˜¯å¦æœ‰è¿‡å¯¼å…¥äº†ä¸€ä¸ªå¾ˆå¤§çš„JavaScriptæ–‡ä»¶ä½†æ˜¯å´ä½¿ç”¨åˆ°é‡Œé¢çš„ä¸€å°éƒ¨åˆ†å‡½æ•°ï¼ŸRollupæ˜¯JavaScript ES6çš„å¦ä¸€ä¸ªæ¨¡å—æ‰“åŒ…å™¨ã€‚è·ŸBrowserifyå’ŒWebpackä¸åŒçš„æ˜¯ï¼ŒRollupåªä¼šå¼•å…¥ä½ åœ¨é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„ä»£ç ã€‚å‡å¦‚ä½ çš„é¡¹ç›®å¼•å…¥äº†ä¸€ä¸ªæœ‰å¾ˆå¤šæ–¹æ³•çš„å¤§æ¨¡å—å¹¶ä¸”ä½ åªç”¨åˆ°é‡Œé¢çš„ä¸€å°éƒ¨åˆ†æ–¹æ³•ï¼ŒRollupåªä¼šæ‰“åŒ…ä½ åœ¨é¡¹ç›®ä¸­ä½ è°ƒç”¨åˆ°çš„æ–¹æ³•ã€‚è¿™å¯ä»¥å¾ˆæ˜¾è‘—çš„å‡å°‘æ‰“åŒ…æ–‡ä»¶çš„å¤§å°ã€‚</p>
<p>Rollup å¯ä»¥è¢«ç”¨ä½œä¸ºå‘½ä»¤è¡Œå·¥å…·ã€‚å¦‚æœå®‰è£…å¥½ NodeJS å’Œ NPMï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨ä»¥ä¸‹çš„å‘½ä»¤å®‰è£…ã€‚</p>
<p><code>$ npm install -g rollup</code></p>
<p>Rollupå¯ä»¥è·Ÿä»»ä½•ç±»å‹çš„æ¨¡å—ç±»å‹ä¸€èµ·æ‰§è¡Œã€‚ä½†æ˜¯ï¼Œæ¨èä½¿ç”¨ES6æ¨¡å—é£æ ¼ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨ <em>tree-shaking</em> åŠŸèƒ½ã€‚ä¸‹é¢æ˜¯ç”¨ES6 ç¼–å†™çš„ä¾‹å­ã€‚</p>
<p>01-add.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> add = <span class="function">(<span class="params">a,b</span>) =&gt;</span> a + b;</span><br><span class="line"><span class="keyword">let</span> sub = <span class="function">(<span class="params">a,b</span>) =&gt;</span> a - b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; add, sub &#125;;</span><br></pre></td></tr></table></figure>
<p>02-reduce.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// reduce.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (arr, iteratee) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> index = <span class="number">0</span>,</span><br><span class="line">  length = arr.length,</span><br><span class="line">  memo = arr[index];</span><br><span class="line"></span><br><span class="line">  index += <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(; index &lt; length; index += <span class="number">1</span>)&#123;</span><br><span class="line">    memo = iteratee(memo, arr[index]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> memo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>03-sum.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// sum.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; add &#125; <span class="keyword">from</span> <span class="string">'./add'</span>;</span><br><span class="line"><span class="keyword">import</span> reduce <span class="keyword">from</span> <span class="string">'./reduce'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (arr) =&gt; reduce(arr, add);</span><br></pre></td></tr></table></figure>
<p>04-main.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> sum <span class="keyword">from</span> <span class="string">"./sum"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> values = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> ];</span><br><span class="line"><span class="keyword">var</span> answer = sum(values);</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"answer"</span>).innerHTML = answer;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åœ¨<code>add</code>æ¨¡å—ï¼Œæˆ‘å¼•å…¥äº†å¦ä¸€ä¸ªå‡½æ•°<code>sub()</code>ï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°åœ¨è¿™ä¸ªé¡¹ç›®é‡Œé¢å¹¶æ²¡æœ‰ä½¿ç”¨ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬ç”¨Rollupæ¥æ‰“åŒ…æˆ‘ä»¬çš„é¡¹ç›®</p>
<p><code>$ rollup main.js -o bundle.js</code></p>
<p>ç”Ÿæˆçš„<code>bundle.js</code></p>
<p>bundle.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> add = <span class="function">(<span class="params">a,b</span>) =&gt;</span> a + b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> reduce = <span class="function">(<span class="params">arr, iteratee</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> index = <span class="number">0</span>,</span><br><span class="line">  length = arr.length,</span><br><span class="line">  memo = arr[index];</span><br><span class="line"></span><br><span class="line">  index += <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(; index &lt; length; index += <span class="number">1</span>)&#123;</span><br><span class="line">    memo = iteratee(memo, arr[index]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> memo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sum = <span class="function">(<span class="params">arr</span>) =&gt;</span> reduce(arr, add);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> values = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> ];</span><br><span class="line"><span class="keyword">var</span> answer = sum(values);</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"answer"</span>).innerHTML = answer;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„è§‚å¯Ÿï¼Œ<code>sub</code>å‡½æ•°å¹¶æ²¡æœ‰å‡ºç°åœ¨æ­¤<code>bunldle.js</code>æ–‡ä»¶é‡Œé¢ã€‚</p>
<h2 id="SystemJS"><a href="#SystemJS" class="headerlink" title="SystemJS"></a>SystemJS</h2><p>SystemJSæ˜¯ä¸€ä¸ªé€šç”¨çš„æ¨¡å—åŠ è½½å™¨ï¼Œå®ƒå¯ä»¥åœ¨æµè§ˆå™¨æˆ–è€…NodeJsåŠ¨æ€çš„åŠ è½½æ¨¡å—ï¼Œå¹¶ä¸”å®ƒè¿˜æ”¯æŒCommonJSï¼ŒAMDï¼Œå…¨å±€å¯¹è±¡å’ŒES6æ¨¡å—ã€‚é€šè¿‡æ’ä»¶ï¼Œå®ƒè¿˜ä¸ä»…ä»…èƒ½åŠ è½½JavaScriptï¼Œè¿˜å¯ä»¥åŠ è½½CoffeeScriptå’ŒTypeScriptã€‚</p>
<p>SystemJSçš„å¦ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯å®ƒæ˜¯åŸºäºES6 module Loader polyfillã€‚å› æ­¤å®ƒçš„è¯­æ³•å’ŒAPIåœ¨æœªæ¥å¾ˆæœ‰å¯èƒ½æˆä¸ºJavaScriptè¯­è¨€çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå¯ä»¥è®©ä½ çš„ä»£ç æ›´åŠ å‰å«ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¯­æ³•ï¼Œé€šè¿‡SystemJSæ¥å¼‚æ­¥çš„å¯¼å…¥æ¨¡å—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.import(â€˜<span class="built_in">module</span>-nameâ€™);</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥ç”¨é…ç½® API æ¥é…ç½® SystemJS çš„è¡Œä¸ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">System.config(&#123;</span><br><span class="line">  transplier: â€˜babelâ€™,</span><br><span class="line">  baseURL: â€˜/appâ€™</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„é…ç½®ä¼šè®©SystemJSä½¿ç”¨<code>babel</code>æ¥ä½œä¸ºES6æ¨¡å—çš„ç¼–è¯‘å™¨ï¼Œå¹¶ä¸”ä»<em>/app</em>ç›®å½•åŠ è½½æ¨¡å—ã€‚</p>
<p>éšç€ç°ä»£JavaScriptå˜å¾—è¶Šæ¥è¶Šå¤§è¶Šæ¥è¶Šå¤æ‚ï¼Œå¼€å‘å·¥ä½œæµäº¦æ˜¯å¦‚æ­¤ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦çš„ï¼Œä¸ä»…ä»…æ˜¯æ¨¡å—åŠ è½½å™¨ï¼Œè¿˜æœ‰å¯»æ‰¾å¼€å‘æœåŠ¡å™¨ï¼Œç”Ÿäº§çš„æ¨¡å—æ‰“åŒ…å™¨ä»¥åŠç¬¬ä¸‰æ–¹æ¨¡å—åŒ…ç®¡ç†å™¨ã€‚</p>
<h2 id="JSPM"><a href="#JSPM" class="headerlink" title="JSPM"></a>JSPM</h2><p>JSPMæ˜¯JavaScriptå¼€å‘å·¥å…·çš„ä¸€æŠŠç‘å£«å†›åˆ€ã€‚JSPMæ˜¯ä¸€ä¸ª(1)åŒ…ç®¡ç†å™¨ï¼›(2)æ¨¡å—åŠ è½½å™¨ï¼›(3)æ¨¡å—æ‰“åŒ…å™¨ã€‚</p>
<p>ç°åœ¨çš„JavaScriptå¼€å‘å¾ˆå°‘åªéœ€è¦è‡ªå·±çš„ä¸€äº›æ¨¡å—å°±å¯ä»¥å®Œæˆçš„ï¼Œå¤§éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ˜¯éœ€è¦å€Ÿç”¨ç¬¬ä¸‰æ–¹æ¨¡å—çš„ã€‚</p>
<p>é€šè¿‡JSPMï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹çš„å‘½ä»¤è¡Œä»NPMæˆ–è€…githubæ¥å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—ã€‚</p>
<p><code>jspm install npm:package-name or github:package/name</code></p>
<p>éšåä¼šä»<em>â€˜npmâ€™</em>æˆ–è€…<em>â€˜githubâ€™</em>ä¸‹è½½è‡³<em>â€˜jspm_packageâ€™</em>ç›®å½•ä¸‹ã€‚</p>
<p>åœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨<em>â€˜jspm-serverâ€™</em>ï¼Œå°±è·ŸWebpack Dev Serverä¸€æ ·ï¼Œå®ƒä¼šæ¢æµ‹åˆ°ä»£ç æ˜¯å¦å‘ç”Ÿæ”¹å˜å¹¶ä¸”ä¼šè‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨å±•ç¤ºä¿®æ”¹åçš„ç»“æœã€‚ä½†æ˜¯ä¸åŒWebpack Dev Serverï¼Œjspm-serverç”¨çš„æ˜¯SystemJSæ¨¡å—åŠ è½½å™¨ã€‚å› æ­¤å½“å®ƒæ¢æµ‹åˆ°æ–‡ä»¶æœ‰å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒä¸ä¼šæ‰“åŒ…æ‰€æœ‰çš„æ¨¡å—ï¼Œè€Œæ˜¯åªåŠ è½½é¡µé¢æ‰€éœ€è¦çš„æ¨¡å—ã€‚</p>
<p>ä½†å½“æ¶‰åŠåˆ°éƒ¨ç½²çš„é—®é¢˜ï¼Œä½ å¯èƒ½æƒ³è¦æ‰“åŒ…ä½ çš„ä»£ç ã€‚JSPMå¸¦æœ‰æ‰“åŒ…å™¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„å‘½ä»¤è¡Œæ¥æ‰“åŒ…ä½ çš„ä»£ç ã€‚</p>
<p><code>jspm bundle main.js bundle.js</code></p>
<p>åœ¨èƒŒåï¼ŒJSPMé‡‡å–äº†Rollupä½œä¸ºå®ƒçš„æ‰“åŒ…å™¨ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æˆ‘å¸Œæœ›å·²ç»ç»™ä½ è¶³å¤Ÿçš„ä¿¡æ¯è®©ä½ å»ç†è§£å…³äºJavaScriptæ¨¡å—åŒ–çš„é—®é¢˜ã€‚ç°åœ¨ä½ å¯èƒ½ä¼šé—®ï¼Œé‚£æˆ‘åœ¨ä¸‹ä¸€ä¸ªé¡¹ç›®åº”è¯¥é‡‡ç”¨ä»€ä¹ˆçš„æ–¹å¼å‘¢ï¼Ÿå¾ˆæŠ±æ­‰ï¼Œæˆ‘ç°åœ¨æ— æ³•å›ç­”ä½ çš„é—®é¢˜ã€‚ç°åœ¨ä½ å·²ç»å…·å¤‡èƒ½åŠ›å»ä¸ºè‡ªå·±å¯»æ‰¾ç­”æ¡ˆã€‚å¸Œæœ›æœ¬æ–‡èƒ½è®©ä½ æ›´å®¹æ˜“ç†è§£æåˆ°æœ‰å…³å·¥å…·çš„æ–‡æ¡£å’Œæ–‡ç« ã€‚</p>
<p>ä½ å¯ä»¥åˆ°<a href="https://github.com/sungthecoder/js-modules-examples" target="_blank" rel="noopener">github</a>æŸ¥çœ‹æœ¬æ–‡ä¸­æ‰€æœ‰çš„ä»£ç ä¾‹å­ï¼Œå‡å¦‚ä½ æœ‰ä»»ä½•ç–‘é—®ï¼Œæ¬¢è¿åˆ°ä¸‹é¢çš„è¯„è®ºåŒºç•™ä¸‹çš„é—®é¢˜ã€‚</p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS - 5ä»¶ä½ éœ€è¦çŸ¥é“çš„csså®šä½]]></title>
      <url>https://lucius0.github.io/2016/10/30/archivers/5-things-you-should-know-about-css/</url>
      <content type="html"><![CDATA[<p>åŸæ–‡é“¾æ¥<a href="https://scotch.io/bar-talk/5-things-you-might-not-know-about-the-css-positioning-types" target="_blank" rel="noopener">5-things-you-might-not-know-about-the-css-positioning-types</a>ã€‚</p>
<p>è¿™äº›å¹´æ¥å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆå¯ä»¥åˆ©ç”¨ä¸åŒçš„cssæ–¹æ¡ˆæ¥æ­å»ºå‡ºå¤æ‚çš„é¡µé¢å¸ƒå±€ã€‚å…¶ä¸­æœ‰ä¸€éƒ¨åˆ†çš„è§£å†³æ–¹æ¡ˆå·²ç»æœ‰äº›å†å²äº†(æ¯”å¦‚ï¼š<code>float</code>)ï¼Œå½“ç„¶ä¹Ÿæœ‰äº›æ˜¯æœ€è¿‘æ‰é€æ¸æµè¡Œèµ·æ¥çš„(æ¯”å¦‚ï¼š<code>flexbox</code>)ã€‚</p>
<p>åœ¨è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°†ä¼šæ·±å…¥ä¸€æ­¥å»æ¢è®¨ä¸€äº›é²œä¸ºäººçŸ¥çš„å…³äº<code>CSS POSITION</code>å®šä½çš„äº‹æƒ…ã€‚</p>
<p>åœ¨æˆ‘ä»¬å¼€å§‹å­¦ä¹ è¿™äº›äº‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆå¿«é€Ÿçš„æµè§ˆä¸‹å¯ç”¨çš„å®šä½ç±»å‹ã€‚</p>
<h2 id="å›é¡¾å¯ç”¨çš„CSSå®šä½ç±»å‹"><a href="#å›é¡¾å¯ç”¨çš„CSSå®šä½ç±»å‹" class="headerlink" title="å›é¡¾å¯ç”¨çš„CSSå®šä½ç±»å‹"></a>å›é¡¾å¯ç”¨çš„CSSå®šä½ç±»å‹</h2><p><code>position</code>è¿™ä¸ªcsså±æ€§å…è®¸æˆ‘ä»¬æŒ‡å®šå…ƒç´ çš„å®šä½ç±»å‹ã€‚</p>
<h3 id="CSSå®šä½é€‰é¡¹"><a href="#CSSå®šä½é€‰é¡¹" class="headerlink" title="CSSå®šä½é€‰é¡¹"></a>CSSå®šä½é€‰é¡¹</h3><p><code>static</code>æ˜¯è¯¥å±æ€§çš„é»˜è®¤å€¼ã€‚åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç§°è¯¥å…ƒç´ å¹¶æ²¡æœ‰è¢«å®šä½ã€‚ä¸ºäº†å¯ä»¥å®šä½è¯¥å…ƒç´ ï¼Œæˆ‘ä»¬éœ€è¦æ”¹å˜å®ƒçš„é¢„è®¾ç±»å‹ã€‚</p>
<p>ä¸ºäº†æ”¹å˜é¢„è®¾ç±»å‹ï¼Œæˆ‘ä»¬éœ€è¦å°†<code>position</code>è®¾ç½®ä¸ºå¦‚ä¸‹å…¶ä¸­ä¸€ä¸ªï¼š</p>
<ul>
<li><p><code>relative</code></p>
</li>
<li><p><code>absolute</code></p>
</li>
<li><p><code>fixed</code></p>
</li>
<li><p><code>sticky</code></p>
</li>
</ul>
<p>åªæœ‰è®¾ç½®ä¹‹åï¼Œæˆ‘ä»¬æ‰å¯ä»¥ä½¿ç”¨<code>offset</code>å»æŒ‡å®šæˆ‘ä»¬å…ƒç´ çš„ä½ç½®ï¼š</p>
<ul>
<li><p><code>top</code></p>
</li>
<li><p><code>bottom</code></p>
</li>
<li><p><code>left</code></p>
</li>
<li><p><code>right</code></p>
</li>
<li><p>é»˜è®¤åˆå§‹å€¼<code>auto</code></p>
</li>
</ul>
<p>éœ€è¦æ³¨æ„ä¸€ç‚¹çš„æ˜¯ï¼ŒæŠŠå…ƒç´ <code>position</code>è®¾ç½®ä¸º<code>absolute</code>æˆ–è€…<code>fixed</code>æˆ‘ä»¬éƒ½ç§°ä¹‹ä¸ºç»å¯¹å®šä½å…ƒç´ ã€‚åŒæ ·ï¼Œæ³¨æ„ä¸€ä¸ªè¢«å®šä½çš„å…ƒç´ å¯ä»¥ç”¨<code>z-index</code>æ¥æŒ‡å®šä»–ä»¬çš„å±‚å å…³ç³»ã€‚</p>
<h3 id="CSSå®šä½å±æ€§çš„ä¸»è¦å·®åˆ«"><a href="#CSSå®šä½å±æ€§çš„ä¸»è¦å·®åˆ«" class="headerlink" title="CSSå®šä½å±æ€§çš„ä¸»è¦å·®åˆ«"></a>CSSå®šä½å±æ€§çš„ä¸»è¦å·®åˆ«</h3><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥ç®€å•çš„è®¨è®ºä¸‹è¿™äº›å®šä½ç±»å‹çš„ä¸»è¦å·®åˆ«ï¼š</p>
<ul>
<li><p>ä¸€ä¸ª<em>ç»å¯¹</em>å®šä½çš„å…ƒç´ æ˜¯ä¼šå®Œå…¨è„±ç¦»æ­£å¸¸çš„æµã€‚é‚»è¿‘çš„å…„å¼ŸèŠ‚ç‚¹ä¼šå æ®å®ƒçš„ä½ç½®ã€‚</p>
</li>
<li><p>ä¸€ä¸ª<em>ç›¸å¯¹</em>æˆ–è€…<em>ç²˜æ€§</em>å®šä½å…ƒç´ ä¿ç•™ä»–ä»¬çš„ç©ºé—´ã€‚é‚»è¿‘çš„å…ƒç´ ä¸ä¼šé‡å®šä½å æ®è¯¥å…ƒç´ ä¿ç•™çš„ç©ºé—´ã€‚ç„¶è€Œï¼Œè¿™ä¸ªå…ƒç´ çš„åç§»é‡ä¸ä¼šå æ®ç©ºé—´ã€‚ä»–ä»¬å·²ç»å®Œå…¨å¿½ç•¥äº†å…¶ä»–çš„å…ƒç´ ï¼Œå› æ­¤ä¼šé€ æˆå…ƒç´ ä¹‹é—´å‘ç”Ÿé‡å ã€‚</p>
</li>
<li><p>ä¸€ä¸ª<em>å›ºå®š(fixed)</em>å®šä½å…ƒç´ (è®°ä½ï¼š<code>fixed</code>å®šä½ç±»å‹å…ƒç´ æ˜¯<code>absolute</code>å®šä½ç±»å‹å…ƒç´ çš„å­ç±»)ç»å¸¸ç›¸å¯¹äº<code>relative</code>å®šä½ç±»å‹çš„è§†å›¾(é™¤äº†æœ‰<code>transform</code>å±æ€§çš„çˆ¶å…ƒç´ ï¼Œæ–°ç‰ˆæœ¬çš„æ¡Œé¢æµè§ˆå™¨å‡æ”¯æŒè¿™ç§è¡Œä¸º)ã€‚</p>
</li>
<li><p>ä¸€ä¸ª<em>ç²˜æ€§(sticky)</em>å®šä½å…ƒç´ æ˜¯ç›¸å¯¹ä¸æœ€è¿‘å¯æ»‘åŠ¨çš„çˆ¶å…ƒç´ (æ¯”å¦‚ï¼š<code>overflow: auto</code>)ã€‚å‡å¦‚æ²¡æœ‰è¿™ç§çˆ¶å…ƒç´ ï¼Œåˆ™ç›¸å¯¹äºè§†å›¾å®šä½ã€‚</p>
</li>
</ul>
<p>æ¥ä¸‹æ¥è¿™äº›ç±»å‹ä¼šåœ¨ä¸‹é¢çš„ä¾‹å­ä¸­æ¼”ç¤ºï¼š</p>
<p data-height="499" data-theme-id="0" data-slug-hash="qOqNgm" data-user="georgemarts" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/georgemarts/pen/qOqNgm" target="_blank" rel="noopener">Timer</a> forked by Georgemarts (<a href="http://codepen.io" target="_blank" rel="noopener">@georgemarts</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p><em>æ³¨æ„ï¼šç²˜æ€§å®šä½ç±»å‹è¿˜æ˜¯å¤„äºå®éªŒæ€§çš„æŠ€æœ¯ï¼Œå¹¶ä¸”æµè§ˆå™¨çš„æ”¯æŒæœ‰é™ã€‚å½“ç„¶ï¼Œå‡å¦‚ä½ æƒ³è¦å°è¯•è¿™ä¸ªæ•ˆæœï¼Œå¯ä»¥ç”¨polyfill(ä¾‹å¦‚ï¼š<a href="https://github.com/wilddeer/stickyfill" target="_blank" rel="noopener">stickyfill</a>)åŠ åˆ°ä¸æ”¯æŒæ­¤ç±»å‹çš„æµè§ˆå™¨ã€‚é‰´äºæ”¯æŒæœ‰é™ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ä»¥ä¸‹çš„æ–‡ç« å°†ä¸ä¼šå¯¹å®ƒè¿›è¡Œè®²è§£</em></p>
<h2 id="ç»å¯¹å®šä½å…ƒç´ "><a href="#ç»å¯¹å®šä½å…ƒç´ " class="headerlink" title="ç»å¯¹å®šä½å…ƒç´ "></a>ç»å¯¹å®šä½å…ƒç´ </h2><p>æˆ‘ç¡®å®šå¾ˆå¤šäººå·²ç»çŸ¥é“ç»å¯¹å®šä½æ˜¯å¦‚ä½•å®ç°çš„ã€‚ç„¶è€Œï¼Œç»å¯¹å®šä½ä¸ä»…ä»…éœ€è¦æŠ€å·§ï¼Œæ›´æ˜¯ç»å¸¸èƒ½æ··æ·†æ–°æ‰‹ã€‚</p>
<p>åŸºäºè¿™ä¸ªåŸå› ï¼Œæˆ‘å†³å®šå°†å…¶åˆ—å…¥é²œä¸ºäººçŸ¥çš„åˆ—è¡¨ä¸­(åŒ…æ‹¬ç›¸å¯¹åº”çš„ä¾‹å­)ï¼Œå¹¶åœ¨æ­¤æ–‡ç« ä¸€ä¸€è®²è§£ã€‚</p>
<p>å› æ­¤ï¼Œä¸€ä¸ªè¢«è®¾ç½®ä¸ºç»å¯¹å®šä½ç±»å‹çš„å…ƒç´ æ˜¯ç›¸å¯¹äºæœ€è¿‘çš„çˆ¶å…ƒç´ ã€‚å½“ç„¶ï¼Œè¿™ä»…ä»…åœ¨çˆ¶å…ƒç´ çš„å®šä½ç±»å‹ä¸æ˜¯<code>static</code>æ—¶æœ‰æ•ˆã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œå‡å¦‚çˆ¶å…ƒç´ æ²¡æœ‰å£°æ˜ä»»ä½•ç±»å‹ï¼Œé‚£ä¹ˆå®ƒæ˜¯ç›¸å¯¹äºè§†å›¾å®šä½ã€‚</p>
<p data-height="499" data-theme-id="0" data-slug-hash="dYOpMm" data-user="georgemarts" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/georgemarts/pen/dYOpMm" target="_blank" rel="noopener">Timer</a> forked by Georgemarts (<a href="http://codepen.io" target="_blank" rel="noopener">@georgemarts</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç»™ç»¿ç›’å­åˆå§‹<code>absolute</code>å®šä½å¹¶ä¸”å°†<code>offset</code>å€¼è®¾ç½®ä¸º<code>bottom: 0</code>å’Œ<code>left: 0</code>ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰æŒ‡å®šå…¶ä¸Šä¸€çº§çˆ¶å…ƒç´ çš„å®šä½ç±»å‹ã€‚</p>
<p>ç„¶è€Œï¼Œæˆ‘ä»¬ä½¿å¤–åŒ…å›´ç›’ç›¸å¯¹å®šä½(ä¾‹å¦‚ï¼š<code>jumbotron</code>å…ƒç´ )ã€‚æ³¨æ„ä¸€ä¸‹åªè¦æˆ‘ä»¬ä¿®æ”¹äº†ç»¿ç›’å­çš„çˆ¶å…ƒç´ çš„å®šä½ç±»å‹å°±ä¼šä½¿å¾—ç»¿ç›’å­çš„ä½ç½®å‘ç”Ÿæ”¹å˜ã€‚</p>
<h2 id="ç»å¯¹å®šä½å…ƒç´ æ— è§†floatå±æ€§çš„å­˜åœ¨"><a href="#ç»å¯¹å®šä½å…ƒç´ æ— è§†floatå±æ€§çš„å­˜åœ¨" class="headerlink" title="ç»å¯¹å®šä½å…ƒç´ æ— è§†floatå±æ€§çš„å­˜åœ¨"></a>ç»å¯¹å®šä½å…ƒç´ æ— è§†<code>float</code>å±æ€§çš„å­˜åœ¨</h2><p>å‡å¦‚ä¸€ä¸ªå…ƒç´ æ˜¯å·¦æµ®åŠ¨æˆ–è€…å³æµ®åŠ¨å¹¶ä¸”æˆ‘ä»¬è®¾ç½®å®ƒçš„å®šä½ç±»å‹ä¸º<code>absolute</code>æˆ–è€…<code>fixed</code>ï¼Œå±æ€§<code>float</code>çš„å€¼åˆ™ä¼šå˜æˆ<code>none</code>ã€‚å¦ä¸€æ–¹é¢ï¼Œå‡å¦‚æˆ‘ä»¬å°†è¯¥å…ƒç´ çš„å®šä½ç±»å‹è®¾ç½®ä¸º<code>relative</code>ï¼Œåˆ™ä¼šä¿ç•™å…¶æµ®åŠ¨å±æ€§ã€‚</p>
<p>çœ‹ä¸€ä¸‹ä»¥ä¸‹çš„ç›¸å…³ä¾‹å­</p>
<p data-height="499" data-theme-id="0" data-slug-hash="WQovLM" data-user="georgemarts" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/georgemarts/pen/WQovLM" target="_blank" rel="noopener">Timer</a> forked by Georgemarts (<a href="http://codepen.io" target="_blank" rel="noopener">@georgemarts</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p>åœ¨è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªå‘å³æµ®åŠ¨çš„ä¸åŒå…ƒç´ ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“æˆ‘ä»¬å°†çº¢ç›’å­æ”¹å˜ä¸º<strong>ç»å¯¹</strong>å®šä½å…ƒç´ ï¼Œå®ƒä¼šå¿½ç•¥<code>float</code>å±æ€§ï¼Œè€Œ<strong>ç›¸å¯¹</strong>å®šä½çš„ç»¿ç›’å­åˆ™ä¿ç•™å…¶å±æ€§å€¼ã€‚</p>
<h2 id="ç»å¯¹å®šä½çš„å†…è”å…ƒç´ è·Ÿå—çº§å…ƒç´ çš„è¡¨ç°ä¸€æ ·"><a href="#ç»å¯¹å®šä½çš„å†…è”å…ƒç´ è·Ÿå—çº§å…ƒç´ çš„è¡¨ç°ä¸€æ ·" class="headerlink" title="ç»å¯¹å®šä½çš„å†…è”å…ƒç´ è·Ÿå—çº§å…ƒç´ çš„è¡¨ç°ä¸€æ ·"></a>ç»å¯¹å®šä½çš„å†…è”å…ƒç´ è·Ÿå—çº§å…ƒç´ çš„è¡¨ç°ä¸€æ ·</h2><p><code>absolute</code>å®šä½æˆ–è€…<code>fixed</code>å®šä½çš„å†…è”å…ƒç´ ï¼Œè·Ÿå—çº§å…ƒç´ å…·æœ‰åŒæ ·çš„èƒ½åŠ›ã€‚<a href="https://drafts.csswg.org/css-position-3/#dis-pos-flo" target="_blank" rel="noopener">è¿™ä»½åˆ—è¡¨</a>æ€»ç»“äº†ä»€ä¹ˆç±»å‹çš„å…ƒç´ å¯ä»¥è½¬æ¢ä¸ºå—çº§å…ƒç´ ã€‚</p>
<p>è¿™é‡ŒåŒæ ·ä¹Ÿæ˜¯ä¸€ä¸ªä¾‹å­</p>
<p data-height="499" data-theme-id="0" data-slug-hash="xwEymK" data-user="georgemarts" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/georgemarts/pen/xwEymK" target="_blank" rel="noopener">Timer</a> forked by Georgemarts (<a href="http://codepen.io" target="_blank" rel="noopener">@georgemarts</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p>åœ¨è¿™ä¸ªæ¡ˆä¾‹é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªä¸åŒçš„å…ƒç´ ã€‚ç¬¬ä¸€ä¸ªå°±æ˜¯å—çº§å…ƒç´ (ç»¿ç›’å­ï¼Œä¾‹å¦‚:<code>div</code>)ï¼Œç¬¬äºŒä¸ªå°±æ˜¯å†…è”å…ƒç´ (çº¢ç›’å­ï¼Œä¾‹å¦‚ï¼š<code>span</code>)ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯è™½ç„¶åªæœ‰ç»¿ç›’å­æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>çº¢è‰²ç›’å­ä¹‹æ‰€ä»¥ç°åœ¨ä¸å¯è§æ˜¯å› ä¸ºæˆ‘ä»¬èµ‹äºˆå®ƒçš„<code>width</code>è·Ÿ<code>height</code>åªèƒ½ä½œç”¨åŸŸå—çº§å…ƒç´ è·Ÿå†…è”å—çº§å…ƒç´ ã€‚å†åŠ ä¸Šï¼Œå®ƒæ˜¯ä¸€ä¸ªç©ºçš„å…ƒç´ (å³ï¼šå®ƒä¸åŒ…å«ä»»ä½•çš„å­å…ƒç´ ä¾‹å¦‚æ–‡æœ¬èŠ‚ç‚¹)ã€‚</p>
<p>è®°ä½ä¸€ç‚¹çš„æ˜¯ï¼Œå‡å¦‚æˆ‘ä»¬å°†å®ƒçš„å®šä½ç±»å‹è®¾ç½®ä¸º<code>absolute</code>æˆ–è€…<code>fixed</code>ï¼Œåˆ™è¯¥å…ƒç´ ä¼šå‡ºç°æ˜¯å› ä¸ºè¿™æ—¶å€™å®ƒçš„è¡¨ç°å·²ç»è·Ÿå—çº§å…ƒç´ ä¸€æ ·äº†ã€‚</p>
<h2 id="å¤–è¾¹è·-margins-æ— æ³•åˆå¹¶ç»å¯¹å®šä½å…ƒç´ "><a href="#å¤–è¾¹è·-margins-æ— æ³•åˆå¹¶ç»å¯¹å®šä½å…ƒç´ " class="headerlink" title="å¤–è¾¹è·(margins)æ— æ³•åˆå¹¶ç»å¯¹å®šä½å…ƒç´ "></a>å¤–è¾¹è·(margins)æ— æ³•åˆå¹¶ç»å¯¹å®šä½å…ƒç´ </h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ä¸¤ä¸ªå‚ç›´å¤–è¾¹è·äº’ç›¸æ¥è§¦ï¼Œå®ƒä»¬ä¼šåˆå¹¶æˆä¸€ä¸ªï¼Œå¹¶ä¸”<code>margin</code>å€¼æŒ‡å®šä¸ºè¾ƒå¤§çš„é‚£ä¸€ä¸ªã€‚è¿™ç§è¡¨ç°ç§°ä¹‹ä¸º<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Box_Model/Mastering_margin_collapsing" target="_blank" rel="noopener">å¤–è¾¹è·åˆå¹¶</a>ã€‚</p>
<p>å°±åƒåœ¨ä¸€ä¸ªæµ®åŠ¨çš„å…ƒç´ ä¸Šçš„å¤–è¾¹è·ä¸€æ ·ï¼Œç»å¯¹å®šä½çš„å¤–è¾¹è·ä¸ä¼šè·Ÿå…¶ä»–å…ƒç´ åˆå¹¶ã€‚</p>
<p>æ€è€ƒä¸€ä¸‹ä»¥ä¸‹çš„ä¾‹å­ï¼š</p>
<p data-height="499" data-theme-id="0" data-slug-hash="jbVrGd" data-user="georgemarts" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/georgemarts/pen/jbVrGd" target="_blank" rel="noopener">Timer</a> forked by Georgemarts (<a href="http://codepen.io" target="_blank" rel="noopener">@georgemarts</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p>åœ¨è¿™ä¸ªä¾‹å­ï¼Œåˆå§‹åŒ–è¯¥å…ƒç´ çš„å¤–è¾¹è·ä¸º<code>20px</code>ã€‚å¦å¤–ï¼Œè¯¥å…ƒç´ çš„<code>top</code>å¤–è¾¹è·è·Ÿçˆ¶å…ƒç´ çš„<code>top</code>å¤–è¾¹è·åˆå¹¶ï¼ŒåŒæ ·ä¹Ÿæ˜¯<code>20px</code>ã€‚æ­£å¦‚ä½ æ‰€è§ï¼Œåªæœ‰å½“æˆ‘ä»¬ç»å¯¹å®šä½å…¶å…ƒç´ ï¼Œ<code>top</code>å¤–è¾¹è·æ‰ä¸ä¼šè·Ÿçˆ¶å…ƒç´ ç›¸å…³å¤–è¾¹è·åˆå¹¶ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚ä½•é˜²æ­¢æˆ‘ä»¬çš„å¤–è¾¹è·å‘ç”Ÿåˆå¹¶å‘¢ï¼Ÿå½“ç„¶ï¼Œæˆ‘ä»¬éœ€è¦æ”¾ä¸€äº›ä¸œè¥¿æ¥åˆ†å‰²å®ƒä»¬ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¾‹å¦‚æœ‰äº›è®¸çš„å†…è¾¹è·æˆ–è€…è¾¹æ¡†(æˆ‘ä»¬åº”è¯¥å°†è¿™æ¡è§„åˆ™åº”ç”¨åœ¨çˆ¶å…ƒç´ æˆ–è€…å­å…ƒç´ )ã€‚å¦å¤–ä¸€ä¸ªé€‰æ‹©å°±æ˜¯åœ¨çˆ¶å…ƒç´ æ·»åŠ <code>clearfix</code>ç±»ã€‚</p>
<h2 id="é€šè¿‡åƒç´ å’Œç™¾åˆ†æ¯”æ¥å®šä½å…ƒç´ "><a href="#é€šè¿‡åƒç´ å’Œç™¾åˆ†æ¯”æ¥å®šä½å…ƒç´ " class="headerlink" title="é€šè¿‡åƒç´ å’Œç™¾åˆ†æ¯”æ¥å®šä½å…ƒç´ "></a>é€šè¿‡åƒç´ å’Œç™¾åˆ†æ¯”æ¥å®šä½å…ƒç´ </h2><p>ä½ æ˜¯å¦é€šè¿‡ç™¾åˆ†æ¯”å–ä»£åƒç´ çš„æ–¹æ³•å®šä¹‰<code>offset</code>æ¥å®šä½å…ƒç´ ï¼Ÿå‡å¦‚ä½ çš„å›ç­”æ˜¯æœ‰çš„è¯ï¼Œä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°è®¡ç®—<code>offset</code>çš„å€¼è·Ÿä½ é€‰æ‹©çš„CSSå•ä½(ä¾‹å¦‚ï¼šåƒç´ æˆ–è€…ç™¾åˆ†æ¯”)ä¸ä¸€æ ·ã€‚</p>
<p>è¿™çœ‹èµ·æ¥æœ‰ç‚¹è®©äººè¿·æƒ‘ï¼Œå¯¹å§ï¼Ÿæ‰€ä»¥ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸‹<a href="https://drafts.csswg.org/css-position-3/#valdef-top-percentage" target="_blank" rel="noopener">è§„èŒƒ</a>å¯¹äºç”¨ç™¾åˆ†æ¯”æ¥å£°æ˜å…ƒç´ çš„<code>offset</code>å€¼æ˜¯æ€ä¹ˆæè¿°çš„ã€‚</p>
<blockquote>
<p>The offset is a percentage of the containing blockâ€™s width (for left or right) or height (for top and bottom). For stickily positioned elements, the offset is a percentage of the flow rootâ€™s width (for left or right) or height (for top or bottom). Negative values are allowed.</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æˆ‘ä»¬é€šè¿‡ç™¾åˆ†æ¯”æ¥å®šä¹‰<code>offset</code>çš„å€¼ï¼Œé‚£ä¹ˆç›®æ ‡å…ƒç´ çš„ä½ç½®ä¾èµ–äºçˆ¶å…ƒç´ çš„å®½(å¯¹äºå·¦å³åç§»)å’Œé«˜(å¯¹äºä¸Šä¸‹åç§»)ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†è¿™ç§å·®å¼‚</p>
<p data-height="499" data-theme-id="0" data-slug-hash="PPbGbL" data-user="georgemarts" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/georgemarts/pen/PPbGbL" target="_blank" rel="noopener">Timer</a> forked by Georgemarts (<a href="http://codepen.io" target="_blank" rel="noopener">@georgemarts</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a></p>

<p>åœ¨è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬é€šè¿‡äº†åƒç´ è·Ÿç™¾åˆ†æ¯”æ¥ç§»åŠ¨è¿™ä¸ªå…ƒç´ ã€‚æœç„¶ï¼Œå½“æˆ‘ä»¬ç”¨åƒç´ æ¥å£°æ˜<code>offset</code>çš„å€¼ï¼Œå…ƒç´ ä¼šåœ¨æŒ‰ç…§æˆ‘ä»¬æ‰€æœŸæœ›çš„ä½ç½®ã€‚</p>
<p>ç›¸åï¼Œå½“æˆ‘ä»¬é€‰æ‹©ç™¾åˆ†æ¯”æ¥è®¾è®¡CSSåç§»å•ä½æ—¶ï¼Œå…¶å…ƒç´ çš„ä½ç§»ä¾èµ–äºçˆ¶å…ƒç´ çš„å°ºå¯¸ã€‚è¿™é‡Œæœ‰ä¸ªæœ‰ç”¨çš„å¯è§†åŒ–å›¾å±•ç¤ºäº†æ–°ä½ç½®æ˜¯å¦‚ä½•è®¡ç®—çš„(é€šè¿‡ç™¾åˆ†æ¯”)ï¼š</p>
<p><img src="/images/css/css-07.png" alt=""></p>
<p><em>æ³¨æ„ï¼šä¼°è®¡ä½ å·²ç»çŸ¥é“äº†ï¼Œ<code>transform</code>å±æ€§(ä¼´éšç€ä¸åŒçš„<code>translate</code>æ–¹æ³•)åŒæ ·ä¹Ÿå¯ä»¥æ”¹å˜ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„å‡å¦‚æˆ‘ä»¬ä½¿ç”¨ç™¾åˆ†æ¯”æ¥ä½œä¸ºCSSçš„å•ä½ï¼Œé‚£ä¹ˆè¯¥å…ƒç´ æ˜¯ç›¸å¯¹äºå®ƒçš„å°ºå¯¸ä½ç§»è€Œä¸æ˜¯ç›¸å¯¹äºçˆ¶å…ƒç´ çš„å°ºå¯¸ä½ç§»ã€‚</em></p>
<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®ä½ ç‰¢å›ºçš„ç†è§£CSSçš„ä½ç½®å¸ƒå±€æ–¹æ³•å’Œçªå‡ºCSSæ¦‚å¿µçš„ç–‘æƒ‘ç‚¹ã€‚åŒæ ·æˆ‘ä¹Ÿå¾ˆä¹æ„åœ¨ä»¥ä¸‹çš„è¯„è®ºä½ èƒ½åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œé—®é¢˜æˆ–è€…å»ºè®®ã€‚æ„Ÿè°¢ä½ çš„é˜…è¯»ï¼</p>
<script src="http://codepen.io/assets/embed/ei.js"> </script>]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS - ä¸ƒç§å…ƒç´ å±…ä¸­çš„æ–¹æ³•]]></title>
      <url>https://lucius0.github.io/2016/10/28/archivers/seven_ways_of_centering_with_css/</url>
      <content type="html"><![CDATA[<p>ç”±äºå·¥ä½œæ—¶é—´å¤ªå¿™åŠ ä¸Šå¤§é•¿å‡å¾ˆä¹…æ²¡æœ‰æ›´æ–°äº†ã€‚</p>
<p>æ¥ä¸‹æ¥æ›´æ–°ä¸€ä¸‹å¦‚ä½•ç”¨csså±…ä¸­å…ƒç´ ï¼ŒåŸæ–‡é“¾æ¥<a href="http://thenewcode.com/723/Seven-Ways-of-Centering-With-CSS" target="_blank" rel="noopener">ã€ŠSeven-Ways-of-Centering-With-CSSã€‹</a>ã€‚</p>
<h2 id="ä¸ƒç§å…ƒç´ å±…ä¸­çš„æ–¹æ³•"><a href="#ä¸ƒç§å…ƒç´ å±…ä¸­çš„æ–¹æ³•" class="headerlink" title="ä¸ƒç§å…ƒç´ å±…ä¸­çš„æ–¹æ³•"></a>ä¸ƒç§å…ƒç´ å±…ä¸­çš„æ–¹æ³•</h2><p>å±…ä¸­htmlå…ƒç´ åœ¨ç½‘é¡µå¼€å‘ä¼¼ä¹çœ‹èµ·æ¥æŒºç®€å•çš„ã€‚ä½†æ˜¯åœ¨æŸäº›æ¡ˆä¾‹ä¸­ï¼Œå¤æ‚çš„å¸ƒå±€ä¼šç»å¸¸æ¶ˆé™¤ä¸€äº›è§£å†³æ–¹æ³•ï¼Œä½¿å¾—ç½‘é¡µå¼€å‘äººå‘˜ç‰¹åˆ«çš„å¤´ç—›ã€‚</p>
<p>ç›¸å¯¹å‚ç›´å±…ä¸­ï¼Œæ°´å¹³å±…ä¸­å°±ç•¥æ˜¾å¾—ç®€å•äº›ï¼Œä½†åŒæ—¶è¦è§£å†³ä¸¤è€…å°±æœ‰éš¾åº¦äº†ã€‚åœ¨è¿™å“åº”å¼è®¾è®¡çš„æ—¶ä»£ï¼Œæˆ‘ä»¬å¾ˆå°‘èƒ½å‡†ç¡®çš„çŸ¥é“å…ƒç´ çš„é«˜åº¦è·Ÿå®½åº¦ï¼Œå› æ­¤å¯¼è‡´å¾ˆå¤šæ–¹æ¡ˆå¤±æ•ˆã€‚æ®æˆ‘æ‰€çŸ¥ï¼ŒCSSè‡³å°‘æœ‰6ç§å±…ä¸­å…ƒç´ çš„æ–¹æ³•ã€‚æˆ‘å°†ç”¨ä»¥ä¸‹çš„åŸºç¡€ä»£ç ï¼Œè®²è§£ä»æœ€ç®€å•æœ€å¥½å®ç°çš„åˆ°å¤æ‚çš„æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"center"</span>&gt;</span><br><span class="line">  &lt;img src=<span class="string">"jimmy-choo-shoe.jpg"</span> alt&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
<p>é‹å­å›¾ç‰‡ä¼šæ”¹å˜ï¼Œä½†éƒ½ä¼šä¿æŒåœ¨500px X 500px çš„å¤§å°ã€‚<a href="http://thenewcode.com/61/An-Easy-Guide-To-HSL-Color-In-CSS3" target="_blank" rel="noopener">HSL colors</a>ä¼šä½¿èƒŒæ™¯å›¾ç‰‡ä¿æŒä¸€è‡´ã€‚</p>
<h3 id="ä½¿ç”¨text-alignæ°´å¹³å±…ä¸­"><a href="#ä½¿ç”¨text-alignæ°´å¹³å±…ä¸­" class="headerlink" title="ä½¿ç”¨text-alignæ°´å¹³å±…ä¸­"></a>ä½¿ç”¨text-alignæ°´å¹³å±…ä¸­</h3><p><img src="/images/css/css-01.png" alt=""></p>
<p>æœ‰æ—¶æ˜¾è€Œæ˜“è§çš„è§£å†³æ–¹æ¡ˆæ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span><span class="selector-class">.center</span> &#123;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">hsl</span>(0, 100%, 97%);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.center</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">33%</span>;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ¡ˆå¹¶ä¸èƒ½ä½¿å›¾ç‰‡å‚ç›´å±…ä¸­ï¼šä½ éœ€è¦åœ¨<code>&lt;div&gt;</code>æ·»åŠ <code>padding</code>æˆ–è€…ç»™å†…å®¹æ·»åŠ <code>margin-top</code>è·Ÿ<code>margin-bottom</code>ä½¿å¾—å†…å®¹ä¸å®¹å™¨æœ‰ä¸€å®šçš„é«˜åº¦ã€‚</p>
<h3 id="ä½¿ç”¨marginå±…ä¸­ï¼šauto"><a href="#ä½¿ç”¨marginå±…ä¸­ï¼šauto" class="headerlink" title="ä½¿ç”¨marginå±…ä¸­ï¼šauto"></a>ä½¿ç”¨marginå±…ä¸­ï¼šauto</h3><p><img src="/images/css/css-02.png" alt=""></p>
<p>åˆä¸€æ¬¡ä¸»è¦æ˜¯é’ˆå¯¹æ°´å¹³å±…ä¸­ï¼Œè·Ÿä¸Šé¢çš„<code>text-align</code>åŒæ ·å…·æœ‰å±€é™æ€§</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span><span class="selector-class">.center</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">hsl</span>(60, 100%, 97%);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.center</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">33%</span>;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ä¸€ä¸‹<code>display: block</code>ï¼Œæ˜¯å…¶å±æ€§ä½¿å¾—<code>margin: 0 auto</code>ç”Ÿæ•ˆçš„ã€‚</p>
<h3 id="table-cell-å±…ä¸­"><a href="#table-cell-å±…ä¸­" class="headerlink" title="table-cell å±…ä¸­"></a>table-cell å±…ä¸­</h3><p>ä½¿ç”¨<code>display: table-cell</code>ï¼Œè€Œä¸æ˜¯<code>tabel</code>æ ‡ç­¾ï¼›å¯ä»¥å¯¹æ°´å¹³è·Ÿå‚ç›´å±…ä¸­åŒæ—¶æœ‰æ•ˆï¼Œä½†æ˜¯éœ€è¦æ·»åŠ é¢å¤–çš„å…ƒç´ ä½œä¸ºå®¹å™¨</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"center-aligned"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"center-core"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"jimmy-choo-shoe.jpg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>The Css</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.center-aligned</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: table;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">hsl</span>(120, 100%, 97%);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.center-core</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: table-cell;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.center-core</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">33%</span>;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„å®½åº¦<code>width: 100%</code>ï¼Œæ˜¯ä¸ºäº†ä½¿å…¶<code>&lt;div&gt;</code>ä¸å‘ç”ŸæŠ˜å ï¼Œè¿˜æœ‰å¤–éƒ¨å®¹å™¨éœ€è¦æ·»åŠ é«˜åº¦ä½¿å…¶å†…å®¹å‚ç›´å±…ä¸­ã€‚å¯ä»¥å°è¯•ç»™<code>html</code>å’Œ<code>body</code>è®¾ç½®é«˜åº¦ï¼Œå…¶å†…å®¹å…ƒç´ åŒæ ·ä¹Ÿå¯ä»¥åœ¨<code>body</code>å‚ç›´å±…ä¸­ã€‚å¯ä»¥æ­£å¸¸çš„è¿è¡Œåœ¨IE 8+æµè§ˆå™¨ã€‚</p>
<h3 id="ç»å¯¹å±…ä¸­-Absolute-Centering"><a href="#ç»å¯¹å±…ä¸­-Absolute-Centering" class="headerlink" title="ç»å¯¹å±…ä¸­(Absolute Centering)"></a>ç»å¯¹å±…ä¸­(Absolute Centering)</h3><p><img src="/images/css/css-03.png" alt=""></p>
<p>æœ‰ä¸€ç§è·¨æµè§ˆå™¨æ”¯æŒçš„æ–¹æ¡ˆï¼Œä½†æ˜¯å”¯ä¸€çš„ç¼ºç‚¹å°±æ˜¯éœ€è¦åœ¨å¤–éƒ¨å®¹å™¨å£°æ˜å…¶é«˜åº¦<code>height</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.absolute-aligned</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">hsl</span>(200, 100%, 97%);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.absolute-aligned</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">  <span class="attribute">overflow</span>: auto;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨translateå±…ä¸­"><a href="#ä½¿ç”¨translateå±…ä¸­" class="headerlink" title="ä½¿ç”¨translateå±…ä¸­"></a>ä½¿ç”¨translateå±…ä¸­</h3><p><img src="/images/css/css-04.png" alt=""></p>
<p>Chris Coiyer æå‡ºäº†ä¸€ç§èƒ½åŒæ—¶æ”¯æŒæ°´å¹³å±…ä¸­è·Ÿå‚ç›´å±…ä¸­çš„<a href="http://thenewcode.com/273/CSS3-2D-Transformations-Introduction" target="_blank" rel="noopener">ã€Šæ–°æ–¹æ¡ˆã€‹</a></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">hsl</span>(180, 100%, 97%);</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">500px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.center</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-50%, -50%);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">30%</span>;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>åŒæ—¶ä¹Ÿå¸¦æ¥äº†ä»¥ä¸‹å‡ ç‚¹ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li><p>CSS transform ä¼šè¦æ±‚åœ¨ä¸åŒçš„æµè§ˆå™¨æ·»åŠ æµè§ˆå™¨å‰ç¼€ï¼›</p>
</li>
<li><p>ä¸èƒ½åœ¨æ¯”è¾ƒè€çš„IEæµè§ˆå™¨å…¼å®¹(IE 8åŠä»¥ä¸‹ç‰ˆæœ¬)ï¼›</p>
</li>
<li><p>å¤–éƒ¨å®¹å™¨å°†éœ€è¦è®¾ç½®é«˜åº¦(æˆ–å…¶ä»–æ–¹å¼)ï¼Œå¹¶ä¸”ä¸èƒ½ä»å¤„äºç»å¯¹ä½ç½®çš„å†…å®¹è·å–ä»»ä½•é«˜åº¦ï¼›</p>
</li>
<li><p>å¦‚ä½•å†…å®¹åŒ…å«æ–‡æœ¬ï¼Œå½“å‰æµè§ˆå™¨åˆæˆæŠ€æœ¯ä¹Ÿä¼šä½¿å·²å‘ç”Ÿè½¬æ¢çš„æ–‡æœ¬æ¨¡ç³Šã€‚</p>
</li>
</ul>
<h3 id="Flexbox-å±…ä¸­"><a href="#Flexbox-å±…ä¸­" class="headerlink" title="Flexbox å±…ä¸­"></a>Flexbox å±…ä¸­</h3><p><img src="/images/css/css-05.png" alt=""></p>
<p>ä¸€æ—¦å±æ€§å·®å¼‚æ€§ä»¥åŠæµè§ˆå™¨å‰ç¼€çš„é—®é¢˜é€æ¸æ¶ˆå¤±ï¼Œè¿™ç§è§£å†³æ–¹æ¡ˆå°†ä¼šæˆä¸ºä¸»æµæ–¹æ¡ˆã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">  <span class="attribute">backgroud</span>: <span class="built_in">hsl</span>(240, 100%, 97%);</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.center</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">30%</span>;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è®¸å¤šæ–¹é¢<code>flexbox</code>æ˜¯æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æœ‰ä¸€ä¸ªç¼ºç‚¹çš„æ˜¯æ–°æ—§ä¸¤ç§è¯­æ³•ä»¥åŠæ—©æœŸç‰ˆæœ¬çš„IEæµè§ˆå™¨ä¸æ”¯æŒ(å°½ç®¡ä½¿ç”¨<code>display:table-cell</code>å¯ä»¥ä½œä¸ºé™çº§æ–¹æ¡ˆ)ã€‚</p>
<p>å¦‚ä»Šçš„è§„èŒƒå·²ç»ç¡®å®šä¸‹æ¥ï¼Œå¹¶ä¸”ç°ä»£çš„æµè§ˆå™¨ä¹Ÿæ”¯æŒäº†ï¼Œå…·ä½“çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒ<a href="http://thenewcode.com/780/A-Designers-Guide-To-Flexbox" target="_blank" rel="noopener">ã€Šflexbox layout and its usesã€‹</a></p>
<h3 id="ä½¿ç”¨calcå±…ä¸­"><a href="#ä½¿ç”¨calcå±…ä¸­" class="headerlink" title="ä½¿ç”¨calcå±…ä¸­"></a>ä½¿ç”¨calcå±…ä¸­</h3><p><img src="/images/css/css-06.png" alt=""></p>
<p>åœ¨æŸäº›æ–¹é¢æ¯”<code>flexbox</code>æ›´çµæ´»ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">hsl</span>(300, 100%, 97%);</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">600px</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.center</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">40%</span>;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="built_in">calc</span>(50% - 20%);</span><br><span class="line">  <span class="attribute">left</span>: <span class="built_in">calc</span>(50% - 20%);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>éå¸¸ç®€å•ï¼Œ<code>calc</code>å…è®¸ä½ åŸºäºå½“å‰é¡µé¢çš„å¸ƒå±€è¿›è¡Œè®¡ç®—ã€‚åœ¨ä¸Šé¢çš„è®¡ç®—ä¸­ï¼Œ50%æ˜¯å®¹å™¨å…ƒç´ çš„ä¸­å¿ƒç‚¹ï¼Œä½†æ˜¯ä»…ä»…ä½¿ç”¨50%ä¼šä½¿<em>å›¾ç‰‡çš„å·¦ä¸Šè§’</em>å¯¹å…¶<code>&lt;div&gt;</code>çš„ä¸­å¿ƒã€‚æˆ‘ä»¬éœ€è¦å°†å›¾ç‰‡çš„å®½é«˜åŒæ—¶ç§»å›ä¸€åŠã€‚è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">top: calc(50% - (40% / 2));</span><br><span class="line">left: calc(50% - (40% / 2));</span><br></pre></td></tr></table></figure>
<p>åœ¨å¦‚ä»Šçš„æµè§ˆå™¨ï¼Œä½ ä¼šå‘ç°è¿™ç§è§£å†³æ–¹æ¡ˆæ›´é€‚åˆå†…å®¹çš„å®½é«˜ä¸ºå›ºå®šå°ºå¯¸ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.center</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="built_in">calc</span>(50% - (300px / 2));</span><br><span class="line">  <span class="attribute">left</span>: <span class="built_in">calc</span>(50% - (300px - 2));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯¦ç»†çš„<code>calc</code>ä½¿ç”¨æ–¹æ³•å¯ä»¥æŸ¥çœ‹ï¼š<a href="http://thenewcode.com/953/Layout-Math-with-CSS-Understanding-calc" target="_blank" rel="noopener">Layout Math with CSS: Understanding calc</a></p>
<p>è¿™ç§è§£å†³æ–¹æ¡ˆè·Ÿ<code>flexbox</code>ä¸€æ ·æœ‰è®¸å¤šç¼ºç‚¹ï¼šå½“ä»£æµè§ˆå™¨èƒ½å¾ˆå¥½çš„æ”¯æŒè¯¥æ–¹æ¡ˆï¼Œä½†æ˜¯åœ¨æ—©æœŸçš„æµè§ˆå™¨è¿˜æ˜¯è¿˜æ˜¯éœ€è¦æµè§ˆå™¨å‰ç¼€ï¼Œå¹¶ä¸”ä¸æ”¯æŒIE 8</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.center</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">40%</span>;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">  <span class="attribute">top</span>: <span class="built_in">calc</span>(50% - 20%);</span><br><span class="line">  <span class="attribute">left</span>: <span class="built_in">calc</span>(50% - 20%);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptä¹‹åäºŒ - CMDä¸AMDå¼‚åŒ]]></title>
      <url>https://lucius0.github.io/2016/08/20/archivers/javascript-cmd-amd/</url>
      <content type="html"><![CDATA[<ul>
<li>å¼‚æ­¥æ¨¡å—å®šä¹‰ï¼š<a href="https://github.com/amdjs/amdjs-api/wiki/AMD" target="_blank" rel="noopener">AMD</a></li>
<li>é€šç”¨æ¨¡å—å®šä¹‰ï¼š<a href="https://github.com/seajs/seajs/issues/242" target="_blank" rel="noopener">CMD</a></li>
</ul>
<p>AMDæ˜¯RequireJsæ¨å¹¿è¿‡ç¨‹ä¸­äº§å‡ºï¼Œè€ŒCMDåˆ™æ˜¯SeaJsã€‚è·Ÿä¸Šä¸€ç¯‡æ–‡ç« ä¸€æ ·éƒ½æ˜¯ä¸ºäº†jsçš„æ¨¡å—åŒ–å¼€å‘ï¼Œç‰¹åˆ«æ˜¯åœ¨æµè§ˆå™¨ç«¯ï¼Œéƒ½èƒ½è¾¾åˆ°æµè§ˆå™¨æ¨¡å—åŒ–å¼€å‘çš„ç›®çš„ã€‚</p>
<p>åŒºåˆ«ï¼š</p>
<ol>
<li><p>å¯¹äºä¾èµ–çš„æ¨¡å—ï¼ŒAMDæ˜¯<strong>æå‰æ‰§è¡Œ</strong>ï¼ŒCMDæ˜¯<strong>å»¶è¿Ÿæ‰§è¡Œ</strong>ã€‚ä¸è¿‡åœ¨RequireJs 2.0å¼€å§‹ä¹Ÿå¯ä»¥æ”¹ä¸ºå»¶è¿Ÿæ‰§è¡Œã€‚</p>
</li>
<li><p>CMDæ¨å´‡<strong>ä¾èµ–å°±è¿‘</strong>ï¼ŒAMDæ¨å´‡<strong>ä¾èµ–å‰ç½®</strong></p>
</li>
</ol>
<p>// CMD</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params">require, exports, module</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./a'</span>);</span><br><span class="line">	a.doSomething();</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">	<span class="keyword">var</span> b = <span class="built_in">require</span>(<span class="string">'./b'</span>);</span><br><span class="line">	b.doSomething();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>// AMD</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">define([<span class="string">'./a'</span>, <span class="string">'./b'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">	a.doSomething();</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">	b.doSomething();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>å‚è€ƒ<strong><a href="https://www.zhihu.com/question/20351507/answer/14859415" target="_blank" rel="noopener">çŸ¥ä¹å¤§ç¥ç‰ä¼¯çš„å›ç­”</a></strong></p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptä¹‹åä¸€ - AMD,CommonJs,UMD]]></title>
      <url>https://lucius0.github.io/2016/08/20/archivers/javascript-amd-commonjs-umd/</url>
      <content type="html"><![CDATA[<p>æ¨¡å—åŒ–æ˜¯jsç›®å‰æ¥è¯´æ˜¯æœ€ä¸ºå¸¸è§çš„å¼€å‘è§„èŒƒï¼Œå› ä¸ºjså¹¶æ²¡æœ‰ç±»çš„æ¦‚å¿µï¼Œå› æ­¤æ‰ä¼šæœ‰ä»¥ä¸‹çš„è§„èŒƒã€‚åœ¨ç†æƒ³çŠ¶æ€ä¸‹ï¼Œç¨‹åºå‘˜åªéœ€è¦å…³å¿ƒä¸šåŠ¡é€»è¾‘å°±å¥½äº†ã€‚åœ¨ä»¥å¾€ï¼Œjsçš„æ¼”å˜ä¹Ÿæ˜¯äº”èŠ±å…«é—¨ï¼Œä»æœ€ä¸ºåŸå§‹çš„å‡½æ•°å†™æ³•ï¼Œåˆ°ç«‹å³æ‰§è¡Œå‡½æ•°å†™æ³•ï¼Œå†åˆ°ä¼ å‚å…¨å±€å˜é‡å†™æ³•ï¼Œå¯è§å¼€å‘è€…å¯¹æ¨¡å—åŒ–ç¼–ç¨‹çš„è¿«åˆ‡éœ€æ±‚ã€‚</p>
<p>åŸå§‹å†™æ³•</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>ç«‹å³æ‰§è¡Œå‡½æ•°å†™æ³•</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> _x = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">var</span> _f1 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">	<span class="keyword">var</span> _f2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		f1: _f1,</span><br><span class="line">		f2: _f2</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>ä¼ å‚å…¨å±€å˜é‡å†™æ³•</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = (<span class="function"><span class="keyword">function</span>(<span class="params">$</span>)</span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;)(jQuery);</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢å°±æ˜¯è¦ä»‹ç»å¸¸è§çš„æ¨¡å—åŒ–è§„èŒƒç¼–ç¨‹ï¼Œç¿»è¯‘è‡ª<strong><a href="http://davidbcalhoun.com/2014/what-is-amd-commonjs-and-umd/" target="_blank" rel="noopener">What Is AMD, CommonJS, and UMD?</a></strong></p>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>å¤šå¹´æ¥Javascriptçš„ç”Ÿæ€åœˆä¸€ç›´åœ¨ç¨³æ­¥çš„å®Œå–„ä»¥è‡³äºæœ‰è¶³å¤Ÿå¤šçš„ç»„ä»¶å¯ä¾›é€‰æ‹©ï¼Œæœ¬æ¥å¤§é‡çš„ç»„ä»¶ç†åº”æ˜¯æŒ¯å¥‹äººå¿ƒçš„ï¼Œä½†æ˜¯å½“å¤šä¸ªç¬¬ä¸‰æ–¹ç»„ä»¶æ··ç”¨æ—¶ä¹ŸåŒæ ·å¸¦æ¥äº†å¾ˆå¤šéº»çƒ¦ï¼Œé‚£å°±æ˜¯å½“å¼€å‘äººå‘˜æ··ç”¨æ—¶å¹¶ä¸èƒ½å¾ˆå¥½çš„äº’ç›¸å…¼å®¹ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒAMDä¸CommonJså°±å‡ºç°äº†ï¼Œä»–ä»¬è¦æ±‚å¼€å‘è€…é‡‡ç”¨è§„èŒƒåŒ–çš„æ¨¡å¼å¼€å‘ä»¥å…æ±¡æŸ“æ•´ä¸ªç”Ÿæ€ç³»ç»Ÿã€‚</p>
<h2 id="AMD"><a href="#AMD" class="headerlink" title="AMD"></a>AMD</h2><p>gitï¼š<a href="https://github.com/amdjs/amdjs-api/wiki/AMD#using-require-and-exports" target="_blank" rel="noopener">amdjs</a></p>
<p>å¼‚æ­¥æ¨¡å—å®šä¹‰(Asynchronous Module Definition)ï¼Œæµè¡Œçš„RequireJSå°±æ˜¯ç”¨çš„AMDè§„èŒƒã€‚å®ƒé‡‡ç”¨å¼‚æ­¥æ–¹å¼åŠ è½½æ¨¡å—ï¼Œæ¨¡å—çš„åŠ è½½ä¸å½±å“å®ƒåé¢è¯­å¥çš„è¿è¡Œï¼Œæ‰€æœ‰éœ€è¦ä¾èµ–çš„é€»è¾‘éƒ½ä¼šå®šä¹‰åœ¨å›è°ƒå‡½æ•°ï¼Œç­‰åˆ°åŠ è½½å®Œæ¯•ä¹‹åå°±ä¼šè§¦å‘å›è°ƒå‡½æ•°ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªå¯¹jQueryå•ä¸€ä¾èµ–æ¨¡å—<code>foo</code>ï¼Œæ˜¯ç”¨AMDè§„èŒƒçš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filename: foo.js</span></span><br><span class="line">define([<span class="string">'jquery'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">$</span>) </span>&#123;</span><br><span class="line">	<span class="comment">// method</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">myFunc</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// exposed public methods</span></span><br><span class="line">	<span class="keyword">return</span> myFunc;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ç¨å¤æ‚å¤šä¾èµ–å¹¶ä¸”æš´éœ²å…¬å…±æ–¹æ³•çš„ä¾‹å­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filename: foo.js</span></span><br><span class="line">define([<span class="string">'jquery'</span>, <span class="string">'underscore'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">$, _</span>) </span>&#123;</span><br><span class="line">	<span class="comment">// methods</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;&#125;; <span class="comment">// private because it's not returned (see below)</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;&#125;; <span class="comment">// public because it's returned</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>) </span>&#123;&#125;; <span class="comment">// public because it's returned</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// exposed public methods</span></span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		b: b,</span><br><span class="line">		c: c</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€éƒ¨åˆ†æ˜¯ä¾èµ–æ¨¡å—çš„æ•°ç»„å®šä¹‰ï¼Œç¬¬äºŒéƒ¨åˆ†åˆ™æ˜¯å›è°ƒå‡½æ•°ï¼Œä½†å½“åªæœ‰ä¾èµ–çš„æ¨¡å—éƒ½æ˜¯å¯ç”¨æ—¶æ‰ä¼šæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚</p>
<p>å‚æ•°é¡ºåºè·Ÿä¾èµ–æ¨¡å—çš„é¡ºåºä¸€è‡´å¾ˆé‡è¦(ex.jQuery -&gt; $, underscore -&gt; _)</p>
<p>å½“ç„¶æˆ‘ä»¬å¯ä»¥å°†å›è°ƒå‡½æ•°çš„å‚æ•°åæ”¹æˆæˆ‘ä»¬æƒ³è¦çš„ï¼Œå‡å¦‚æˆ‘ä»¬åœ¨ä»£ç ä¸­å°†<code>$</code>æ”¹æˆ<code>$$</code>ï¼Œé‚£ä¹ˆå°±åº”è¯¥åœ¨å‡½æ•°ä½“é‡Œé¢æ‰€æœ‰JQueryçš„å¼•ç”¨éƒ½ç”¨<code>$$</code>æ›¿æ¢<code>$</code></p>
<p>æœ€åä¸€ç‚¹ï¼Œä¹Ÿæ˜¯é‡è¦çš„ä¸€ç‚¹ï¼Œå°±æ˜¯ä½ ä¸èƒ½å†å‡½æ•°çš„å£°æ˜å¤–éƒ¨è°ƒç”¨<code>$</code>è·Ÿ<code>_</code>ï¼Œå› ä¸ºæœ‰å‡½æ•°ä½œç”¨åŸŸï¼Œåªæœ‰å›è°ƒå‡½æ•°å†…æ‰å¯ä»¥è°ƒç”¨ã€‚</p>
<h2 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h2><p>git: <a href="https://github.com/efacilitation/commonjs-require" target="_blank" rel="noopener">commonJs</a></p>
<p>å‡å¦‚ä½ æœ‰å†™è¿‡nodejsçš„è¯ï¼Œé‚£ä¹ˆä½ åº”è¯¥ä¼šå¯¹CommonJsæ„Ÿåˆ°éå¸¸çš„äº²åˆ‡ï¼ŒCommonJsæ˜¯å› ä¸ºBrowserifyæµè¡Œèµ·æ¥çš„ã€‚</p>
<p>ç”¨ä¸€ä¸ªè·Ÿä¸Šä¸€ä¸ªåŒæ ·çš„æ¡ˆä¾‹ï¼Œæ¥çœ‹çœ‹<code>foo</code>å‡½æ•°åœ¨CommonJsé•¿ä»€ä¹ˆæ ·</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filename: foo.js</span></span><br><span class="line"><span class="comment">// dependencies</span></span><br><span class="line"><span class="keyword">var</span> $ = <span class="built_in">require</span>(<span class="string">'jquery'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// methods</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunc</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// exposed public method (single)</span></span><br><span class="line"><span class="built_in">module</span>.exports = myFunc;</span><br></pre></td></tr></table></figure>
<p>åŒæ ·ç”¨ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„ä¾‹å­ï¼Œä¹Ÿæ˜¯å¤šä¾èµ–</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filename: foo.js</span></span><br><span class="line"><span class="keyword">var</span> $ = <span class="built_in">require</span>(<span class="string">'jquery'</span>);</span><br><span class="line"><span class="keyword">var</span> _ = <span class="built_in">require</span>(<span class="string">'underscore'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// methods</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;&#125;; <span class="comment">// private because it's omitted from module.exports</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;&#125;; <span class="comment">// public because it's defined in module.exports</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>) </span>&#123;&#125;; <span class="comment">// public because it's defined in module.exports</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// exposed public methods</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	b: b,</span><br><span class="line">	c: c</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="UMD-Universal-Module-Definition"><a href="#UMD-Universal-Module-Definition" class="headerlink" title="UMD: Universal Module Definition"></a>UMD: Universal Module Definition</h2><p>git: <a href="https://github.com/umdjs/umd" target="_blank" rel="noopener">umdjs</a></p>
<p>è™½ç„¶CommonJsè·ŸAMDè§„èŒƒéƒ½åŒæ ·å—æ¬¢è¿ï¼Œä½†ä»–ä»¬ä¼¼ä¹è¿˜æ²¡æœ‰è¾¾æˆå…±è¯†ã€‚å› æ­¤æ¨åŠ¨äº†é€šç”¨æ¨¡å—å®šä¹‰çš„äº§ç”Ÿï¼Œç”¨ä»¥åŒæ—¶æ”¯æŒä¸¤ç§è§„èŒƒã€‚</p>
<p>ä¸å¾—ä¸è¯´UMDæ¨¡å¼çœ‹èµ·æ¥æ²¡æœ‰æ¯”AMDè·ŸCMDç®€æ´ï¼Œä½†æ˜¯CommonJsä¸ä»…åŒæ—¶æ”¯æŒAMDè·ŸCommonJSï¼Œè¿˜æ”¯æŒè€çš„è§„èŒƒå…¨å±€å˜é‡å®šä¹‰æ¨¡å¼(â€œglobalâ€ variable definition)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">root, factory</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">typeof</span> define === <span class="string">'function'</span> &amp;&amp; define.amd) &#123;</span><br><span class="line">		<span class="comment">// AMD</span></span><br><span class="line">		define([<span class="string">'jquery'</span>], factory);</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">typeof</span> exports === <span class="string">'object'</span>) &#123;</span><br><span class="line">		<span class="comment">// Node, CommonJS-like</span></span><br><span class="line">		<span class="built_in">module</span>.exports = factory(<span class="built_in">require</span>(<span class="string">'jquery'</span>));</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="comment">// Browser global (root is window)</span></span><br><span class="line">		root.returnExports = factory(root, jQuery);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$</span>)</span>&#123;</span><br><span class="line">	<span class="comment">// methods</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">myFunc</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// exposed public method</span></span><br><span class="line">	<span class="keyword">return</span> myFunc;</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<p>è€è§„çŸ©ï¼Œå¤æ‚çš„ä¾‹å­ä»¥åŠå¤šä¾èµ–è·Ÿæš´éœ²å…¬å…±æ–¹æ³•</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">root, factory</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">typeof</span> define === <span class="string">'function'</span> &amp;&amp; define.amd) &#123;</span><br><span class="line">		<span class="comment">// AMD</span></span><br><span class="line">		define([<span class="string">'jquery'</span>, <span class="string">'underscore'</span>], factory);</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">typeof</span> exports === <span class="string">'object'</span>) &#123;</span><br><span class="line">		<span class="comment">// Node, CommonJs-like</span></span><br><span class="line">		<span class="built_in">module</span>.exports = factory(<span class="built_in">require</span>(<span class="string">'jquery'</span>), <span class="built_in">require</span>(<span class="string">'underscore'</span>));</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="comment">// Browser global (root is window)</span></span><br><span class="line">		root.returnExports = factory(root.jQuery, root._);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$, _</span>)</span>&#123;</span><br><span class="line">	<span class="comment">// methods</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;&#125;;    <span class="comment">//    private because it's not returned (see below)</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span>&#123;&#125;;    <span class="comment">//    public because it's returned</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>)</span>&#123;&#125;;    <span class="comment">//    public because it's returned</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// exposed public methods</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">    	b: b,</span><br><span class="line">    	c: c</span><br><span class="line">    &#125;</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<h2 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h2><p>è¿˜æœ‰ä¸€ç§æ¨¡å—åŒ–è§„èŒƒï¼Œè§ä¸‹ä¸€ç¯‡<!-- [ã€ŠCMDä¸AMDå¼‚åŒã€‹](/archivers/javascript-cmd-amd) --><a href="/2016/08/20//archivers/javascript-cmd-amd/" title="ã€ŠCMDä¸AMDå¼‚åŒã€‹">ã€ŠCMDä¸AMDå¼‚åŒã€‹</a></p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptä¹‹å - prototype]]></title>
      <url>https://lucius0.github.io/2016/08/18/archivers/javascript-prototype/</url>
      <content type="html"><![CDATA[<p>ä¸‹é¢è¿™æ®µæ˜¯ECMAScriptå…³äºåŸå‹çš„è§£é‡Š</p>
<blockquote>
<p>ECMAScript does not contain proper classes such as those in C++, Smalltalk, or Java, but rather, supports constructors which create objects by executing code that allocates storage for the objects and initialises all or part of them by assigning initial values to their properties. All constructors are objects, but not all objects are constructors. Each constructor has a Prototype property that is used to implement prototype-based inheritance and shared properties. Objects are created by using constructors in new expressions; for example, new String(â€œA Stringâ€) creates a new String object. Invoking a constructor without using new has consequences that depend on the constructor. For example, String(â€œA Stringâ€) produces a primitive string, not an object.</p>
<p>ECMAScript supports prototype-based inheritance. Every constructor has an associated prototype, and every object created by that constructor has an implicit reference to the prototype (called the objectâ€™s prototype) associated with its constructor. Furthermore, a prototype may have a non-null implicit reference to its prototype, and so on; this is called the prototype chain. When a reference is made to a property in an object, that reference is to the property of that name in the first object in the prototype chain that contains a property of that name. In other words, first the object mentioned directly is examined for such a property; if that object contains the named property, that is the property to which the reference refers; if that object does not contain the named property, the prototype for that object is examined next; and so on.</p>
</blockquote>
<p>ä»¥ä¸‹è½¬è‡ªçŸ¥ä¹<strong><a href="https://www.zhihu.com/question/34183746/answer/58155878?from=profile_answer_card" target="_blank" rel="noopener">doris</a></strong>çš„å›ç­”</p>
<p>é¦–å…ˆï¼Œåœ¨JSä¸­ï¼Œé™¤äº†åŸºæœ¬ç±»å‹<a href="/2016/08/07//archivers/javascript-data-types/" title="åŸºæœ¬ç±»å‹">åŸºæœ¬ç±»å‹</a>ï¼Œå…¶ä»–çš„éƒ½ä¸ºå¯¹è±¡ï¼ŒFunctionä¹Ÿæ˜¯å¯¹è±¡ï¼ŒFunction.prototypeä¹Ÿæ˜¯å¯¹è±¡ï¼Œå› æ­¤éƒ½æœ‰éšå¼åŸå‹<strong><strong>proto</strong></strong>ï¼ŒæŒ‡å‘äº†è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°çš„åŸå‹ï¼Œè¿™ä¿è¯äº†å®ä¾‹èƒ½å¤Ÿè®¿é—®åœ¨æ„é€ å‡½æ•°åŸå‹ä¸­å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•ã€‚</p>
<p>æ–¹æ³•(Function)åˆ™é™¤äº†ä»¥ä¸Šçš„<strong><strong>proto</strong></strong>å±æ€§ä»¥å¤–ï¼Œè¿˜æœ‰<strong>prototype</strong>è¿™ä¸ª<strong>åŸå‹å¯¹è±¡</strong>ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ç”¨é€”å°±æ˜¯åŒ…å«æ‰€æœ‰å®ä¾‹å…±äº«çš„å±æ€§å’Œæ–¹æ³•(prototype)ã€‚åŸå‹å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ªå±æ€§ï¼Œå«åš<strong>constructor</strong>ï¼Œè¿™ä¸ªå±æ€§åŒ…å«äº†ä¸€ä¸ªæŒ‡å‘åŸæ„é€ å‡½æ•°çš„æŒ‡é’ˆã€‚</p>
<p><img src="/images/javascript/javascript-prototype.jpg" alt=""></p>
<p>ç”±å›¾æˆ‘ä»¬å¯ä»¥çœ‹å‡º</p>
<ol>
<li><p><strong>æ„é€ å‡½æ•°Foo</strong> ï¼šæ„é€ å‡½æ•°çš„åŸå‹å±æ€§<strong>Foo.prototype</strong>æŒ‡å‘äº†åŸå‹å¯¹è±¡ï¼Œåœ¨åŸå‹å¯¹è±¡é‡Œæœ‰å…±æœ‰çš„æ–¹æ³•ï¼Œæ‰€æœ‰æ„é€ å‡½æ•°å£°æ˜çš„å®ä¾‹(f1, f2)éƒ½å¯ä»¥å…±äº«è¿™ä¸ªæ–¹æ³•ã€‚</p>
</li>
<li><p><strong>åŸå‹å¯¹è±¡Foo.prototype</strong> ï¼šåŸå‹å¯¹è±¡ä¿å­˜ç€å®ä¾‹å…±äº«çš„æ–¹æ³•ï¼Œæœ‰ä¸€ä¸ªconstructoræŒ‡å›æ„é€ å‡½æ•°ã€‚</p>
</li>
<li><p><strong>å®ä¾‹</strong> ï¼šf1å’Œf2æ˜¯Fooè¿™ä¸ªå¯¹è±¡çš„ä¸¤ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªä¸¤ä¸ªå¯¹è±¡ä¹Ÿæœ‰å±æ€§<strong><strong>proto</strong></strong>ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œè¿™æ ·å­å°±å¯ä»¥æƒ³<em>1</em>é‚£æ ·è®¿é—®åŸå‹å¯¹è±¡çš„æ‰€æœ‰æ–¹æ³•ã€‚</p>
</li>
</ol>
<p>å¦å¤–ï¼Œæ„é€ å‡½æ•°Foo()é™¤äº†æ˜¯æ–¹æ³•ï¼Œè¿˜æ˜¯ä¸ªå¯¹è±¡ï¼Œå®ƒä¹Ÿæœ‰<strong><strong>proto</strong></strong>å±æ€§ï¼ŒæŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚å‡½æ•°çš„æ„é€ å‡½æ•°æ˜¯Functionï¼Œå› æ­¤è¿™é‡Œçš„<strong><strong>proto</strong></strong>æŒ‡å‘äº†<strong>Function.prototype</strong>ã€‚</p>
<p>åŸå‹å¯¹è±¡åŒæ ·æ˜¯å±äºå¯¹è±¡ï¼Œå®ƒçš„<strong><strong>proto</strong></strong>å±æ€§æŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œå³<strong>Object.prototype</strong>ã€‚</p>
<p>æœ€åï¼ŒObject.prototypeçš„<strong><strong>proto</strong></strong>å±æ€§æŒ‡å‘nullã€‚</p>
<p><em>æ³¨æ„ï¼š</em> <code>typeof null</code>è¿”å›objectæ˜¯ç”±äºå†å²åŸå› å¯¼è‡´çš„ï¼Œå®é™…ä¸ŠECMAè§„èŒƒå°è¯•æŠŠ<code>typeof null</code>è¿”å›å€¼æ”¹ä¸ºâ€nullâ€ï¼Œä½†æ˜¯ä¼šå¯¼è‡´å¾ˆå¤šæ—§çš„ä»£ç å‡ºç°é—®é¢˜ï¼Œå› æ­¤åˆæ”¹å›æ¥äº†ã€‚æ‰€ä»¥è¯´nullå¹¶ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ªåŸºç¡€ç±»å‹ã€‚åœ¨<strong><a href="http://stackoverflow.com/questions/18808226/why-is-typeof-null-object" target="_blank" rel="noopener">stackoverflow</a></strong>æœ‰è¯¦ç»†çš„è¯´æ˜ã€‚</p>
<p><strong>æ€»ç»“ï¼š</strong></p>
<ol>
<li><p>å¯¹è±¡æœ‰å±æ€§<strong><strong>proto</strong></strong>ï¼ŒæŒ‡å‘è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼›</p>
</li>
<li><p>æ–¹æ³•é™¤äº†æœ‰å±æ€§<strong><strong>proto</strong></strong>ï¼Œè¿˜æœ‰å±æ€§<strong>prototype</strong>ï¼ŒæŒ‡å‘è¯¥æ–¹æ³•çš„åŸå‹å¯¹è±¡ã€‚</p>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[gitå¸¸ç”¨æŠ€å·§]]></title>
      <url>https://lucius0.github.io/2016/08/15/archivers/git-tips/</url>
      <content type="html"><![CDATA[<p>è¿™é‡Œè®°å½•çš„æ˜¯gitæœ€ä¸ºå¸¸è§çš„æ“ä½œï¼Œç„¶è€Œè¿™ç§å¸–å­åšå®¢åˆ°å¤„å¯è§ï¼Œæˆ‘åªæ˜¯è®°ä¸‹æ¥æ–¹ä¾¿æˆ‘æŸ¥é˜…è€Œä¸éœ€è¦åˆ°å¤„å»æŸ¥æ‰¾ã€‚åœ¨è¿™é‡Œæˆ‘æ¨èä¸€ä½åšä¸»çš„ç½‘ç«™<a href="http://www.liaoxuefeng.com/" target="_blank" rel="noopener">ã€Šå»–é›ªå³°ã€‹</a>ï¼Œç›¸ä¿¡å¾ˆå¤šäººéƒ½å·²ç»è§è¿‡ä»–çš„æ–‡ç« äº†ï¼Œæˆ‘ä¹Ÿæ˜¯æ‹œè¯»ä»–çš„æ–‡ç« å¾—ä»¥æŠ€æœ¯æˆé•¿ã€‚è¿˜æœ‰<a href="https://github.com/jaywcjlove/handbook/blob/master/other/Git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E6%B8%85%E5%8D%95.md" target="_blank" rel="noopener">ã€Šgit å¸¸ç”¨æ¸…å•ã€‹</a>ã€‚</p>
<ol>
<li><p>å·¥ä½œåŒºå’Œæš‚å­˜åŒº</p>
<p> å·¥ä½œåŒºï¼šå°±æ˜¯æœ¬åœ°ç›®å½•ï¼Œå³åœ¨<code>git add</code>ä¹‹å‰</p>
<p> æš‚å­˜åŒºï¼šåœ¨æ–‡ä»¶å¤¹.gitè¿™ä¸ª<strong>ç‰ˆæœ¬åº“</strong>ä¸‹æœ‰ä¸€ä¸ªæš‚å­˜åŒºè·Ÿå¾ˆå¤šåˆ†æ”¯ï¼Œå³åœ¨<code>git add</code>ä¹‹å</p>
<p> å½“æ‰§è¡Œ<code>git add</code>å‘½ä»¤æ—¶ï¼Œå·¥ä½œåŒºçš„å†…å®¹ä¾¿ä¼šåˆ°stageæš‚å­˜åŒºï¼Œ<code>git commit</code>ä¹‹åæš‚å­˜åŒºçš„å†…å®¹å°±ä¼šæäº¤åˆ°ç›¸å¯¹åº”çš„åˆ†æ”¯ä¸Šã€‚</p>
</li>
<li><p>gitç®¡ç†çš„æ˜¯ä¿®æ”¹</p>
<p> æ¯”å¦‚ç¬¬ä¸€æ¬¡ä¿®æ”¹<strong>readme</strong>ï¼Œç„¶åæ‰§è¡Œ<code>git add</code>åˆ°æš‚å­˜åŒºï¼Œç„¶åå†ä¿®æ”¹readmeï¼Œæœ€åæ‰§è¡Œ<code>git commit</code>æäº¤åˆ°åˆ†æ”¯ã€‚</p>
<p> ç»“æœè°ƒç”¨<code>git status</code>æ—¶å‘ç°ç°åœ¨ä»æœ‰ä¸€ä¸ª<strong>modified</strong>æ–‡ä»¶ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰æŠŠæ–°ä¿®æ”¹çš„æ–‡ä»¶æäº¤åˆ°æš‚å­˜åŒºï¼Œæ‰€ä»¥å¯¼è‡´åˆ†æ”¯ä¸­çš„æ–‡ä»¶å’Œå·¥ä½œåŒºçš„åŸæ–‡ä¸åŒ¹é…ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡æ–°<strong>add</strong>è·Ÿ<strong>commit</strong>ã€‚è¿™å°±æ˜¯æ‰€è¯´çš„ï¼Œgitç®¡ç†çš„æ˜¯<strong>â€œä¿®æ”¹â€</strong>ï¼Œè€Œä¸æ˜¯<strong>â€œæ–‡ä»¶â€</strong>æœ¬èº«ã€‚</p>
</li>
</ol>
<h2 id="1ã€ä¸¢å¼ƒå·¥ä½œåŒºçš„æ–‡ä»¶"><a href="#1ã€ä¸¢å¼ƒå·¥ä½œåŒºçš„æ–‡ä»¶" class="headerlink" title="1ã€ä¸¢å¼ƒå·¥ä½œåŒºçš„æ–‡ä»¶"></a>1ã€ä¸¢å¼ƒå·¥ä½œåŒºçš„æ–‡ä»¶</h2><p><strong>modified</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -- file</span><br></pre></td></tr></table></figure>
<h2 id="2ã€æš‚å­˜åŒºå›æ»š"><a href="#2ã€æš‚å­˜åŒºå›æ»š" class="headerlink" title="2ã€æš‚å­˜åŒºå›æ»š"></a>2ã€æš‚å­˜åŒºå›æ»š</h2><p><strong>add</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git reset HEAD file</span><br><span class="line">$ git checkout -- file</span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥</span></span><br><span class="line">$ git checkout HEAD -- file</span><br></pre></td></tr></table></figure>
<h2 id="3ã€ç‰ˆæœ¬å›æ»š"><a href="#3ã€ç‰ˆæœ¬å›æ»š" class="headerlink" title="3ã€ç‰ˆæœ¬å›æ»š"></a>3ã€ç‰ˆæœ¬å›æ»š</h2><p><strong>commit</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git reset --hard commit_id</span><br><span class="line"><span class="comment">// æŸ¥çœ‹å†å²ç‰ˆæœ¬</span></span><br><span class="line">$ git log</span><br><span class="line"><span class="comment">// æŸ¥çœ‹æœªæ¥ç‰ˆæœ¬</span></span><br><span class="line">$ git relog</span><br></pre></td></tr></table></figure>
<h2 id="4ã€å›æ»šå·²æäº¤åˆ°è¿œç¨‹ä»“åº“çš„æäº¤"><a href="#4ã€å›æ»šå·²æäº¤åˆ°è¿œç¨‹ä»“åº“çš„æäº¤" class="headerlink" title="4ã€å›æ»šå·²æäº¤åˆ°è¿œç¨‹ä»“åº“çš„æäº¤"></a>4ã€å›æ»šå·²æäº¤åˆ°è¿œç¨‹ä»“åº“çš„æäº¤</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git revert commit_id</span><br></pre></td></tr></table></figure>
<h2 id="5ã€filename-too-longé”™è¯¯"><a href="#5ã€filename-too-longé”™è¯¯" class="headerlink" title="5ã€filename too longé”™è¯¯"></a>5ã€filename too longé”™è¯¯</h2><p>æˆ‘åœ¨windowsæäº¤node_moduleæ—¶ï¼Œå‘ç°node_moduleçš„è·¯å¾„å¤ªé•¿äº†ï¼Œå¯¼è‡´æˆ‘æ²¡æ³•æäº¤ï¼Œæ‰¾åˆ°äº†ç½‘ä¸Šçš„è§£å†³æ–¹æ³•ã€‚</p>
<p>è¯¦ç»†æŸ¥çœ‹è¿™é‡Œ <a href="http://stackoverflow.com/questions/21123415/git-pull-aborted-with-error-filename-too-long" target="_blank" rel="noopener">Filename too long</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config --system core.longpaths <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h2 id="6ã€æŸ¥çœ‹ä¿®æ”¹å†å²"><a href="#6ã€æŸ¥çœ‹ä¿®æ”¹å†å²" class="headerlink" title="6ã€æŸ¥çœ‹ä¿®æ”¹å†å²"></a>6ã€æŸ¥çœ‹ä¿®æ”¹å†å²</h2><ul>
<li><strong>git log â€“pretty</strong>ï¼šå¯åˆ—å‡ºæ–‡ä»¶çš„æ‰€æœ‰æ”¹åŠ¨å†å²ï¼Œæ³¨æ„ï¼Œè¿™é‡Œç€çœ¼äºå…·ä½“çš„ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œä¸æ˜¯gitåº“ï¼Œå¦‚æœæ˜¯åº“ï¼Œé‚£å°±æœ‰å¾ˆå¤šæ”¹åŠ¨äº†</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git log --pretty=oneline filename</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>git show</strong>ï¼šæ‰“å°å‡ºæ–‡ä»¶çš„è¯¦ç»†æ”¹åŠ¨å†å²ï¼Œè¡Œå‰çš„æ•°å­—å°±æ˜¯æ¯æ¬¡æäº¤çš„commit_idï¼Œå¸¸å¸¸é…åˆ<code>git log</code>æŸ¥çœ‹æŸä¸ªæ–‡ä»¶çš„commit_id</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git show commit_id</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>git reflog</strong>ï¼šæŸ¥çœ‹æ¯ä¸€æ¬¡çš„æ“ä½œå‘½ä»¤</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git reflog</span><br></pre></td></tr></table></figure>
<h2 id="7ã€åˆ›å»ºåˆ†æ”¯"><a href="#7ã€åˆ›å»ºåˆ†æ”¯" class="headerlink" title="7ã€åˆ›å»ºåˆ†æ”¯"></a>7ã€åˆ›å»ºåˆ†æ”¯</h2><ul>
<li>åˆ›å»ºå¹¶åˆ‡æ¢åˆ†æ”¯</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b dev_name</span><br></pre></td></tr></table></figure>
<ul>
<li>æ¨é€åˆ†æ”¯</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push -u origin dev:dev <span class="comment">// -u å…³è”æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœpullçš„æ—¶å€™æç¤º<strong>â€œno tracking informationâ€</strong>ï¼Œåˆ™è¯´æ˜æœ¬åœ°åˆ†æ”¯æ²¡æœ‰è·Ÿè¸ªè¿œç¨‹åˆ†æ”¯</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git branch --set-upstream branch-name origin/branch-name</span><br></pre></td></tr></table></figure>
<h2 id="8ã€åˆ é™¤åˆ†æ”¯"><a href="#8ã€åˆ é™¤åˆ†æ”¯" class="headerlink" title="8ã€åˆ é™¤åˆ†æ”¯"></a>8ã€åˆ é™¤åˆ†æ”¯</h2><ul>
<li>åˆ é™¤æœ¬åœ°åˆ†æ”¯</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -d dev_name</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ é™¤è¿œç¨‹åˆ†æ”¯</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin :dev_name <span class="comment">//æ³¨æ„å†’å·è·Ÿåˆ†æ”¯åæ²¡æœ‰ç©ºæ ¼</span></span><br></pre></td></tr></table></figure>
<h2 id="9ã€æš‚å­˜ä¿®æ”¹"><a href="#9ã€æš‚å­˜ä¿®æ”¹" class="headerlink" title="9ã€æš‚å­˜ä¿®æ”¹"></a>9ã€æš‚å­˜ä¿®æ”¹</h2><p>è‹¥é‡åˆ°å·¥ä½œçš„åˆ†æ”¯ä¸Šè¿˜æ²¡åšå®ŒåŒæ—¶åˆä¸æƒ³æäº¤ï¼Œå¹¶ä¸”è¿™æ—¶å€™å¦å¤–ä¸€åˆ†æ”¯å‡ºç°bugæ€¥éœ€ä¿®å¤ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å°†æœ¬åœ°ä¿®æ”¹åšæš‚æ—¶å‚¨å­˜</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git stash [save <span class="string">"description"</span>] <span class="comment">// æš‚æ—¶å­˜å‚¨æ˜¯å¦æ·»åŠ æè¿°ä¸ºé€‰å¡«</span></span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹æš‚å­˜åˆ—è¡¨</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git stash list</span><br></pre></td></tr></table></figure>
<p>å–å‡ºstashåˆ—è¡¨å†…å®¹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git stash apply <span class="comment">// å…¨éƒ¨å–å‡º</span></span><br><span class="line"></span><br><span class="line">$ git stash apply stash@&#123;index&#125; <span class="comment">// å–indexä¸‹çš„å‚¨å­˜</span></span><br></pre></td></tr></table></figure>
<p>å–æ¶ˆstashå‚¨å­˜</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git stash drop stash@&#123;index&#125;</span><br></pre></td></tr></table></figure>
<h2 id="10ã€å¼ºåˆ¶è¦†ç›–è¿œç¨‹å†…å®¹"><a href="#10ã€å¼ºåˆ¶è¦†ç›–è¿œç¨‹å†…å®¹" class="headerlink" title="10ã€å¼ºåˆ¶è¦†ç›–è¿œç¨‹å†…å®¹"></a>10ã€å¼ºåˆ¶è¦†ç›–è¿œç¨‹å†…å®¹</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin master --force</span><br></pre></td></tr></table></figure>
<h2 id="11ã€ä¿®æ”¹commitå¤‡æ³¨"><a href="#11ã€ä¿®æ”¹commitå¤‡æ³¨" class="headerlink" title="11ã€ä¿®æ”¹commitå¤‡æ³¨"></a>11ã€ä¿®æ”¹commitå¤‡æ³¨</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git commit --amend</span><br></pre></td></tr></table></figure>
<h2 id="12ã€é‡å‘½ååˆ†æ”¯"><a href="#12ã€é‡å‘½ååˆ†æ”¯" class="headerlink" title="12ã€é‡å‘½ååˆ†æ”¯"></a>12ã€é‡å‘½ååˆ†æ”¯</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -m ordinary-dev-name <span class="keyword">new</span>-dev-name</span><br></pre></td></tr></table></figure>
<h2 id="13ã€æ ‡ç­¾"><a href="#13ã€æ ‡ç­¾" class="headerlink" title="13ã€æ ‡ç­¾"></a>13ã€æ ‡ç­¾</h2><p>æ˜¾ç¤ºæ ‡ç­¾(å¯ä»¥å‚è€ƒ<a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/0013762144381812a168659b3dd4610b4229d81de5056cc000" target="_blank" rel="noopener">å»–é›ªå³°å¤§å¤§çš„åšå®¢</a>)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line">$ git tag</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç³»åˆ—æ ‡ç­¾(æ˜¾ç¤º1.9.*çš„æ‰€æœ‰æ ‡ç­¾)</span></span><br><span class="line">$ git tag -l <span class="string">'v1.9.*'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥çœ‹ç›¸åº”æ ‡ç­¾çš„ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">$ git show v1<span class="number">.9</span><span class="number">.0</span></span><br></pre></td></tr></table></figure>
<p>æ–°å»ºæ ‡ç­¾</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git tag -a v1<span class="number">.9</span><span class="number">.9</span> -m <span class="string">"version tag description"</span> <span class="comment">// -a(annotated)</span></span><br></pre></td></tr></table></figure>
<p>åˆ é™¤æ ‡ç­¾</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ é™¤æœ¬åœ°æ ‡ç­¾</span></span><br><span class="line">$ git tag -d v1<span class="number">.9</span><span class="number">.9</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤è¿œç¨‹æ ‡ç­¾</span></span><br><span class="line">$ git tag -d v1<span class="number">.9</span><span class="number">.9</span></span><br><span class="line">$ git push origin :refs/tags/v1<span class="number">.9</span><span class="number">.9</span></span><br></pre></td></tr></table></figure>
<p>æ¨é€æ ‡ç­¾</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨é€æŒ‡å®šæ ‡ç­¾</span></span><br><span class="line">$ git push origin v1<span class="number">.9</span><span class="number">.9</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¨é€æ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line">$ git push origin --tags</span><br></pre></td></tr></table></figure>
<h2 id="14ã€è¿œç¨‹åˆ†æ”¯"><a href="#14ã€è¿œç¨‹åˆ†æ”¯" class="headerlink" title="14ã€è¿œç¨‹åˆ†æ”¯"></a>14ã€è¿œç¨‹åˆ†æ”¯</h2><p>æ‹‰å–è¿œç¨‹åˆ†æ”¯</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// git checkout -b [åˆ†æ”¯å] [è¿œç¨‹å]/[åˆ†æ”¯å]</span></span><br><span class="line">$ git checkout -b test origin/test</span><br></pre></td></tr></table></figure>
<p>è·Ÿè¸ªè¿œç¨‹åˆ†æ”¯</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout --track origin/test</span><br></pre></td></tr></table></figure>
<p>æ¨é€è¿œç¨‹åˆ†æ”¯</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin localBranch:remoteBranch</span><br></pre></td></tr></table></figure>
<h2 id="15ã€Permission-denied-publickey"><a href="#15ã€Permission-denied-publickey" class="headerlink" title="15ã€Permission denied (publickey)"></a>15ã€Permission denied (publickey)</h2><p>ä»Šå¤©è¦æ‹‰å–ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œå‘ç°äº†è€æ˜¯æ‹‰ä¸æˆåŠŸï¼Œåœ¨<strong>gitlab</strong>æˆå‘˜æƒé™æ£€æŸ¥äº†å®Œå…¨æ²¡é—®é¢˜ï¼Œåªèƒ½å…ˆè¯•è¯•é‡æ–°ç”Ÿæˆkeyã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C <span class="string">"xxx@xxx.com"</span> -f ~<span class="regexp">/.ssh/</span>MyXXX</span><br><span class="line"># -f ~/.ssh/MyXXX # é‡å‘½åä¸ºMyXXX</span><br></pre></td></tr></table></figure>
<p>å‘ç°è¿˜æ˜¯ä¸è¡Œã€‚åæ¥æŸ¥åˆ°äº†æ˜¯å› ä¸ºæ–°æ·»åŠ çš„keyä¸èƒ½åŠ å…¥sshï¼Œäºæ˜¯å°±è¯•è¯•ä¸‹é¢çš„å‘½ä»¤å°±å‘ç°å¥½äº†ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-agent</span><br><span class="line">$ ssh-add ~/.ssh/MyXXX # æ·»åŠ èº«ä»½éªŒè¯</span><br></pre></td></tr></table></figure>
<h2 id="16ã€æŸ¥çœ‹æŒ‡çº¹"><a href="#16ã€æŸ¥çœ‹æŒ‡çº¹" class="headerlink" title="16ã€æŸ¥çœ‹æŒ‡çº¹"></a>16ã€æŸ¥çœ‹æŒ‡çº¹</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -l -E md5 -f ~/.ssh/xxx.pub</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å°†githubçš„åˆå¹¶åˆ°æœ¬åœ°(å«æäº¤æ—¥å¿—)]]></title>
      <url>https://lucius0.github.io/2016/08/15/archivers/git-local-merge-github/</url>
      <content type="html"><![CDATA[<p>æœ‰æ—¶å€™æˆ‘ä»¬åœ¨ä½¿ç”¨githubä¸Šçš„æŸä¸€ä¸ªæ¡†æ¶æ—¶ï¼Œä¼šå…ˆæŠŠæ¡†æ¶ä¸‹è½½ä¸‹æ¥è€Œä¸æ˜¯cloneä¸‹æ¥ï¼Œè™½ç„¶å·¥ç¨‹ä¸Šå¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯å·²ç»ä¸¢å¤±äº†githubä¸ŠåŸä½œè€…è·Ÿä¼—å¤šç»´æŠ¤è€…çš„æäº¤æ—¥å¿—ã€‚è¿™ç¯‡æ–‡ç« å°±æ˜¯æ¥å°†æœ¬åœ°å·²ç»ä¿®æ”¹çš„æ¡†æ¶è·Ÿè¿œç¨‹githubçš„æ¡†æ¶è¿›è¡Œæ—¥å¿—ä¸Šçš„åˆå¹¶ã€‚</p>
<p>å°†ç”Ÿæˆçš„id_rsa.pubçš„å†…å®¹æä¾›ç»™githubï¼Œå³åœ¨githubä¸Šåˆ›å»ºä¸€ä¸ªSSH keyï¼Œå¹¶æŠŠè¯¥å…¬é’¥å¤åˆ¶è¿›å»ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æˆ‘ä½¿ç”¨gitçš„å†…å®¹ï¼Œçœäº†ä¸€äº›ä¿¡æ¯ï¼Œå…¶ä¸­local-masterå°±æ˜¯ä¸Šæ–‡è¯´çš„æœ¬åœ°å·²ç»åšä¿®æ”¹çš„æ¡†æ¶ï¼Œå°†æœ¬åœ°çš„masteré‡å‘½åä¸ºold-masterï¼Œæ‹‰å–githubä¸Šçš„masterï¼Œè¿›è¡Œå•ä¿®æ”¹åˆå¹¶ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–githubçš„å…¨éƒ¨æ›´æ–°</span></span><br><span class="line">user /local-framework (master)</span><br><span class="line">$ git fetch github</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡å‘½åmasterä¸ºold-masterï¼Œä¸ºäº†å°±æ˜¯githubä¸Šçš„masteråˆ†æ”¯å¯ä»¥æ‹‰å–åˆ°æœ¬åœ°</span></span><br><span class="line">user /local-framework (master)</span><br><span class="line">$ git branch -m old-master</span><br><span class="line"></span><br><span class="line"><span class="comment">// checkoutè¿œç¨‹åˆ†æ”¯masterå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯</span></span><br><span class="line">user /local-framework (old-master)</span><br><span class="line">$ git checkout github/master -b master</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿œç¨‹masteråˆ†æ”¯åˆå¹¶æœ¬åœ°å·²ä¿®æ”¹åˆ†æ”¯</span></span><br><span class="line">user /local-framework (master)</span><br><span class="line">$ git merge old-master</span><br><span class="line"></span><br><span class="line"><span class="comment">// å› ä¸ºåœ¨ä¸Šä¸€æ­¥å‡ºç°å†²çªï¼Œå› æ­¤å›æ»šä¸Šä¸€æ­¥</span></span><br><span class="line">user /local-framework (master|MERGING)</span><br><span class="line">$ git reset --hard master</span><br><span class="line"></span><br><span class="line">user /local-framework (master)</span><br><span class="line">$ git status</span><br><span class="line"></span><br><span class="line">user /local-framework (master)</span><br><span class="line">$ git log --pretty=oneline</span><br><span class="line"></span><br><span class="line">user /local-framwork (master)</span><br><span class="line">$ git cherry-pick &lt; commit id_1 &gt;</span><br><span class="line"></span><br><span class="line">user /local-framwork (master)</span><br><span class="line">$ git cherry-pick &lt; commit id_2 &gt;</span><br><span class="line"></span><br><span class="line">user /local-framwork (master)</span><br><span class="line">$ git cherry-pick &lt; commit id_3 &gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>åˆ°è¿™é‡Œå·²ç»å°†githubä¸Šçš„åˆ†æ”¯åˆå¹¶å¹¶ä¸”ä¿ç•™äº†ä»¥å‰æäº¤çš„æ—¥å¿—ï¼Œä¹‹åå¯ä»¥åˆ é™¤è¿œç¨‹githubåˆ†æ”¯å¹¶ä¸”ä¿®æ”¹æœ¬åœ°åˆ†æ”¯åä¸ºmasteräº†</p>
]]></content>
      
        <categories>
            
            <category> tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptä¹‹ä¹ - OOP]]></title>
      <url>https://lucius0.github.io/2016/08/14/archivers/javascript-oop/</url>
      <content type="html"><![CDATA[<h2 id="1ã€åŸºäºåŸå‹é“¾ç»§æ‰¿"><a href="#1ã€åŸºäºåŸå‹é“¾ç»§æ‰¿" class="headerlink" title="1ã€åŸºäºåŸå‹é“¾ç»§æ‰¿"></a>1ã€åŸºäºåŸå‹é“¾ç»§æ‰¿</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123; <span class="keyword">this</span>.y = <span class="number">2</span>; &#125;</span><br><span class="line"><span class="keyword">typeof</span> Foo.prototype; <span class="comment">// "object"</span></span><br><span class="line">Foo.prototype.x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> obj3 = <span class="keyword">new</span> Foo();</span><br><span class="line">obj3.y; <span class="comment">// 2</span></span><br><span class="line">obj3.x; <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line">Foo.prototype = &#123;</span><br><span class="line">	<span class="keyword">constructor</span>: Foo,</span><br><span class="line">	__proto__: Object.prototype,</span><br><span class="line">	x: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2ã€jsç»§æ‰¿çš„å®ä¾‹"><a href="#2ã€jsç»§æ‰¿çš„å®ä¾‹" class="headerlink" title="2ã€jsç»§æ‰¿çš„å®ä¾‹"></a>2ã€jsç»§æ‰¿çš„å®ä¾‹</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.name = name;</span><br><span class="line">	<span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.hi = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>.name, <span class="keyword">this</span>.age);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.LEGS_NUM = <span class="number">2</span>;</span><br><span class="line">Person.prototype.ARMS_NUM = <span class="number">2</span>;</span><br><span class="line">Person.prototype.walk = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>.name + <span class="string">" is walking..."</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age, className</span>) </span>&#123;</span><br><span class="line">	Person.call(<span class="keyword">this</span>, name, age);</span><br><span class="line">	<span class="keyword">this</span>.className = className;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student.prototype = <span class="built_in">Object</span>.create(Person.prototype);</span><br><span class="line">Student.prototype.constructor = Student;</span><br><span class="line"></span><br><span class="line"><span class="comment">// override</span></span><br><span class="line">Student.prototype.hi = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>.name, <span class="keyword">this</span>.age, <span class="keyword">this</span>.className);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student.prototype.learn = <span class="function"><span class="keyword">function</span>(<span class="params">subject</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>.name, subject, <span class="keyword">this</span>.className);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> boss = <span class="keyword">new</span> Student(<span class="string">"Boss"</span>, <span class="number">1</span>, <span class="string">"Class one"</span>);</span><br><span class="line">boss.hi(); <span class="comment">// boss 1 Class one</span></span><br><span class="line">boss.LEGS_NUM; <span class="comment">// 2</span></span><br><span class="line">boss.walk(); <span class="comment">// boss is walking...</span></span><br><span class="line">boss.learn(<span class="string">"math"</span>); <span class="comment">// boss math Class one</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em> <code>Person.prototype</code> æ˜¯è®©å­ç±»å…±äº«çˆ¶ç±»çš„æ–¹æ³•ï¼Œè‹¥æ²¡æœ‰prototypeï¼Œåˆ™Studentç»§æ‰¿çš„æ—¶å€™ï¼Œæ°¸è¿œè°ƒç”¨çš„éƒ½æ˜¯çˆ¶ç±»çš„æ–¹æ³•ï¼›<code>Object.create</code> ä¸»è¦æ˜¯é‡æ–°å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶è®©Studentçš„prototypeæŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼Œè‹¥ä¸é‡æ–°å®ä¾‹åŒ–ï¼Œåˆ™ç»™Studentåˆ›å»ºæ–°æ–¹æ³•çš„åŒæ—¶ä¹Ÿä¼šç»™Person.prototypeåˆ›å»ºå¯¹åº”çš„æ–¹æ³•ï¼›<code>Student.prototype.constructor = Student</code>ï¼Œä¼šè®©Studentçš„æ„é€ å‡½æ•°æŒ‡å‘è‡ªèº«ï¼Œå¦åˆ™æŒ‡å‘çˆ¶ç±»çš„constructor</p>
<h2 id="3ã€æ”¹å˜prototype"><a href="#3ã€æ”¹å˜prototype" class="headerlink" title="3ã€æ”¹å˜prototype"></a>3ã€æ”¹å˜prototype</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Student.prototype.x = <span class="number">101</span>;</span><br><span class="line">boss.x; <span class="comment">// 101</span></span><br><span class="line">Student.prototype = &#123;<span class="attr">y</span>: <span class="number">2</span>&#125;;</span><br><span class="line">boss.y; <span class="comment">// undefined</span></span><br><span class="line">boss.x; <span class="comment">// 101</span></span><br><span class="line"><span class="keyword">var</span> lucius = <span class="keyword">new</span> Student(<span class="string">"lucius"</span>, <span class="number">22</span>, <span class="string">"Class two"</span>);</span><br><span class="line">lucius.x; <span class="comment">// undefined</span></span><br><span class="line">lucius.y; <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em> å½“æˆ‘ä»¬åœ¨åŸå‹ä¸Šåˆ›å»ºæ–°çš„å±æ€§çš„æ—¶å€™ï¼Œå½±å“çš„æ˜¯å·²åˆ›å»ºçš„å¯¹è±¡ï¼›ä½†å½“æˆ‘ä»¬å°†åŸå‹æŒ‡å‘æ–°çš„å¯¹è±¡ï¼Œåˆ™æ— æ³•å½±å“å·²åˆ›å»ºçš„å¯¹è±¡ï¼Œåè€Œä¼šå½±å“æ–°çš„å®ä¾‹åŒ–å¯¹è±¡ã€‚</p>
<h2 id="4ã€å†…ç½®æ„é€ å™¨çš„prototype"><a href="#4ã€å†…ç½®æ„é€ å™¨çš„prototype" class="headerlink" title="4ã€å†…ç½®æ„é€ å™¨çš„prototype"></a>4ã€å†…ç½®æ„é€ å™¨çš„prototype</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">obj.x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(key); <span class="comment">// x, å¯ä»¥é€šè¿‡definePropertyå°†enumerableè®¾ç½®ä¸ºfalse</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5ã€å®ç°ç»§æ‰¿æ–¹å¼"><a href="#5ã€å®ç°ç»§æ‰¿æ–¹å¼" class="headerlink" title="5ã€å®ç°ç»§æ‰¿æ–¹å¼"></a>5ã€å®ç°ç»§æ‰¿æ–¹å¼</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="comment">// æ”¹å˜äº†Studentçš„æ–¹æ³•è·Ÿå±æ€§ï¼ŒåŒæ—¶ä¹Ÿä¿®æ”¹äº†Personçš„æ–¹æ³•è·Ÿå±æ€§ï¼Œæ— æ³•å®ç°é‡å†™</span></span><br><span class="line">Student.prototype = Person.prototype;</span><br><span class="line"><span class="comment">// prototype æ²¡æœ‰æ­£ç¡®çš„æŒ‡å‘</span></span><br><span class="line">Student.prototype = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="comment">// æ¯”è¾ƒå¥½çš„ç»§æ‰¿æ–¹æ³•ï¼Œä½†æ˜¯createåªæœ‰åœ¨ES5æ‰æœ‰</span></span><br><span class="line">Student.prototype = <span class="built_in">Object</span>.create(Person.prototype);</span><br><span class="line">Student.prototype.constructor = Person;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¨¡æ‹Ÿcreate</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">Object</span>.create) &#123;</span><br><span class="line">	<span class="built_in">Object</span>.create = <span class="function"><span class="keyword">function</span>(<span class="params">proto</span>) </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">		F.prototype = proto;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> F;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6ã€æ¨¡æ‹Ÿé‡è½½"><a href="#6ã€æ¨¡æ‹Ÿé‡è½½" class="headerlink" title="6ã€æ¨¡æ‹Ÿé‡è½½"></a>6ã€æ¨¡æ‹Ÿé‡è½½</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">typeof</span> args[<span class="number">0</span>] === <span class="string">"object"</span> &amp;&amp; args[<span class="number">0</span>]) &#123;</span><br><span class="line">		<span class="keyword">if</span>(args[<span class="number">0</span>].name) &#123;</span><br><span class="line">			<span class="keyword">this</span>.name = args[<span class="number">0</span>].name;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(args[<span class="number">0</span>].age) &#123;</span><br><span class="line">			<span class="keyword">this</span>.age = args[<span class="number">0</span>].age;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(args[<span class="number">0</span>]) &#123;</span><br><span class="line">			<span class="keyword">this</span>.name = args[<span class="number">0</span>];</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(args[<span class="number">1</span>]) &#123;</span><br><span class="line">			<span class="keyword">this</span>.age = args[<span class="number">1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.toString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"name="</span> + <span class="keyword">this</span>.name + <span class="string">" , age="</span> + <span class="keyword">this</span>.age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> Person(<span class="string">"lucius"</span>, <span class="number">24</span>);</span><br><span class="line">obj.toString(); <span class="comment">// "name=lucius , age=24"</span></span><br><span class="line"><span class="keyword">var</span> obj2 = <span class="keyword">new</span> Person(&#123;<span class="attr">name</span>: lucius0, <span class="attr">age</span>: <span class="number">24</span>&#125;);</span><br><span class="line">obj.toString(); <span class="comment">// "name=lucius , age=24"</span></span><br></pre></td></tr></table></figure>
<h2 id="7ã€è°ƒç”¨åŸºç±»çš„æ–¹æ³•"><a href="#7ã€è°ƒç”¨åŸºç±»çš„æ–¹æ³•" class="headerlink" title="7ã€è°ƒç”¨åŸºç±»çš„æ–¹æ³•"></a>7ã€è°ƒç”¨åŸºç±»çš„æ–¹æ³•</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">superClass.prototype.methodName.call(this, arg0, arg1, arg2);</span><br><span class="line">superClass.prototype.methodName.apply(this, args);</span><br></pre></td></tr></table></figure>
<h2 id="8ã€é“¾å¼è°ƒç”¨"><a href="#8ã€é“¾å¼è°ƒç”¨" class="headerlink" title="8ã€é“¾å¼è°ƒç”¨"></a>8ã€é“¾å¼è°ƒç”¨</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ClassManager</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	ClassManager.prototype.addClass = <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">"Class: "</span> + str + <span class="string">" added."</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>; <span class="comment">// this æŒ‡å‘ClassManagerå®ä¾‹</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> manager = <span class="keyword">new</span> ClassManager();</span><br><span class="line">manager.addClass(<span class="string">"classA"</span>).addClass(<span class="string">"classB"</span>).addClass(<span class="string">"classC"</span>);</span><br></pre></td></tr></table></figure>
<h2 id="9ã€æ¨¡å—åŒ–"><a href="#9ã€æ¨¡å—åŒ–" class="headerlink" title="9ã€æ¨¡å—åŒ–"></a>9ã€æ¨¡å—åŒ–</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CASE 1</span></span><br><span class="line"><span class="keyword">var</span> moduleA;</span><br><span class="line">moduleA = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> prop = <span class="number">1</span>;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		func: func,</span><br><span class="line">		prop: prop</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CASE 2</span></span><br><span class="line"><span class="keyword">var</span> moduleA;</span><br><span class="line">moduleA = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> prop = <span class="number">1</span>;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">	<span class="keyword">this</span>.func = func;</span><br><span class="line">	<span class="keyword">this</span>.prop = prop;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptä¹‹å…« - æ‰§è¡Œä¸Šä¸‹æ–‡]]></title>
      <url>https://lucius0.github.io/2016/08/13/archivers/javascript-execution-context/</url>
      <content type="html"><![CDATA[<p>ä½œç”¨åŸŸï¼šå…¨å±€ã€å‡½æ•°ã€evalã€‚å¯å‚è€ƒ<a href="/2016/08/11//archivers/javascript-function-01/" title="ã€Šå‡½æ•°ä¸ä½œç”¨åŸŸ01ã€‹">ã€Šå‡½æ•°ä¸ä½œç”¨åŸŸ01ã€‹</a>å’Œ<a href="/2016/08/13//archivers/javascript-function-02/" title="ã€Šå‡½æ•°ä¸ä½œç”¨åŸŸ02ã€‹">ã€Šå‡½æ•°ä¸ä½œç”¨åŸŸ02ã€‹</a>ã€‚</p>
<h2 id="1ã€æ¦‚å¿µ"><a href="#1ã€æ¦‚å¿µ" class="headerlink" title="1ã€æ¦‚å¿µ"></a>1ã€æ¦‚å¿µ</h2><p>æ‰§è¡Œä¸Šä¸‹æ–‡ç±»ä¼¼äºæ ˆçš„ç»“æ„ï¼Œå¯å‚è€ƒ<a href="http://blogread.cn/it/article/6178" target="_blank" rel="noopener">ã€Šæ·±å…¥ç†è§£Javascriptä¹‹æ‰§è¡Œä¸Šä¸‹æ–‡ã€‹</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"EC0"</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">funcEC1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">"EC1"</span>);</span><br><span class="line">	<span class="keyword">var</span> funcEC2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">"EC2"</span>);</span><br><span class="line">		<span class="keyword">var</span> funcEC3 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="built_in">console</span>.log(<span class="string">"EC3"</span>);</span><br><span class="line">		&#125;;</span><br><span class="line">		funcEC3();</span><br><span class="line">	&#125;</span><br><span class="line">	funcEC2();</span><br><span class="line">&#125;</span><br><span class="line">funcEC1();</span><br><span class="line"></span><br><span class="line"><span class="comment">// EC0 -&gt; EC1 -&gt; EC2 -&gt; EC3</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em> å˜é‡å¯¹è±¡(VO)æ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µçš„â€œå¯¹è±¡â€ï¼Œå®ƒç”¨äºå­˜å‚¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„å˜é‡ã€å‡½æ•°å£°æ˜ã€å‡½æ•°å‚æ•°</p>
<p>å¯ä»¥å°†ä¸Šä¸‹æ–‡çœ‹æˆä¸€ä¸ªå¯¹è±¡</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">activeExecutionContext = &#123;</span><br><span class="line">	VO: &#123;</span><br><span class="line">		data_var,</span><br><span class="line">		data_func_declaration,</span><br><span class="line">		data_func_arguments</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> b = <span class="number">20</span>;</span><br><span class="line">&#125;</span><br><span class="line">test(<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">VO(globalContext) = &#123;</span><br><span class="line">	a = <span class="number">10</span>,</span><br><span class="line">	test: <span class="xml"><span class="tag">&lt; <span class="attr">ref</span> <span class="attr">to</span> <span class="attr">function</span> &gt;</span></span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">VO(test function) = &#123;</span></span><br><span class="line"><span class="xml">	x: 30,</span></span><br><span class="line"><span class="xml">	b: 20</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="2ã€å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡-æµè§ˆå™¨"><a href="#2ã€å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡-æµè§ˆå™¨" class="headerlink" title="2ã€å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡(æµè§ˆå™¨)"></a>2ã€å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡(æµè§ˆå™¨)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">VO(globalContext) === [[global]];</span><br><span class="line"><span class="comment">// å…¨å±€åˆå§‹åŒ–</span></span><br><span class="line">[[global]] = &#123;</span><br><span class="line">	<span class="built_in">Math</span>: <span class="xml"><span class="tag">&lt;<span class="name">...</span>&gt;</span>,</span></span><br><span class="line"><span class="xml">	String: <span class="tag">&lt;<span class="name">...</span>&gt;</span>,</span></span><br><span class="line"><span class="xml">	isNaN: <span class="tag">&lt;<span class="name">...</span>&gt;</span>,</span></span><br><span class="line"><span class="xml">	...</span></span><br><span class="line"><span class="xml">	window: global // ä¾èµ–æµè§ˆå™¨	</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">String(10); // [[global]].string(10)</span></span><br><span class="line"><span class="xml">window.a = 10; // [[global]].window.a = 10</span></span><br><span class="line"><span class="xml">this.b = 10; // [[global]].b = 10</span></span><br></pre></td></tr></table></figure>
<h2 id="3ã€å‡½æ•°æ¿€æ´»å¯¹è±¡-AO"><a href="#3ã€å‡½æ•°æ¿€æ´»å¯¹è±¡-AO" class="headerlink" title="3ã€å‡½æ•°æ¿€æ´»å¯¹è±¡(AO)"></a>3ã€å‡½æ•°æ¿€æ´»å¯¹è±¡(AO)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°åˆå§‹åŒ–</span></span><br><span class="line">VO(functionContext) === AO;</span><br><span class="line">AO = &#123;</span><br><span class="line">	<span class="built_in">arguments</span>: <span class="xml"><span class="tag">&lt; <span class="attr">Arg0</span> &gt;</span></span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"><span class="xml">arguments = &#123;</span></span><br><span class="line"><span class="xml">	callee,</span></span><br><span class="line"><span class="xml">	length,</span></span><br><span class="line"><span class="xml">	properties-indexes</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br></pre></td></tr></table></figure>
<h3 id="3-1-å˜é‡åˆå§‹åŒ–é˜¶æ®µ"><a href="#3-1-å˜é‡åˆå§‹åŒ–é˜¶æ®µ" class="headerlink" title="3.1 å˜é‡åˆå§‹åŒ–é˜¶æ®µ"></a>3.1 å˜é‡åˆå§‹åŒ–é˜¶æ®µ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> c = <span class="number">10</span>;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">	<span class="keyword">var</span> e = <span class="function"><span class="keyword">function</span> <span class="title">_e</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">	(<span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"></span>) </span>&#123;&#125;);</span><br><span class="line">	b = <span class="number">20</span>;</span><br><span class="line">&#125;</span><br><span class="line">test(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">AO(test) = &#123;</span><br><span class="line">	a: <span class="number">10</span>,</span><br><span class="line">	b: <span class="literal">undefined</span>,</span><br><span class="line">	c: <span class="literal">undefined</span>,</span><br><span class="line">	d: <span class="xml"><span class="tag">&lt; <span class="attr">ref</span> <span class="attr">to</span> <span class="attr">func</span> "<span class="attr">d</span>" &gt;</span>,</span></span><br><span class="line"><span class="xml">	e: undefined</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>VOæŒ‰ç…§å¦‚ä¸‹é¡ºåºå¡«å……ï¼š</strong></p>
<ol>
<li><p>å‡½æ•°å‚æ•°(è‹¥æœªä¼ å…¥ï¼Œåˆå§‹åŒ–è¯¥å‚æ•°å€¼ä¸ºundefined)</p>
</li>
<li><p>å‡½æ•°å£°æ˜(è‹¥å‘ç”Ÿå‘½åå†²çªï¼Œä¼šè¦†ç›–)</p>
</li>
<li><p>å˜é‡å£°æ˜(åˆå§‹åŒ–å˜é‡å€¼ä¸ºundefinedï¼Œè‹¥å‘ç”Ÿå‘½åå†²çªï¼Œå¿½ç•¥)</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x, y, z</span>) </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">	<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br><span class="line">foo(<span class="number">100</span>); <span class="comment">// function x() &#123;&#125;</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em> å‡½æ•°å‚æ•°ä¼ è¿›å»ä¹‹åï¼Œå› ä¸ºå‡½æ•°å£°æ˜è·Ÿå‚æ•°å‘½åå‘ç”Ÿå†²çªï¼Œå³xç›´æ¥è¦†ç›–å‡½æ•°å‚æ•°å˜é‡</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x, y, z</span>) </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">	<span class="keyword">var</span> func;</span><br><span class="line">	<span class="built_in">console</span>.log(func);</span><br><span class="line">&#125;</span><br><span class="line">foo(<span class="number">100</span>); <span class="comment">// function x() &#123;&#125;</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em> å˜é‡å£°æ˜è·Ÿå‡½æ•°å£°æ˜çš„å‘½åå‘ç”Ÿå†²çªï¼Œæ ¹æ®VOçš„é¡ºåºï¼Œå˜é‡å£°æ˜å‘ç”Ÿå†²çªï¼Œåˆ™ä¼šè¢«å¿½ç•¥</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x, y, z</span>) </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">	<span class="keyword">var</span> func = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">console</span>.log(func);</span><br><span class="line">&#125;</span><br><span class="line">foo(<span class="number">100</span>); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em> åˆå§‹åŒ–é˜¶æ®µå˜é‡å£°æ˜å› ä¸ºå‘½åå†²çªä¼šè¢«å¿½ç•¥ï¼Œä½†æ˜¯åœ¨ç¬¬äºŒä¸ªé˜¶æ®µï¼Œå³æ‰§è¡Œé˜¶æ®µ<code>func = 1</code>ä¼šè¢«èµ‹å€¼ä¸º1ï¼Œåˆ™å°±æ˜¯ä¸ºä»€ä¹ˆç»“æœ1çš„åŸå› äº†ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong> å‡½æ•°è¡¨è¾¾å¼ä¸ä¼šå½±å“VOã€‚ä¸Šæ–‡çš„<code>var e = function _e(){}</code>ä¸­çš„_eåŒ¿åå‡½æ•°ï¼Œeçš„å˜é‡å£°æ˜ä¼šè¢«æ”¾åœ¨å³è¾¹çš„AOé‡Œé¢ï¼Œæ‰§è¡Œé˜¶æ®µçš„æ—¶å€™æ‰æœ‰æŠŠåŒ¿åå‡½æ•°_eèµ‹å€¼ç»™å˜é‡eã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æ²¡åŠæ³•é€šè¿‡_eæ¥è®¿é—®å‡½æ•°å¯¹è±¡ã€‚</p>
<h3 id="3-2-ä»£ç æ‰§è¡Œé˜¶æ®µ"><a href="#3-2-ä»£ç æ‰§è¡Œé˜¶æ®µ" class="headerlink" title="3.2 ä»£ç æ‰§è¡Œé˜¶æ®µ"></a>3.2 ä»£ç æ‰§è¡Œé˜¶æ®µ</h3><p>è¯¥é˜¶æ®µä¼šå¯¹ä¸Šä¸€é˜¶æ®µåˆå§‹åŒ–çš„å˜é‡è¿›è¡Œèµ‹å€¼</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">AO(test) = &#123;</span><br><span class="line">	a: <span class="number">10</span>,</span><br><span class="line">	b: <span class="literal">undefined</span>,</span><br><span class="line">	c: <span class="literal">undefined</span>,</span><br><span class="line">	d: <span class="xml"><span class="tag">&lt; <span class="attr">ref</span> <span class="attr">to</span> <span class="attr">func</span> "<span class="attr">d</span>" &gt;</span>,</span></span><br><span class="line"><span class="xml">	e: undefined</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">/** â†“ **/</span></span><br><span class="line"><span class="xml">VO["c"] = 10;</span></span><br><span class="line"><span class="xml">VO["e"] = function _e() &#123;&#125;;</span></span><br><span class="line"><span class="xml">VO["b"] = 20;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">/** â†“ **/</span></span><br><span class="line"><span class="xml">AO(test) = &#123;</span></span><br><span class="line"><span class="xml">	a: 10,</span></span><br><span class="line"><span class="xml">	b: 20,</span></span><br><span class="line"><span class="xml">	c: 10,</span></span><br><span class="line"><span class="xml">	d: <span class="tag">&lt; <span class="attr">reference</span> <span class="attr">to</span> <span class="attr">FunctionDeclaration</span> "<span class="attr">d</span>" &gt;</span></span></span><br><span class="line"><span class="xml">	e: function _e() &#123;&#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>æ —å­ï¼š</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">// function x() &#123;&#125;</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">// 10</span></span><br><span class="line">x = <span class="number">20</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">// 20</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> b = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(b); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em></p>
<ol>
<li><p>åˆå§‹åŒ–é˜¶æ®µ</p>
<ul>
<li><p>å‡½æ•°å‚æ•°ï¼šä¸Šä¸‹æ–‡æµ‹è¯•ä¸å­˜åœ¨å‡½æ•°å‚æ•°é—®é¢˜</p>
</li>
<li><p>å‡½æ•°å£°æ˜ï¼š<code>function x() {}</code></p>
</li>
<li><p>å˜é‡å£°æ˜ï¼š<code>var x</code> å‘½åå†²çªï¼Œå¿½ç•¥ï¼›<code>var a; var b</code> undefined</p>
</li>
</ul>
</li>
<li><p>æ‰§è¡Œé˜¶æ®µ</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">// function x() &#123;&#125;</span></span><br><span class="line">x = <span class="number">10</span>; <span class="comment">// x è¢«èµ‹å€¼</span></span><br><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">// 10</span></span><br><span class="line">x = <span class="number">20</span>; <span class="comment">// x å†æ¬¡è¢«èµ‹å€¼</span></span><br><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">// 20</span></span><br><span class="line">a = <span class="number">1</span>; <span class="comment">// a è¢«èµ‹å€¼</span></span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(b); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptä¹‹ä¸ƒ - å‡½æ•°ä¸ä½œç”¨åŸŸ(2)]]></title>
      <url>https://lucius0.github.io/2016/08/13/archivers/javascript-function-02/</url>
      <content type="html"><![CDATA[<h2 id="1ã€é—­åŒ…"><a href="#1ã€é—­åŒ…" class="headerlink" title="1ã€é—­åŒ…"></a>1ã€é—­åŒ…</h2><p>æ˜¯æŒ‡ä¸€ä¸ªå‡½æ•°æˆ–å‡½æ•°çš„å¼•ç”¨ï¼Œä¸ä¸€ä¸ªå¼•ç”¨ç¯å¢ƒç»‘å®šåœ¨ä¸€èµ·ã€‚è¿™ä¸ªå¼•ç”¨ç¯å¢ƒæ˜¯ä¸€ä¸ªå­˜å‚¨è¯¥å‡½æ•°æ¯ä¸ªéå±€éƒ¨å˜é‡çš„è¡¨ï¼Œå®ƒä¸åŒäºä¸€èˆ¬çš„å‡½æ•°ï¼Œå®ƒå…è®¸ä¸€ä¸ªå‡½æ•°åœ¨ç«‹å³è¯æ³•ä½œç”¨åŸŸå¤–è°ƒç”¨æ—¶ï¼Œä»å¯è®¿é—®éæœ¬åœ°å˜é‡ã€‚</p>
<p><strong>ç¼ºç‚¹ï¼š</strong> å®¹æ˜“é€ æˆç©ºé—´æµªè´¹ï¼Œå†…å­˜æ³„æ¼ï¼Œæ€§èƒ½æ¶ˆè€—</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CASE 1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> localVal = <span class="number">30</span>;</span><br><span class="line">	<span class="keyword">return</span> localVal;</span><br><span class="line">&#125;</span><br><span class="line">outer(); <span class="comment">// 30</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// CASE 2</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> localVal = <span class="number">30</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> localVal;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> func = outer();</span><br><span class="line">func(); <span class="comment">// 30</span></span><br></pre></td></tr></table></figure>
<p><strong>å¾ªç¯é—­åŒ…ï¼š</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.innerHTML = <span class="string">"&lt;div id='div1'&gt;aaa&lt;/div&gt;&lt;div id='div2'&gt;bbb&lt;/div&gt;&lt;div id='div3'&gt;ccc&lt;/div&gt;"</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">	<span class="built_in">document</span>.getElementById(<span class="string">"div"</span> + i).addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">		alert(i); <span class="comment">// éƒ½æ˜¯4</span></span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£å†³</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">	(<span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">		<span class="built_in">document</span>.getElementById(<span class="string">"div"</span> + i).addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">			alert(i); <span class="comment">// 1, 2, 3</span></span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;)(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2ã€å°è£…"><a href="#2ã€å°è£…" class="headerlink" title="2ã€å°è£…"></a>2ã€å°è£…</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> _userId = <span class="number">123</span>;</span><br><span class="line">	<span class="keyword">var</span> _typeId = <span class="string">"item"</span>;</span><br><span class="line">	<span class="keyword">var</span> _export = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">converter</span>(<span class="params">userId</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> _userId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	_export.getUserId = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> converter(_userId);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	_export.getTypeId = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> _typeId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">window</span>._export = _export;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line">_export.getUserId(); <span class="comment">// 123</span></span><br><span class="line">_export.getTypeId(); <span class="comment">// item</span></span><br><span class="line">_export._userId; <span class="comment">// undefined</span></span><br><span class="line">_export._typeId; <span class="comment">// undefined</span></span><br><span class="line">_export.converter; <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<h2 id="3ã€å…¨å±€-å‡½æ•°-eval"><a href="#3ã€å…¨å±€-å‡½æ•°-eval" class="headerlink" title="3ã€å…¨å±€/å‡½æ•°/eval"></a>3ã€å…¨å±€/å‡½æ•°/eval</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>; <span class="comment">// å…¨å±€</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> b = <span class="number">20</span>; <span class="comment">// å±€éƒ¨</span></span><br><span class="line">&#125;)();</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// 10</span></span><br><span class="line"><span class="built_in">console</span>.log(b); <span class="comment">// error</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> item <span class="keyword">in</span> &#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>&#125;) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(item); <span class="comment">// a b</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(item); <span class="comment">// b</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">"var c = 1;"</span>); </span><br><span class="line"><span class="built_in">console</span>.log(c); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em> ç”±äºæ²¡æœ‰å—ä½œç”¨åŸŸï¼Œæ‰€ä»¥<code>var item</code>ç›¸å½“äº<code>var a</code>æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ã€‚båˆ™æ˜¯ä¸€ä¸ªå‡½æ•°å˜é‡ï¼Œåªèƒ½åœ¨å‡½æ•°å†…æœ‰æ•ˆï¼Œevalåˆ™åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹å¤–éƒ¨æ˜¯å–ä¸åˆ°evalä½œç”¨åŸŸä¸‹çš„å˜é‡çš„ã€‚</p>
<h2 id="5ã€ä½œç”¨åŸŸé“¾"><a href="#5ã€ä½œç”¨åŸŸé“¾" class="headerlink" title="5ã€ä½œç”¨åŸŸé“¾"></a>5ã€ä½œç”¨åŸŸé“¾</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outer2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> local2 = <span class="number">2</span>;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">outer1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> local1 = <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">console</span>.log(local1 + <span class="string">"---"</span> + local2 + <span class="string">"---"</span> + global3); <span class="comment">// 1 2 3</span></span><br><span class="line">	&#125;</span><br><span class="line">	outer1();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> global3 = <span class="number">3</span>;</span><br><span class="line">outer2();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> i = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">var</span> func = <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">"console.log(typeof i);"</span>);</span><br><span class="line">	func(); <span class="comment">// undefined</span></span><br><span class="line">&#125;</span><br><span class="line">outer();</span><br></pre></td></tr></table></figure>
<h2 id="6ã€ä½œç”¨åŸŸå°è£…"><a href="#6ã€ä½œç”¨åŸŸå°è£…" class="headerlink" title="6ã€ä½œç”¨åŸŸå°è£…"></a>6ã€ä½œç”¨åŸŸå°è£…</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°è¡¨è¾¾å¼</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> a, b;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°è¡¨è¾¾å¼</span></span><br><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> a, b;</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼šè¿™æ ·çš„å¥½å¤„å°±æ˜¯å°†å˜é‡ä½œç”¨åŸŸå°è£…ä¸ºå‡½æ•°å†…éƒ¨ä½œç”¨åŸŸï¼Œé˜²æ­¢è·Ÿå…¨å±€å˜é‡å‘ç”Ÿå†²çª</p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptä¹‹å…­ - å‡½æ•°ä¸ä½œç”¨åŸŸ(1)]]></title>
      <url>https://lucius0.github.io/2016/08/11/archivers/javascript-function-01/</url>
      <content type="html"><![CDATA[<h2 id="1ã€è°ƒç”¨æ–¹å¼"><a href="#1ã€è°ƒç”¨æ–¹å¼" class="headerlink" title="1ã€è°ƒç”¨æ–¹å¼"></a>1ã€è°ƒç”¨æ–¹å¼</h2><ul>
<li><p>ç›´æ¥è°ƒç”¨ï¼šfoo();</p>
</li>
<li><p>å¯¹è±¡æ–¹æ³•ï¼šo.method();</p>
</li>
<li><p>æ„é€ å™¨ï¼šnew Foo();</p>
</li>
<li><p>call/apply/bindï¼šfunc.call(o);</p>
</li>
</ul>
<h2 id="2ã€åˆ›å»ºå‡½æ•°"><a href="#2ã€åˆ›å»ºå‡½æ•°" class="headerlink" title="2ã€åˆ›å»ºå‡½æ•°"></a>2ã€åˆ›å»ºå‡½æ•°</h2><ul>
<li>å‡½æ•°å£°æ˜</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>å‡½æ•°è¡¨è¾¾å¼</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°å˜é‡</span></span><br><span class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">	<span class="comment">// do something here</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">// do something here</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒ¿åå‡½æ•°</span></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">// do something here</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘½åå¼å‡½æ•°è¡¨è¾¾å¼</span></span><br><span class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">	<span class="comment">// do something here</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¸€èˆ¬æ¥è¯´fooæ˜¯åœ¨addæ‰€åˆ›å»ºçš„ä½œç”¨åŸŸé‡Œï¼Œå³å¤–éƒ¨è°ƒç”¨ä¸€èˆ¬éƒ½æ˜¯è®¿é—®ä¸åˆ°</span></span><br><span class="line"><span class="built_in">console</span>.log(foo); <span class="comment">// Uncaught ReferenceError: foo is not defined(â€¦) </span></span><br><span class="line"><span class="comment">// IE6 ~ IE8åˆ™æ˜¯å¯ä»¥çš„</span></span><br></pre></td></tr></table></figure>
<h2 id="3ã€å‡½æ•°æ„é€ å™¨"><a href="#3ã€å‡½æ•°æ„é€ å™¨" class="headerlink" title="3ã€å‡½æ•°æ„é€ å™¨"></a>3ã€å‡½æ•°æ„é€ å™¨</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> func = <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"console.log(a + b);"</span>);</span><br><span class="line">func(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> func = <span class="built_in">Function</span>(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"console.log(a + b);"</span>);</span><br><span class="line">func(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<p>å‡½æ•°æ„é€ å™¨ä¸€èˆ¬å¾ˆå°‘ä½¿ç”¨ï¼Œä¼šå‡ºç°ä¸€äº›å¾ˆå¥‡æ€ªçš„ç°è±¡</p>
<ul>
<li>localValue ä»ä¸ºå±€éƒ¨å˜é‡</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>(<span class="string">"var localVal='local'; console.log(localVal);"</span>)(); <span class="comment">// local</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> localVal); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<ul>
<li>localä¸å¯è®¿é—®ï¼Œå…¨å±€å˜é‡globalå¯ä»¥è®¿é—®</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> globalVal = <span class="string">"global"</span>;</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> localVal = <span class="string">"local"</span>;</span><br><span class="line">	<span class="built_in">Function</span>(<span class="string">"console.log(typeof localVal, typeof globalVal);"</span>)(); <span class="comment">// undefined, string</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left">ç©ºç™½</th>
<th>å‡½æ•°å£°æ˜</th>
<th>å‡½æ•°è¡¨è¾¾å¼</th>
<th>å‡½æ•°æ„é€ å™¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">å‰ç½®</td>
<td>âˆš</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">å…è®¸åŒ¿å</td>
<td></td>
<td>âˆš</td>
<td>âˆš </td>
</tr>
<tr>
<td style="text-align:left">ç«‹å³è°ƒç”¨</td>
<td></td>
<td>âˆš</td>
<td>âˆš </td>
</tr>
<tr>
<td style="text-align:left">åœ¨å®šä¹‰è¯¥å‡½æ•°çš„ä½œç”¨åŸŸé€šè¿‡å‡½æ•°åè®¿é—®</td>
<td>âˆš</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">æ²¡æœ‰å‡½æ•°å</td>
<td></td>
<td></td>
<td>âˆš </td>
</tr>
</tbody>
</table>
<h2 id="4ã€this"><a href="#4ã€this" class="headerlink" title="4ã€this"></a>4ã€this</h2><h3 id="4-1-å…¨å±€ä½œç”¨åŸŸä¸‹çš„this"><a href="#4-1-å…¨å±€ä½œç”¨åŸŸä¸‹çš„this" class="headerlink" title="4.1 å…¨å±€ä½œç”¨åŸŸä¸‹çš„this"></a>4.1 å…¨å±€ä½œç”¨åŸŸä¸‹çš„this</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.document === <span class="built_in">document</span>; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span> ==== <span class="built_in">window</span>; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.a = <span class="number">37</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.a); <span class="comment">// 37</span></span><br></pre></td></tr></table></figure>
<h3 id="4-2-ä¸€èˆ¬å‡½æ•°çš„this"><a href="#4-2-ä¸€èˆ¬å‡½æ•°çš„this" class="headerlink" title="4.2 ä¸€èˆ¬å‡½æ•°çš„this"></a>4.2 ä¸€èˆ¬å‡½æ•°çš„this</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f1() === <span class="built_in">window</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h3 id="4-3-ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„å‡½æ•°this"><a href="#4-3-ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„å‡½æ•°this" class="headerlink" title="4.3 ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„å‡½æ•°this"></a>4.3 ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„å‡½æ•°this</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CASE 1</span></span><br><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">	prop: <span class="number">37</span>,</span><br><span class="line">	f: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.prop;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(o.f()); <span class="comment">// 37</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// CASE 2</span></span><br><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">prop</span>: <span class="number">37</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.prop;</span><br><span class="line">&#125;</span><br><span class="line">o.f = f;</span><br><span class="line"><span class="built_in">console</span>.log(o.f()); <span class="comment">// 37</span></span><br></pre></td></tr></table></figure>
<h3 id="4-4-å¯¹è±¡åŸå‹é“¾ä¸Šçš„this"><a href="#4-4-å¯¹è±¡åŸå‹é“¾ä¸Šçš„this" class="headerlink" title="4.4 å¯¹è±¡åŸå‹é“¾ä¸Šçš„this"></a>4.4 å¯¹è±¡åŸå‹é“¾ä¸Šçš„this</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">f</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.a + <span class="keyword">this</span>.b;</span><br><span class="line">&#125;&#125;;</span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">Object</span>.create(o); <span class="comment">// p çš„åŸå‹o</span></span><br><span class="line">p.a = <span class="number">1</span>;</span><br><span class="line">p.b = <span class="number">4</span>;</span><br><span class="line"><span class="built_in">console</span>.log(p.f()); <span class="comment">// è°ƒç”¨åŸå‹é“¾çš„få‡½æ•°ï¼ŒthisæŒ‡å‘p</span></span><br></pre></td></tr></table></figure>
<h3 id="4-5-get-setæ–¹æ³•ä¸this"><a href="#4-5-get-setæ–¹æ³•ä¸this" class="headerlink" title="4.5 get/setæ–¹æ³•ä¸this"></a>4.5 get/setæ–¹æ³•ä¸this</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">modules</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="keyword">this</span>.re * <span class="keyword">this</span>.re + <span class="keyword">this</span>.im + <span class="keyword">this</span>.im);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">	re: <span class="number">1</span>,</span><br><span class="line">	im:<span class="number">-1</span>,</span><br><span class="line">	get phase() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">Math</span>.atan2(<span class="keyword">this</span>.im, <span class="keyword">this</span>.re);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o, <span class="string">"modules"</span>, &#123;<span class="attr">get</span>: modules, <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">configurable</span>: <span class="literal">true</span>&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(o.phase, o.modules);</span><br></pre></td></tr></table></figure>
<h3 id="4-6-æ„é€ å™¨ä¸­çš„this"><a href="#4-6-æ„é€ å™¨ä¸­çš„this" class="headerlink" title="4.6 æ„é€ å™¨ä¸­çš„this"></a>4.6 æ„é€ å™¨ä¸­çš„this</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyClass</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.a = <span class="number">37</span>; <span class="comment">// å…¨å±€å˜é‡a</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> MyClass(); <span class="comment">// this æŒ‡å‘o</span></span><br><span class="line"><span class="built_in">console</span>.log(o.a); <span class="comment">// 37ï¼Œoçš„åŸå‹é“¾æ˜¯MyClass</span></span><br></pre></td></tr></table></figure>
<h3 id="4-7-call-applyæ–¹æ³•ä¸this"><a href="#4-7-call-applyæ–¹æ³•ä¸this" class="headerlink" title="4.7 call/applyæ–¹æ³•ä¸this"></a>4.7 call/applyæ–¹æ³•ä¸this</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">c, d</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.a + <span class="keyword">this</span>.b + c + d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">3</span>&#125;;</span><br><span class="line">add.call(o, <span class="number">5</span>, <span class="number">7</span>);</span><br><span class="line">add.apply(o, [<span class="number">5</span>, <span class="number">7</span>]);</span><br><span class="line"><span class="comment">// callä¸applyå¸¸è§ä½¿ç”¨æ–¹æ³•ï¼Œå³æƒ³æŠŠæŸä¸ªå‡½æ•°æŒ‡å‘æŸä¸ªthis</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">this</span>));</span><br><span class="line">&#125;</span><br><span class="line">bar.call(<span class="number">7</span>); <span class="comment">// [object Number] this æŒ‡å‘ new Number(7)</span></span><br></pre></td></tr></table></figure>
<h3 id="4-8-bindæ–¹æ³•ä¸this"><a href="#4-8-bindæ–¹æ³•ä¸this" class="headerlink" title="4.8 bindæ–¹æ³•ä¸this"></a>4.8 bindæ–¹æ³•ä¸this</h3><p>ES5æ‰æä¾›ï¼ŒIE9+æ‰æ”¯æŒçš„å‡½æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> g = f.bind(&#123;<span class="attr">a</span>: <span class="string">"test"</span>&#125;); <span class="comment">// fçš„thisæŒ‡å‘å¯¹è±¡&#123;a:"test"&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(g()); <span class="comment">// test</span></span><br><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">a</span>: <span class="number">37</span>, <span class="attr">f</span>: f, <span class="attr">g</span>: g&#125;; <span class="comment">// fä¸­çš„thisæŒ‡å‘oï¼Œè€Œgçš„thisæŒ‡å‘ä¸º&#123;a:"test"&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(o.f(), o.g()); <span class="comment">// 37, test</span></span><br></pre></td></tr></table></figure>
<h3 id="4-9-å‡½æ•°å±æ€§-amp-amp-arguments"><a href="#4-9-å‡½æ•°å±æ€§-amp-amp-arguments" class="headerlink" title="4.9 å‡½æ•°å±æ€§ &amp;&amp; arguments"></a>4.9 å‡½æ•°å±æ€§ &amp;&amp; arguments</h3><ul>
<li><strong>arguments</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x, y, z</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">arguments</span>.length; <span class="comment">// 2</span></span><br><span class="line">	<span class="built_in">arguments</span>[<span class="number">0</span>]; <span class="comment">// 1</span></span><br><span class="line">	<span class="built_in">arguments</span>[<span class="number">0</span>] = <span class="number">10</span>; <span class="comment">// åœ¨use strictæ¨¡å¼ä¸‹ï¼Œæ— æ³•èµ‹å€¼ï¼Œxè¿˜æ˜¯ä¸º 1</span></span><br><span class="line">	x; <span class="comment">// 10</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">arguments</span>[<span class="number">2</span>] = <span class="number">100</span>;</span><br><span class="line">	z; <span class="comment">// undefined</span></span><br><span class="line">	<span class="built_in">arguments</span>.callee === foo; <span class="comment">// trueï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹åˆ™æ— æ³•ä½¿ç”¨callee</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">foo.length; <span class="comment">// 3</span></span><br><span class="line">foo.name; <span class="comment">// foo</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>apply/call</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(x, y, <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line">foo.call(<span class="number">100</span>, <span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 1, 2, Number</span></span><br><span class="line">foo.apply(<span class="literal">true</span>, [<span class="number">1</span>,<span class="number">2</span>]); <span class="comment">// 1, 2, Boolean(true)</span></span><br><span class="line">foo.apply(<span class="literal">null</span>); <span class="comment">// undefined, undefined, window (ä¸¥æ ¼æ¨¡å¼ä¸‹ä¸ºnull)</span></span><br><span class="line">foo.apply(<span class="literal">undefined</span>); <span class="comment">// undefined, undefined, window (ä¸¥æ ¼æ¨¡å¼ä¸‹ä¸ºundefined)</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>bind</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.x = <span class="number">9</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="built_in">module</span> = &#123;</span><br><span class="line">	x: <span class="number">81</span>, </span><br><span class="line">	getX: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.x;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">module</span>.getX(); <span class="comment">// 81 this æŒ‡å‘module</span></span><br><span class="line"><span class="keyword">var</span> getX = <span class="built_in">module</span>.getX;</span><br><span class="line">getX(); <span class="comment">// 9 this æŒ‡å‘å…¨å±€å˜é‡</span></span><br><span class="line"><span class="keyword">var</span> boundGetX = getX.bind(<span class="built_in">module</span>); </span><br><span class="line"><span class="comment">// ä½¿ç”¨call/applyï¼ŒboundGetXä¼šæŠ¥æœªå®šä¹‰çš„é”™è¯¯.</span></span><br><span class="line"><span class="comment">// åŸå› æ˜¯callè·Ÿapplyæ²¡æœ‰è¿”å›å€¼ï¼Œä½†æ˜¯å¯ä»¥è¿™æ ·ï¼Œ</span></span><br><span class="line"><span class="comment">// getX.call(module)();</span></span><br><span class="line"><span class="comment">// getX.apply(module)();</span></span><br><span class="line">boundGetX(); <span class="comment">// 81 å°†ä¸Šæ–‡çš„å…¨å±€å˜é‡æŒ‡å‘module</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>bindä¸å‡½æ•°é¢—ç²’åŒ–</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> func = add.bind(<span class="literal">undefined</span>, <span class="number">100</span>);</span><br><span class="line">func(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 103</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em> <code>add.bind(undefined, 100)</code> å…ˆå°†100ä¼ å‚ç»™addå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³aï¼›ç„¶å<code>func(1, 2)</code>åˆ™ä¼šä¼ å‚ç»™å‡½æ•°çš„bè·Ÿc</p>
<ul>
<li><strong>bindä¸new</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.b = <span class="number">100</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> func = foo.bind(&#123;<span class="attr">a</span>: <span class="number">1</span>&#125;);</span><br><span class="line">func(); <span class="comment">// 1</span></span><br><span class="line"><span class="keyword">new</span> func(); <span class="comment">// &#123;b: 100&#125;</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em> fooå‡½æ•°ä¸­è¿”å›å€¼é™¤éæ˜¯<strong>å¯¹è±¡</strong>ï¼Œå¦åˆ™å°±å°†<strong>this</strong>ä½œä¸ºè¿”å›å€¼è¿”å›ï¼Œ<strong>this</strong>ä¼šè¢«åˆå§‹åŒ–ä¸ºé»˜è®¤çš„ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå¹¶ä¸”<strong>this</strong>çš„åŸå‹æ˜¯<em>foo.prototype</em>ï¼Œè¯¥ç©ºå¯¹è±¡çš„bå±æ€§ä¼šèµ‹å€¼ä¸º100ï¼Œç„¶åæ•´ä¸ªå¯¹è±¡ä¼šè¢«ä½œä¸ºè¿”å›å€¼è¿”å›å¹¶ä¸”å¿½ç•¥returnçš„è¿”å›å€¼ã€‚</p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptä¹‹äº” - æ•°ç»„]]></title>
      <url>https://lucius0.github.io/2016/08/11/archivers/javascript-array/</url>
      <content type="html"><![CDATA[<p>æœ‰åºï¼Œå¼±ç±»å‹(å¤šç±»å‹)é›†åˆã€‚æ•°ç»„æ˜¯æœ‰é•¿åº¦é™åˆ¶çš„ï¼Œå³0~2^23 - 1</p>
<p>æ•°ç»„çš„åŸå‹é“¾ï¼š<code>[] -&gt; Array.prototype</code>; å¯¹è±¡çš„åŸå‹é“¾ï¼š<code>{} -&gt; Object.prototype</code></p>
<p><strong>å¸¸ç”¨æ–¹æ³•</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.join</span><br><span class="line"><span class="built_in">Array</span>.prototype.reverse</span><br><span class="line"><span class="built_in">Array</span>.prototype.sort</span><br><span class="line"><span class="built_in">Array</span>.prototype.concat</span><br><span class="line"><span class="built_in">Array</span>.prototype.slice</span><br><span class="line"><span class="built_in">Array</span>.prototype.splice</span><br><span class="line"><span class="built_in">Array</span>.prototype.foreach(ES5)</span><br><span class="line"><span class="built_in">Array</span>.prototype.map(ES5)</span><br><span class="line"><span class="built_in">Array</span>.prototype.filter(ES5)</span><br><span class="line"><span class="built_in">Array</span>.prototype.every(ES5)</span><br><span class="line"><span class="built_in">Array</span>.prototype.some(ES5)</span><br><span class="line"><span class="built_in">Array</span>.prototype.reduce/reduceRight(ES5)</span><br><span class="line"><span class="built_in">Array</span>.prototype.indexOf/<span class="built_in">Array</span>.prototype.lastIndexOf(ES5)</span><br><span class="line"><span class="built_in">Array</span>.isArray(ES5)</span><br></pre></td></tr></table></figure>
<ul>
<li>reduce</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> sum = arr.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">x,y</span>) </span>&#123; <span class="keyword">return</span> x + y&#125;, <span class="number">0</span>); <span class="comment">// 6</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em> reduceæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°åˆ™æ˜¯é€»è¾‘å‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨æ˜æ˜¯å¦è¦è·Ÿé¦–æ¬¡ä¼ å…¥é€»è¾‘å‡½æ•°çš„å‚æ•°è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œä¾‹å¦‚ä¸Šæ–‡ä¾‹å­ï¼Œä¼šå…ˆè¿›è¡Œ 0 + 1 = 1ï¼Œ1 + 2 = 3ï¼Œ3 + 3 = 6</p>
<ul>
<li>isArray</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.isArray([]); <span class="comment">// true</span></span><br><span class="line">[] <span class="keyword">instanceof</span> <span class="built_in">Array</span>; <span class="comment">// true</span></span><br><span class="line">(&#123;&#125;).toString.apply([]) === [<span class="string">"object Array"</span>]; <span class="comment">// true</span></span><br><span class="line">[].constructor === <span class="built_in">Array</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptä¹‹å›› - å¯¹è±¡]]></title>
      <url>https://lucius0.github.io/2016/08/09/archivers/javascript-object/</url>
      <content type="html"><![CDATA[<p>å¯¹è±¡ä¸­åŒ…å«ä¸€ç³»åˆ—å±æ€§ï¼Œè¿™äº›å±æ€§æ˜¯æ— åºçš„ã€‚æ¯ä¸ªå±æ€§éƒ½æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²keyå’Œå¯¹åº”çš„valueã€‚(æ— åºï¼Œkeyä¸ºå­—ç¬¦ä¸²)</p>
<h2 id="1ã€å¯¹è±¡ç»“æ„"><a href="#1ã€å¯¹è±¡ç»“æ„" class="headerlink" title="1ã€å¯¹è±¡ç»“æ„"></a>1ã€å¯¹è±¡ç»“æ„</h2><p>æ‹¥æœ‰<code>[[proto]]ã€[[class]](å±äºå“ªä¸ªç±»)ã€[[extensible]](æ˜¯å¦å…è®¸æ·»åŠ æ–°çš„å±æ€§)ã€writableã€enumerableã€configurableã€valueã€get/set</code></p>
<h2 id="2ã€new-åŸå‹é“¾"><a href="#2ã€new-åŸå‹é“¾" class="headerlink" title="2ã€new/åŸå‹é“¾"></a>2ã€new/åŸå‹é“¾</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">foo.prototype.z = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> foo();</span><br><span class="line">obj.y = <span class="number">2</span>;</span><br><span class="line">obj.x = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">obj.x; <span class="comment">// 1</span></span><br><span class="line">obj.y; <span class="comment">// 2</span></span><br><span class="line">obj.z; <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typeof</span> obj.toString; <span class="comment">// "function"</span></span><br><span class="line"><span class="string">"z"</span> <span class="keyword">in</span> obj; <span class="comment">// true</span></span><br><span class="line">obj.hasOwnProperty(<span class="string">"z"</span>); <span class="comment">//false</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em></p>
<ul>
<li><p><code>var obj = new foo();</code> objçš„[[proto]]åˆ™ä¼šæŒ‡å‘foo.prototype, è€Œfooçš„prototypeåˆ™ä¼šæŒ‡å‘Object.prototypeï¼ŒObject.prototypeåˆ™ä¼šæŒ‡å‘null</p>
</li>
<li><p><code>foo.prototype.z = 3;</code> åœ¨foo.prototypeæ·»åŠ ä¸€ä¸ªå±æ€§z</p>
</li>
<li><p><code>obj.z</code> ä¼šå…ˆä»objæŸ¥æ‰¾æ˜¯å¦æœ‰zè¿™ä¸ªå±æ€§ï¼Œç„¶åå†æŸ¥æ‰¾objçš„[[proto]]ï¼Œå³foo.prototype</p>
</li>
<li><p><code>obj.toString</code> è¯¥æ–¹æ³•æ˜¯åœ¨Object.prototypeä¸­ï¼Œå³Object.prototype.toString();</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">obj.z = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">obj.hasOwnProperty(<span class="string">"z"</span>); <span class="comment">// true</span></span><br><span class="line">foo.prototype.z; <span class="comment">// 3</span></span><br><span class="line">obj.z; <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line">obj.z = <span class="literal">undefined</span>;</span><br><span class="line">obj.z; <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> obj.z; <span class="comment">// true</span></span><br><span class="line">obj.z; <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> obj.z; <span class="comment">// true</span></span><br><span class="line">obj.z; <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em></p>
<ul>
<li><p><code>obj.z = 5;</code> èµ‹å€¼ä¸ä¼šå› ä¸ºobjæ²¡æœ‰zå±æ€§è€Œç»§ç»­å¾€prototypeæ‰¾æ˜¯å¦æœ‰è¿™ä¸ªå±æ€§ï¼Œä»è€Œä¿®æ”¹prototypeçš„å±æ€§ï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯objæ²¡æœ‰zå±æ€§ï¼Œåˆ™åªä¼šåœ¨objæ·»åŠ æ–°çš„zå±æ€§ï¼Œåè€Œfoo.prototype.zçš„å€¼ä¸ä¼šè¢«ä¿®æ”¹ã€‚</p>
</li>
<li><p><code>obj.hasOwnProperty(&quot;z&quot;);    foo.prototype.z;    obj.z;</code> zçš„å±æ€§æ˜¯æ·»åŠ åˆ°objä¸Šçš„ï¼Œfoo.prototype.zæ˜¯ä¸ä¼šå—åˆ°å½±å“çš„ï¼Œä¾æ—§ä¿ç•™ã€‚</p>
</li>
<li><p><code>obj.z = undefined;        obj.z;        foo.prototype.z;</code> åŒç†</p>
</li>
<li><p><code>delete obj.z;        obj.z;        delete obj.z;        obj.z;</code> delete åˆ é™¤çš„åªæ˜¯objçš„å±æ€§ï¼Œè€Œä¸ä¼šå½±å“foo.prototypeçš„å±æ€§ï¼Œä½†å½“objçš„zè¢«åˆ é™¤åï¼Œobj.zæŸ¥æ‰¾æ­¥éª¤åˆè·Ÿä¹‹å‰ä¸€æ ·ä¼šåˆ°foo.prototypeåŸå‹é“¾å»æŸ¥æ‰¾ã€‚</p>
</li>
</ul>
<h2 id="3ã€Object-create"><a href="#3ã€Object-create" class="headerlink" title="3ã€Object.create"></a>3ã€Object.create</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.create(&#123;<span class="attr">x</span>: <span class="number">1</span>&#125;);</span><br><span class="line">obj.x; <span class="comment">// 1</span></span><br><span class="line"><span class="keyword">typeof</span> obj.toString; <span class="comment">// "function"</span></span><br><span class="line">obj.hasOwnProperty(<span class="string">"x"</span>); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">obj.toString; <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em></p>
<ul>
<li><p><code>var obj = Object.create({x:1});</code> åˆ©ç”¨Object.createï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå…¶åŸå‹é“¾åˆ™æŒ‡å‘å‚æ•°ã€‚å³<code>obj -&gt; {x:1} -&gt; Object.prototype -&gt; null</code></p>
</li>
<li><p><code>obj.x; // 1</code> è°ƒç”¨åŸå‹é“¾ä¸Šçš„å‚æ•°</p>
</li>
</ul>
<h2 id="4ã€å±æ€§æ“ä½œ"><a href="#4ã€å±æ€§æ“ä½œ" class="headerlink" title="4ã€å±æ€§æ“ä½œ"></a>4ã€å±æ€§æ“ä½œ</h2><h3 id="4-1-å±æ€§è¯»å†™"><a href="#4-1-å±æ€§è¯»å†™" class="headerlink" title="4.1 å±æ€§è¯»å†™"></a>4.1 å±æ€§è¯»å†™</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">x</span>:<span class="number">1</span>&#125;;</span><br><span class="line">obj.x; <span class="comment">// è¯»</span></span><br><span class="line">obj.x = <span class="number">2</span>; <span class="comment">// å†™</span></span><br></pre></td></tr></table></figure>
<h3 id="4-2-å¼‚å¸¸"><a href="#4-2-å¼‚å¸¸" class="headerlink" title="4.2 å¼‚å¸¸"></a>4.2 å¼‚å¸¸</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">x</span>:<span class="number">1</span>&#125;;</span><br><span class="line">obj.y; <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">var</span> yx = obj.y.z; <span class="comment">// TypeError : Cannot read property "z" of undefined</span></span><br><span class="line">obj.y.z = <span class="number">2</span>; <span class="comment">// TypeError : Cannot set property "z" of undefinedï¼Œå‡å¦‚ obj.y = 1; obj.y.z=2; åˆ™ä¸ä¼šæŠ¥é”™</span></span><br></pre></td></tr></table></figure>
<h3 id="4-3-åˆ é™¤"><a href="#4-3-åˆ é™¤" class="headerlink" title="4.3 åˆ é™¤"></a>4.3 åˆ é™¤</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="built_in">Object</span>.prototype; <span class="comment">// false, è¿™æ˜¯å› ä¸ºObject.prototypeçš„configurableä¸ºfalse</span></span><br><span class="line"><span class="keyword">var</span> descriptor = <span class="built_in">Object</span>.getOwnPropertyDescriptor(<span class="built_in">Object</span>, <span class="string">"prototype"</span>);</span><br><span class="line">descriptor.configurable; <span class="comment">// falseï¼Œè¿™æ ·å°±æ— æ³•delete Object.prototype</span></span><br></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼š</p>
<ul>
<li><p>æ˜¯æ— æ³•åˆ é™¤åŸºæœ¬ç±»å‹çš„ï¼Œä¾‹å¦‚ï¼š<code>var a = 1;        delete a; // false</code> </p>
</li>
<li><p>æ˜¯æ— æ³•åˆ é™¤å‡½æ•°å£°æ˜çš„ï¼Œä¾‹å¦‚ï¼š<code>function func(){};        delete func; // false</code></p>
</li>
<li><p>å¯ä»¥åˆ é™¤éšå¼çš„å…¨å±€å˜é‡ï¼Œä¾‹å¦‚ï¼š<code>a = 1;         window.a; // 1        delete a; //true</code></p>
</li>
<li><p>å¯ä»¥åˆ é™¤evalå®šä¹‰å˜é‡ï¼Œä¾‹å¦‚ï¼š<code>eval(&quot;var x = 1&quot;);        delete x; //true</code></p>
</li>
</ul>
<h3 id="4-4-æ£€æµ‹"><a href="#4-4-æ£€æµ‹" class="headerlink" title="4.4 æ£€æµ‹"></a>4.4 æ£€æµ‹</h3><ul>
<li><p><code>&quot;x&quot; in obj;</code> ä¸ä»…ä»…ä¼šåœ¨è¯¥å¯¹è±¡æ‰¾ï¼Œè¿˜ä¼šæ²¿åŸå‹é“¾ä¸Šæ‰¾</p>
</li>
<li><p><code>obj.hasOwnProperty(&quot;x&quot;)</code> åªä¼šåœ¨è¯¥å¯¹è±¡æ‰¾ï¼Œä¸ä¼šåˆ°æ²¿åŸå‹é“¾ä¸Šæ‰¾</p>
</li>
<li><p><code>obj.propertyIsEnumeratable</code> æ˜¯å¦å¯æšä¸¾</p>
</li>
<li><p><code>Object.defineProperty(obj, propertyName, propertyArgsObject);</code></p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">"x"</span>, &#123;<span class="attr">enumeratable</span>: <span class="literal">false</span>, <span class="attr">value</span>: <span class="number">1000</span>&#125;);</span><br><span class="line">obj.propertyIsEnumerable(<span class="string">"x"</span>); <span class="comment">// false</span></span><br><span class="line">obj.hasOwnProperty(<span class="string">"x"</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="5ã€getter-setter"><a href="#5ã€getter-setter" class="headerlink" title="5ã€getter/setter"></a>5ã€getter/setter</h2><p>ç”¨æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">	_x:<span class="number">1</span>,</span><br><span class="line"></span><br><span class="line">	get x() &#123;</span><br><span class="line">		<span class="keyword">return</span> _x;</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	set x(val) &#123;</span><br><span class="line">		_x = val;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æ —å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(foo.prototype, <span class="string">"z"</span>, &#123;<span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="number">1</span>;&#125;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> foo();</span><br><span class="line">obj.z; <span class="comment">// 1</span></span><br><span class="line">obj.z = <span class="number">10</span>;</span><br><span class="line">obj.z; <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">"z"</span>, &#123;<span class="attr">value</span>: <span class="number">100</span>, <span class="attr">configurable</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">obj.z; <span class="comment">// 100</span></span><br><span class="line"><span class="keyword">delete</span> obj.z; <span class="comment">// true</span></span><br><span class="line">obj.z; <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em></p>
<ul>
<li><p><code>Object.defineProperty(foo.prototype, &quot;z&quot;, {get: function(){return 1;}});</code> ç»™fooçš„åŸå‹é“¾åˆ›å»ºå±æ€§zï¼Œå¹¶ç»™å…¶å±æ€§å£°æ˜getæ–¹æ³•</p>
</li>
<li><p><code>obj.z</code> è°ƒç”¨åŸå‹é“¾z</p>
</li>
<li><p><code>obj.z = 10</code> ç”±äºåŸå‹é“¾æœ‰getteræ–¹æ³•ï¼Œè¡¨æ˜è¯¥å±æ€§åœ¨åŸå‹é“¾ä¸Šåªè¯»ä¸å¯å†™ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šç»™åŸå‹é“¾ä¸Šåˆ›å»ºæ–°å±æ€§</p>
</li>
<li><p><code>obj.z</code> ä¾æ—§è°ƒç”¨åŸå‹é“¾getteræ–¹æ³•</p>
</li>
<li><p><code>Object.defineProperty(obj, &quot;z&quot;, {value: 100, configurable: true});</code> åœ¨objä¸Šåˆ›å»ºæ–°å±æ€§zï¼Œå¹¶è®¾ç½®configurableä¸ºtrueï¼Œå€¼ä¸º100</p>
</li>
<li><p><code>obj.z // 100</code> è°ƒç”¨objæœ¬èº«çš„å±æ€§z </p>
</li>
<li><p><code>delete obj.z</code> å› ä¸ºconfigurableä¸ºtrueï¼Œå› æ­¤å¯ä»¥åˆ é™¤</p>
</li>
<li><p><code>obj.z</code> objä¸Šçš„zè¢«åˆ é™¤äº†ï¼Œæ‰€ä»¥ä¼šé‡æ–°ä»åŸå‹é“¾ä¸ŠæŸ¥æ‰¾zå±æ€§</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o, <span class="string">"x"</span>, &#123;<span class="attr">value</span>: <span class="number">1</span>&#125;); <span class="comment">// writable = false, configurable = false;</span></span><br><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.create(o);</span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em> æ²¡å•¥è§£é‡Š</p>
<h2 id="6ã€å±æ€§æ ‡ç­¾"><a href="#6ã€å±æ€§æ ‡ç­¾" class="headerlink" title="6ã€å±æ€§æ ‡ç­¾"></a>6ã€å±æ€§æ ‡ç­¾</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Object.getOwnPropertyDescriptor(obj, propertyName);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(person, <span class="string">"name"</span>, &#123;<span class="attr">configurable</span>: <span class="literal">false</span>, <span class="attr">writable</span>: <span class="literal">false</span>, <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">value</span>: <span class="string">"Test"</span>&#125;);</span><br><span class="line"><span class="built_in">Object</span>.keys(person); <span class="comment">// ["name"]</span></span><br><span class="line">person.name; <span class="comment">// Test;</span></span><br><span class="line">person.name = <span class="string">"Test2"</span>;</span><br><span class="line">person.name; <span class="comment">// Test</span></span><br><span class="line"><span class="keyword">delete</span> person.name; <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em></p>
<p>-<code>Object.keys(person)</code> è·å–è¯¥å¯¹è±¡æ‰€æœ‰å¯æšä¸¾çš„å±æ€§</p>
<ul>
<li><p><code>Object.getOwnPropertyDescriptor(obj, propertyName)</code> è·å–å¯¹è±¡æè¿°å™¨ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è·å–æè¿°çš„å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¯¥å¯¹è±¡çš„å±æ€§ï¼Œè‹¥ä¸å­˜åœ¨åˆ™è¿”å›undefinedï¼Œåä¹‹åˆ™è¿”å›è¯¥å¯¹è±¡çš„å±æ€§é…ç½®</p>
</li>
<li><p><code>Object.defineProperty(person, &quot;name&quot;, {configurable: false, writable: false, enumerable: true, value: &quot;Test&quot;})</code> å®šä¹‰å±æ€§çš„é…ç½®ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå±æ€§æ˜¯ä¸å­˜åœ¨äºè¯¥å¯¹è±¡çš„å±æ€§ï¼Œç¬¬ä¸‰ä¸ªåˆ™å®šä¹‰è¯¥å¯¹è±¡çš„å±æ€§æè¿°å™¨å¯¹è±¡</p>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">c(configurable)/w(writable)</th>
<th>c:true/w:true</th>
<th>c:true/w:false</th>
<th>c:false/w:true</th>
<th>c:false/w:false</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ä¿®æ”¹å±æ€§çš„å€¼</td>
<td>âˆš</td>
<td>âˆš</td>
<td>âˆš</td>
<td>Ã—</td>
</tr>
<tr>
<td style="text-align:left">é€šè¿‡å±æ€§èµ‹å€¼ã€ä¿®æ”¹å±æ€§çš„å€¼</td>
<td>âˆš</td>
<td>Ã—</td>
<td>âˆš</td>
<td>Ã—</td>
</tr>
<tr>
<td style="text-align:left">deleteè¯¥å±æ€§è¿”å›true</td>
<td>âˆš</td>
<td>âˆš</td>
<td>Ã—</td>
<td>Ã—</td>
</tr>
<tr>
<td style="text-align:left">ä¿®æ”¹getter/setteræ–¹æ³•</td>
<td>âˆš</td>
<td>âˆš</td>
<td>Ã—</td>
<td>Ã—</td>
</tr>
<tr>
<td style="text-align:left">ä¿®æ”¹å±æ€§æ ‡ç­¾(é™¤äº†writableä»trueä¿®æ”¹ä¸ºfalseæ€»æ˜¯å…è®¸)</td>
<td>âˆš</td>
<td>âˆš</td>
<td>Ã—</td>
<td>Ã—</td>
</tr>
</tbody>
</table>
<p> <strong>æ³¨æ„ï¼š</strong>å‡å¦‚æˆ‘ä»¬æƒ³æ”¹å±æ€§çš„å€¼ï¼Œconfigurableä¸writableä¸ºfalseçš„è¯å°±æ²¡åŠæ³•ä¿®æ”¹äº†ï¼Œä½†æ˜¯å‡å¦‚writableä¸ºfalseï¼Œè€Œconfigurableä¸ºtrueçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å˜ç›¸çš„é€šè¿‡configurableä¿®æ”¹å±æ€§çš„å€¼ï¼Œå¦‚Object.defineProperty(xxx, x, {value: 1})æˆ–è€…é€šè¿‡configurableæ¥ä¿®æ”¹å±æ€§çš„writableçš„å€¼ä½¿å…¶èƒ½è¢«ä¿®æ”¹ï¼Œå¦‚Object.defineProperty(xxx, x, {writable: true});</p>
<h2 id="7ã€å¯¹è±¡æ ‡ç­¾"><a href="#7ã€å¯¹è±¡æ ‡ç­¾" class="headerlink" title="7ã€å¯¹è±¡æ ‡ç­¾"></a>7ã€å¯¹è±¡æ ‡ç­¾</h2><p>å¯¹è±¡æ ‡ç­¾æœ‰ä¸‰ç§ï¼š[[proto]]ã€[[class]]ã€[[extensible]]</p>
<ul>
<li><p><strong>[[proto]]ï¼š</strong> åŸå‹å¯¹è±¡</p>
</li>
<li><p><strong>[[class]]ï¼š</strong> è¡¨æ˜è¯¥å¯¹è±¡æ˜¯å“ªç§ç±»å‹çš„ç±»</p>
</li>
<li><p><strong>[[extensible]]ï¼š</strong> å¯¹è±¡æ˜¯å¦èƒ½å†è¢«æ·»åŠ æ–°çš„å±æ€§ï¼Œå¦‚ASçš„dynamic</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>&#125;;</span><br><span class="line"><span class="built_in">Object</span>.isExtensible(obj); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Object</span>.preventExtensions(obj);</span><br><span class="line"><span class="built_in">Object</span>.isExtensible(obj); <span class="comment">// false</span></span><br><span class="line">obj.z = <span class="number">1</span>;</span><br><span class="line">obj.z; <span class="comment">// undefinedï¼Œæ·»åŠ å¤±è´¥</span></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">"x"</span>);</span><br><span class="line"><span class="comment">// Object &#123;value: 1, writable: true, enumerable: true, configurable: true&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.seal(obj);</span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">"x"</span>);</span><br><span class="line"><span class="comment">// Object &#123;value: 1, writable: true, enumerable: true, configurable: false&#125;</span></span><br><span class="line"><span class="built_in">Object</span>.isSeal(obj); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.freeze(obj);</span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">"x"</span>);</span><br><span class="line"><span class="comment">// Object &#123;value: 1, writable: false, enumerable: true, configurable: false&#125;</span></span><br><span class="line"><span class="built_in">Object</span>.isFrozen(obj);</span><br></pre></td></tr></table></figure>
<p><em>è§£æï¼š</em></p>
<ul>
<li><p><code>Object.preventExtensions(obj)</code> é˜»æ­¢objæ‰©å±•æ–°å±æ€§ï¼Œä½†æ˜¯ä¸ä¼šå½±å“åˆ°æ—§çš„å±æ€§</p>
</li>
<li><p><code>Object.seal(obj)</code> è®¾ç½®configurableä¸ºfalse</p>
</li>
<li><p><code>Object.freeze(obj)</code> è®¾ç½®configurableè·Ÿwritableä¸ºfalse</p>
</li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong>ä»¥ä¸Šçš„æ–¹æ³•åªä¼šé™åˆ¶å½“å‰å¯¹è±¡ï¼Œå¹¶ä¸ä¼šå½±å“åˆ°åŸå‹é“¾å¯¹è±¡ï¼Œè‹¥æƒ³å½±å“åŸå‹é“¾çš„å¯¹è±¡ï¼Œå°±å¾—å¯¹åŸå‹é“¾å¯¹è±¡åšåŒæ ·çš„æ“ä½œ</p>
<h2 id="8ã€åºåˆ—åŒ–"><a href="#8ã€åºåˆ—åŒ–" class="headerlink" title="8ã€åºåˆ—åŒ–"></a>8ã€åºåˆ—åŒ–</h2><h3 id="8-1"><a href="#8-1" class="headerlink" title="8.1"></a>8.1</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="literal">true</span>, <span class="attr">z</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="attr">nullVal</span>: <span class="literal">null</span>&#125;;</span><br><span class="line"><span class="built_in">JSON</span>.stringify(obj); <span class="comment">// "&#123;"x":1,"y":true,"z":[1,2,3],"nullVal":null&#125;"</span></span><br><span class="line"></span><br><span class="line">obj = &#123;<span class="attr">val</span>: <span class="literal">undefined</span>, <span class="attr">a</span>: <span class="literal">NaN</span>, <span class="attr">b</span>: <span class="literal">Infinity</span>, <span class="attr">c</span>: <span class="keyword">new</span> <span class="built_in">Date</span>()&#125;;</span><br><span class="line"><span class="built_in">JSON</span>.stringify(obj); <span class="comment">// "&#123;"a":null,"b":null,"c":"2016-08-10T15:45:03.197Z"&#125;"</span></span><br><span class="line"></span><br><span class="line">obj = <span class="built_in">JSON</span>.parse(<span class="string">"&#123;'x': 1&#125;"</span>);</span><br><span class="line">obj.x; <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼š</p>
<ul>
<li><p><code>JSON.stringify(obj);</code> åºåˆ—åŒ–</p>
</li>
<li><p><code>JSON.parse(&quot;{&#39;x&#39;: 1}&quot;)</code> ååºåˆ—åŒ–ï¼Œæ³¨æ„å±æ€§æ˜¯ä»¥â€â€å¼•èµ·æ¥</p>
</li>
<li><p>undefined çš„å±æ€§ä¸ä¼šè¢«åºåˆ—åŒ–å‡ºæ¥</p>
</li>
<li><p>NaNæˆ–Infinity åˆ™ä¼šè¢«åºåˆ—åŒ–æˆnull</p>
</li>
<li><p>new Date() åˆ™ä¼šåºåˆ—åŒ–æˆUTCæ—¶é—´æ ¼å¼</p>
</li>
</ul>
<h3 id="8-2-è‡ªå®šä¹‰"><a href="#8-2-è‡ªå®šä¹‰" class="headerlink" title="8.2 è‡ªå®šä¹‰"></a>8.2 è‡ªå®šä¹‰</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">	x: <span class="number">1</span>,</span><br><span class="line">	y: <span class="number">2</span>,</span><br><span class="line">	z: &#123;</span><br><span class="line">		o1: <span class="number">1</span>,</span><br><span class="line">		o2: <span class="number">2</span>,</span><br><span class="line">		toJSON: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">this</span>.o1 + <span class="keyword">this</span>.o2;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">JSON</span>.stringify(obj); <span class="comment">// "&#123;"x":1,"y":2,"z":3&#125;"</span></span><br></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼šè‡ªå®šä¹‰zå±æ€§ï¼Œå…¶ä¸­toJSONä¸ºå›ºå®šå†™æ³•ï¼Œè‹¥ä¸æ˜¯toJSONåˆ™ä¸º<code>&quot;{&quot;x&quot;:1,&quot;y&quot;:2,&quot;z&quot;:{&quot;o1&quot;:1,&quot;o2&quot;:2}}&quot;</code></p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptä¹‹ä¸‰ - è¯­æ³•]]></title>
      <url>https://lucius0.github.io/2016/08/08/archivers/javascript-statement/</url>
      <content type="html"><![CDATA[<h2 id="1ã€block"><a href="#1ã€block" class="headerlink" title="1ã€block"></a>1ã€block</h2><p>ä¸€èˆ¬å°±æ˜¯{}åŒ…æ‹¬èµ·æ¥çš„ä»£ç å—ï¼Œæ³¨æ„çš„æ˜¯ï¼Œjsæ²¡æœ‰å—ä½œç”¨åŸŸï¼Œä½†æ˜¯æœ‰å‡½æ•°ä½œç”¨åŸŸï¼Œå…¨å±€ä½œç”¨åŸŸã€‚</p>
<h2 id="2ã€var"><a href="#2ã€var" class="headerlink" title="2ã€var"></a>2ã€var</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = b = <span class="number">1</span>; <span class="comment">// ç›¸å½“äºåˆ›å»ºäº†bä¸ºå…¨å±€ä½œç”¨åŸŸï¼Œè§£å†³æ–¹æ³•ï¼švar a = 1, b = 1</span></span><br></pre></td></tr></table></figure>
<p>å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> a = b = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">foo();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> a); <span class="comment">// "undefined"</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> b); <span class="comment">// "number" bä¸ºå…¨å±€å˜é‡</span></span><br></pre></td></tr></table></figure>
<h2 id="3ã€try-catch"><a href="#3ã€try-catch" class="headerlink" title="3ã€try catch"></a>3ã€try catch</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="keyword">throw</span> <span class="string">"test"</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span>(ex) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(ex); <span class="comment">// "test"</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">"finally"</span>); <span class="comment">// finally</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4ã€function"><a href="#4ã€function" class="headerlink" title="4ã€function"></a>4ã€function</h2><p><code>function fd() { // do something }; // å‡½æ•°å£°æ˜</code></p>
<p><code>var fe = function { // do something }; // å‡½æ•°è¡¨è¾¾å¼</code></p>
<p>åŒºåˆ«ï¼šå‡½æ•°å£°æ˜å¯ä»¥åœ¨å£°æ˜å‰è°ƒç”¨ï¼Œä¸”æ— æŠ¥é”™ï¼›è€Œå‡½æ•°è¡¨è¾¾å¼ä¸å¯ä»¥åœ¨å£°æ˜å‰è°ƒç”¨ï¼Œæœ‰TypeError </p>
<h2 id="5ã€forâ€¦in"><a href="#5ã€forâ€¦in" class="headerlink" title="5ã€forâ€¦in"></a>5ã€forâ€¦in</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">x</span>:<span class="number">1</span>, <span class="attr">y</span>:<span class="number">2</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(p <span class="keyword">in</span> obj) &#123;</span><br><span class="line">	<span class="comment">// è·å–objçš„keyå€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>é¡ºåºä¸ç¡®å®š</li>
<li>enumerableä¸ºfalseæ—¶ä¸æ˜¾ç¤º</li>
<li>forâ€¦in å¯¹è±¡å±æ€§å—åˆ°åŸå‹é“¾çš„å½±å“</li>
</ul>
<h2 id="6ã€ä¸¥æ ¼æ¨¡å¼"><a href="#6ã€ä¸¥æ ¼æ¨¡å¼" class="headerlink" title="6ã€ä¸¥æ ¼æ¨¡å¼"></a>6ã€ä¸¥æ ¼æ¨¡å¼</h2><p>ä¸¥æ ¼æ¨¡å¼æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ‰§è¡Œæ¨¡å¼ï¼Œå®ƒä¿®å¤äº†éƒ¨åˆ†è¯­è¨€ä¸Šçš„ä¸è¶³ï¼Œæä¾›æ›´å¼ºçš„é”™è¯¯æ£€æŸ¥ï¼Œå¹¶å¢å¼ºå®‰å…¨æ€§</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>  <span class="title">func</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">// psï¼šie ä¸è®¤è¯¥æ¨¡å¼ï¼Œä¼šè‡ªåŠ¨å¿½ç•¥ä¸¥æ ¼æ¨¡å¼</span></span><br><span class="line">	<span class="comment">// æ–¹æ³•funcæŒ‰ç…§ä¸¥æ ¼æ¨¡å¼æ‰§è¡Œ</span></span><br><span class="line"><span class="meta">	"use strict"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.</span></span><br><span class="line"><span class="meta">"use strict"</span> <span class="comment">// æŒ‰ç…§ä¸¥æ ¼æ¨¡å¼æ¥</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸¥æ ¼æ¨¡å¼ï¼š</p>
<ul>
<li>ä¸å…è®¸ä½¿ç”¨with(SyntaxError);</li>
<li>ä¸å…è®¸ç»™æœªå£°æ˜çš„å˜é‡èµ‹å€¼(RefrenceError);</li>
<li>argumentså˜ä¸ºå‚æ•°çš„é™æ€å˜é‡ï¼›</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ­£å¸¸çŠ¶æ€ä¸‹</span></span><br><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">	<span class="comment">// "use strict";</span></span><br><span class="line">	<span class="built_in">arguments</span>[<span class="number">0</span>] = <span class="number">100</span>;</span><br><span class="line">	<span class="built_in">console</span>.log(a);</span><br><span class="line">&#125;(<span class="number">1</span>);</span><br><span class="line"><span class="comment">// ps: è‹¥æœ‰ä¼ å‚çš„è¯ï¼Œåˆ™arguments[0]å¯ä»¥æ”¹å˜açš„å€¼ï¼Œå³açš„å€¼ä¸º100ï¼Œ</span></span><br><span class="line"><span class="comment">//     è‹¥ä¸ä¼ å‚ï¼Œå³!function(a)&#123;&#125;();åˆ™æ— è®ºæ˜¯å¦æœ‰argumentsçš„èµ‹å€¼ï¼Œaéƒ½æ˜¯ä¸ºundefined</span></span><br><span class="line"><span class="comment">// ä¸¥æ ¼æ¨¡å¼ï¼š</span></span><br><span class="line"><span class="comment">// 		1) å€¼ä¼ é€’ï¼šä¼ å‚åˆ™1ï¼Œæ— ä¼ å‚åˆ™undefined</span></span><br><span class="line"><span class="comment">//		2) å€ä¼ é€’ï¼šè‹¥åœ¨æ— ä¼ å‚çš„æƒ…å†µä¸‹èµ‹å€¼åˆ™ä¼šæŠ¥é”™</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ä¸¥æ ¼æ¨¡å¼ä¸‹åˆ é™¤å½¢å‚ä¼šæŠ¥é”™(1.configurableä¸ºtrueåˆ™æŠ¥SyntaxErrorï¼›2.configurableä¸ºfalseåˆ™æŠ¥TypeError)ï¼›</li>
<li>å¯¹è±¡å­—é¢é‡å±æ€§é‡å¤æŠ¥é”™ã€‚<code>var obj = {x:1, x:2}; // SyntaxError</code></li>
<li>ç¦æ­¢å…«è¿›åˆ¶å­—é¢é‡ <code>console.log(0123); //SyntaxError</code></li>
<li>eval, argumentså˜ä¸ºå…³é”®å­—ï¼Œä¸èƒ½ä½œä¸ºå˜é‡ã€å‡½æ•°åï¼Œè‹¥è¿ååˆ™æŠ¥SyntaxError </li>
<li>evalç‹¬ç«‹ä½œç”¨åŸŸ</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">eval</span>(<span class="string">"val evalValue = 2;"</span>);</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="keyword">typeof</span> evalValue);<span class="comment">//number</span></span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="meta">	"use strict"</span>;</span><br><span class="line">	<span class="built_in">eval</span>(<span class="string">"var evalValue = 2;"</span>);</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="keyword">typeof</span> evalValue);<span class="comment">//undefinedï¼ŒåŸå› æ˜¯evalç‹¬ç«‹ä½œç”¨åŸŸ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ä¸¥æ ¼æ¨¡å¼æ€»ç»“ï¼š</strong></p>
<ol>
<li>ä¸å…è®¸ä½¿ç”¨withï¼›</li>
<li>æ‰€æœ‰å˜é‡å¿…é¡»å£°æ˜ï¼Œèµ‹å€¼ç»™æœªå£°æ˜çš„å˜é‡æŠ¥é”™ï¼Œè€Œä¸æ˜¯éšå¼åˆ›å»ºå…¨å±€å˜é‡ï¼›</li>
<li>evalä¸­çš„ä»£ç ä¸èƒ½åˆ›å»ºevalæ‰€åœ¨çš„ä½œç”¨åŸŸå˜é‡ã€å‡½æ•°ï¼Œè€Œæ˜¯ä¸ºevalå•ç‹¬åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸï¼Œå¹¶åœ¨evalè¿”å›æ—¶åºŸå¼ƒï¼›</li>
<li>å‡½æ•°ä¸­çš„ç‰¹æ®Šå¯¹è±¡argumentsæ˜¯é™æ€å‰¯æœ¬ï¼Œè€Œä¸åƒéä¸¥æ ¼æ¨¡å¼é‚£æ ·ï¼Œä¿®æ”¹argumentsæˆ–ä¿®æ”¹å½¢å‚ä¼šç›¸äº’å½±å“ï¼›</li>
<li>åˆ é™¤configurableä¸ºfalseä¼šæŠ¥é”™ï¼Œè€Œä¸æ˜¯é€‰æ‹©å¿½ç•¥ï¼›</li>
<li>ç¦æ­¢å…«è¿›åˆ¶å­—é¢é‡ï¼›</li>
<li>evalã€argumentsä¸ºå…³é”®å­—ï¼Œä¸èƒ½ä½œä¸ºå˜é‡åæˆ–å‡½æ•°åï¼›</li>
<li>ä¸€èˆ¬å‡½æ•°çš„è°ƒç”¨(ä¸æ˜¯å¯¹è±¡æ–¹æ³•çš„è°ƒç”¨ï¼Œä¹Ÿä¸æ˜¯ç”¨apply/call/bindç­‰ä¿®æ”¹thisæŒ‡å‘)ï¼ŒthisæŒ‡å‘nullè€Œä¸æ˜¯å…¨å±€å¯¹è±¡ï¼›</li>
<li>è‹¥ä½¿ç”¨apply/callï¼Œå½“ä¼ å…¥nullæˆ–è€…undefinedæ—¶ï¼ŒthisæŒ‡å‘nullæˆ–undefinedè€Œä¸æ˜¯å…¨å±€å¯¹è±¡ï¼›</li>
<li>è¯•å›¾ä¿®æ”¹ä¸å¯å†™å±æ€§(writable=false)ï¼Œåœ¨ä¸å¯æ‰©å±•çš„å¯¹è±¡ä¸Šæ·»åŠ å±æ€§æ—¶æŠ¥TypeErrorï¼Œè€Œä¸æ˜¯å¿½ç•¥ï¼›</li>
<li>arguments.callerã€arguments.calleeè¢«ç¦ç”¨</li>
</ol>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptä¹‹ä¸€ - æ•°æ®ç±»å‹]]></title>
      <url>https://lucius0.github.io/2016/08/07/archivers/javascript-data-types/</url>
      <content type="html"><![CDATA[<p>ä»¥ä¸‹ç¬”è®°æ˜¯è§‚çœ‹<a href="http://www.imooc.com/view/277" target="_blank" rel="noopener">ã€Šæ·±å…¥æµ…å‡ºjavascriptã€‹</a>æ‰€è®°ä¸‹çš„ã€‚</p>
<p>javascript å› ä¸ºæ˜¯å¼±ç±»å‹ï¼Œæ‰€ä»¥å£°æ˜ç±»å‹å¯ä»¥çœç•¥</p>
<h2 id="1-å…­ç§åŸºæœ¬ç±»å‹"><a href="#1-å…­ç§åŸºæœ¬ç±»å‹" class="headerlink" title="1. å…­ç§åŸºæœ¬ç±»å‹"></a>1. <strong>å…­ç§åŸºæœ¬ç±»å‹</strong></h2><p>   åŸºç¡€ç±»å‹ï¼šnumberã€stringã€booleanã€nullã€undefined</p>
<p>   å¯¹è±¡ç±»å‹ï¼šobject(Functionã€Arrayã€Date)</p>
<h2 id="2-éšå¼è½¬æ¢"><a href="#2-éšå¼è½¬æ¢" class="headerlink" title="2. éšå¼è½¬æ¢"></a>2. <strong>éšå¼è½¬æ¢</strong></h2><p>   (â€œnumâ€ - 0) -&gt; number; (num + â€œâ€) -&gt; string</p>
<ul>
<li><p>ç­‰äº(ä¼šå‘ç”Ÿéšå¼è½¬æ¢)</p>
<p>   trueï¼šâ€1.23â€ == 1.23ï¼›0 == falseï¼›null == undefinedï¼›new Object() == new Object()ï¼›[1,2] == [1,2]ï¼›new String(â€œhiâ€) == â€œhiâ€</p>
</li>
<li><p>ä¸¥æ ¼ç­‰äº(ä¼šåˆ¤æ–­ä¸¤è¾¹çš„ç±»å‹ï¼Œç±»å‹ä¸åŒåˆ™ä¸ºfalseï¼Œåä¹‹åˆ¤æ–­å€¼æ˜¯å¦ç›¸åŒ)</p>
<p>   trueï¼šnull === nullï¼›undefined === undefinedï¼›</p>
<p>   falseï¼šNaN === NaNï¼›NaN == NaNï¼›null === undefinedï¼›new Object() === new Object()</p>
</li>
</ul>
<h2 id="3-åŒ…è£…å¯¹è±¡"><a href="#3-åŒ…è£…å¯¹è±¡" class="headerlink" title="3. åŒ…è£…å¯¹è±¡"></a>3. <strong>åŒ…è£…å¯¹è±¡</strong></h2><p>   <code>console.log(&quot;string&quot;)</code>è·Ÿ<code>console.log(new String(&quot;string&quot;))</code>æ˜¯ä¸åŒçš„ã€‚</p>
<p>   <code>var a = &quot;string&quot;; console.log(a.length); // 6</code>å³è¡¨æ˜åœ¨è®¿é—®å±æ€§çš„æ—¶å€™ä¼šå°†aä¸´æ—¶å°è£…æˆå¯¹è±¡ï¼Œä½†è®¿é—®å®Œä¹‹åï¼Œä¸´æ—¶å¯¹è±¡ä¹Ÿä¼šè¢«é”€æ¯ã€‚<code>a.t = 10;</code>å°è£…açš„ä¸´æ—¶åŒ…è£…å¯¹è±¡ï¼Œèµ‹å€¼ç»“æŸåï¼Œä¸´æ—¶å¯¹è±¡ä¼šè¢«é”€æ¯ã€‚<code>console.log(a.t);//undefined</code>ä¸´æ—¶å¯¹è±¡è¢«é”€æ¯äº†ã€‚</p>
<h2 id="4-ç±»å‹æ£€æµ‹"><a href="#4-ç±»å‹æ£€æµ‹" class="headerlink" title="4. ç±»å‹æ£€æµ‹"></a>4. <strong>ç±»å‹æ£€æµ‹</strong></h2><pre><code>typeofã€instanceofã€Object.prototype.toString
</code></pre><ul>
<li><p>typeof</p>
<p>   typeof 100 â€œnumberâ€ã€typeof true â€œbooleanâ€ã€typeof function â€œfunctionâ€ã€typeof undefined â€œundefinedâ€</p>
<p>   typeof new Object() â€œobjectâ€ã€typeof[1,2] â€œobjectâ€ã€typeof NaN â€œnumberâ€ã€typeof null â€œobjectâ€(æ³¨æ„ä¸æ˜¯nullï¼Œè€Œæ˜¯object)</p>
</li>
<li><p>instanceof(åŸºäºåŸå‹é“¾åˆ¤æ–­çš„æ“ä½œç¬¦ï¼Œå¯ä»¥åˆ¤æ–­æ˜¯å¦ä¸ºå…·ä½“çš„ç±»å‹)</p>
<p>   <strong>åŸç†</strong>ï¼š<code>object instanceof Object</code>å·¦è¾¹çš„æ“ä½œæ•°çš„å¯¹è±¡çš„åŸå‹é“¾ä¸Šæ˜¯å¦æœ‰å³è¾¹æ„é€ å‡½æ•°çš„prototypeå±æ€§</p>
<p>   <code>[1,2] instanceof Array &quot;true&quot;</code>ã€<code>new Object() instanceof Array &quot;false&quot;</code></p>
<p>   <strong>æ³¨æ„</strong>ï¼šä¸åŒwindowæˆ–iframeé—´çš„å¯¹è±¡ç±»å‹æ£€æµ‹ä¸èƒ½ä½¿ç”¨instanceof</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Student.prototype = <span class="keyword">new</span> Person(); <span class="comment">// Person</span></span><br><span class="line">Student.prototype.construtor = Student; <span class="comment">// function Student()&#123;&#125;</span></span><br><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> Student();</span><br><span class="line">o <span class="keyword">instanceof</span> Student; <span class="comment">// true</span></span><br><span class="line">o <span class="keyword">instanceof</span> Person; <span class="comment">// true</span></span><br><span class="line"><span class="keyword">var</span> oo = <span class="keyword">new</span> Person();</span><br><span class="line">oo <span class="keyword">instanceof</span> Person; <span class="comment">// true</span></span><br><span class="line">oo <span class="keyword">instanceof</span> Student; <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Object.prototype.toString</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.toString.apply([]); <span class="comment">// [object Array]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.apply(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;); <span class="comment">// [object Function]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.apply(<span class="literal">null</span>); <span class="comment">// [object Null]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.apply(<span class="literal">undefined</span>); <span class="comment">// [object Undefined]</span></span><br></pre></td></tr></table></figure>
<p> <strong>æ³¨æ„</strong>ï¼šIE/6/7/8 <code>Object.prototype.toString.apply(null); // [object Object]</code></p>
<p> <strong>æ€»ç»“ï¼š</strong> typeof é€‚åˆåŸºæœ¬ç±»å‹åŠfunctionæ£€æµ‹ï¼Œé‡åˆ°nullå¤±æ•ˆï¼›Classé€šè¿‡{}.toStringæ‹¿åˆ°ï¼Œé€‚åˆå†…ç½®å¯¹è±¡å’ŒåŸºæœ¬ç±»å‹ï¼Œé‡åˆ°nullå’Œundefinedå¤±æ•ˆ(IE 6/7/8è¿”å›[object Object])ï¼›instanceofé€‚ç”¨è‡ªå®šä¹‰å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥æ£€æµ‹åŸç”Ÿå¯¹è±¡ï¼Œåœ¨ä¸åŒiframeå’Œwindowé—´æ£€æµ‹æ—¶å¤±æ•ˆã€‚<br> <!-- ![](/images/javascript/JavaScript-data-types-01.png) --></p>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptä¹‹äºŒ - è¡¨è¾¾å¼]]></title>
      <url>https://lucius0.github.io/2016/08/07/archivers/javascript-expression/</url>
      <content type="html"><![CDATA[<h2 id="1-delete"><a href="#1-delete" class="headerlink" title="1. delete"></a>1. <strong>delete</strong></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">x</span>:<span class="number">1</span>&#125;;</span><br><span class="line">obj.x; <span class="comment">// 1</span></span><br><span class="line"><span class="keyword">delete</span> obj.x;</span><br><span class="line">obj.x; <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj1, <span class="string">"x"</span>, &#123;</span><br><span class="line">	configurable: <span class="literal">false</span>, <span class="comment">// configurableä¸ºfalseè¡¨ç¤ºè¯¥å€¼æ— æ³•åˆ é™¤</span></span><br><span class="line">	value: <span class="number">1</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">delete</span> obj1.x; <span class="comment">// false</span></span><br><span class="line">obj1.x; <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<h2 id="2-in"><a href="#2-in" class="headerlink" title="2. in"></a>2. <strong>in</strong></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.x = <span class="number">1</span>; <span class="comment">//å…¨å±€å˜é‡</span></span><br><span class="line"><span class="string">"x"</span> <span class="keyword">in</span> <span class="built_in">window</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="3-new"><a href="#3-new" class="headerlink" title="3. new"></a>3. <strong>new</strong></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">Foo.prototype.x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> Foo();</span><br><span class="line">obj.x; <span class="comment">// 1</span></span><br><span class="line">obj.hasOwnProperty(<span class="string">"x"</span>); <span class="comment">// false</span></span><br><span class="line">obj.__proto__.hasOwnProperty(<span class="string">"x"</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="4-this"><a href="#4-this" class="headerlink" title="4. this"></a>4. <strong>this</strong></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>; <span class="comment">// window</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">fun</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>; &#125;&#125;;</span><br><span class="line">obj.func(); <span class="comment">// obj</span></span><br></pre></td></tr></table></figure>
<h2 id="5-void"><a href="#5-void" class="headerlink" title="5. void"></a>5. <strong>void</strong></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="number">0</span>; <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">void</span> (<span class="number">0</span>); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> front-end </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æ¬è¿›jekyll]]></title>
      <url>https://lucius0.github.io/2016/08/06/archivers/move-to-jekyll/</url>
      <content type="html"><![CDATA[<p>ç»è¿‡å‡ ä¸ªä¸‹ç­çš„æ—¶é—´ï¼Œç»ˆäºæŠŠjekyllæ£å¼„å¥½äº†ã€‚æœŸé—´æ„Ÿè°¢ä»¥ä¸‹å‡ ä½åšå®¢çš„æ•™ç¨‹<a href="http://www.ezlippi.com/blog/2015/03/github-pages-blog.html" target="_blank" rel="noopener">ezlippi</a>ä»¥åŠ<a href="http://blog.csdn.net/dliyuedong/article/details/46848155" target="_blank" rel="noopener">æè·ƒä¸œ</a>ï¼Œè¿˜æœ‰ä¸€äº›æŸ¥æ‰¾é—®é¢˜çš„è¿‡ç¨‹ä¸­å¿˜è®°å­˜æ¡£ä¸‹æ¥çš„åšä¸»ã€‚</p>
<p><strong>ä»¥ä¸‹è®°å½•ä»¥ä¸‹æˆ‘é‡åˆ°çš„é—®é¢˜ï¼š</strong></p>
<ol>
<li><p>gitçš„ä½¿ç”¨è·Ÿrubyçš„å®‰è£…è¯·å‚è€ƒ<a href="http://www.ezlippi.com/blog/2015/03/github-pages-blog.html" target="_blank" rel="noopener">ezlippi</a>ï¼Œä½†æ˜¯åœ¨å®‰è£…jekyllçš„æ—¶å€™ï¼Œä¸‹è½½é€Ÿåº¦ä¼šå¾ˆæ…¢ä»¥è‡³äºç»å¸¸å¤±è´¥ï¼Œå¤§å®¶å¯ä»¥ä½¿ç”¨<a href="https://ruby.taobao.org/" target="_blank" rel="noopener">æ·˜å®çš„é•œåƒ</a>æˆ–è€…<a href="http://gems.ruby-china.org/" target="_blank" rel="noopener">Ruby Chinaçš„é•œåƒ</a>(æ¨è)ã€‚åœ¨ä½¿ç”¨é•œåƒå®‰è£…ä¹‹å‰ä¼šå…ˆå¸è½½è‡ªå¸¦çš„é•œåƒ<br><code>--remove https://rubygems.org/</code>ï¼Œä½†æ˜¯åœ¨æ·»åŠ æ–°çš„é•œåƒçš„æ—¶å€™ä¼šæŠ¥æ‰¾ä¸åˆ°è¯¥æ–°é•œåƒçš„é”™è¯¯ï¼Œä¸€æ—¦æœ‰è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ³•å°±æ˜¯åˆ°<code>user/your account/.gemrc</code> å°†sourcesçš„å€¼æ”¹ä¸ºæ–°é•œåƒåœ°å€å°±å¯ä»¥äº†ã€‚ </p>
</li>
<li><p>jekyll 3.2.0æœ‰è·¯å¾„æŸ¥æ‰¾é”™è¯¯çš„bugã€‚æˆ‘æ˜¯é€€å›åˆ°3.1.6å°±å¯ä»¥äº†ã€‚å®˜æ–¹åœ¨3.2.1å·²ç»ä¿®å¤ã€‚è‹¥æœ‰é—®é¢˜ï¼Œå¯ä»¥<br><code>gem install -v 3.1.6 jekyll -V</code> æ¥å®‰è£…3.1.6ç‰ˆæœ¬ã€‚</p>
</li>
<li><p><a href="http://jekyllcn.com/" target="_blank" rel="noopener">jekyllcn</a>æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¸­æ–‡å®˜æ–¹æ–‡æ¡£ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒã€‚</p>
</li>
<li><p>è¯„è®ºæˆ‘æ˜¯ç”¨å¤šè¯´çš„ï¼Œåªè¦å»å¤šè¯´å®˜ç½‘åˆ›å»ºä¸€ä¸ªç®¡ç†ç«™ç‚¹å°±å¯ä»¥äº†ï¼Œè¯¦ç»†å¤§å®¶å¯ä»¥è‡ªè¡Œæœç´¢ã€‚</p>
</li>
<li><p>ç«™å†…æœç´¢å¯ä»¥å‚è€ƒ<a href="http://blog.csdn.net/dliyuedong/article/details/46848155" target="_blank" rel="noopener">æè·ƒä¸œ</a>ã€‚</p>
</li>
</ol>
<p>ä»¥ä¸Šæ˜¯æˆ‘çš„åˆ†äº«ï¼Œjekyllæ˜¯æˆ‘ä»WordPressæ¬è¿‡æ¥ä¹‹åæ„Ÿè§‰å¾ˆå¿«å¾ˆçˆ½çš„ä¸€ä¸ªé™æ€åšå®¢ç½‘ç«™ï¼Œå¸Œæœ›å¤§å®¶enjoy itï¼</p>
]]></content>
      
        <categories>
            
            <category> jekyll </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jekyll </tag>
            
        </tags>
        
    </entry>
    
  
  
    
    <entry>
      <title></title>
      <url>https://lucius0.github.io/404.html</url>
      <content type="html"><![CDATA[<!DOCTYPE HTML>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8;">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="robots" content="all">
  <meta name="robots" content="index,follow">
</head>
<body>

<script type="text/javascript" src="http://www.qq.com/404/search_children.js" charset="utf-8" homepageurl="/" homepagename="å›åˆ°æˆ‘çš„ä¸»é¡µ">
</script>

</body>
</html>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[about]]></title>
      <url>https://lucius0.github.io/about/index.html</url>
      <content type="html"><![CDATA[<h1>WElCOME</h1>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[categories]]></title>
      <url>https://lucius0.github.io/categories/index.html</url>
      <content type="html"></content>
    </entry>
    
    <entry>
      <title><![CDATA[tags]]></title>
      <url>https://lucius0.github.io/tags/index.html</url>
      <content type="html"></content>
    </entry>
    
  
</search>
